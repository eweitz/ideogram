{"version":3,"file":"ideogram.min.js","mappings":"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","sources":["webpack://ideogram/webpack/universalModuleDefinition","webpack://ideogram/./node_modules/workbox-core/_version.js","webpack://ideogram/./node_modules/workbox-range-requests/_version.js","webpack://ideogram/webpack/bootstrap","webpack://ideogram/webpack/runtime/define property getters","webpack://ideogram/webpack/runtime/hasOwnProperty shorthand","webpack://ideogram/webpack/runtime/make namespace object","webpack://ideogram/./src/js/version.js","webpack://ideogram/./node_modules/d3-selection/src/selector.js","webpack://ideogram/./node_modules/d3-selection/src/array.js","webpack://ideogram/./node_modules/d3-selection/src/selectorAll.js","webpack://ideogram/./node_modules/d3-selection/src/matcher.js","webpack://ideogram/./node_modules/d3-selection/src/selection/selectChild.js","webpack://ideogram/./node_modules/d3-selection/src/selection/selectChildren.js","webpack://ideogram/./node_modules/d3-selection/src/selection/sparse.js","webpack://ideogram/./node_modules/d3-selection/src/selection/enter.js","webpack://ideogram/./node_modules/d3-selection/src/selection/data.js","webpack://ideogram/./node_modules/d3-selection/src/selection/sort.js","webpack://ideogram/./node_modules/d3-selection/src/namespaces.js","webpack://ideogram/./node_modules/d3-selection/src/namespace.js","webpack://ideogram/./node_modules/d3-selection/src/selection/attr.js","webpack://ideogram/./node_modules/d3-selection/src/window.js","webpack://ideogram/./node_modules/d3-selection/src/selection/style.js","webpack://ideogram/./node_modules/d3-selection/src/selection/property.js","webpack://ideogram/./node_modules/d3-selection/src/selection/classed.js","webpack://ideogram/./node_modules/d3-selection/src/selection/text.js","webpack://ideogram/./node_modules/d3-selection/src/selection/html.js","webpack://ideogram/./node_modules/d3-selection/src/selection/raise.js","webpack://ideogram/./node_modules/d3-selection/src/selection/lower.js","webpack://ideogram/./node_modules/d3-selection/src/creator.js","webpack://ideogram/./node_modules/d3-selection/src/selection/insert.js","webpack://ideogram/./node_modules/d3-selection/src/selection/remove.js","webpack://ideogram/./node_modules/d3-selection/src/selection/clone.js","webpack://ideogram/./node_modules/d3-selection/src/selection/on.js","webpack://ideogram/./node_modules/d3-selection/src/selection/dispatch.js","webpack://ideogram/./node_modules/d3-selection/src/selection/index.js","webpack://ideogram/./node_modules/d3-selection/src/selection/select.js","webpack://ideogram/./node_modules/d3-selection/src/selection/selectAll.js","webpack://ideogram/./node_modules/d3-selection/src/selection/filter.js","webpack://ideogram/./node_modules/d3-selection/src/constant.js","webpack://ideogram/./node_modules/d3-selection/src/selection/exit.js","webpack://ideogram/./node_modules/d3-selection/src/selection/join.js","webpack://ideogram/./node_modules/d3-selection/src/selection/merge.js","webpack://ideogram/./node_modules/d3-selection/src/selection/order.js","webpack://ideogram/./node_modules/d3-selection/src/selection/call.js","webpack://ideogram/./node_modules/d3-selection/src/selection/nodes.js","webpack://ideogram/./node_modules/d3-selection/src/selection/node.js","webpack://ideogram/./node_modules/d3-selection/src/selection/size.js","webpack://ideogram/./node_modules/d3-selection/src/selection/empty.js","webpack://ideogram/./node_modules/d3-selection/src/selection/each.js","webpack://ideogram/./node_modules/d3-selection/src/selection/append.js","webpack://ideogram/./node_modules/d3-selection/src/selection/datum.js","webpack://ideogram/./node_modules/d3-selection/src/selection/iterator.js","webpack://ideogram/./node_modules/d3-selection/src/select.js","webpack://ideogram/./node_modules/d3-fetch/src/blob.js","webpack://ideogram/./node_modules/d3-fetch/src/buffer.js","webpack://ideogram/./node_modules/d3-dsv/src/dsv.js","webpack://ideogram/./node_modules/d3-dsv/src/csv.js","webpack://ideogram/./node_modules/d3-dsv/src/tsv.js","webpack://ideogram/./node_modules/d3-fetch/src/text.js","webpack://ideogram/./node_modules/d3-fetch/src/dsv.js","webpack://ideogram/./node_modules/d3-fetch/src/image.js","webpack://ideogram/./node_modules/d3-fetch/src/json.js","webpack://ideogram/./node_modules/d3-fetch/src/xml.js","webpack://ideogram/./node_modules/d3-dispatch/src/dispatch.js","webpack://ideogram/./node_modules/d3-drag/src/noevent.js","webpack://ideogram/./node_modules/d3-color/src/define.js","webpack://ideogram/./node_modules/d3-color/src/color.js","webpack://ideogram/./node_modules/d3-interpolate/src/basis.js","webpack://ideogram/./node_modules/d3-interpolate/src/constant.js","webpack://ideogram/./node_modules/d3-interpolate/src/color.js","webpack://ideogram/./node_modules/d3-interpolate/src/rgb.js","webpack://ideogram/./node_modules/d3-interpolate/src/array.js","webpack://ideogram/./node_modules/d3-interpolate/src/date.js","webpack://ideogram/./node_modules/d3-interpolate/src/number.js","webpack://ideogram/./node_modules/d3-interpolate/src/object.js","webpack://ideogram/./node_modules/d3-interpolate/src/basisClosed.js","webpack://ideogram/./node_modules/d3-interpolate/src/string.js","webpack://ideogram/./node_modules/d3-interpolate/src/numberArray.js","webpack://ideogram/./node_modules/d3-interpolate/src/value.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selector.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selectorAll.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/matcher.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/selectChild.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/selectChildren.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/sparse.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/enter.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/data.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/sort.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/namespaces.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/namespace.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/attr.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/window.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/style.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/property.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/classed.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/text.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/html.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/raise.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/lower.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/creator.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/insert.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/remove.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/clone.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/on.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/dispatch.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/index.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/select.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/pointer.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/sourceEvent.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/select.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/selectAll.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/array.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/filter.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/constant.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/exit.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/join.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/merge.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/order.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/call.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/nodes.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/node.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/size.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/empty.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/each.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/append.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/datum.js","webpack://ideogram/./node_modules/d3-brush/node_modules/d3-selection/src/selection/iterator.js","webpack://ideogram/./node_modules/d3-timer/src/timer.js","webpack://ideogram/./node_modules/d3-timer/src/timeout.js","webpack://ideogram/./node_modules/d3-transition/src/transition/schedule.js","webpack://ideogram/./node_modules/d3-transition/src/interrupt.js","webpack://ideogram/./node_modules/d3-interpolate/src/transform/decompose.js","webpack://ideogram/./node_modules/d3-interpolate/src/transform/parse.js","webpack://ideogram/./node_modules/d3-interpolate/src/transform/index.js","webpack://ideogram/./node_modules/d3-transition/src/transition/tween.js","webpack://ideogram/./node_modules/d3-transition/src/transition/interpolate.js","webpack://ideogram/./node_modules/d3-transition/src/transition/attr.js","webpack://ideogram/./node_modules/d3-transition/src/transition/attrTween.js","webpack://ideogram/./node_modules/d3-transition/src/transition/delay.js","webpack://ideogram/./node_modules/d3-transition/src/transition/duration.js","webpack://ideogram/./node_modules/d3-transition/src/transition/selection.js","webpack://ideogram/./node_modules/d3-transition/src/transition/style.js","webpack://ideogram/./node_modules/d3-transition/src/transition/index.js","webpack://ideogram/./node_modules/d3-transition/src/transition/select.js","webpack://ideogram/./node_modules/d3-transition/src/transition/selectAll.js","webpack://ideogram/./node_modules/d3-transition/src/transition/filter.js","webpack://ideogram/./node_modules/d3-transition/src/transition/merge.js","webpack://ideogram/./node_modules/d3-transition/src/transition/transition.js","webpack://ideogram/./node_modules/d3-transition/src/transition/on.js","webpack://ideogram/./node_modules/d3-transition/src/transition/styleTween.js","webpack://ideogram/./node_modules/d3-transition/src/transition/text.js","webpack://ideogram/./node_modules/d3-transition/src/transition/textTween.js","webpack://ideogram/./node_modules/d3-transition/src/transition/remove.js","webpack://ideogram/./node_modules/d3-transition/src/transition/ease.js","webpack://ideogram/./node_modules/d3-transition/src/transition/easeVarying.js","webpack://ideogram/./node_modules/d3-transition/src/transition/end.js","webpack://ideogram/./node_modules/d3-transition/src/selection/transition.js","webpack://ideogram/./node_modules/d3-ease/src/cubic.js","webpack://ideogram/./node_modules/d3-transition/src/selection/index.js","webpack://ideogram/./node_modules/d3-transition/src/selection/interrupt.js","webpack://ideogram/./node_modules/d3-brush/src/constant.js","webpack://ideogram/./node_modules/d3-brush/src/event.js","webpack://ideogram/./node_modules/d3-brush/src/noevent.js","webpack://ideogram/./node_modules/d3-brush/src/brush.js","webpack://ideogram/./node_modules/d3-drag/src/nodrag.js","webpack://ideogram/./node_modules/d3-format/src/formatDecimal.js","webpack://ideogram/./node_modules/d3-format/src/exponent.js","webpack://ideogram/./node_modules/d3-format/src/formatSpecifier.js","webpack://ideogram/./node_modules/d3-format/src/formatPrefixAuto.js","webpack://ideogram/./node_modules/d3-format/src/formatRounded.js","webpack://ideogram/./node_modules/d3-format/src/formatTypes.js","webpack://ideogram/./node_modules/d3-format/src/identity.js","webpack://ideogram/./node_modules/d3-format/src/locale.js","webpack://ideogram/./node_modules/d3-format/src/defaultLocale.js","webpack://ideogram/./node_modules/d3-format/src/formatGroup.js","webpack://ideogram/./node_modules/d3-format/src/formatNumerals.js","webpack://ideogram/./node_modules/d3-format/src/formatTrim.js","webpack://ideogram/./node_modules/d3-format/src/precisionFixed.js","webpack://ideogram/./node_modules/d3-format/src/precisionPrefix.js","webpack://ideogram/./node_modules/d3-format/src/precisionRound.js","webpack://ideogram/./node_modules/d3-scale/node_modules/d3-array/src/ticks.js","webpack://ideogram/./node_modules/d3-scale/node_modules/d3-array/src/ascending.js","webpack://ideogram/./node_modules/d3-scale/node_modules/d3-array/src/descending.js","webpack://ideogram/./node_modules/d3-scale/node_modules/d3-array/src/bisector.js","webpack://ideogram/./node_modules/d3-scale/node_modules/d3-array/src/bisect.js","webpack://ideogram/./node_modules/d3-scale/node_modules/d3-array/src/number.js","webpack://ideogram/./node_modules/d3-interpolate/src/round.js","webpack://ideogram/./node_modules/d3-scale/src/number.js","webpack://ideogram/./node_modules/d3-scale/src/continuous.js","webpack://ideogram/./node_modules/d3-scale/src/constant.js","webpack://ideogram/./node_modules/d3-scale/src/init.js","webpack://ideogram/./node_modules/d3-scale/src/linear.js","webpack://ideogram/./node_modules/d3-scale/src/tickFormat.js","webpack://ideogram/./src/js/init/organism-metadata.js","webpack://ideogram/./src/js/lib.js","webpack://ideogram/./node_modules/d3-selection/src/selectAll.js","webpack://ideogram/./node_modules/d3-array/src/max.js","webpack://ideogram/./src/js/bands/styles.js","webpack://ideogram/./src/js/init/configure.js","webpack://ideogram/./src/js/collinear-vertical.js","webpack://ideogram/./src/js/collinear.js","webpack://ideogram/./node_modules/fflate/esm/browser.js","webpack://ideogram/./node_modules/workbox-core/_private/WorkboxError.js","webpack://ideogram/./node_modules/workbox-core/models/messages/messageGenerator.js","webpack://ideogram/./node_modules/workbox-range-requests/createPartialResponse.js","webpack://ideogram/./node_modules/workbox-range-requests/utils/parseRangeHeader.js","webpack://ideogram/./node_modules/workbox-range-requests/utils/calculateEffectiveBoundaries.js","webpack://ideogram/./src/js/init/caches/cache-lib.js","webpack://ideogram/./src/js/init/caches/gene-structure-cache-worker.js","webpack://ideogram/./src/js/init/caches/protein-cache-worker.js","webpack://ideogram/./src/js/init/caches/tissue-cache-worker.js","webpack://ideogram/./src/js/init/caches/cache.js","webpack://ideogram/./src/js/init/caches/gene-cache-worker.js","webpack://ideogram/./src/js/init/caches/paralog-cache-worker.js","webpack://ideogram/./src/js/init/caches/interaction-cache-worker.js","webpack://ideogram/./src/js/init/caches/synonym-cache-worker.js","webpack://ideogram/./src/js/init/finish-init.js","webpack://ideogram/./src/js/ploidy.js","webpack://ideogram/./src/js/views/chromosome-util.js","webpack://ideogram/./src/js/layouts/layout.js","webpack://ideogram/./src/js/layouts/vertical-layout.js","webpack://ideogram/./src/js/layouts/horizontal-layout.js","webpack://ideogram/./src/js/layouts/paired-layout.js","webpack://ideogram/./src/js/layouts/small-layout.js","webpack://ideogram/./src/js/init/write-container.js","webpack://ideogram/./src/js/layouts/layout-adapter.js","webpack://ideogram/./src/js/bands/fetch.js","webpack://ideogram/./src/js/init/init.js","webpack://ideogram/./src/js/parsers/bed-parser.js","webpack://ideogram/./src/js/parsers/tsv-parser.js","webpack://ideogram/./src/js/annotations/heatmap-lib.js","webpack://ideogram/./src/js/annotations/heatmap-collinear.js","webpack://ideogram/./src/js/annotations/heatmap-2d.js","webpack://ideogram/./src/js/annotations/track-labels.js","webpack://ideogram/./src/js/annotations/heatmap.js","webpack://ideogram/./src/js/annotations/track-labels-collinear.js","webpack://ideogram/./src/js/annotations/events.js","webpack://ideogram/./src/js/annotations/labels.js","webpack://ideogram/./src/js/annotations/histogram.js","webpack://ideogram/./src/js/annotations/legend.js","webpack://ideogram/./src/js/annotations/draw.js","webpack://ideogram/./src/js/annotations/synteny-lib.js","webpack://ideogram/./src/js/annotations/synteny-collinear.js","webpack://ideogram/./src/js/annotations/synteny-collinear-horizontal.js","webpack://ideogram/./src/js/annotations/synteny.js","webpack://ideogram/./src/js/annotations/filter.js","webpack://ideogram/./src/js/annotations/process.js","webpack://ideogram/./src/js/parsers/expression-matrix-parser.js","webpack://ideogram/./src/js/annotations/download.js","webpack://ideogram/./src/js/annotations/annotations.js","webpack://ideogram/./src/js/annotations/highlight.js","webpack://ideogram/./src/js/services/eutils-config.js","webpack://ideogram/./src/js/services/organisms.js","webpack://ideogram/./src/js/services/services.js","webpack://ideogram/./src/js/bands/show.js","webpack://ideogram/./src/js/bands/draw.js","webpack://ideogram/./src/js/bands/parse.js","webpack://ideogram/./src/js/bands/bands.js","webpack://ideogram/./src/js/brush.js","webpack://ideogram/./src/js/cursor.js","webpack://ideogram/./src/js/sex-chromosomes.js","webpack://ideogram/./src/js/coordinate-converters.js","webpack://ideogram/./node_modules/crossfilter2/src/array.js","webpack://ideogram/./node_modules/crossfilter2/src/filter.js","webpack://ideogram/./node_modules/crossfilter2/src/identity.js","webpack://ideogram/./node_modules/crossfilter2/src/null.js","webpack://ideogram/./node_modules/crossfilter2/src/zero.js","webpack://ideogram/./node_modules/crossfilter2/src/heap.js","webpack://ideogram/./node_modules/crossfilter2/src/heapselect.js","webpack://ideogram/./node_modules/crossfilter2/src/bisect.js","webpack://ideogram/./node_modules/crossfilter2/src/permute.js","webpack://ideogram/./node_modules/crossfilter2/src/reduce.js","webpack://ideogram/./node_modules/crossfilter2/src/result.js","webpack://ideogram/./node_modules/crossfilter2/src/index.js","webpack://ideogram/./node_modules/@ranfdev/deepobj/dist/deepobj.m.js","webpack://ideogram/./src/js/filter.js","webpack://ideogram/./src/js/views/chromosome-model.js","webpack://ideogram/./src/js/tools/tools.js","webpack://ideogram/./src/js/model-adapter.js","webpack://ideogram/./src/js/color.js","webpack://ideogram/./src/js/range.js","webpack://ideogram/./src/js/views/chromosome.js","webpack://ideogram/./src/js/views/draw-chromosomes.js","webpack://ideogram/./src/js/views/chromosome-labels.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getWindow.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/instanceOf.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/math.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/userAgent.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/isLayoutViewport.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getNodeName.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getParentNode.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/isTableElement.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js","webpack://ideogram/./node_modules/@popperjs/core/lib/enums.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/orderModifiers.js","webpack://ideogram/./node_modules/@popperjs/core/lib/createPopper.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/debounce.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/mergeByName.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/eventListeners.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/getBasePlacement.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/getVariation.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/computeOffsets.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/computeStyles.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/applyStyles.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/offset.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/getOppositePlacement.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/contains.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/rectToClientRect.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js","webpack://ideogram/./node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/mergePaddingObject.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/getFreshSideObject.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/expandToHashMap.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/detectOverflow.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/flip.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/within.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/preventOverflow.js","webpack://ideogram/./node_modules/@popperjs/core/lib/utils/getAltAxis.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/arrow.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/hide.js","webpack://ideogram/./node_modules/@popperjs/core/lib/popper.js","webpack://ideogram/./node_modules/@popperjs/core/lib/modifiers/popperOffsets.js","webpack://ideogram/./node_modules/tippy.js/dist/tippy.esm.js","webpack://ideogram/./src/js/kit/tippy-styles.js","webpack://ideogram/./src/js/kit/analyze-related-genes.js","webpack://ideogram/./src/js/kit/protein-color.js","webpack://ideogram/./src/js/kit/protein.js","webpack://ideogram/./src/js/kit/gene-structure.js","webpack://ideogram/./src/js/kit/wikipathways.js","webpack://ideogram/./node_modules/fast-kde/src/accessor.js","webpack://ideogram/./node_modules/fast-kde/src/deriche.js","webpack://ideogram/./node_modules/fast-kde/src/nrd.js","webpack://ideogram/./node_modules/fast-kde/src/density1d.js","webpack://ideogram/./node_modules/fast-kde/src/extent.js","webpack://ideogram/./node_modules/fast-kde/src/bin1d.js","webpack://ideogram/./src/js/kit/tissue.js","webpack://ideogram/./src/js/kit/related-genes.js","webpack://ideogram/./src/js/ideogram.js","webpack://ideogram/./src/js/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, () => {\nreturn ","\"use strict\";\n// @ts-ignore\ntry {\n    self['workbox:core:7.0.0'] && _();\n}\ncatch (e) { }\n","\"use strict\";\n// @ts-ignore\ntry {\n    self['workbox:range-requests:7.0.0'] && _();\n}\ncatch (e) { }\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var version = '1.45.1';\nexport default version;\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","export default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n\nexport function childMatcher(selector) {\n  return function(node) {\n    return node.matches(selector);\n  };\n}\n\n","import {childMatcher} from \"../matcher.js\";\n\nvar find = Array.prototype.find;\n\nfunction childFind(match) {\n  return function() {\n    return find.call(this.children, match);\n  };\n}\n\nfunction childFirst() {\n  return this.firstElementChild;\n}\n\nexport default function(match) {\n  return this.select(match == null ? childFirst\n      : childFind(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {childMatcher} from \"../matcher.js\";\n\nvar filter = Array.prototype.filter;\n\nfunction children() {\n  return this.children;\n}\n\nfunction childrenFilter(match) {\n  return function() {\n    return filter.call(this.children, match);\n  };\n}\n\nexport default function(match) {\n  return this.selectAll(match == null ? children\n      : childrenFilter(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index.js\";\nimport {EnterNode} from \"./enter.js\";\nimport array from \"../array.js\";\nimport constant from \"../constant.js\";\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that don’t fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = new Map,\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + \"\";\n      if (nodeByKeyValue.has(keyValue)) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue.set(keyValue, node);\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = key.call(parent, data[i], i, data) + \"\";\n    if (node = nodeByKeyValue.get(keyValue)) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue.delete(keyValue);\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction datum(node) {\n  return node.__data__;\n}\n\nexport default function(value, key) {\n  if (!arguments.length) return Array.from(this, datum);\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = array(value.call(parent, parent && parent.__data__, j, parents)),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces.js\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins\n}\n","import namespace from \"../namespace.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window.js\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import namespace from \"./namespace.js\";\nimport {xhtml} from \"./namespaces.js\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","import creator from \"../creator.js\";\nimport selector from \"../selector.js\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","function contextListener(listener) {\n  return function(event) {\n    listener.call(this, event, this.__data__);\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, options) {\n  return function() {\n    var on = this.__on, o, listener = contextListener(value);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n        this.addEventListener(o.type, o.listener = listener, o.options = options);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, options);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, options) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));\n  return this;\n}\n","import defaultView from \"../window.js\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select.js\";\nimport selection_selectAll from \"./selectAll.js\";\nimport selection_selectChild from \"./selectChild.js\";\nimport selection_selectChildren from \"./selectChildren.js\";\nimport selection_filter from \"./filter.js\";\nimport selection_data from \"./data.js\";\nimport selection_enter from \"./enter.js\";\nimport selection_exit from \"./exit.js\";\nimport selection_join from \"./join.js\";\nimport selection_merge from \"./merge.js\";\nimport selection_order from \"./order.js\";\nimport selection_sort from \"./sort.js\";\nimport selection_call from \"./call.js\";\nimport selection_nodes from \"./nodes.js\";\nimport selection_node from \"./node.js\";\nimport selection_size from \"./size.js\";\nimport selection_empty from \"./empty.js\";\nimport selection_each from \"./each.js\";\nimport selection_attr from \"./attr.js\";\nimport selection_style from \"./style.js\";\nimport selection_property from \"./property.js\";\nimport selection_classed from \"./classed.js\";\nimport selection_text from \"./text.js\";\nimport selection_html from \"./html.js\";\nimport selection_raise from \"./raise.js\";\nimport selection_lower from \"./lower.js\";\nimport selection_append from \"./append.js\";\nimport selection_insert from \"./insert.js\";\nimport selection_remove from \"./remove.js\";\nimport selection_clone from \"./clone.js\";\nimport selection_datum from \"./datum.js\";\nimport selection_on from \"./on.js\";\nimport selection_dispatch from \"./dispatch.js\";\nimport selection_iterator from \"./iterator.js\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nfunction selection_selection() {\n  return this;\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  selectChild: selection_selectChild,\n  selectChildren: selection_selectChildren,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  selection: selection_selection,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch,\n  [Symbol.iterator]: selection_iterator\n};\n\nexport default selection;\n","import {Selection} from \"./index.js\";\nimport selector from \"../selector.js\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index.js\";\nimport array from \"../array.js\";\nimport selectorAll from \"../selectorAll.js\";\n\nfunction arrayAll(select) {\n  return function() {\n    var group = select.apply(this, arguments);\n    return group == null ? [] : array(group);\n  };\n}\n\nexport default function(select) {\n  if (typeof select === \"function\") select = arrayAll(select);\n  else select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","import {Selection} from \"./index.js\";\nimport matcher from \"../matcher.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  enter = typeof onenter === \"function\" ? onenter(enter) : enter.append(onenter + \"\");\n  if (onupdate != null) update = onupdate(update);\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(selection) {\n  if (!(selection instanceof Selection)) throw new Error(\"invalid merge\");\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  return Array.from(this);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  let size = 0;\n  for (const node of this) ++size; // eslint-disable-line no-unused-vars\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator.js\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","export default function*() {\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) yield node;\n    }\n  }\n}\n","import {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","function responseBlob(response) {\n  if (!response.ok) throw new Error(response.status + \" \" + response.statusText);\n  return response.blob();\n}\n\nexport default function(input, init) {\n  return fetch(input, init).then(responseBlob);\n}\n","function responseArrayBuffer(response) {\n  if (!response.ok) throw new Error(response.status + \" \" + response.statusText);\n  return response.arrayBuffer();\n}\n\nexport default function(input, init) {\n  return fetch(input, init).then(responseArrayBuffer);\n}\n","var EOL = {},\n    EOF = {},\n    QUOTE = 34,\n    NEWLINE = 10,\n    RETURN = 13;\n\nfunction objectConverter(columns) {\n  return new Function(\"d\", \"return {\" + columns.map(function(name, i) {\n    return JSON.stringify(name) + \": d[\" + i + \"] || \\\"\\\"\";\n  }).join(\",\") + \"}\");\n}\n\nfunction customConverter(columns, f) {\n  var object = objectConverter(columns);\n  return function(row, i) {\n    return f(object(row), i, columns);\n  };\n}\n\n// Compute unique columns in order of discovery.\nfunction inferColumns(rows) {\n  var columnSet = Object.create(null),\n      columns = [];\n\n  rows.forEach(function(row) {\n    for (var column in row) {\n      if (!(column in columnSet)) {\n        columns.push(columnSet[column] = column);\n      }\n    }\n  });\n\n  return columns;\n}\n\nfunction pad(value, width) {\n  var s = value + \"\", length = s.length;\n  return length < width ? new Array(width - length + 1).join(0) + s : s;\n}\n\nfunction formatYear(year) {\n  return year < 0 ? \"-\" + pad(-year, 6)\n    : year > 9999 ? \"+\" + pad(year, 6)\n    : pad(year, 4);\n}\n\nfunction formatDate(date) {\n  var hours = date.getUTCHours(),\n      minutes = date.getUTCMinutes(),\n      seconds = date.getUTCSeconds(),\n      milliseconds = date.getUTCMilliseconds();\n  return isNaN(date) ? \"Invalid Date\"\n      : formatYear(date.getUTCFullYear(), 4) + \"-\" + pad(date.getUTCMonth() + 1, 2) + \"-\" + pad(date.getUTCDate(), 2)\n      + (milliseconds ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \":\" + pad(seconds, 2) + \".\" + pad(milliseconds, 3) + \"Z\"\n      : seconds ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \":\" + pad(seconds, 2) + \"Z\"\n      : minutes || hours ? \"T\" + pad(hours, 2) + \":\" + pad(minutes, 2) + \"Z\"\n      : \"\");\n}\n\nexport default function(delimiter) {\n  var reFormat = new RegExp(\"[\\\"\" + delimiter + \"\\n\\r]\"),\n      DELIMITER = delimiter.charCodeAt(0);\n\n  function parse(text, f) {\n    var convert, columns, rows = parseRows(text, function(row, i) {\n      if (convert) return convert(row, i - 1);\n      columns = row, convert = f ? customConverter(row, f) : objectConverter(row);\n    });\n    rows.columns = columns || [];\n    return rows;\n  }\n\n  function parseRows(text, f) {\n    var rows = [], // output rows\n        N = text.length,\n        I = 0, // current character index\n        n = 0, // current line number\n        t, // current token\n        eof = N <= 0, // current token followed by EOF?\n        eol = false; // current token followed by EOL?\n\n    // Strip the trailing newline.\n    if (text.charCodeAt(N - 1) === NEWLINE) --N;\n    if (text.charCodeAt(N - 1) === RETURN) --N;\n\n    function token() {\n      if (eof) return EOF;\n      if (eol) return eol = false, EOL;\n\n      // Unescape quotes.\n      var i, j = I, c;\n      if (text.charCodeAt(j) === QUOTE) {\n        while (I++ < N && text.charCodeAt(I) !== QUOTE || text.charCodeAt(++I) === QUOTE);\n        if ((i = I) >= N) eof = true;\n        else if ((c = text.charCodeAt(I++)) === NEWLINE) eol = true;\n        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }\n        return text.slice(j + 1, i - 1).replace(/\"\"/g, \"\\\"\");\n      }\n\n      // Find next delimiter or newline.\n      while (I < N) {\n        if ((c = text.charCodeAt(i = I++)) === NEWLINE) eol = true;\n        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }\n        else if (c !== DELIMITER) continue;\n        return text.slice(j, i);\n      }\n\n      // Return last token before EOF.\n      return eof = true, text.slice(j, N);\n    }\n\n    while ((t = token()) !== EOF) {\n      var row = [];\n      while (t !== EOL && t !== EOF) row.push(t), t = token();\n      if (f && (row = f(row, n++)) == null) continue;\n      rows.push(row);\n    }\n\n    return rows;\n  }\n\n  function preformatBody(rows, columns) {\n    return rows.map(function(row) {\n      return columns.map(function(column) {\n        return formatValue(row[column]);\n      }).join(delimiter);\n    });\n  }\n\n  function format(rows, columns) {\n    if (columns == null) columns = inferColumns(rows);\n    return [columns.map(formatValue).join(delimiter)].concat(preformatBody(rows, columns)).join(\"\\n\");\n  }\n\n  function formatBody(rows, columns) {\n    if (columns == null) columns = inferColumns(rows);\n    return preformatBody(rows, columns).join(\"\\n\");\n  }\n\n  function formatRows(rows) {\n    return rows.map(formatRow).join(\"\\n\");\n  }\n\n  function formatRow(row) {\n    return row.map(formatValue).join(delimiter);\n  }\n\n  function formatValue(value) {\n    return value == null ? \"\"\n        : value instanceof Date ? formatDate(value)\n        : reFormat.test(value += \"\") ? \"\\\"\" + value.replace(/\"/g, \"\\\"\\\"\") + \"\\\"\"\n        : value;\n  }\n\n  return {\n    parse: parse,\n    parseRows: parseRows,\n    format: format,\n    formatBody: formatBody,\n    formatRows: formatRows,\n    formatRow: formatRow,\n    formatValue: formatValue\n  };\n}\n","import dsv from \"./dsv.js\";\n\nvar csv = dsv(\",\");\n\nexport var csvParse = csv.parse;\nexport var csvParseRows = csv.parseRows;\nexport var csvFormat = csv.format;\nexport var csvFormatBody = csv.formatBody;\nexport var csvFormatRows = csv.formatRows;\nexport var csvFormatRow = csv.formatRow;\nexport var csvFormatValue = csv.formatValue;\n","import dsv from \"./dsv.js\";\n\nvar tsv = dsv(\"\\t\");\n\nexport var tsvParse = tsv.parse;\nexport var tsvParseRows = tsv.parseRows;\nexport var tsvFormat = tsv.format;\nexport var tsvFormatBody = tsv.formatBody;\nexport var tsvFormatRows = tsv.formatRows;\nexport var tsvFormatRow = tsv.formatRow;\nexport var tsvFormatValue = tsv.formatValue;\n","function responseText(response) {\n  if (!response.ok) throw new Error(response.status + \" \" + response.statusText);\n  return response.text();\n}\n\nexport default function(input, init) {\n  return fetch(input, init).then(responseText);\n}\n","import {csvParse, dsvFormat, tsvParse} from \"d3-dsv\";\nimport text from \"./text.js\";\n\nfunction dsvParse(parse) {\n  return function(input, init, row) {\n    if (arguments.length === 2 && typeof init === \"function\") row = init, init = undefined;\n    return text(input, init).then(function(response) {\n      return parse(response, row);\n    });\n  };\n}\n\nexport default function dsv(delimiter, input, init, row) {\n  if (arguments.length === 3 && typeof init === \"function\") row = init, init = undefined;\n  var format = dsvFormat(delimiter);\n  return text(input, init).then(function(response) {\n    return format.parse(response, row);\n  });\n}\n\nexport var csv = dsvParse(csvParse);\nexport var tsv = dsvParse(tsvParse);\n","export default function(input, init) {\n  return new Promise(function(resolve, reject) {\n    var image = new Image;\n    for (var key in init) image[key] = init[key];\n    image.onerror = reject;\n    image.onload = function() { resolve(image); };\n    image.src = input;\n  });\n}\n","function responseJson(response) {\n  if (!response.ok) throw new Error(response.status + \" \" + response.statusText);\n  if (response.status === 204 || response.status === 205) return;\n  return response.json();\n}\n\nexport default function(input, init) {\n  return fetch(input, init).then(responseJson);\n}\n","import text from \"./text.js\";\n\nfunction parser(type) {\n  return (input, init) => text(input, init)\n    .then(text => (new DOMParser).parseFromString(text, type));\n}\n\nexport default parser(\"application/xml\");\n\nexport var html = parser(\"text/html\");\n\nexport var svg = parser(\"image/svg+xml\");\n","var noop = {value: () => {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _) || /[\\s.]/.test(t)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","export function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(`^rgb\\\\(${reI},${reI},${reI}\\\\)$`),\n    reRgbPercent = new RegExp(`^rgb\\\\(${reP},${reP},${reP}\\\\)$`),\n    reRgbaInteger = new RegExp(`^rgba\\\\(${reI},${reI},${reI},${reN}\\\\)$`),\n    reRgbaPercent = new RegExp(`^rgba\\\\(${reP},${reP},${reP},${reN}\\\\)$`),\n    reHslPercent = new RegExp(`^hsl\\\\(${reN},${reP},${reP}\\\\)$`),\n    reHslaPercent = new RegExp(`^hsla\\\\(${reN},${reP},${reP},${reN}\\\\)$`);\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHex8: color_formatHex8,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHex8() {\n  return this.rgb().formatHex8();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb() {\n    return this;\n  },\n  clamp() {\n    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));\n  },\n  displayable() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatHex8: rgb_formatHex8,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;\n}\n\nfunction rgb_formatHex8() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;\n}\n\nfunction rgb_formatRgb() {\n  const a = clampa(this.opacity);\n  return `${a === 1 ? \"rgb(\" : \"rgba(\"}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? \")\" : `, ${a})`}`;\n}\n\nfunction clampa(opacity) {\n  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));\n}\n\nfunction clampi(value) {\n  return Math.max(0, Math.min(255, Math.round(value) || 0));\n}\n\nfunction hex(value) {\n  value = clampi(value);\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  clamp() {\n    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));\n  },\n  displayable() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl() {\n    const a = clampa(this.opacity);\n    return `${a === 1 ? \"hsl(\" : \"hsla(\"}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? \")\" : `, ${a})`}`;\n  }\n}));\n\nfunction clamph(value) {\n  value = (value || 0) % 360;\n  return value < 0 ? value + 360 : value;\n}\n\nfunction clampt(value) {\n  return Math.max(0, Math.min(1, value || 0));\n}\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","export default x => () => x;\n","import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","import value from \"./value.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  return (isNumberArray(b) ? numberArray : genericArray)(a, b);\n}\n\nexport function genericArray(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n","export default function(a, b) {\n  var d = new Date;\n  return a = +a, b = +b, function(t) {\n    return d.setTime(a * (1 - t) + b * t), d;\n  };\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n","import value from \"./value.js\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n","import {basis} from \"./basis.js\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","export default function(a, b) {\n  if (!b) b = [];\n  var n = a ? Math.min(b.length, a.length) : 0,\n      c = b.slice(),\n      i;\n  return function(t) {\n    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;\n    return c;\n  };\n}\n\nexport function isNumberArray(x) {\n  return ArrayBuffer.isView(x) && !(x instanceof DataView);\n}\n","import {color} from \"d3-color\";\nimport rgb from \"./rgb.js\";\nimport {genericArray} from \"./array.js\";\nimport date from \"./date.js\";\nimport number from \"./number.js\";\nimport object from \"./object.js\";\nimport string from \"./string.js\";\nimport constant from \"./constant.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : isNumberArray(b) ? numberArray\n      : Array.isArray(b) ? genericArray\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n\nexport function childMatcher(selector) {\n  return function(node) {\n    return node.matches(selector);\n  };\n}\n\n","import {childMatcher} from \"../matcher.js\";\n\nvar find = Array.prototype.find;\n\nfunction childFind(match) {\n  return function() {\n    return find.call(this.children, match);\n  };\n}\n\nfunction childFirst() {\n  return this.firstElementChild;\n}\n\nexport default function(match) {\n  return this.select(match == null ? childFirst\n      : childFind(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {childMatcher} from \"../matcher.js\";\n\nvar filter = Array.prototype.filter;\n\nfunction children() {\n  return Array.from(this.children);\n}\n\nfunction childrenFilter(match) {\n  return function() {\n    return filter.call(this.children, match);\n  };\n}\n\nexport default function(match) {\n  return this.selectAll(match == null ? children\n      : childrenFilter(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index.js\";\nimport {EnterNode} from \"./enter.js\";\nimport constant from \"../constant.js\";\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that don’t fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = new Map,\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + \"\";\n      if (nodeByKeyValue.has(keyValue)) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue.set(keyValue, node);\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = key.call(parent, data[i], i, data) + \"\";\n    if (node = nodeByKeyValue.get(keyValue)) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue.delete(keyValue);\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction datum(node) {\n  return node.__data__;\n}\n\nexport default function(value, key) {\n  if (!arguments.length) return Array.from(this, datum);\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = arraylike(value.call(parent, parent && parent.__data__, j, parents)),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n\n// Given some data, this returns an array-like view of it: an object that\n// exposes a length property and allows numeric indexing. Note that unlike\n// selectAll, this isn’t worried about “live” collections because the resulting\n// array will only be used briefly while data is being bound. (It is possible to\n// cause the data to change while iterating by using a key function, but please\n// don’t; we’d rather avoid a gratuitous copy.)\nfunction arraylike(data) {\n  return typeof data === \"object\" && \"length\" in data\n    ? data // Array, TypedArray, NodeList, array-like\n    : Array.from(data); // Map, Set, iterable, string, or anything else\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces.js\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins\n}\n","import namespace from \"../namespace.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window.js\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import namespace from \"./namespace.js\";\nimport {xhtml} from \"./namespaces.js\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","import creator from \"../creator.js\";\nimport selector from \"../selector.js\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","function contextListener(listener) {\n  return function(event) {\n    listener.call(this, event, this.__data__);\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, options) {\n  return function() {\n    var on = this.__on, o, listener = contextListener(value);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n        this.addEventListener(o.type, o.listener = listener, o.options = options);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, options);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, options) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));\n  return this;\n}\n","import defaultView from \"../window.js\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select.js\";\nimport selection_selectAll from \"./selectAll.js\";\nimport selection_selectChild from \"./selectChild.js\";\nimport selection_selectChildren from \"./selectChildren.js\";\nimport selection_filter from \"./filter.js\";\nimport selection_data from \"./data.js\";\nimport selection_enter from \"./enter.js\";\nimport selection_exit from \"./exit.js\";\nimport selection_join from \"./join.js\";\nimport selection_merge from \"./merge.js\";\nimport selection_order from \"./order.js\";\nimport selection_sort from \"./sort.js\";\nimport selection_call from \"./call.js\";\nimport selection_nodes from \"./nodes.js\";\nimport selection_node from \"./node.js\";\nimport selection_size from \"./size.js\";\nimport selection_empty from \"./empty.js\";\nimport selection_each from \"./each.js\";\nimport selection_attr from \"./attr.js\";\nimport selection_style from \"./style.js\";\nimport selection_property from \"./property.js\";\nimport selection_classed from \"./classed.js\";\nimport selection_text from \"./text.js\";\nimport selection_html from \"./html.js\";\nimport selection_raise from \"./raise.js\";\nimport selection_lower from \"./lower.js\";\nimport selection_append from \"./append.js\";\nimport selection_insert from \"./insert.js\";\nimport selection_remove from \"./remove.js\";\nimport selection_clone from \"./clone.js\";\nimport selection_datum from \"./datum.js\";\nimport selection_on from \"./on.js\";\nimport selection_dispatch from \"./dispatch.js\";\nimport selection_iterator from \"./iterator.js\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nfunction selection_selection() {\n  return this;\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  selectChild: selection_selectChild,\n  selectChildren: selection_selectChildren,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  selection: selection_selection,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch,\n  [Symbol.iterator]: selection_iterator\n};\n\nexport default selection;\n","import {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","import sourceEvent from \"./sourceEvent.js\";\n\nexport default function(event, node) {\n  event = sourceEvent(event);\n  if (node === undefined) node = event.currentTarget;\n  if (node) {\n    var svg = node.ownerSVGElement || node;\n    if (svg.createSVGPoint) {\n      var point = svg.createSVGPoint();\n      point.x = event.clientX, point.y = event.clientY;\n      point = point.matrixTransform(node.getScreenCTM().inverse());\n      return [point.x, point.y];\n    }\n    if (node.getBoundingClientRect) {\n      var rect = node.getBoundingClientRect();\n      return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n    }\n  }\n  return [event.pageX, event.pageY];\n}\n","export default function(event) {\n  let sourceEvent;\n  while (sourceEvent = event.sourceEvent) event = sourceEvent;\n  return event;\n}\n","import {Selection} from \"./index.js\";\nimport selector from \"../selector.js\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index.js\";\nimport array from \"../array.js\";\nimport selectorAll from \"../selectorAll.js\";\n\nfunction arrayAll(select) {\n  return function() {\n    return array(select.apply(this, arguments));\n  };\n}\n\nexport default function(select) {\n  if (typeof select === \"function\") select = arrayAll(select);\n  else select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","// Given something array like (or null), returns something that is strictly an\n// array. This is used to ensure that array-like objects passed to d3.selectAll\n// or selection.selectAll are converted into proper arrays when creating a\n// selection; we don’t ever want to create a selection backed by a live\n// HTMLCollection or NodeList. However, note that selection.selectAll will use a\n// static NodeList as a group, since it safely derived from querySelectorAll.\nexport default function array(x) {\n  return x == null ? [] : Array.isArray(x) ? x : Array.from(x);\n}\n","import {Selection} from \"./index.js\";\nimport matcher from \"../matcher.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  if (typeof onenter === \"function\") {\n    enter = onenter(enter);\n    if (enter) enter = enter.selection();\n  } else {\n    enter = enter.append(onenter + \"\");\n  }\n  if (onupdate != null) {\n    update = onupdate(update);\n    if (update) update = update.selection();\n  }\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(context) {\n  var selection = context.selection ? context.selection() : context;\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  return Array.from(this);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  let size = 0;\n  for (const node of this) ++size; // eslint-disable-line no-unused-vars\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator.js\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","export default function*() {\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) yield node;\n    }\n  }\n}\n","var frame = 0, // is an animation frame pending?\n    timeout = 0, // is a timeout pending?\n    interval = 0, // are any timers active?\n    pokeDelay = 1000, // how frequently we check for clock skew\n    taskHead,\n    taskTail,\n    clockLast = 0,\n    clockNow = 0,\n    clockSkew = 0,\n    clock = typeof performance === \"object\" && performance.now ? performance : Date,\n    setFrame = typeof window === \"object\" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };\n\nexport function now() {\n  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);\n}\n\nfunction clearNow() {\n  clockNow = 0;\n}\n\nexport function Timer() {\n  this._call =\n  this._time =\n  this._next = null;\n}\n\nTimer.prototype = timer.prototype = {\n  constructor: Timer,\n  restart: function(callback, delay, time) {\n    if (typeof callback !== \"function\") throw new TypeError(\"callback is not a function\");\n    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);\n    if (!this._next && taskTail !== this) {\n      if (taskTail) taskTail._next = this;\n      else taskHead = this;\n      taskTail = this;\n    }\n    this._call = callback;\n    this._time = time;\n    sleep();\n  },\n  stop: function() {\n    if (this._call) {\n      this._call = null;\n      this._time = Infinity;\n      sleep();\n    }\n  }\n};\n\nexport function timer(callback, delay, time) {\n  var t = new Timer;\n  t.restart(callback, delay, time);\n  return t;\n}\n\nexport function timerFlush() {\n  now(); // Get the current time, if not already set.\n  ++frame; // Pretend we’ve set an alarm, if we haven’t already.\n  var t = taskHead, e;\n  while (t) {\n    if ((e = clockNow - t._time) >= 0) t._call.call(undefined, e);\n    t = t._next;\n  }\n  --frame;\n}\n\nfunction wake() {\n  clockNow = (clockLast = clock.now()) + clockSkew;\n  frame = timeout = 0;\n  try {\n    timerFlush();\n  } finally {\n    frame = 0;\n    nap();\n    clockNow = 0;\n  }\n}\n\nfunction poke() {\n  var now = clock.now(), delay = now - clockLast;\n  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;\n}\n\nfunction nap() {\n  var t0, t1 = taskHead, t2, time = Infinity;\n  while (t1) {\n    if (t1._call) {\n      if (time > t1._time) time = t1._time;\n      t0 = t1, t1 = t1._next;\n    } else {\n      t2 = t1._next, t1._next = null;\n      t1 = t0 ? t0._next = t2 : taskHead = t2;\n    }\n  }\n  taskTail = t0;\n  sleep(time);\n}\n\nfunction sleep(time) {\n  if (frame) return; // Soonest alarm already set, or will be.\n  if (timeout) timeout = clearTimeout(timeout);\n  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.\n  if (delay > 24) {\n    if (time < Infinity) timeout = setTimeout(wake, time - clock.now() - clockSkew);\n    if (interval) interval = clearInterval(interval);\n  } else {\n    if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);\n    frame = 1, setFrame(wake);\n  }\n}\n","import {Timer} from \"./timer.js\";\n\nexport default function(callback, delay, time) {\n  var t = new Timer;\n  delay = delay == null ? 0 : +delay;\n  t.restart(elapsed => {\n    t.stop();\n    callback(elapsed + delay);\n  }, delay, time);\n  return t;\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {timer, timeout} from \"d3-timer\";\n\nvar emptyOn = dispatch(\"start\", \"end\", \"cancel\", \"interrupt\");\nvar emptyTween = [];\n\nexport var CREATED = 0;\nexport var SCHEDULED = 1;\nexport var STARTING = 2;\nexport var STARTED = 3;\nexport var RUNNING = 4;\nexport var ENDING = 5;\nexport var ENDED = 6;\n\nexport default function(node, name, id, index, group, timing) {\n  var schedules = node.__transition;\n  if (!schedules) node.__transition = {};\n  else if (id in schedules) return;\n  create(node, id, {\n    name: name,\n    index: index, // For context during callback.\n    group: group, // For context during callback.\n    on: emptyOn,\n    tween: emptyTween,\n    time: timing.time,\n    delay: timing.delay,\n    duration: timing.duration,\n    ease: timing.ease,\n    timer: null,\n    state: CREATED\n  });\n}\n\nexport function init(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > CREATED) throw new Error(\"too late; already scheduled\");\n  return schedule;\n}\n\nexport function set(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > STARTED) throw new Error(\"too late; already running\");\n  return schedule;\n}\n\nexport function get(node, id) {\n  var schedule = node.__transition;\n  if (!schedule || !(schedule = schedule[id])) throw new Error(\"transition not found\");\n  return schedule;\n}\n\nfunction create(node, id, self) {\n  var schedules = node.__transition,\n      tween;\n\n  // Initialize the self timer when the transition is created.\n  // Note the actual delay is not known until the first callback!\n  schedules[id] = self;\n  self.timer = timer(schedule, 0, self.time);\n\n  function schedule(elapsed) {\n    self.state = SCHEDULED;\n    self.timer.restart(start, self.delay, self.time);\n\n    // If the elapsed delay is less than our first sleep, start immediately.\n    if (self.delay <= elapsed) start(elapsed - self.delay);\n  }\n\n  function start(elapsed) {\n    var i, j, n, o;\n\n    // If the state is not SCHEDULED, then we previously errored on start.\n    if (self.state !== SCHEDULED) return stop();\n\n    for (i in schedules) {\n      o = schedules[i];\n      if (o.name !== self.name) continue;\n\n      // While this element already has a starting transition during this frame,\n      // defer starting an interrupting transition until that transition has a\n      // chance to tick (and possibly end); see d3/d3-transition#54!\n      if (o.state === STARTED) return timeout(start);\n\n      // Interrupt the active transition, if any.\n      if (o.state === RUNNING) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"interrupt\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n\n      // Cancel any pre-empted transitions.\n      else if (+i < id) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"cancel\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n    }\n\n    // Defer the first tick to end of the current frame; see d3/d3#1576.\n    // Note the transition may be canceled after start and before the first tick!\n    // Note this must be scheduled before the start event; see d3/d3-transition#16!\n    // Assuming this is successful, subsequent callbacks go straight to tick.\n    timeout(function() {\n      if (self.state === STARTED) {\n        self.state = RUNNING;\n        self.timer.restart(tick, self.delay, self.time);\n        tick(elapsed);\n      }\n    });\n\n    // Dispatch the start event.\n    // Note this must be done before the tween are initialized.\n    self.state = STARTING;\n    self.on.call(\"start\", node, node.__data__, self.index, self.group);\n    if (self.state !== STARTING) return; // interrupted\n    self.state = STARTED;\n\n    // Initialize the tween, deleting null tween.\n    tween = new Array(n = self.tween.length);\n    for (i = 0, j = -1; i < n; ++i) {\n      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {\n        tween[++j] = o;\n      }\n    }\n    tween.length = j + 1;\n  }\n\n  function tick(elapsed) {\n    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),\n        i = -1,\n        n = tween.length;\n\n    while (++i < n) {\n      tween[i].call(node, t);\n    }\n\n    // Dispatch the end event.\n    if (self.state === ENDING) {\n      self.on.call(\"end\", node, node.__data__, self.index, self.group);\n      stop();\n    }\n  }\n\n  function stop() {\n    self.state = ENDED;\n    self.timer.stop();\n    delete schedules[id];\n    for (var i in schedules) return; // eslint-disable-line no-unused-vars\n    delete node.__transition;\n  }\n}\n","import {STARTING, ENDING, ENDED} from \"./transition/schedule.js\";\n\nexport default function(node, name) {\n  var schedules = node.__transition,\n      schedule,\n      active,\n      empty = true,\n      i;\n\n  if (!schedules) return;\n\n  name = name == null ? null : name + \"\";\n\n  for (i in schedules) {\n    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }\n    active = schedule.state > STARTING && schedule.state < ENDING;\n    schedule.state = ENDED;\n    schedule.timer.stop();\n    schedule.on.call(active ? \"interrupt\" : \"cancel\", node, node.__data__, schedule.index, schedule.group);\n    delete schedules[i];\n  }\n\n  if (empty) delete node.__transition;\n}\n","var degrees = 180 / Math.PI;\n\nexport var identity = {\n  translateX: 0,\n  translateY: 0,\n  rotate: 0,\n  skewX: 0,\n  scaleX: 1,\n  scaleY: 1\n};\n\nexport default function(a, b, c, d, e, f) {\n  var scaleX, scaleY, skewX;\n  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;\n  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;\n  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;\n  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;\n  return {\n    translateX: e,\n    translateY: f,\n    rotate: Math.atan2(b, a) * degrees,\n    skewX: Math.atan(skewX) * degrees,\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n","import decompose, {identity} from \"./decompose.js\";\n\nvar svgNode;\n\n/* eslint-disable no-undef */\nexport function parseCss(value) {\n  const m = new (typeof DOMMatrix === \"function\" ? DOMMatrix : WebKitCSSMatrix)(value + \"\");\n  return m.isIdentity ? identity : decompose(m.a, m.b, m.c, m.d, m.e, m.f);\n}\n\nexport function parseSvg(value) {\n  if (value == null) return identity;\n  if (!svgNode) svgNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n  svgNode.setAttribute(\"transform\", value);\n  if (!(value = svgNode.transform.baseVal.consolidate())) return identity;\n  value = value.matrix;\n  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);\n}\n","import number from \"../number.js\";\nimport {parseCss, parseSvg} from \"./parse.js\";\n\nfunction interpolateTransform(parse, pxComma, pxParen, degParen) {\n\n  function pop(s) {\n    return s.length ? s.pop() + \" \" : \"\";\n  }\n\n  function translate(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(\"translate(\", null, pxComma, null, pxParen);\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb || yb) {\n      s.push(\"translate(\" + xb + pxComma + yb + pxParen);\n    }\n  }\n\n  function rotate(a, b, s, q) {\n    if (a !== b) {\n      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path\n      q.push({i: s.push(pop(s) + \"rotate(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"rotate(\" + b + degParen);\n    }\n  }\n\n  function skewX(a, b, s, q) {\n    if (a !== b) {\n      q.push({i: s.push(pop(s) + \"skewX(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"skewX(\" + b + degParen);\n    }\n  }\n\n  function scale(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(pop(s) + \"scale(\", null, \",\", null, \")\");\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb !== 1 || yb !== 1) {\n      s.push(pop(s) + \"scale(\" + xb + \",\" + yb + \")\");\n    }\n  }\n\n  return function(a, b) {\n    var s = [], // string constants and placeholders\n        q = []; // number interpolators\n    a = parse(a), b = parse(b);\n    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);\n    rotate(a.rotate, b.rotate, s, q);\n    skewX(a.skewX, b.skewX, s, q);\n    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);\n    a = b = null; // gc\n    return function(t) {\n      var i = -1, n = q.length, o;\n      while (++i < n) s[(o = q[i]).i] = o.x(t);\n      return s.join(\"\");\n    };\n  };\n}\n\nexport var interpolateTransformCss = interpolateTransform(parseCss, \"px, \", \"px)\", \"deg)\");\nexport var interpolateTransformSvg = interpolateTransform(parseSvg, \", \", \")\", \")\");\n","import {get, set} from \"./schedule.js\";\n\nfunction tweenRemove(id, name) {\n  var tween0, tween1;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and we’re done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = tween0 = tween;\n      for (var i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1 = tween1.slice();\n          tween1.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nfunction tweenFunction(id, name, value) {\n  var tween0, tween1;\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and we’re done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = (tween0 = tween).slice();\n      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1[i] = t;\n          break;\n        }\n      }\n      if (i === n) tween1.push(t);\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nexport default function(name, value) {\n  var id = this._id;\n\n  name += \"\";\n\n  if (arguments.length < 2) {\n    var tween = get(this.node(), id).tween;\n    for (var i = 0, n = tween.length, t; i < n; ++i) {\n      if ((t = tween[i]).name === name) {\n        return t.value;\n      }\n    }\n    return null;\n  }\n\n  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));\n}\n\nexport function tweenValue(transition, name, value) {\n  var id = transition._id;\n\n  transition.each(function() {\n    var schedule = set(this, id);\n    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);\n  });\n\n  return function(node) {\n    return get(node, id).value[name];\n  };\n}\n","import {color} from \"d3-color\";\nimport {interpolateNumber, interpolateRgb, interpolateString} from \"d3-interpolate\";\n\nexport default function(a, b) {\n  var c;\n  return (typeof b === \"number\" ? interpolateNumber\n      : b instanceof color ? interpolateRgb\n      : (c = color(b)) ? (b = c, interpolateRgb)\n      : interpolateString)(a, b);\n}\n","import {interpolateTransformSvg as interpolateTransform} from \"d3-interpolate\";\nimport {namespace} from \"d3-selection\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttribute(name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrConstantNS(fullname, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttributeNS(fullname.space, fullname.local);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttribute(name);\n    string0 = this.getAttribute(name);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction attrFunctionNS(fullname, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);\n    string0 = this.getAttributeNS(fullname.space, fullname.local);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name), i = fullname === \"transform\" ? interpolateTransform : interpolate;\n  return this.attrTween(name, typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, \"attr.\" + name, value))\n      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)\n      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));\n}\n","import {namespace} from \"d3-selection\";\n\nfunction attrInterpolate(name, i) {\n  return function(t) {\n    this.setAttribute(name, i.call(this, t));\n  };\n}\n\nfunction attrInterpolateNS(fullname, i) {\n  return function(t) {\n    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));\n  };\n}\n\nfunction attrTweenNS(fullname, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nfunction attrTween(name, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value) {\n  var key = \"attr.\" + name;\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  var fullname = namespace(name);\n  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));\n}\n","import {get, init} from \"./schedule.js\";\n\nfunction delayFunction(id, value) {\n  return function() {\n    init(this, id).delay = +value.apply(this, arguments);\n  };\n}\n\nfunction delayConstant(id, value) {\n  return value = +value, function() {\n    init(this, id).delay = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? delayFunction\n          : delayConstant)(id, value))\n      : get(this.node(), id).delay;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction durationFunction(id, value) {\n  return function() {\n    set(this, id).duration = +value.apply(this, arguments);\n  };\n}\n\nfunction durationConstant(id, value) {\n  return value = +value, function() {\n    set(this, id).duration = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? durationFunction\n          : durationConstant)(id, value))\n      : get(this.node(), id).duration;\n}\n","import {selection} from \"d3-selection\";\n\nvar Selection = selection.prototype.constructor;\n\nexport default function() {\n  return new Selection(this._groups, this._parents);\n}\n","import {interpolateTransformCss as interpolateTransform} from \"d3-interpolate\";\nimport {style} from \"d3-selection\";\nimport {set} from \"./schedule.js\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction styleNull(name, interpolate) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        string1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, string10 = string1);\n  };\n}\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = style(this, name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction styleFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        value1 = value(this),\n        string1 = value1 + \"\";\n    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction styleMaybeRemove(id, name) {\n  var on0, on1, listener0, key = \"style.\" + name, event = \"end.\" + key, remove;\n  return function() {\n    var schedule = set(this, id),\n        on = schedule.on,\n        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and we’re done!\n    // Otherwise, copy-on-write.\n    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, value, priority) {\n  var i = (name += \"\") === \"transform\" ? interpolateTransform : interpolate;\n  return value == null ? this\n      .styleTween(name, styleNull(name, i))\n      .on(\"end.style.\" + name, styleRemove(name))\n    : typeof value === \"function\" ? this\n      .styleTween(name, styleFunction(name, i, tweenValue(this, \"style.\" + name, value)))\n      .each(styleMaybeRemove(this._id, name))\n    : this\n      .styleTween(name, styleConstant(name, i, value), priority)\n      .on(\"end.style.\" + name, null);\n}\n","import {selection} from \"d3-selection\";\nimport transition_attr from \"./attr.js\";\nimport transition_attrTween from \"./attrTween.js\";\nimport transition_delay from \"./delay.js\";\nimport transition_duration from \"./duration.js\";\nimport transition_ease from \"./ease.js\";\nimport transition_easeVarying from \"./easeVarying.js\";\nimport transition_filter from \"./filter.js\";\nimport transition_merge from \"./merge.js\";\nimport transition_on from \"./on.js\";\nimport transition_remove from \"./remove.js\";\nimport transition_select from \"./select.js\";\nimport transition_selectAll from \"./selectAll.js\";\nimport transition_selection from \"./selection.js\";\nimport transition_style from \"./style.js\";\nimport transition_styleTween from \"./styleTween.js\";\nimport transition_text from \"./text.js\";\nimport transition_textTween from \"./textTween.js\";\nimport transition_transition from \"./transition.js\";\nimport transition_tween from \"./tween.js\";\nimport transition_end from \"./end.js\";\n\nvar id = 0;\n\nexport function Transition(groups, parents, name, id) {\n  this._groups = groups;\n  this._parents = parents;\n  this._name = name;\n  this._id = id;\n}\n\nexport default function transition(name) {\n  return selection().transition(name);\n}\n\nexport function newId() {\n  return ++id;\n}\n\nvar selection_prototype = selection.prototype;\n\nTransition.prototype = transition.prototype = {\n  constructor: Transition,\n  select: transition_select,\n  selectAll: transition_selectAll,\n  selectChild: selection_prototype.selectChild,\n  selectChildren: selection_prototype.selectChildren,\n  filter: transition_filter,\n  merge: transition_merge,\n  selection: transition_selection,\n  transition: transition_transition,\n  call: selection_prototype.call,\n  nodes: selection_prototype.nodes,\n  node: selection_prototype.node,\n  size: selection_prototype.size,\n  empty: selection_prototype.empty,\n  each: selection_prototype.each,\n  on: transition_on,\n  attr: transition_attr,\n  attrTween: transition_attrTween,\n  style: transition_style,\n  styleTween: transition_styleTween,\n  text: transition_text,\n  textTween: transition_textTween,\n  remove: transition_remove,\n  tween: transition_tween,\n  delay: transition_delay,\n  duration: transition_duration,\n  ease: transition_ease,\n  easeVarying: transition_easeVarying,\n  end: transition_end,\n  [Symbol.iterator]: selection_prototype[Symbol.iterator]\n};\n","import {selector} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n        schedule(subgroup[i], name, id, i, subgroup, get(node, id));\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, name, id);\n}\n","import {selectorAll} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {\n          if (child = children[k]) {\n            schedule(child, name, id, k, children, inherit);\n          }\n        }\n        subgroups.push(children);\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, parents, name, id);\n}\n","import {matcher} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, this._name, this._id);\n}\n","import {Transition} from \"./index.js\";\n\nexport default function(transition) {\n  if (transition._id !== this._id) throw new Error;\n\n  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Transition(merges, this._parents, this._name, this._id);\n}\n","import {Transition, newId} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function() {\n  var name = this._name,\n      id0 = this._id,\n      id1 = newId();\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        var inherit = get(node, id0);\n        schedule(node, name, id1, i, group, {\n          time: inherit.time + inherit.delay + inherit.duration,\n          delay: 0,\n          duration: inherit.duration,\n          ease: inherit.ease\n        });\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id1);\n}\n","import {get, set, init} from \"./schedule.js\";\n\nfunction start(name) {\n  return (name + \"\").trim().split(/^|\\s+/).every(function(t) {\n    var i = t.indexOf(\".\");\n    if (i >= 0) t = t.slice(0, i);\n    return !t || t === \"start\";\n  });\n}\n\nfunction onFunction(id, name, listener) {\n  var on0, on1, sit = start(name) ? init : set;\n  return function() {\n    var schedule = sit(this, id),\n        on = schedule.on;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and we’re done!\n    // Otherwise, copy-on-write.\n    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, listener) {\n  var id = this._id;\n\n  return arguments.length < 2\n      ? get(this.node(), id).on.on(name)\n      : this.each(onFunction(id, name, listener));\n}\n","function styleInterpolate(name, i, priority) {\n  return function(t) {\n    this.style.setProperty(name, i.call(this, t), priority);\n  };\n}\n\nfunction styleTween(name, value, priority) {\n  var t, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);\n    return t;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value, priority) {\n  var key = \"style.\" + (name += \"\");\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, styleTween(name, value, priority == null ? \"\" : priority));\n}\n","import {tweenValue} from \"./tween.js\";\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var value1 = value(this);\n    this.textContent = value1 == null ? \"\" : value1;\n  };\n}\n\nexport default function(value) {\n  return this.tween(\"text\", typeof value === \"function\"\n      ? textFunction(tweenValue(this, \"text\", value))\n      : textConstant(value == null ? \"\" : value + \"\"));\n}\n","function textInterpolate(i) {\n  return function(t) {\n    this.textContent = i.call(this, t);\n  };\n}\n\nfunction textTween(value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(value) {\n  var key = \"text\";\n  if (arguments.length < 1) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, textTween(value));\n}\n","function removeFunction(id) {\n  return function() {\n    var parent = this.parentNode;\n    for (var i in this.__transition) if (+i !== id) return;\n    if (parent) parent.removeChild(this);\n  };\n}\n\nexport default function() {\n  return this.on(\"end.remove\", removeFunction(this._id));\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction easeConstant(id, value) {\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    set(this, id).ease = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each(easeConstant(id, value))\n      : get(this.node(), id).ease;\n}\n","import {set} from \"./schedule.js\";\n\nfunction easeVarying(id, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (typeof v !== \"function\") throw new Error;\n    set(this, id).ease = v;\n  };\n}\n\nexport default function(value) {\n  if (typeof value !== \"function\") throw new Error;\n  return this.each(easeVarying(this._id, value));\n}\n","import {set} from \"./schedule.js\";\n\nexport default function() {\n  var on0, on1, that = this, id = that._id, size = that.size();\n  return new Promise(function(resolve, reject) {\n    var cancel = {value: reject},\n        end = {value: function() { if (--size === 0) resolve(); }};\n\n    that.each(function() {\n      var schedule = set(this, id),\n          on = schedule.on;\n\n      // If this node shared a dispatch with the previous node,\n      // just assign the updated shared dispatch and we’re done!\n      // Otherwise, copy-on-write.\n      if (on !== on0) {\n        on1 = (on0 = on).copy();\n        on1._.cancel.push(cancel);\n        on1._.interrupt.push(cancel);\n        on1._.end.push(end);\n      }\n\n      schedule.on = on1;\n    });\n\n    // The selection was empty, resolve end immediately\n    if (size === 0) resolve();\n  });\n}\n","import {Transition, newId} from \"../transition/index.js\";\nimport schedule from \"../transition/schedule.js\";\nimport {easeCubicInOut} from \"d3-ease\";\nimport {now} from \"d3-timer\";\n\nvar defaultTiming = {\n  time: null, // Set on use.\n  delay: 0,\n  duration: 250,\n  ease: easeCubicInOut\n};\n\nfunction inherit(node, id) {\n  var timing;\n  while (!(timing = node.__transition) || !(timing = timing[id])) {\n    if (!(node = node.parentNode)) {\n      throw new Error(`transition ${id} not found`);\n    }\n  }\n  return timing;\n}\n\nexport default function(name) {\n  var id,\n      timing;\n\n  if (name instanceof Transition) {\n    id = name._id, name = name._name;\n  } else {\n    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + \"\";\n  }\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        schedule(node, name, id, i, group, timing || inherit(node, id));\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id);\n}\n","export function cubicIn(t) {\n  return t * t * t;\n}\n\nexport function cubicOut(t) {\n  return --t * t * t + 1;\n}\n\nexport function cubicInOut(t) {\n  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\n}\n","import {selection} from \"d3-selection\";\nimport selection_interrupt from \"./interrupt.js\";\nimport selection_transition from \"./transition.js\";\n\nselection.prototype.interrupt = selection_interrupt;\nselection.prototype.transition = selection_transition;\n","import interrupt from \"../interrupt.js\";\n\nexport default function(name) {\n  return this.each(function() {\n    interrupt(this, name);\n  });\n}\n","export default x => () => x;\n","export default function BrushEvent(type, {\n  sourceEvent,\n  target,\n  selection,\n  mode,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    selection: {value: selection, enumerable: true, configurable: true},\n    mode: {value: mode, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n","export function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolate} from \"d3-interpolate\";\nimport {pointer, select} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport BrushEvent from \"./event.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\nvar MODE_DRAG = {name: \"drag\"},\n    MODE_SPACE = {name: \"space\"},\n    MODE_HANDLE = {name: \"handle\"},\n    MODE_CENTER = {name: \"center\"};\n\nconst {abs, max, min} = Math;\n\nfunction number1(e) {\n  return [+e[0], +e[1]];\n}\n\nfunction number2(e) {\n  return [number1(e[0]), number1(e[1])];\n}\n\nvar X = {\n  name: \"x\",\n  handles: [\"w\", \"e\"].map(type),\n  input: function(x, e) { return x == null ? null : [[+x[0], e[0][1]], [+x[1], e[1][1]]]; },\n  output: function(xy) { return xy && [xy[0][0], xy[1][0]]; }\n};\n\nvar Y = {\n  name: \"y\",\n  handles: [\"n\", \"s\"].map(type),\n  input: function(y, e) { return y == null ? null : [[e[0][0], +y[0]], [e[1][0], +y[1]]]; },\n  output: function(xy) { return xy && [xy[0][1], xy[1][1]]; }\n};\n\nvar XY = {\n  name: \"xy\",\n  handles: [\"n\", \"w\", \"e\", \"s\", \"nw\", \"ne\", \"sw\", \"se\"].map(type),\n  input: function(xy) { return xy == null ? null : number2(xy); },\n  output: function(xy) { return xy; }\n};\n\nvar cursors = {\n  overlay: \"crosshair\",\n  selection: \"move\",\n  n: \"ns-resize\",\n  e: \"ew-resize\",\n  s: \"ns-resize\",\n  w: \"ew-resize\",\n  nw: \"nwse-resize\",\n  ne: \"nesw-resize\",\n  se: \"nwse-resize\",\n  sw: \"nesw-resize\"\n};\n\nvar flipX = {\n  e: \"w\",\n  w: \"e\",\n  nw: \"ne\",\n  ne: \"nw\",\n  se: \"sw\",\n  sw: \"se\"\n};\n\nvar flipY = {\n  n: \"s\",\n  s: \"n\",\n  nw: \"sw\",\n  ne: \"se\",\n  se: \"ne\",\n  sw: \"nw\"\n};\n\nvar signsX = {\n  overlay: +1,\n  selection: +1,\n  n: null,\n  e: +1,\n  s: null,\n  w: -1,\n  nw: -1,\n  ne: +1,\n  se: +1,\n  sw: -1\n};\n\nvar signsY = {\n  overlay: +1,\n  selection: +1,\n  n: -1,\n  e: null,\n  s: +1,\n  w: null,\n  nw: -1,\n  ne: -1,\n  se: +1,\n  sw: +1\n};\n\nfunction type(t) {\n  return {type: t};\n}\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter(event) {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultExtent() {\n  var svg = this.ownerSVGElement || this;\n  if (svg.hasAttribute(\"viewBox\")) {\n    svg = svg.viewBox.baseVal;\n    return [[svg.x, svg.y], [svg.x + svg.width, svg.y + svg.height]];\n  }\n  return [[0, 0], [svg.width.baseVal.value, svg.height.baseVal.value]];\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\n// Like d3.local, but with the name “__brush” rather than auto-generated.\nfunction local(node) {\n  while (!node.__brush) if (!(node = node.parentNode)) return;\n  return node.__brush;\n}\n\nfunction empty(extent) {\n  return extent[0][0] === extent[1][0]\n      || extent[0][1] === extent[1][1];\n}\n\nexport function brushSelection(node) {\n  var state = node.__brush;\n  return state ? state.dim.output(state.selection) : null;\n}\n\nexport function brushX() {\n  return brush(X);\n}\n\nexport function brushY() {\n  return brush(Y);\n}\n\nexport default function() {\n  return brush(XY);\n}\n\nfunction brush(dim) {\n  var extent = defaultExtent,\n      filter = defaultFilter,\n      touchable = defaultTouchable,\n      keys = true,\n      listeners = dispatch(\"start\", \"brush\", \"end\"),\n      handleSize = 6,\n      touchending;\n\n  function brush(group) {\n    var overlay = group\n        .property(\"__brush\", initialize)\n      .selectAll(\".overlay\")\n      .data([type(\"overlay\")]);\n\n    overlay.enter().append(\"rect\")\n        .attr(\"class\", \"overlay\")\n        .attr(\"pointer-events\", \"all\")\n        .attr(\"cursor\", cursors.overlay)\n      .merge(overlay)\n        .each(function() {\n          var extent = local(this).extent;\n          select(this)\n              .attr(\"x\", extent[0][0])\n              .attr(\"y\", extent[0][1])\n              .attr(\"width\", extent[1][0] - extent[0][0])\n              .attr(\"height\", extent[1][1] - extent[0][1]);\n        });\n\n    group.selectAll(\".selection\")\n      .data([type(\"selection\")])\n      .enter().append(\"rect\")\n        .attr(\"class\", \"selection\")\n        .attr(\"cursor\", cursors.selection)\n        .attr(\"fill\", \"#777\")\n        .attr(\"fill-opacity\", 0.3)\n        .attr(\"stroke\", \"#fff\")\n        .attr(\"shape-rendering\", \"crispEdges\");\n\n    var handle = group.selectAll(\".handle\")\n      .data(dim.handles, function(d) { return d.type; });\n\n    handle.exit().remove();\n\n    handle.enter().append(\"rect\")\n        .attr(\"class\", function(d) { return \"handle handle--\" + d.type; })\n        .attr(\"cursor\", function(d) { return cursors[d.type]; });\n\n    group\n        .each(redraw)\n        .attr(\"fill\", \"none\")\n        .attr(\"pointer-events\", \"all\")\n        .on(\"mousedown.brush\", started)\n      .filter(touchable)\n        .on(\"touchstart.brush\", started)\n        .on(\"touchmove.brush\", touchmoved)\n        .on(\"touchend.brush touchcancel.brush\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  brush.move = function(group, selection, event) {\n    if (group.tween) {\n      group\n          .on(\"start.brush\", function(event) { emitter(this, arguments).beforestart().start(event); })\n          .on(\"interrupt.brush end.brush\", function(event) { emitter(this, arguments).end(event); })\n          .tween(\"brush\", function() {\n            var that = this,\n                state = that.__brush,\n                emit = emitter(that, arguments),\n                selection0 = state.selection,\n                selection1 = dim.input(typeof selection === \"function\" ? selection.apply(this, arguments) : selection, state.extent),\n                i = interpolate(selection0, selection1);\n\n            function tween(t) {\n              state.selection = t === 1 && selection1 === null ? null : i(t);\n              redraw.call(that);\n              emit.brush();\n            }\n\n            return selection0 !== null && selection1 !== null ? tween : tween(1);\n          });\n    } else {\n      group\n          .each(function() {\n            var that = this,\n                args = arguments,\n                state = that.__brush,\n                selection1 = dim.input(typeof selection === \"function\" ? selection.apply(that, args) : selection, state.extent),\n                emit = emitter(that, args).beforestart();\n\n            interrupt(that);\n            state.selection = selection1 === null ? null : selection1;\n            redraw.call(that);\n            emit.start(event).brush(event).end(event);\n          });\n    }\n  };\n\n  brush.clear = function(group, event) {\n    brush.move(group, null, event);\n  };\n\n  function redraw() {\n    var group = select(this),\n        selection = local(this).selection;\n\n    if (selection) {\n      group.selectAll(\".selection\")\n          .style(\"display\", null)\n          .attr(\"x\", selection[0][0])\n          .attr(\"y\", selection[0][1])\n          .attr(\"width\", selection[1][0] - selection[0][0])\n          .attr(\"height\", selection[1][1] - selection[0][1]);\n\n      group.selectAll(\".handle\")\n          .style(\"display\", null)\n          .attr(\"x\", function(d) { return d.type[d.type.length - 1] === \"e\" ? selection[1][0] - handleSize / 2 : selection[0][0] - handleSize / 2; })\n          .attr(\"y\", function(d) { return d.type[0] === \"s\" ? selection[1][1] - handleSize / 2 : selection[0][1] - handleSize / 2; })\n          .attr(\"width\", function(d) { return d.type === \"n\" || d.type === \"s\" ? selection[1][0] - selection[0][0] + handleSize : handleSize; })\n          .attr(\"height\", function(d) { return d.type === \"e\" || d.type === \"w\" ? selection[1][1] - selection[0][1] + handleSize : handleSize; });\n    }\n\n    else {\n      group.selectAll(\".selection,.handle\")\n          .style(\"display\", \"none\")\n          .attr(\"x\", null)\n          .attr(\"y\", null)\n          .attr(\"width\", null)\n          .attr(\"height\", null);\n    }\n  }\n\n  function emitter(that, args, clean) {\n    var emit = that.__brush.emitter;\n    return emit && (!clean || !emit.clean) ? emit : new Emitter(that, args, clean);\n  }\n\n  function Emitter(that, args, clean) {\n    this.that = that;\n    this.args = args;\n    this.state = that.__brush;\n    this.active = 0;\n    this.clean = clean;\n  }\n\n  Emitter.prototype = {\n    beforestart: function() {\n      if (++this.active === 1) this.state.emitter = this, this.starting = true;\n      return this;\n    },\n    start: function(event, mode) {\n      if (this.starting) this.starting = false, this.emit(\"start\", event, mode);\n      else this.emit(\"brush\", event);\n      return this;\n    },\n    brush: function(event, mode) {\n      this.emit(\"brush\", event, mode);\n      return this;\n    },\n    end: function(event, mode) {\n      if (--this.active === 0) delete this.state.emitter, this.emit(\"end\", event, mode);\n      return this;\n    },\n    emit: function(type, event, mode) {\n      var d = select(this.that).datum();\n      listeners.call(\n        type,\n        this.that,\n        new BrushEvent(type, {\n          sourceEvent: event,\n          target: brush,\n          selection: dim.output(this.state.selection),\n          mode,\n          dispatch: listeners\n        }),\n        d\n      );\n    }\n  };\n\n  function started(event) {\n    if (touchending && !event.touches) return;\n    if (!filter.apply(this, arguments)) return;\n\n    var that = this,\n        type = event.target.__data__.type,\n        mode = (keys && event.metaKey ? type = \"overlay\" : type) === \"selection\" ? MODE_DRAG : (keys && event.altKey ? MODE_CENTER : MODE_HANDLE),\n        signX = dim === Y ? null : signsX[type],\n        signY = dim === X ? null : signsY[type],\n        state = local(that),\n        extent = state.extent,\n        selection = state.selection,\n        W = extent[0][0], w0, w1,\n        N = extent[0][1], n0, n1,\n        E = extent[1][0], e0, e1,\n        S = extent[1][1], s0, s1,\n        dx = 0,\n        dy = 0,\n        moving,\n        shifting = signX && signY && keys && event.shiftKey,\n        lockX,\n        lockY,\n        points = Array.from(event.touches || [event], t => {\n          const i = t.identifier;\n          t = pointer(t, that);\n          t.point0 = t.slice();\n          t.identifier = i;\n          return t;\n        });\n\n    interrupt(that);\n    var emit = emitter(that, arguments, true).beforestart();\n\n    if (type === \"overlay\") {\n      if (selection) moving = true;\n      const pts = [points[0], points[1] || points[0]];\n      state.selection = selection = [[\n          w0 = dim === Y ? W : min(pts[0][0], pts[1][0]),\n          n0 = dim === X ? N : min(pts[0][1], pts[1][1])\n        ], [\n          e0 = dim === Y ? E : max(pts[0][0], pts[1][0]),\n          s0 = dim === X ? S : max(pts[0][1], pts[1][1])\n        ]];\n      if (points.length > 1) move(event);\n    } else {\n      w0 = selection[0][0];\n      n0 = selection[0][1];\n      e0 = selection[1][0];\n      s0 = selection[1][1];\n    }\n\n    w1 = w0;\n    n1 = n0;\n    e1 = e0;\n    s1 = s0;\n\n    var group = select(that)\n        .attr(\"pointer-events\", \"none\");\n\n    var overlay = group.selectAll(\".overlay\")\n        .attr(\"cursor\", cursors[type]);\n\n    if (event.touches) {\n      emit.moved = moved;\n      emit.ended = ended;\n    } else {\n      var view = select(event.view)\n          .on(\"mousemove.brush\", moved, true)\n          .on(\"mouseup.brush\", ended, true);\n      if (keys) view\n          .on(\"keydown.brush\", keydowned, true)\n          .on(\"keyup.brush\", keyupped, true)\n\n      dragDisable(event.view);\n    }\n\n    redraw.call(that);\n    emit.start(event, mode.name);\n\n    function moved(event) {\n      for (const p of event.changedTouches || [event]) {\n        for (const d of points)\n          if (d.identifier === p.identifier) d.cur = pointer(p, that);\n      }\n      if (shifting && !lockX && !lockY && points.length === 1) {\n        const point = points[0];\n        if (abs(point.cur[0] - point[0]) > abs(point.cur[1] - point[1]))\n          lockY = true;\n        else\n          lockX = true;\n      }\n      for (const point of points)\n        if (point.cur) point[0] = point.cur[0], point[1] = point.cur[1];\n      moving = true;\n      noevent(event);\n      move(event);\n    }\n\n    function move(event) {\n      const point = points[0], point0 = point.point0;\n      var t;\n\n      dx = point[0] - point0[0];\n      dy = point[1] - point0[1];\n\n      switch (mode) {\n        case MODE_SPACE:\n        case MODE_DRAG: {\n          if (signX) dx = max(W - w0, min(E - e0, dx)), w1 = w0 + dx, e1 = e0 + dx;\n          if (signY) dy = max(N - n0, min(S - s0, dy)), n1 = n0 + dy, s1 = s0 + dy;\n          break;\n        }\n        case MODE_HANDLE: {\n          if (points[1]) {\n            if (signX) w1 = max(W, min(E, points[0][0])), e1 = max(W, min(E, points[1][0])), signX = 1;\n            if (signY) n1 = max(N, min(S, points[0][1])), s1 = max(N, min(S, points[1][1])), signY = 1;\n          } else {\n            if (signX < 0) dx = max(W - w0, min(E - w0, dx)), w1 = w0 + dx, e1 = e0;\n            else if (signX > 0) dx = max(W - e0, min(E - e0, dx)), w1 = w0, e1 = e0 + dx;\n            if (signY < 0) dy = max(N - n0, min(S - n0, dy)), n1 = n0 + dy, s1 = s0;\n            else if (signY > 0) dy = max(N - s0, min(S - s0, dy)), n1 = n0, s1 = s0 + dy;\n          }\n          break;\n        }\n        case MODE_CENTER: {\n          if (signX) w1 = max(W, min(E, w0 - dx * signX)), e1 = max(W, min(E, e0 + dx * signX));\n          if (signY) n1 = max(N, min(S, n0 - dy * signY)), s1 = max(N, min(S, s0 + dy * signY));\n          break;\n        }\n      }\n\n      if (e1 < w1) {\n        signX *= -1;\n        t = w0, w0 = e0, e0 = t;\n        t = w1, w1 = e1, e1 = t;\n        if (type in flipX) overlay.attr(\"cursor\", cursors[type = flipX[type]]);\n      }\n\n      if (s1 < n1) {\n        signY *= -1;\n        t = n0, n0 = s0, s0 = t;\n        t = n1, n1 = s1, s1 = t;\n        if (type in flipY) overlay.attr(\"cursor\", cursors[type = flipY[type]]);\n      }\n\n      if (state.selection) selection = state.selection; // May be set by brush.move!\n      if (lockX) w1 = selection[0][0], e1 = selection[1][0];\n      if (lockY) n1 = selection[0][1], s1 = selection[1][1];\n\n      if (selection[0][0] !== w1\n          || selection[0][1] !== n1\n          || selection[1][0] !== e1\n          || selection[1][1] !== s1) {\n        state.selection = [[w1, n1], [e1, s1]];\n        redraw.call(that);\n        emit.brush(event, mode.name);\n      }\n    }\n\n    function ended(event) {\n      nopropagation(event);\n      if (event.touches) {\n        if (event.touches.length) return;\n        if (touchending) clearTimeout(touchending);\n        touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n      } else {\n        dragEnable(event.view, moving);\n        view.on(\"keydown.brush keyup.brush mousemove.brush mouseup.brush\", null);\n      }\n      group.attr(\"pointer-events\", \"all\");\n      overlay.attr(\"cursor\", cursors.overlay);\n      if (state.selection) selection = state.selection; // May be set by brush.move (on start)!\n      if (empty(selection)) state.selection = null, redraw.call(that);\n      emit.end(event, mode.name);\n    }\n\n    function keydowned(event) {\n      switch (event.keyCode) {\n        case 16: { // SHIFT\n          shifting = signX && signY;\n          break;\n        }\n        case 18: { // ALT\n          if (mode === MODE_HANDLE) {\n            if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;\n            if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;\n            mode = MODE_CENTER;\n            move(event);\n          }\n          break;\n        }\n        case 32: { // SPACE; takes priority over ALT\n          if (mode === MODE_HANDLE || mode === MODE_CENTER) {\n            if (signX < 0) e0 = e1 - dx; else if (signX > 0) w0 = w1 - dx;\n            if (signY < 0) s0 = s1 - dy; else if (signY > 0) n0 = n1 - dy;\n            mode = MODE_SPACE;\n            overlay.attr(\"cursor\", cursors.selection);\n            move(event);\n          }\n          break;\n        }\n        default: return;\n      }\n      noevent(event);\n    }\n\n    function keyupped(event) {\n      switch (event.keyCode) {\n        case 16: { // SHIFT\n          if (shifting) {\n            lockX = lockY = shifting = false;\n            move(event);\n          }\n          break;\n        }\n        case 18: { // ALT\n          if (mode === MODE_CENTER) {\n            if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;\n            if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;\n            mode = MODE_HANDLE;\n            move(event);\n          }\n          break;\n        }\n        case 32: { // SPACE\n          if (mode === MODE_SPACE) {\n            if (event.altKey) {\n              if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;\n              if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;\n              mode = MODE_CENTER;\n            } else {\n              if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;\n              if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;\n              mode = MODE_HANDLE;\n            }\n            overlay.attr(\"cursor\", cursors[type]);\n            move(event);\n          }\n          break;\n        }\n        default: return;\n      }\n      noevent(event);\n    }\n  }\n\n  function touchmoved(event) {\n    emitter(this, arguments).moved(event);\n  }\n\n  function touchended(event) {\n    emitter(this, arguments).ended(event);\n  }\n\n  function initialize() {\n    var state = this.__brush || {selection: null};\n    state.extent = number2(extent.apply(this, arguments));\n    state.dim = dim;\n    return state;\n  }\n\n  brush.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant(number2(_)), brush) : extent;\n  };\n\n  brush.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), brush) : filter;\n  };\n\n  brush.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), brush) : touchable;\n  };\n\n  brush.handleSize = function(_) {\n    return arguments.length ? (handleSize = +_, brush) : handleSize;\n  };\n\n  brush.keyModifiers = function(_) {\n    return arguments.length ? (keys = !!_, brush) : keys;\n  };\n\n  brush.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? brush : value;\n  };\n\n  return brush;\n}\n","import {select} from \"d3-selection\";\nimport noevent from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, true);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, true);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, true);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","export default function(x) {\n  return Math.abs(x = Math.round(x)) >= 1e21\n      ? x.toLocaleString(\"en\").replace(/,/g, \"\")\n      : x.toString(10);\n}\n\n// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimalParts(1.23) returns [\"123\", 0].\nexport function formatDecimalParts(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, ±Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x) {\n  return x = formatDecimalParts(Math.abs(x)), x ? x[1] : NaN;\n}\n","// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  return new FormatSpecifier({\n    fill: match[1],\n    align: match[2],\n    sign: match[3],\n    symbol: match[4],\n    zero: match[5],\n    width: match[6],\n    comma: match[7],\n    precision: match[8] && match[8].slice(1),\n    trim: match[9],\n    type: match[10]\n  });\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nexport function FormatSpecifier(specifier) {\n  this.fill = specifier.fill === undefined ? \" \" : specifier.fill + \"\";\n  this.align = specifier.align === undefined ? \">\" : specifier.align + \"\";\n  this.sign = specifier.sign === undefined ? \"-\" : specifier.sign + \"\";\n  this.symbol = specifier.symbol === undefined ? \"\" : specifier.symbol + \"\";\n  this.zero = !!specifier.zero;\n  this.width = specifier.width === undefined ? undefined : +specifier.width;\n  this.comma = !!specifier.comma;\n  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;\n  this.trim = !!specifier.trim;\n  this.type = specifier.type === undefined ? \"\" : specifier.type + \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width === undefined ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision === undefined ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimalParts(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n","import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n","import formatDecimal from \"./formatDecimal.js\";\nimport formatPrefixAuto from \"./formatPrefixAuto.js\";\nimport formatRounded from \"./formatRounded.js\";\n\nexport default {\n  \"%\": (x, p) => (x * 100).toFixed(p),\n  \"b\": (x) => Math.round(x).toString(2),\n  \"c\": (x) => x + \"\",\n  \"d\": formatDecimal,\n  \"e\": (x, p) => x.toExponential(p),\n  \"f\": (x, p) => x.toFixed(p),\n  \"g\": (x, p) => x.toPrecision(p),\n  \"o\": (x) => Math.round(x).toString(8),\n  \"p\": (x, p) => formatRounded(x * 100, p),\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": (x) => Math.round(x).toString(16).toUpperCase(),\n  \"x\": (x) => Math.round(x).toString(16)\n};\n","export default function(x) {\n  return x;\n}\n","import exponent from \"./exponent.js\";\nimport formatGroup from \"./formatGroup.js\";\nimport formatNumerals from \"./formatNumerals.js\";\nimport formatSpecifier from \"./formatSpecifier.js\";\nimport formatTrim from \"./formatTrim.js\";\nimport formatTypes from \"./formatTypes.js\";\nimport {prefixExponent} from \"./formatPrefixAuto.js\";\nimport identity from \"./identity.js\";\n\nvar map = Array.prototype.map,\n    prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"µ\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping === undefined || locale.thousands === undefined ? identity : formatGroup(map.call(locale.grouping, Number), locale.thousands + \"\"),\n      currencyPrefix = locale.currency === undefined ? \"\" : locale.currency[0] + \"\",\n      currencySuffix = locale.currency === undefined ? \"\" : locale.currency[1] + \"\",\n      decimal = locale.decimal === undefined ? \".\" : locale.decimal + \"\",\n      numerals = locale.numerals === undefined ? identity : formatNumerals(map.call(locale.numerals, String)),\n      percent = locale.percent === undefined ? \"%\" : locale.percent + \"\",\n      minus = locale.minus === undefined ? \"−\" : locale.minus + \"\",\n      nan = locale.nan === undefined ? \"NaN\" : locale.nan + \"\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currencyPrefix : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currencySuffix : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision === undefined ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Determine the sign. -0 is not less than 0, but 1 / -0 is!\n        var valueNegative = value < 0 || 1 / value < 0;\n\n        // Perform the initial formatting.\n        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero after formatting, and no explicit positive sign is requested, hide the sign.\n        if (valueNegative && +value === 0 && sign !== \"+\") valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : minus) : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer “value” part that can be\n        // grouped, and fractional or exponential “suffix” part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n","import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n","export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n","export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n","// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (!+s[i]) break out; if (i0 > 0) i0 = 0; break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent.js\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n","var e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nexport default function ticks(start, stop, count) {\n  var reverse,\n      i = -1,\n      n,\n      ticks,\n      step;\n\n  stop = +stop, start = +start, count = +count;\n  if (start === stop && count > 0) return [start];\n  if (reverse = stop < start) n = start, start = stop, stop = n;\n  if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) return [];\n\n  if (step > 0) {\n    let r0 = Math.round(start / step), r1 = Math.round(stop / step);\n    if (r0 * step < start) ++r0;\n    if (r1 * step > stop) --r1;\n    ticks = new Array(n = r1 - r0 + 1);\n    while (++i < n) ticks[i] = (r0 + i) * step;\n  } else {\n    step = -step;\n    let r0 = Math.round(start * step), r1 = Math.round(stop * step);\n    if (r0 / step < start) ++r0;\n    if (r1 / step > stop) --r1;\n    ticks = new Array(n = r1 - r0 + 1);\n    while (++i < n) ticks[i] = (r0 + i) / step;\n  }\n\n  if (reverse) ticks.reverse();\n\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  var step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log(step) / Math.LN10),\n      error = step / Math.pow(10, power);\n  return power >= 0\n      ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power)\n      : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);\n}\n\nexport function tickStep(start, stop, count) {\n  var step0 = Math.abs(stop - start) / Math.max(0, count),\n      step1 = Math.pow(10, Math.floor(Math.log(step0) / Math.LN10)),\n      error = step0 / step1;\n  if (error >= e10) step1 *= 10;\n  else if (error >= e5) step1 *= 5;\n  else if (error >= e2) step1 *= 2;\n  return stop < start ? -step1 : step1;\n}\n","export default function ascending(a, b) {\n  return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export default function descending(a, b) {\n  return a == null || b == null ? NaN\n    : b < a ? -1\n    : b > a ? 1\n    : b >= a ? 0\n    : NaN;\n}\n","import ascending from \"./ascending.js\";\nimport descending from \"./descending.js\";\n\nexport default function bisector(f) {\n  let compare1, compare2, delta;\n\n  // If an accessor is specified, promote it to a comparator. In this case we\n  // can test whether the search value is (self-) comparable. We can’t do this\n  // for a comparator (except for specific, known comparators) because we can’t\n  // tell if the comparator is symmetric, and an asymmetric comparator can’t be\n  // used to test whether a single value is comparable.\n  if (f.length !== 2) {\n    compare1 = ascending;\n    compare2 = (d, x) => ascending(f(d), x);\n    delta = (d, x) => f(d) - x;\n  } else {\n    compare1 = f === ascending || f === descending ? f : zero;\n    compare2 = f;\n    delta = f;\n  }\n\n  function left(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) < 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function right(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) <= 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function center(a, x, lo = 0, hi = a.length) {\n    const i = left(a, x, lo, hi - 1);\n    return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;\n  }\n\n  return {left, center, right};\n}\n\nfunction zero() {\n  return 0;\n}\n","import ascending from \"./ascending.js\";\nimport bisector from \"./bisector.js\";\nimport number from \"./number.js\";\n\nconst ascendingBisect = bisector(ascending);\nexport const bisectRight = ascendingBisect.right;\nexport const bisectLeft = ascendingBisect.left;\nexport const bisectCenter = bisector(number).center;\nexport default bisectRight;\n","export default function number(x) {\n  return x === null ? NaN : +x;\n}\n\nexport function* numbers(values, valueof) {\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  }\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return Math.round(a * (1 - t) + b * t);\n  };\n}\n","export default function number(x) {\n  return +x;\n}\n","import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateNumber, interpolateRound} from \"d3-interpolate\";\nimport constant from \"./constant.js\";\nimport number from \"./number.js\";\n\nvar unit = [0, 1];\n\nexport function identity(x) {\n  return x;\n}\n\nfunction normalize(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(isNaN(b) ? NaN : 0.5);\n}\n\nfunction clamper(a, b) {\n  var t;\n  if (a > b) t = a, a = b, b = t;\n  return function(x) { return Math.max(a, Math.min(b, x)); };\n}\n\n// normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].\nfunction bimap(domain, range, interpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);\n  else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, interpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = normalize(domain[i], domain[i + 1]);\n    r[i] = interpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp())\n      .unknown(source.unknown());\n}\n\nexport function transformer() {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      transform,\n      untransform,\n      unknown,\n      clamp = identity,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    var n = Math.min(domain.length, range.length);\n    if (clamp !== identity) clamp = clamper(domain[0], domain[n - 1]);\n    piecewise = n > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return x == null || isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n  }\n\n  scale.invert = function(y) {\n    return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = Array.from(_, number), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = Array.from(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = _ ? true : identity, rescale()) : clamp !== identity;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  return function(t, u) {\n    transform = t, untransform = u;\n    return rescale();\n  };\n}\n\nexport default function continuous() {\n  return transformer()(identity, identity);\n}\n","export default function constants(x) {\n  return function() {\n    return x;\n  };\n}\n","export function initRange(domain, range) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: this.range(domain); break;\n    default: this.range(range).domain(domain); break;\n  }\n  return this;\n}\n\nexport function initInterpolator(domain, interpolator) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: {\n      if (typeof domain === \"function\") this.interpolator(domain);\n      else this.range(domain);\n      break;\n    }\n    default: {\n      this.domain(domain);\n      if (typeof interpolator === \"function\") this.interpolator(interpolator);\n      else this.range(interpolator);\n      break;\n    }\n  }\n  return this;\n}\n","import {ticks, tickIncrement} from \"d3-array\";\nimport continuous, {copy} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport tickFormat from \"./tickFormat.js\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    var d = domain();\n    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain();\n    var i0 = 0;\n    var i1 = d.length - 1;\n    var start = d[i0];\n    var stop = d[i1];\n    var prestep;\n    var step;\n    var maxIter = 10;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n    \n    while (maxIter-- > 0) {\n      step = tickIncrement(start, stop, count);\n      if (step === prestep) {\n        d[i0] = start\n        d[i1] = stop\n        return domain(d);\n      } else if (step > 0) {\n        start = Math.floor(start / step) * step;\n        stop = Math.ceil(stop / step) * step;\n      } else if (step < 0) {\n        start = Math.ceil(start * step) / step;\n        stop = Math.floor(stop * step) / step;\n      } else {\n        break;\n      }\n      prestep = step;\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous();\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return linearish(scale);\n}\n","import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function tickFormat(start, stop, count, specifier) {\n  var step = tickStep(start, stop, count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n","var organismMetadata = {\n  9606: {\n    commonName: 'Human',\n    scientificName: 'Homo sapiens',\n    assemblies: {\n      default: 'GCF_000001405.26', // GRCh38\n      GRCh38: 'GCF_000001405.26',\n      GRCh37: 'GCF_000001405.13',\n      NCBI36: 'GCF_000001405.12'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasInteractionCache: true,\n    hasGeneStructureCache: true,\n    hasProteinCache: true,\n    hasSynonymCache: true,\n    hasTissueCache: true\n  },\n  10090: {\n    commonName: 'Mouse',\n    scientificName: 'Mus musculus',\n    assemblies: {\n      default: 'GCF_000001635.27', // GRCm39\n      GRCm39: 'GCF_000001635.27',\n      GRCm38: 'GCF_000001635.20',\n      MGSCv37: 'GCF_000001635.18'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasInteractionCache: true,\n    hasGeneStructureCache: true,\n    hasProteinCache: true,\n    hasSynonymCache: true\n  },\n  9598: {\n    commonName: 'Chimpanzee',\n    scientificName: 'Pan troglodytes',\n    assemblies: {\n      'default': 'GCF_028858775.1',\n      'NHGRI_mPanTro3-v1.1-hic.freeze_pri': 'GCF_028858775.1',\n      'Pan_tro 3.0': 'GCF_000001515.7'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasSynonymCache: true\n  },\n  10116: {\n    commonName: 'Rat',\n    scientificName: 'Rattus norvegicus',\n    assemblies: {\n      'default': 'GCF_000001895.5',\n      'Rnor_6.0': 'GCF_000001895.5'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasSynonymCache: true\n  },\n  3702: {\n    commonName: 'Thale cress',\n    scientificName: 'Arabidopsis thaliana',\n    assemblies: {\n      default: 'GCF_000001735.3', // TAIR10\n      TAIR10: 'GCF_000001735.3'\n    }\n  },\n  4530: {\n    commonName: 'Rice',\n    scientificName: 'Oryza sativa',\n    assemblies: {\n      'default': 'GCA_001433935.1',\n      'IRGSP-1.0': 'GCA_001433935.1'\n    }\n  },\n  4577: {\n    commonName: 'Maize',\n    scientificName: 'Zea mays',\n    assemblies: {\n      'default': 'GCA_000005005.5',\n      'IRGSP-1.0': 'GCA_001433935.1'\n    }\n  },\n  4641: {\n    commonName: 'Banana',\n    scientificName: 'Musa acuminata',\n    assemblies: {\n      default: 'mock'\n    }\n  },\n  7227: {\n    commonName: 'Fly',\n    scientificName: 'Drosophila melanogaster',\n    assemblies: {\n      'default': 'GCA_000001215.4',\n      'Release 6 plus ISO1 MT': 'GCA_000001215.4'\n    },\n    hasSynonymCache: true\n  },\n  7165: {\n    commonName: 'Mosquito',\n    scientificName: 'Anopheles gambiae',\n    assemblies: {\n      default: 'GCF_000005575.2'\n    }\n  },\n  746128: {\n    commonName: 'Aspergillis fumigatus',\n    scientificName: 'Aspergillis fumigatus',\n    assemblies: {\n      default: 'GCF_000002655.1'\n    }\n  },\n  227321: {\n    scientificName: 'Aspergillus nidulans',\n    assemblies: {\n      default: 'GCF_000149205.2'\n    }\n  },\n  5061: {\n    commonName: 'black mold',\n    scientificName: 'Aspergillus niger',\n    assemblies: {\n      default: 'GCF_003184595.1'\n    }\n  },\n  5062: {\n    commonName: 'koji',\n    scientificName: 'Aspergillus oryzae',\n    assemblies: {\n      default: 'GCF_000184455.2'\n    }\n  },\n  15368: {\n    commonName: 'stiff brome',\n    scientificName: 'Brachypodium distachyon',\n    assemblies: {\n      default: 'GCF_000005505.3'\n    }\n  },\n  60711: {\n    commonName: 'green monkey',\n    scientificName: 'Chlorocebus sabaeus',\n    assemblies: {\n      default: 'GCF_015252025.1'\n    }\n  },\n  7719: {\n    commonName: 'Vase tunicate',\n    scientificName: 'Ciona intestinalis',\n    assemblies: {\n      default: 'GCF_000224145.3'\n    }\n  },\n  9685: {\n    commonName: 'Cat',\n    scientificName: 'Felis catus',\n    assemblies: {\n      default: 'GCF_000181335.3'\n    },\n    hasGeneCache: true\n  },\n  9031: {\n    commonName: 'Chicken',\n    scientificName: 'Gallus gallus',\n    assemblies: {\n      default: 'GCF_000002315.6'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true\n  },\n  9593: {\n    commonName: 'Gorilla',\n    scientificName: 'Gorilla gorilla',\n    assemblies: {\n      default: 'GCF_008122165.1'\n    }\n  },\n  4513: {\n    commonName: 'Barley',\n    scientificName: 'Hordeum vulgare',\n    assemblies: {\n      default: 'GCA_901482405.1'\n    }\n  },\n  9541: {\n    commonName: 'Crab-eating macaque',\n    scientificName: 'Macaca fascicularis',\n    assemblies: {\n      default: 'GCF_000364345.1'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasSynonymCache: true\n  },\n  9544: {\n    commonName: 'Rhesus macaque',\n    scientificName: 'Macaca mulatta',\n    assemblies: {\n      default: 'GCF_003339765.1'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasSynonymCache: true\n  },\n  9597: {\n    commonName: 'Bonobo',\n    scientificName: 'Pan paniscus',\n    assemblies: {\n      default: 'GCF_013052645.1'\n    }\n  },\n  9615: {\n    commonName: 'Dog',\n    scientificName: 'Canis lupus familiaris',\n    assemblies: {\n      default: 'GCF_014441545.1'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasSynonymCache: true\n  },\n  9823: {\n    commonName: 'Pig',\n    scientificName: 'Sus scrofa',\n    assemblies: {\n      default: 'GCF_000003025.6'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasSynonymCache: true\n  },\n  4932: {\n    commonName: 'Yeast',\n    scientificName: 'Saccharomyces cerevisiae',\n    assemblies: {\n      default: 'GCA_000146045.2',\n      R64: 'GCA_000146045.2'\n    }\n  },\n  5833: {\n    commonName: 'malaria parasite',\n    scientificName: 'Plasmodium falciparum',\n    assemblies: {\n      default: 'GCA_000002765.3',\n      GCA_000002765: 'GCA_000002765.3'\n    }\n  },\n  6239: {\n    commonName: 'worm',\n    scientificName: 'Caenorhabditis elegans',\n    assemblies: {\n      default: 'GCF_000002985.6'\n    },\n    hasGeneCache: true,\n    hasParalogCache: true,\n    hasSynonymCache: true\n  },\n  4081: {\n    commonName: 'tomato',\n    scientificName: 'Solanum lycopersicum',\n    assemblies: {\n      default: 'GCF_000188115.4'\n    }\n  },\n  4072: {\n    commonName: 'pepper',\n    scientificName: 'Capsicum annuum',\n    assemblies: {\n      default: 'GCF_000710875.1'\n    }\n  },\n  3694: {\n    commonName: 'black cottonwood',\n    scientificName: 'Populus trichocarpa',\n    assemblies: {\n      default: 'GCF_000002775.5'\n    }\n  }\n};\n\nexport {organismMetadata};\n","/**\n * @fileoverview A collection of Ideogram methods that don't fit elsewhere.\n */\n\nimport {select, selectAll} from 'd3-selection';\nimport * as d3fetch from 'd3-fetch';\nimport * as d3brush from 'd3-brush';\nimport * as d3dispatch from 'd3-dispatch';\nimport * as d3format from 'd3-format';\nimport {scaleLinear} from 'd3-scale';\nimport {max} from 'd3-array';\n\nimport {organismMetadata} from './init/organism-metadata';\n\nvar d3 = Object.assign(\n  {}, d3fetch, d3brush, d3dispatch, d3format\n);\n\nd3.select = select;\nd3.selectAll = selectAll;\nd3.scaleLinear = scaleLinear;\nd3.max = max;\n\n/**\n * Is the assembly in this.config an NCBI Assembly accession?\n *\n * @returns {boolean}\n */\nfunction assemblyIsAccession() {\n  return (\n    'assembly' in this.config &&\n    /(GCF_|GCA_)/.test(this.config.assembly)\n  );\n}\n\n/**\n * Is the assembly in this.config not from GenBank?\n *\n * @returns {boolean}\n */\nfunction hasNonGenBankAssembly(ideo) {\n  return (\n    'assembly' in ideo.config &&\n    /(GCA_)/.test(ideo.config.assembly) === false\n  );\n}\n\n/**\n * Is the assembly in this.config from GenBank?\n *\n * @returns {boolean}\n */\nfunction hasGenBankAssembly(ideo) {\n  return (\n    'assembly' in ideo.config &&\n    /(GCA_)/.test(ideo.config.assembly)\n  );\n}\n\nfunction getDir(dir) {\n  var script, tmp, protocol, dataDir, ideogramInLeaf,\n    scripts = document.scripts,\n    version = Ideogram.version;\n\n  if (location.pathname.includes('/examples/vanilla/') === false) {\n    return (\n      `https://cdn.jsdelivr.net/npm/ideogram@${version}/dist/data/${dir}`\n    );\n  }\n\n  for (var i = 0; i < scripts.length; i++) {\n    script = scripts[i];\n    ideogramInLeaf = /ideogram/.test(script.src.split('/').slice(-1));\n    if ('src' in script && ideogramInLeaf) {\n      tmp = script.src.split('//');\n      protocol = tmp[0];\n      tmp = '/' + tmp[1].split('/').slice(0, -2).join('/');\n      dataDir = protocol + '//' + tmp + '/data/' + dir;\n      return dataDir;\n    }\n  }\n\n  return '../data/' + dir;\n}\n\n/** Try request, and if failed then retry with URL lacking extension */\nfunction fetchWithRetry(url, isRetry=false) {\n  return fetch(url)\n    .then((response) => {\n      if (response.ok) {\n        return response;\n      } else {\n        if (isRetry === false) {\n          var urlWithoutExtension = url.replace('.json', '');\n          return fetchWithRetry(urlWithoutExtension, true);\n        } else {\n          throw Error('Fetch failed for ' + url);\n        }\n      }\n    });\n}\n\n/**\n * Returns directory used to fetch data for bands and annotations\n *\n * This simplifies ideogram configuration.  By default, the dataDir is\n * set to an external CDN unless we're serving from the local Ideogram\n * working directory\n *\n * @returns {String}\n */\nfunction getDataDir() {\n  return getDir('bands/native/');\n}\n\n/**\n * Rounds a float (e.g. SVG coordinate) to two decimal places\n *\n * @param coord Floating-point number, e.g. 42.1234567890\n * @returns {number} Rounded value, e.g. 42.12\n */\nfunction round(coord) {\n  // Per http://stackoverflow.com/a/9453447, below method is fastest\n  return Math.round(coord * 100) / 100;\n}\n\n/**\n * Convert e.g. 1000 to 1 k, 1500000 to 1.5 M, etc.\n * Used to format 1500000 base pairs to e.g. 1.5 Mbp\n *\n * Adapted from https://stackoverflow.com/a/9462382/10564415\n */\nfunction formatSiPrefix(num, digits) {\n  const lookup = [\n    {value: 1, symbol: ''},\n    {value: 1e3, symbol: 'k'},\n    {value: 1e6, symbol: 'M'},\n    {value: 1e9, symbol: 'G'},\n    {value: 1e12, symbol: 'T'},\n    {value: 1e15, symbol: 'P'},\n    {value: 1e18, symbol: 'E'}\n  ];\n  const rx = /\\.0+$|(\\.[0-9]*[1-9])0+$/;\n  var item = lookup.slice().reverse().find(function(item) {\n    return num >= item.value;\n  });\n  // eslint-disable-next-line max-len\n  return item ? (num / item.value).toFixed(digits).replace(rx, '$1') + ' ' + item.symbol : '0';\n}\n\nfunction onDidRotate(chrModel) {\n  call(this.onDidRotateCallback, chrModel);\n}\n\n/**\n * Get ideogram SVG container\n */\nfunction getSvg() {\n  return d3.select(this.selector).node();\n}\n\n/** Request data with Ideogram's authorization bearer token */\nfunction fetchWithAuth(url, contentType) {\n  var ideo = this,\n    config = ideo.config,\n    headers = new Headers();\n\n  if (config.accessToken) {\n    headers = new Headers({Authorization: 'Bearer ' + config.accessToken});\n  }\n\n  if (contentType === 'text') {\n    return d3.text(url, {headers: headers});\n  } else {\n    return d3.json(url, {headers: headers});\n  }\n}\n\n/** getTaxid(), but without need to initialize ideogram  */\nfunction getEarlyTaxid(name) {\n  name = slug(name);\n  for (const taxid in organismMetadata) {\n    const organism = organismMetadata[taxid];\n    const commonName = slug(organism.commonName);\n    const scientificName = slug(organism.scientificName);\n    if (commonName === name || scientificName === name) {\n      return taxid;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Get organism's taxid (NCBI Taxonomy ID) given its common or scientific name\n */\nfunction getTaxid(name) {\n  var organism, taxid, commonName, scientificName,\n    ideo = this,\n    organisms = ideo.organisms;\n\n  name = slug(name);\n\n  for (taxid in organisms) {\n    organism = organisms[taxid];\n    commonName = slug(organism.commonName);\n    scientificName = slug(organism.scientificName);\n    if (commonName === name || scientificName === name) {\n      return taxid;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Get organism's common name given its taxid\n */\nfunction getCommonName(taxid) {\n  var ideo = this;\n  if (taxid in ideo.organisms) {\n    return ideo.organisms[taxid].commonName;\n  }\n  return null;\n}\n\n/**\n * Get organism's scientific name given its taxid\n */\nfunction getScientificName(taxid) {\n  var ideo = this;\n  if (taxid in ideo.organisms) {\n    return ideo.organisms[taxid].scientificName;\n  }\n  return null;\n}\n\n/** Convert string to camelcase */\nexport function camel(str) {\n  const camelCaseString = str\n    .split(/[ _-]/g)\n    .map((token, i) => {\n      if (i > 0) {\n        return token[0].toUpperCase() + token.slice(1);\n      } else {\n        return token;\n      }\n    })\n    .join('');\n\n  return camelCaseString;\n}\n\n/**\n* Examples:\n* \"Homo sapiens\" -> \"homo-sapiens\"\n* \"Canis lupus familiaris\" -> \"canis-lupus-familiaris\"\n*/\nfunction slug(value) {\n  if (typeof value === 'undefined') return '';\n  return value.toLowerCase().replace(/ /g, '-');\n}\n\n// Determine if a string is a Roman numeral\n// From https://stackoverflow.com/a/48601418\nfunction isRoman(s) {\n  // http://stackoverflow.com/a/267405/1447675\n  return /^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/i.test(s);\n}\n\n// Convert Roman numeral to integer\n// From https://stackoverflow.com/a/48601418\nfunction parseRoman(s) {\n  var val = {M: 1000, D: 500, C: 100, L: 50, X: 10, V: 5, I: 1};\n  return s.toUpperCase().split('').reduce(function(r, a, i, aa) {\n    return val[a] < val[aa[i + 1]] ? r - val[a] : r + val[a];\n  }, 0);\n}\n\n/**\n* Download a PNG image of the ideogram\n*\n* Includes any annotations, but not legend.\n*/\nfunction downloadPng(ideo) {\n  var ideoSvg = document.querySelector(ideo.selector);\n\n  // Create a hidden canvas.  This will contain the raster image to download.\n  var canvas = document.createElement('canvas');\n  var canvasId = '_ideo-undisplayed-dl-canvas';\n  canvas.setAttribute('style', 'display: none');\n  canvas.setAttribute('id', canvasId);\n  var width = ideoSvg.width.baseVal.value + 30;\n  var ideoSvgClone = ideoSvg.cloneNode(true);\n  ideoSvgClone.style.left = '';\n  canvas.setAttribute('width', width);\n  document.body.appendChild(canvas);\n\n  // Called after PNG image is created from data URL\n  function triggerDownload(imgUrl) {\n    var evt = new MouseEvent('click', {\n      view: window,\n      bubbles: false,\n      cancelable: true\n    });\n\n    var a = document.createElement('a');\n    a.setAttribute('download', 'ideogram.png');\n    a.setAttribute('href', imgUrl);\n    a.setAttribute('target', '_blank');\n\n    // Enables easy testing\n    a.setAttribute('id', '_ideo-undisplayed-dl-image-link');\n    a.setAttribute('style', 'display: none;');\n    document.body.appendChild(a);\n\n    a.dispatchEvent(evt);\n    canvas.remove();\n  }\n\n  var canvas = document.getElementById(canvasId);\n\n  // Enlarge canvas and disable smoothing, for higher resolution PNG\n  canvas.width *= 2;\n  canvas.height *= 2;\n  var ctx = canvas.getContext('2d');\n  ctx.setTransform(2, 0, 0, 2, 0, 0);\n  ctx.imageSmoothingEnabled = false;\n\n  var data = (new XMLSerializer()).serializeToString(ideoSvgClone);\n  var domUrl = window.URL || window.webkitURL || window;\n\n  var img = new Image();\n  var svgBlob = new Blob([data], {type: 'image/svg+xml;charset=utf-8'});\n  var url = domUrl.createObjectURL(svgBlob);\n\n  img.onload = function() {\n    ctx.drawImage(img, 0, 0);\n    domUrl.revokeObjectURL(url);\n\n    var imgUrl = canvas\n      .toDataURL('image/png')\n      .replace('image/png', 'image/octet-stream');\n\n    triggerDownload(imgUrl);\n  };\n\n  img.src = url;\n}\n\nfunction getFont(ideo) {\n  const config = ideo.config;\n\n  let family = 'sans-serif';\n  if (config.fontFamily) {\n    family = config.fontFamily;\n  }\n  let weight = 600;\n  if (config.fontWeight) {\n    weight = config.fontWeight;\n  }\n\n  const labelSize = config.annotLabelSize ? config.annotLabelSize : 13;\n  const font = weight + ' ' + labelSize + 'px ' + family;\n\n  return font;\n}\n\n/**\n * Get width and height of given text in pixels.\n *\n * Background: https://erikonarheim.com/posts/canvas-text-metrics/\n */\nfunction getTextSize(text, ideo) {\n  var font = getFont(ideo);\n\n  // re-use canvas object for better performance\n  var canvas =\n    getTextSize.canvas ||\n    (getTextSize.canvas = document.createElement('canvas'));\n  var context = canvas.getContext('2d');\n  context.font = font;\n  var metrics = context.measureText(text);\n\n  // metrics.width is less precise than technique below\n  var right = metrics.actualBoundingBoxRight;\n  var left = metrics.actualBoundingBoxLeft;\n  var width = Math.abs(left) + Math.abs(right);\n\n  const height =\n    Math.abs(metrics.actualBoundingBoxAscent) +\n    Math.abs(metrics.actualBoundingBoxDescent);\n\n  return {width, height};\n}\n\n/** Clone a nested array */\nfunction deepCopy(array) {\n  return JSON.parse(JSON.stringify(array));\n}\n\n/** Naively pluralizes a word, if count is > 1 */\nexport function pluralize(word, count) {\n  return word + (count > 1 ? 's' : '');\n}\n\n/**\n * Convert hexadecimal color to RGB color\n * Source: https://stackoverflow.com/a/5624139/10564415\n */\nexport function hexToRgb(hex) {\n  // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n  var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  hex = hex.replace(shorthandRegex, function(m, r, g, b) {\n    return r + r + g + g + b + b;\n  });\n\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? {\n    r: parseInt(result[1], 16),\n    g: parseInt(result[2], 16),\n    b: parseInt(result[3], 16)\n  } : null;\n}\n\n// http://stackoverflow.com/a/5624139\nfunction componentToHex(c) {\n  var hex = parseInt(c, 10).toString(16);\n  return hex.length === 1 ? '0' + hex : hex;\n}\n\nfunction rgbToHex(r, g, b) {\n  return (\n    '#' +\n    componentToHex(r) +\n    componentToHex(g) +\n    componentToHex(b)\n  );\n}\n\nfunction rgbColorToHex(color) {\n  const rgb = color.split('rgb(')[1].trim(')').split(', ');\n  const hex = rgbToHex(rgb[0], rgb[1], rgb[2]);\n  return hex;\n}\n\n/**\n * If hex color is low contrast with white, then darken it.\n *\n * @param {String} color Initial color that fills the shape, in hex\n */\nexport function ensureContrast(color, bgColor='#FFF') {\n  if (color.slice(0, 3) === 'rgb') color = rgbColorToHex(color);\n  if (color[0] !== '#') return color; // preserve non-hex color, e.g. \"purple\"\n  const rgb = hexToRgb(color);\n\n  if (bgColor === '#FFF') {\n    // If low contrast, darken\n    if (rgb.r > 150 && rgb.g > 150 && rgb.b > 150) {\n      color = `rgb(${rgb.r - 30}, ${rgb.g - 30}, ${rgb.b - 30})`;\n    }\n\n    // If lower contrast, darken more\n    if (rgb.r > 200 && rgb.g > 200 && rgb.b > 200) {\n      color = `rgb(${rgb.r - 50}, ${rgb.g - 50}, ${rgb.b - 50})`;\n    }\n  } else {\n    const bgRgb = hexToRgb(bgColor);\n    const contrast = getContrast(\n      [rgb.r, rgb.g, rgb.b],\n      [bgRgb.r, bgRgb.g, bgRgb.b]\n    );\n    if (contrast < 3) {\n      color = `rgb(230, 230, 230)`;\n    }\n  }\n\n  return color;\n}\n\n/** https://stackoverflow.com/a/9733420 */\nconst RED = 0.2126;\nconst GREEN = 0.7152;\nconst BLUE = 0.0722;\n\nconst GAMMA = 2.4;\n\n/** https://stackoverflow.com/a/9733420 */\nfunction luminance(r, g, b) {\n  var a = [r, g, b].map((v) => {\n    v /= 255;\n    return (\n      v <= 0.03928\n        ? v / 12.92\n        : Math.pow((v + 0.055) / 1.055, GAMMA)\n    );\n  });\n  return a[0] * RED + a[1] * GREEN + a[2] * BLUE;\n}\n\n/** https://stackoverflow.com/a/9733420 */\nfunction getContrast(rgb1, rgb2) {\n  var lum1 = luminance(...rgb1);\n  var lum2 = luminance(...rgb2);\n  var brightest = Math.max(lum1, lum2);\n  var darkest = Math.min(lum1, lum2);\n  return (brightest + 0.05) / (darkest + 0.05);\n}\n\n\nexport function adjustBrightness(color, brightness) {\n  if (color[0] !== '#') return color; // preserve non-hex color, e.g. \"purple\"\n  const rgb = hexToRgb(color);\n  const br = brightness;\n  const newRgb = {r: rgb.r * br, g: rgb.g * br, b: rgb.b * br};\n  const newColor = `rgb(${newRgb.r}, ${newRgb.g}, ${newRgb.b})`;\n\n  return newColor;\n}\n\nexport function getTippyConfig() {\n  return {\n    theme: 'light-border',\n    allowHTML: true,\n    popperOptions: { // Docs: https://atomiks.github.io/tippyjs/v6/all-props/#popperoptions\n      modifiers: [ // Docs: https://popper.js.org/docs/v2/modifiers\n        {\n          name: 'flip'\n        }\n      ]\n    },\n    onShow: function() {\n      // Ensure only 1 tippy tooltip is displayed at a time\n      document.querySelectorAll('[data-tippy-root]')\n        .forEach(tippyNode => tippyNode.remove());\n    }\n  };\n}\n\nexport {\n  assemblyIsAccession, hasNonGenBankAssembly, hasGenBankAssembly, getDataDir,\n  getDir, round, formatSiPrefix, onDidRotate, getSvg, d3, getEarlyTaxid,\n  getTaxid, getCommonName, getScientificName, slug, isRoman, parseRoman,\n  downloadPng, fetchWithRetry, getTextSize, getFont, deepCopy,\n  fetchWithAuth as fetch\n};\n","import array from \"./array.js\";\nimport {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([document.querySelectorAll(selector)], [document.documentElement])\n      : new Selection([selector == null ? [] : array(selector)], root);\n}\n","export default function max(values, valueof) {\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  }\n  return max;\n}\n","var staticColors, staticCss, staticGradients;\n\n// Gradient colors for each class, for polished rendering\nstaticColors = [\n  ['gneg', '#FFF', '#FFF', '#DDD'],\n  ['gpos25', '#C8C8C8', '#DDD', '#BBB'],\n  ['gpos33', '#BBB', '#BBB', '#AAA'],\n  ['gpos50', '#999', '#AAA', '#888'],\n  ['gpos66', '#888', '#888', '#666'],\n  ['gpos75', '#777', '#777', '#444'],\n  ['gpos100', '#444', '#666', '#000'],\n  ['acen', '#FEE', '#FEE', '#FDD'],\n  ['noBands', '#BBB', '#BBB', '#AAA']\n];\n\nstaticCss =\n  '#_ideogram {padding-left: 5px;} ' +\n  '#_ideogram .labeled {padding-left: 15px;} ' +\n  '#_ideogram.labeledLeft {padding-left: 15px; padding-top: 15px;} ' +\n  // Tahoma has great readability and space utilization at small sizes\n  // More: http://ux.stackexchange.com/a/3334\n  '#_ideogram text {font: 9px Tahoma; fill: #000;} ' +\n  '#_ideogram .italic {font-style: italic;} ' +\n  '#_ideogram .chromosome {cursor: pointer; fill: #AAA;}' +\n  '#_ideogram.no-rotate .chromosome {cursor: default;} ' +\n  '#_ideogram .chrLabel, #_ideogram .annot {cursor: pointer;}' +\n  '#_ideogram .chrSetLabel {font-weight: bolder;}' +\n  '#_ideogram .ghost {opacity: 0.2;}' +\n  '#_ideogram .hidden {display: none;}' +\n  '#_ideogram .bandLabelStalk line {stroke: #AAA; stroke-width: 1;}' +\n  '#_ideogram .syntenyBorder {stroke:#AAA;stroke-width:1;}' +\n  '#_ideogram rect.cursor {' +\n  '  fill: #F00;' +\n  '  stroke: #F00;' +\n  '  fill-opacity: .3;' +\n  '  shape-rendering: crispEdges;' +\n  '}' +\n  '#_ideogram .brush .selection {' +\n  '  fill: #F00;' +\n  '  stroke: #F00;' +\n  '  fill-opacity: .3;' +\n  '  shape-rendering: crispEdges;' +\n  '}' +\n  '#_ideogram .noBands {fill: #AAA;}' +\n  // NCBI stain density colors\n  '#_ideogram .gneg {fill: #FFF}' +\n  '#_ideogram .gpos25 {fill: #BBB}' +\n  '#_ideogram .gpos33 {fill: #AAA}' +\n  '#_ideogram .gpos50 {fill: #888}' +\n  '#_ideogram .gpos66 {fill: #666}' +\n  '#_ideogram .gpos75 {fill: #444}' +\n  '#_ideogram .gpos100 {fill: #000}' +\n  '#_ideogram .gpos {fill: #000}' +\n  '#_ideogram .acen {fill: #FDD}' +\n  '#_ideogram .stalk {fill: #CCE;}' +\n  '#_ideogram .gvar {fill: #DDF}' +\n  // Used when overlaid with annotations\n  '#_ideogram.faint .gneg {fill: #FFF}' +\n  '#_ideogram.faint .gpos25 {fill: #EEE}' +\n  '#_ideogram.faint .gpos33 {fill: #EEE}' +\n  '#_ideogram.faint .gpos50 {fill: #EEE}' +\n  '#_ideogram.faint .gpos66 {fill: #EEE}' +\n  '#_ideogram.faint .gpos75 {fill: #EEE}' +\n  '#_ideogram.faint .gpos100 {fill: #DDD}' +\n  '#_ideogram.faint .gpos {fill: #DDD}' +\n  '#_ideogram.faint .acen {fill: #FEE}' +\n  '#_ideogram.faint .stalk {fill: #EEF;}' +\n  '#_ideogram.faint .gvar {fill: #EEF}' +\n  // For sheen, i.e. the soft shine in chromosomes\n  '#_ideogram .gneg {fill: url(\"#gneg\")} ' +\n  '#_ideogram .gpos25 {fill: url(\"#gpos25\")} ' +\n  '#_ideogram .gpos33 {fill: url(\"#gpos33\")} ' +\n  '#_ideogram .gpos50 {fill: url(\"#gpos50\")} ' +\n  '#_ideogram .gpos66 {fill: url(\"#gpos66\")} ' +\n  '#_ideogram .gpos75 {fill: url(\"#gpos75\")} ' +\n  '#_ideogram .gpos100 {fill: url(\"#gpos100\")} ' +\n  '#_ideogram .gpos {fill: url(\"#gpos100\")} ' +\n  '#_ideogram .acen {fill: url(\"#acen\")} ' +\n  '#_ideogram .stalk {fill: url(\"#stalk\")} ' +\n  '#_ideogram .gvar {fill: url(\"#gvar\")} ' +\n  '#_ideogram .noBands {fill: url(\"#noBands\")} ' +\n  '#_ideogram .chromosome {fill: url(\"#noBands\")} ';\n\nstaticGradients =\n  '<pattern id=\"stalk\" width=\"2\" height=\"1\" patternUnits=\"userSpaceOnUse\" ' +\n  'patternTransform=\"rotate(30 0 0)\">' +\n  '<rect x=\"0\" y=\"0\" width=\"10\" height=\"2\" fill=\"#CCE\" /> ' +\n  '<line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"100%\" style=\"stroke:#88B; ' +\n  'stroke-width:0.7;\" />' +\n  '</pattern>' +\n  '<pattern id=\"gvar\" width=\"2\" height=\"1\" patternUnits=\"userSpaceOnUse\" ' +\n  'patternTransform=\"rotate(-30 0 0)\">' +\n  '<rect x=\"0\" y=\"0\" width=\"10\" height=\"2\" fill=\"#DDF\" /> ' +\n  '<line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"100%\" style=\"stroke:#99C; ' +\n  'stroke-width:0.7;\" />' +\n  '</pattern>';\n\nexport {staticColors, staticCss, staticGradients};\n","import {organismMetadata} from './organism-metadata';\nimport {staticCss} from './../bands/styles';\n\nfunction configurePloidy(ideo) {\n  if (!ideo.config.ploidy) ideo.config.ploidy = 1;\n\n  if (ideo.config.ploidy > 1) {\n    ideo.sexChromosomes = {};\n    if (!ideo.config.sex) {\n      // Default to 'male' per human, mouse reference genomes.\n      // TODO: The default sex value should probably be the heterogametic sex,\n      // i.e. whichever sex has allosomes that differ in morphology.\n      // In mammals and most insects that is the male.\n      // However, in birds and reptiles, that is female.\n      ideo.config.sex = 'male';\n    }\n    if (ideo.config.ploidy === 2 && !ideo.config.ancestors) {\n      ideo.config.ancestors = {M: '#ffb6c1', P: '#add8e6'};\n      ideo.config.ploidyDesc = 'MP';\n    }\n  }\n}\n\nfunction configureHeight(ideo) {\n  var container, rect, chrHeight;\n\n  if (!ideo.config.chrHeight) {\n    container = ideo.config.container;\n    rect = document.querySelector(container).getBoundingClientRect();\n\n    if (ideo.config.orientation === 'vertical') {\n      chrHeight = rect.height;\n    } else {\n      chrHeight = rect.width;\n    }\n\n    if (container === 'body' || chrHeight === 0) chrHeight = 400;\n    ideo.config.chrHeight = chrHeight;\n  }\n}\n\nfunction configureWidth(ideo) {\n  var chrWidth, chrHeight;\n\n  if (!ideo.config.chrWidth) {\n    chrWidth = 10;\n    chrHeight = ideo.config.chrHeight;\n\n    if (chrHeight < 900 && chrHeight > 500) {\n      chrWidth = Math.round(chrHeight / 40);\n    } else if (chrHeight >= 900) {\n      chrWidth = Math.round(chrHeight / 45);\n    }\n    ideo.config.chrWidth = chrWidth;\n  }\n}\n\nfunction configureMargin(ideo) {\n  if (ideo.config.geometry && ideo.config.geometry === 'collinear') {\n    if ('chrMargin' in ideo.config === false) {\n      ideo.config.chrMargin = 0;\n    }\n    return;\n  }\n  if (!ideo.config.chrMargin) {\n    if (ideo.config.ploidy === 1) {\n      ideo.config.chrMargin = 10;\n    } else {\n      // Defaults polyploid chromosomes to relatively small interchromatid gap\n      ideo.config.chrMargin = Math.round(ideo.config.chrWidth / 4);\n    }\n  }\n  if (ideo.config.showBandLabels) ideo.config.chrMargin += 20;\n}\n\nfunction configureBump(ideo) {\n  ideo.bump = Math.round(ideo.config.chrHeight / 125);\n  ideo.adjustedBump = false;\n  if (ideo.config.chrHeight < 200) {\n    ideo.adjustedBump = true;\n    ideo.bump = 4;\n  }\n}\n\nfunction configureSingleChromosome(config, ideo) {\n  if (config.chromosome) {\n    ideo.config.chromosomes = [config.chromosome];\n    if ('showBandLabels' in config === false) {\n      ideo.config.showBandLabels = true;\n    }\n    if ('rotatable' in config === false) ideo.config.rotatable = false;\n  }\n}\n\nfunction configureOrganisms(config, ideo) {\n  ideo.organisms = Object.assign({}, organismMetadata);\n  if (config.taxid && config.organismMetadata) ideo.organisms[config.taxid] = config.organismMetadata\n  ideo.organismsWithBands = Object.assign({}, ideo.organisms);\n}\n\nfunction configureCallbacks(config, ideo) {\n  if (config.onLoad) ideo.onLoadCallback = config.onLoad;\n  if (config.onLoadAnnots) ideo.onLoadAnnotsCallback = config.onLoadAnnots;\n  if (config.onBeforeDrawAnnots) {\n    ideo.onBeforeDrawAnnotsCallback = config.onBeforeDrawAnnots;\n  }\n  if (config.onDrawAnnots) ideo.onDrawAnnotsCallback = config.onDrawAnnots;\n  if (config.onBrushMove) ideo.onBrushMoveCallback = config.onBrushMove;\n  if (config.onBrushEnd) ideo.onBrushEndCallback = config.onBrushEnd;\n  if (config.onCursorMove) ideo.onCursorMoveCallback = config.onCursorMove;\n  if (config.onDidRotate) ideo.onDidRotateCallback = config.onDidRotate;\n  if (config.onWillShowAnnotTooltip) {\n    ideo.onWillShowAnnotTooltipCallback = config.onWillShowAnnotTooltip;\n  }\n  if (config.onDidShowAnnotTooltip) {\n    ideo.onDidShowAnnotTooltipCallback = config.onDidShowAnnotTooltip;\n  }\n  if (config.onClickAnnot) {\n    ideo.onClickAnnotCallback = config.onClickAnnot;\n  }\n}\n\nfunction configureMiscellaneous(ideo) {\n  ideo.chromosomesArray = [];\n  ideo.coordinateSystem = 'iscn';\n  ideo.maxLength = {bp: 0, iscn: 0};\n  ideo.chromosomes = {};\n  ideo.numChromosomes = 0;\n  if (!ideo.config.debug) ideo.config.debug = false;\n  if (!ideo.config.dataDir) ideo.config.dataDir = ideo.getDataDir();\n  if (!ideo.config.container) ideo.config.container = 'body';\n  ideo.selector = ideo.config.container + ' #_ideogram';\n  if (!ideo.config.resolution) ideo.config.resolution = '';\n  if (!ideo.config.orientation) ideo.config.orientation = 'vertical';\n  if (!ideo.config.brush) ideo.config.brush = null;\n  if (!ideo.config.rows) ideo.config.rows = 1;\n  if ('showChromosomeLabels' in ideo.config === false) {\n    ideo.config.showChromosomeLabels = true;\n  }\n  if (!ideo.config.showNonNuclearChromosomes) {\n    ideo.config.showNonNuclearChromosomes = false;\n  }\n  if (!ideo.config.chromosomeScale) {\n    ideo.config.chromosomeScale = 'absolute';\n  }\n  if (!ideo.config.showTools) ideo.config.showTools = false;\n}\n\nfunction configureBands(ideo) {\n  if (!ideo.config.showBandLabels) ideo.config.showBandLabels = false;\n\n  if ('showFullyBanded' in ideo.config === false) {\n    ideo.config.showFullyBanded = true;\n  }\n\n  ideo.bandsToShow = [];\n  ideo.bandData = {};\n}\n\nlet configuredCss = staticCss;\nfunction configureTextStyle(ideo) {\n  const config = ideo.config;\n  if (!config.chrLabelSize) ideo.config.chrLabelSize = 9;\n  if (!config.chrLabelColor) ideo.config.chrLabelColor = '#000';\n  if (!config.fontFamily) ideo.config.fontFamily = '';\n\n  const size = `font-size: ${config.chrLabelSize}px`;\n  const color = `fill: ${config.chrLabelColor}`;\n  const fontFamily = `font-family: ${config.fontFamily}`;\n  configuredCss += `#_ideogram text {${fontFamily}; ${size}; ${color};}`;\n  configuredCss += `#_ideogramLabel text {${fontFamily};}`;\n}\n\n/**\n * High-level helper method for Ideogram constructor.\n *\n * @param config Configuration object.  Enables setting Ideogram properties.\n *\n * Docs: https://github.com/eweitz/ideogram/blob/master/api.md\n */\nfunction configure(config) {\n  // Clone the config object, to allow multiple instantiations\n  // without picking up prior ideogram's settings\n  this.config = JSON.parse(JSON.stringify(config));\n\n  configureMiscellaneous(this);\n  configurePloidy(this);\n  configureBands(this);\n  configureHeight(this);\n  configureWidth(this);\n  configureMargin(this);\n  configureCallbacks(config, this);\n  configureOrganisms(config, this);\n  configureBump(this);\n  configureSingleChromosome(config, this);\n  configureTextStyle(this);\n  this.initAnnotSettings();\n  if (!this.config.geometry || this.config.geometry === 'parallel') {\n    this.config.chrMargin += this.config.chrWidth;\n    if (this.config.annotationsLayout === 'heatmap') {\n      this.config.chrMargin += this.config.annotTracksHeight;\n    } else {\n      this.config.chrMargin += this.config.annotTracksHeight * 2;\n    }\n  }\n  this.init();\n}\n\nexport {configure, configuredCss};\n","/**\n * @fileoverview Functions for collinear chromosomes.\n * Collinear chromosomes form a line together, unlike the default parallel\n * geometry.\n */\n\nimport {d3} from './lib';\n\nfunction labelGenomes(ideo) {\n\n  ideo.config.taxids.forEach((taxid, i) => {\n    var org = ideo.organisms[taxid];\n    // var commonName = slug(org.commonName);\n    var scientificName = org.scientificName;\n    d3.select(ideo.selector)\n      .append('text')\n      .attr('class', 'genomeLabel italic')\n      .attr('x', 55 + 200 * i)\n      .attr('y', 10)\n      .text(scientificName)\n      .attr('text-anchor', 'middle');\n  });\n}\n\n/**\n* Rearrange chromosomes from parallel vertical to collinear vertical\n*\n* Parallel vertical (as in https://eweitz.github.io/ideogram/human)\n* | | |\n*\n* Collinear vertical (as in https://eweitz.github.io/ideogram/orthologs?loci=2:150000000,5:20000000;3:100000000,10:80000000&org=homo-sapiens&org2=mus-musculus)\n* |\n* |\n* |\n*/\nfunction rearrangeChromosomes(chrSets, yOffsets, x, ideo) {\n  var i, chrSet, y, chrLabelX, adjustedX, chr, taxid, orgIndex,\n    config = ideo.config,\n    chrLabelSize = config.chrLabelSize;\n\n  for (i = 0; i < chrSets.length; i++) {\n    chrSet = chrSets[i];\n    y = yOffsets[i] + 23 - chrLabelSize;\n\n    chr = ideo.chromosomesArray[i];\n    taxid = chr.id.split('-')[1];\n    orgIndex = ideo.config.taxids.indexOf(taxid);\n    adjustedX = x - orgIndex * 200 - 30 - 5;\n    if (orgIndex === 0) {\n      chrLabelX = -34;\n      adjustedX += ideo.config.chrWidth * 2 - 16;\n    } else {\n      chrLabelX = ideo.config.chrWidth * 2 - 24;\n    }\n\n    if (config.showChromosomeLabels) {\n      const labelSpan = chrSet.querySelector('.chrLabel > tspan');\n      labelSpan.setAttribute('x', chrLabelX);\n      labelSpan.setAttribute('dy', chrLabelSize - 8);\n      chrSet.querySelector('.chrLabel').setAttribute('text-anchor', 'start');\n    }\n    chrSet.setAttribute(\n      'transform', 'rotate(90) translate(' + y + ',' + adjustedX + ')'\n    );\n    chrSet.querySelector('.chromosome').setAttribute(\n      'transform', 'translate(-13, 10)'\n    );\n  }\n\n  labelGenomes(ideo);\n}\n\n/**\n* Get pixel coordinates to use for rearrangement\n*/\nfunction getYOffsets(chrSets, ideo) {\n  var yOffsets, i, index, chr, prevChr, y, prevWidth, prevY, yBump, taxid,\n    seenTaxids = {};\n\n  yOffsets = [];\n  for (i = 0; i < chrSets.length; i++) {\n    chr = ideo.chromosomesArray[i];\n    taxid = chr.id.split('-')[1];\n    index = (i === 0) ? i : i - 1;\n    prevChr = ideo.chromosomesArray[index];\n    if (i === 0 || taxid in seenTaxids === false) {\n      y = 20;\n      seenTaxids[taxid] = 1;\n    } else {\n      prevWidth = prevChr.width;\n      prevY = yOffsets[index];\n      yBump = (ideo.config.showChromosomeLabels ? 0 : 2);\n      y = prevY + prevWidth + yBump + ideo.config.chrMargin;\n    }\n    yOffsets.push(y);\n  }\n\n  return yOffsets;\n}\n\nfunction collinearizeVerticalChromosomes(ideo) {\n  var chrSets, yOffsets, x, height, width,\n    config = ideo.config;\n\n  ideo.config.annotLabelHeight = 12;\n  // var annotLabelHeight = ideo.config.annotLabelHeight;\n\n  if ('demarcateCollinearChromosomes' in ideo.config === false) {\n    ideo.config.demarcateCollinearChromosomes = true;\n  }\n\n  chrSets = document.querySelectorAll('.chromosome-set');\n\n  x = -40;\n\n  yOffsets = getYOffsets(chrSets, ideo);\n  rearrangeChromosomes(chrSets, yOffsets, x, ideo);\n\n  width = Math.round(yOffsets.slice(-1)[0] + 70);\n\n  if (config.multiorganism) {\n    height *= 8;\n    var maxHeight = 0;\n    yOffsets.forEach(d => {\n      if (d > maxHeight) maxHeight = d;\n    });\n    height = maxHeight + 30;\n  } else {\n    height = xOffsets.slice(-1)[0] + 30;\n  }\n\n  d3.select(ideo.selector)\n    .attr('height', height)\n    .attr('width', width);\n\n  d3.select('#_ideogramTrackLabelContainer').remove();\n  d3.select('#_ideogramInnerWrap')\n    .insert('div', ':first-child')\n    .attr('id', '_ideogramTrackLabelContainer')\n    .style('position', 'absolute');\n}\n\nexport default collinearizeVerticalChromosomes;\n","/**\n * @fileoverview Functions for collinear chromosomes.\n * Collinear chromosomes form a line together, unlike the default parallel\n * geometry.\n */\n\nimport {d3} from './lib';\nimport collinearizeVerticalChromosomes from './collinear-vertical';\n\nfunction labelGenomes(ideo) {\n\n  ideo.config.taxids.forEach((taxid, i) => {\n    var org = ideo.organisms[taxid];\n    var config = ideo.config;\n    // var commonName = slug(org.commonName);\n    var scientificName = org.scientificName;\n    d3.select(ideo.selector)\n      .append('text')\n      .attr('class', 'genomeLabel italic')\n      .attr('x', 5)\n      .attr('y', config.chrLabelSize + (200 + (3 * config.chrWidth)) * i)\n      .text(scientificName);\n  });\n}\n\n/**\n* Rearrange chromosomes from parallel horizontal to collinear horizontal\n*\n* Parallel horizontal (as in https://eweitz.github.io/ideogram/mouse)\n*     ---\n*     ---\n*     ---\n*\n* Collinear horizontal (as in https://eweitz.github.io/ideogram/geometry-collinear):\n*     --- --- ---\n*/\nfunction rearrangeChromosomes(chrSets, xOffsets, y, ideo) {\n  var i, chr, chrSet, taxid, x, adjustedY, orgIndex, chrLabelY,\n    config = ideo.config,\n    chrWidth = config.chrWidth,\n    chrLabelSize = config.chrLabelSize;\n\n  for (i = 0; i < chrSets.length; i++) {\n    chrSet = chrSets[i];\n    x = xOffsets[i];\n\n    chr = ideo.chromosomesArray[i];\n    taxid = chr.id.split('-')[1];\n    orgIndex = config.taxids.indexOf(taxid);\n    adjustedY = y + orgIndex * 200;\n    if (orgIndex === 0 && ideo.config.multiorganism) {\n      chrLabelY = chrLabelSize - 4;\n      adjustedY += chrWidth * 2 + chrLabelSize;\n    } else {\n      chrLabelY = chrWidth * 2 + chrLabelSize + 2;\n    }\n\n    if (ideo.config.showChromosomeLabels) {\n      chrSet.querySelector('.chrLabel').setAttribute('y', chrLabelY);\n      chrSet.querySelector('.chrLabel').setAttribute('text-anchor', 'middle');\n    }\n    chrSet.setAttribute('transform', 'translate(' + x + ',' + adjustedY + ')');\n    chrSet.querySelector('.chromosome').setAttribute(\n      'transform', 'translate(-13, 10)'\n    );\n  }\n\n  if (config.multiorganism) {\n    labelGenomes(ideo);\n  }\n}\n\n/**\n* Get pixel coordinates to use for rearrangement\n*/\nfunction getXOffsets(chrSets, ideo) {\n  var xOffsets, i, index, chr, prevChr, x, prevWidth, prevX, xBump, taxid,\n    seenTaxids = {};\n\n  xOffsets = [];\n  for (i = 0; i < chrSets.length; i++) {\n    chr = ideo.chromosomesArray[i];\n    taxid = chr.id.split('-')[1];\n    index = (i === 0) ? i : i - 1;\n    prevChr = ideo.chromosomesArray[index];\n    if (i === 0 || taxid in seenTaxids === false) {\n      x = 20;\n      seenTaxids[taxid] = 1;\n    } else {\n      prevWidth = prevChr.width;\n      prevX = xOffsets[index];\n      xBump = (ideo.config.showChromosomeLabels ? 0 : 2);\n      x = prevX + prevWidth + xBump + ideo.config.chrMargin;\n    }\n    xOffsets.push(x);\n  }\n\n  return xOffsets;\n}\n\n// /**\n//  * Track number of chromosomes in preceding organisms.\n//  * Adds an instance variable to the ideogram object to offset\n//  * chromosome indices.  Needed for multiorganism collinear ideograms.\n//  */\n// function setTaxidChrOffsets(ideo) {\n//   var taxidChrOffsets, taxidChrOffset;\n\n//   taxidChrOffsets = {};\n\n//   taxidChrOffset = 0;\n//   ideo.config.organism.forEach((org) => {\n//     var taxid, numChrs;\n//     taxid = ideo.getTaxid(org);\n//     taxidChrOffsets[taxid] = taxidChrOffset;\n//     numChrs = Object.keys(ideo.chromosomes[taxid]).length;\n//     taxidChrOffset += numChrs;\n//   });\n\n//   ideo.taxidChrOffsets = taxidChrOffsets;\n// }\n\n// /**\n//  * Change chromosome indices for multiorganism collinear ideograms\n//  * This is needed to account for x-offsets.\n//  */\n// function adjustChrIndex(ideo) {\n//   setTaxidChrOffsets(ideo);\n\n//   ideo.chromosomesArray.map((chr) => {\n//     var taxid = chr.id.split('-')[1];\n//     var taxidChrOffset = ideo.taxidChrOffsets[taxid];\n//     chr.chrIndex -= taxidChrOffset;\n//     ideo.chromosomes[taxid][chr.name].chrIndex = chr.chrIndex;\n//   });\n// }\n\nfunction collinearizeChromosomes(ideo) {\n  var chrSets, xOffsets, y, height, width,\n    config = ideo.config,\n    annotHeight = config.annotationHeight || 0;\n\n  if (config.orientation === 'vertical') {\n    collinearizeVerticalChromosomes(ideo);\n    return;\n  }\n\n  // if (config.multiorganism) adjustChrIndex(ideo);\n\n  ideo.config.annotLabelHeight = 12;\n  var annotLabelHeight = ideo.config.annotLabelHeight;\n\n  if ('demarcateCollinearChromosomes' in ideo.config === false) {\n    ideo.config.demarcateCollinearChromosomes = true;\n  }\n\n  chrSets = document.querySelectorAll('.chromosome-set');\n\n  y = (\n    (config.numAnnotTracks * (annotHeight + annotLabelHeight + 4)) -\n    config.chrWidth + 1\n  );\n\n  xOffsets = getXOffsets(chrSets, ideo);\n  rearrangeChromosomes(chrSets, xOffsets, y, ideo);\n\n  height = y + config.chrWidth * 2 + 20;\n\n  if (config.multiorganism) {\n    height *= 8;\n    var maxWidth = 0;\n    xOffsets.forEach(d => {\n      if (d > maxWidth) maxWidth = d;\n    });\n    width = maxWidth + 20;\n  } else {\n    width = xOffsets.slice(-1)[0] + 20;\n  }\n\n  d3.select(ideo.selector)\n    .attr('width', width)\n    .attr('height', height);\n\n  d3.select('#_ideogramTrackLabelContainer').remove();\n  d3.select('#_ideogramInnerWrap')\n    .insert('div', ':first-child')\n    .attr('id', '_ideogramTrackLabelContainer')\n    .style('position', 'absolute');\n}\n\nexport default collinearizeChromosomes;\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v.BYTES_PER_ELEMENT == 2 ? u16 : v.BYTES_PER_ELEMENT == 4 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && st.f && !st.l))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[pos >> 3] = lst;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if (d[1] & 32)\n        err(6, 'invalid zlib data: preset dictionaries not supported');\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                err(6, 'invalid gzip data');\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            err(8);\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this_1.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this_1.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this_1.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this_1.ondata(err, dat, final);\n                    _this_1.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_3 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295;\n        if (z) {\n            e = b4(data, e - 12);\n            if (b4(data, e) != 0x6064B50) {\n                cbd(err(13, 0, 1), null);\n                return tAll;\n            }\n            c = lft = b4(data, e + 32);\n            o = b4(data, e + 48);\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    if (sc < 320000) {\n                        try {\n                            cbl(null, inflateSync(infl, new u8(su)));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            err(13);\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","/*\n  Copyright 2018 Google LLC\n\n  Use of this source code is governed by an MIT-style\n  license that can be found in the LICENSE file or at\n  https://opensource.org/licenses/MIT.\n*/\nimport { messageGenerator } from '../models/messages/messageGenerator.js';\nimport '../_version.js';\n/**\n * Workbox errors should be thrown with this class.\n * This allows use to ensure the type easily in tests,\n * helps developers identify errors from workbox\n * easily and allows use to optimise error\n * messages correctly.\n *\n * @private\n */\nclass WorkboxError extends Error {\n    /**\n     *\n     * @param {string} errorCode The error code that\n     * identifies this particular error.\n     * @param {Object=} details Any relevant arguments\n     * that will help developers identify issues should\n     * be added as a key on the context object.\n     */\n    constructor(errorCode, details) {\n        const message = messageGenerator(errorCode, details);\n        super(message);\n        this.name = errorCode;\n        this.details = details;\n    }\n}\nexport { WorkboxError };\n","/*\n  Copyright 2018 Google LLC\n\n  Use of this source code is governed by an MIT-style\n  license that can be found in the LICENSE file or at\n  https://opensource.org/licenses/MIT.\n*/\nimport { messages } from './messages.js';\nimport '../../_version.js';\nconst fallback = (code, ...args) => {\n    let msg = code;\n    if (args.length > 0) {\n        msg += ` :: ${JSON.stringify(args)}`;\n    }\n    return msg;\n};\nconst generatorFunction = (code, details = {}) => {\n    const message = messages[code];\n    if (!message) {\n        throw new Error(`Unable to find message for code '${code}'.`);\n    }\n    return message(details);\n};\nexport const messageGenerator = process.env.NODE_ENV === 'production' ? fallback : generatorFunction;\n","/*\n  Copyright 2018 Google LLC\n\n  Use of this source code is governed by an MIT-style\n  license that can be found in the LICENSE file or at\n  https://opensource.org/licenses/MIT.\n*/\nimport { WorkboxError } from 'workbox-core/_private/WorkboxError.js';\nimport { assert } from 'workbox-core/_private/assert.js';\nimport { logger } from 'workbox-core/_private/logger.js';\nimport { calculateEffectiveBoundaries } from './utils/calculateEffectiveBoundaries.js';\nimport { parseRangeHeader } from './utils/parseRangeHeader.js';\nimport './_version.js';\n/**\n * Given a `Request` and `Response` objects as input, this will return a\n * promise for a new `Response`.\n *\n * If the original `Response` already contains partial content (i.e. it has\n * a status of 206), then this assumes it already fulfills the `Range:`\n * requirements, and will return it as-is.\n *\n * @param {Request} request A request, which should contain a Range:\n * header.\n * @param {Response} originalResponse A response.\n * @return {Promise<Response>} Either a `206 Partial Content` response, with\n * the response body set to the slice of content specified by the request's\n * `Range:` header, or a `416 Range Not Satisfiable` response if the\n * conditions of the `Range:` header can't be met.\n *\n * @memberof workbox-range-requests\n */\nasync function createPartialResponse(request, originalResponse) {\n    try {\n        if (process.env.NODE_ENV !== 'production') {\n            assert.isInstance(request, Request, {\n                moduleName: 'workbox-range-requests',\n                funcName: 'createPartialResponse',\n                paramName: 'request',\n            });\n            assert.isInstance(originalResponse, Response, {\n                moduleName: 'workbox-range-requests',\n                funcName: 'createPartialResponse',\n                paramName: 'originalResponse',\n            });\n        }\n        if (originalResponse.status === 206) {\n            // If we already have a 206, then just pass it through as-is;\n            // see https://github.com/GoogleChrome/workbox/issues/1720\n            return originalResponse;\n        }\n        const rangeHeader = request.headers.get('range');\n        if (!rangeHeader) {\n            throw new WorkboxError('no-range-header');\n        }\n        const boundaries = parseRangeHeader(rangeHeader);\n        const originalBlob = await originalResponse.blob();\n        const effectiveBoundaries = calculateEffectiveBoundaries(originalBlob, boundaries.start, boundaries.end);\n        const slicedBlob = originalBlob.slice(effectiveBoundaries.start, effectiveBoundaries.end);\n        const slicedBlobSize = slicedBlob.size;\n        const slicedResponse = new Response(slicedBlob, {\n            // Status code 206 is for a Partial Content response.\n            // See https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/206\n            status: 206,\n            statusText: 'Partial Content',\n            headers: originalResponse.headers,\n        });\n        slicedResponse.headers.set('Content-Length', String(slicedBlobSize));\n        slicedResponse.headers.set('Content-Range', `bytes ${effectiveBoundaries.start}-${effectiveBoundaries.end - 1}/` +\n            `${originalBlob.size}`);\n        return slicedResponse;\n    }\n    catch (error) {\n        if (process.env.NODE_ENV !== 'production') {\n            logger.warn(`Unable to construct a partial response; returning a ` +\n                `416 Range Not Satisfiable response instead.`);\n            logger.groupCollapsed(`View details here.`);\n            logger.log(error);\n            logger.log(request);\n            logger.log(originalResponse);\n            logger.groupEnd();\n        }\n        return new Response('', {\n            status: 416,\n            statusText: 'Range Not Satisfiable',\n        });\n    }\n}\nexport { createPartialResponse };\n","/*\n  Copyright 2018 Google LLC\n\n  Use of this source code is governed by an MIT-style\n  license that can be found in the LICENSE file or at\n  https://opensource.org/licenses/MIT.\n*/\nimport { WorkboxError } from 'workbox-core/_private/WorkboxError.js';\nimport { assert } from 'workbox-core/_private/assert.js';\nimport '../_version.js';\n/**\n * @param {string} rangeHeader A Range: header value.\n * @return {Object} An object with `start` and `end` properties, reflecting\n * the parsed value of the Range: header. If either the `start` or `end` are\n * omitted, then `null` will be returned.\n *\n * @private\n */\nfunction parseRangeHeader(rangeHeader) {\n    if (process.env.NODE_ENV !== 'production') {\n        assert.isType(rangeHeader, 'string', {\n            moduleName: 'workbox-range-requests',\n            funcName: 'parseRangeHeader',\n            paramName: 'rangeHeader',\n        });\n    }\n    const normalizedRangeHeader = rangeHeader.trim().toLowerCase();\n    if (!normalizedRangeHeader.startsWith('bytes=')) {\n        throw new WorkboxError('unit-must-be-bytes', { normalizedRangeHeader });\n    }\n    // Specifying multiple ranges separate by commas is valid syntax, but this\n    // library only attempts to handle a single, contiguous sequence of bytes.\n    // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Range#Syntax\n    if (normalizedRangeHeader.includes(',')) {\n        throw new WorkboxError('single-range-only', { normalizedRangeHeader });\n    }\n    const rangeParts = /(\\d*)-(\\d*)/.exec(normalizedRangeHeader);\n    // We need either at least one of the start or end values.\n    if (!rangeParts || !(rangeParts[1] || rangeParts[2])) {\n        throw new WorkboxError('invalid-range-values', { normalizedRangeHeader });\n    }\n    return {\n        start: rangeParts[1] === '' ? undefined : Number(rangeParts[1]),\n        end: rangeParts[2] === '' ? undefined : Number(rangeParts[2]),\n    };\n}\nexport { parseRangeHeader };\n","/*\n  Copyright 2018 Google LLC\n\n  Use of this source code is governed by an MIT-style\n  license that can be found in the LICENSE file or at\n  https://opensource.org/licenses/MIT.\n*/\nimport { WorkboxError } from 'workbox-core/_private/WorkboxError.js';\nimport { assert } from 'workbox-core/_private/assert.js';\nimport '../_version.js';\n/**\n * @param {Blob} blob A source blob.\n * @param {number} [start] The offset to use as the start of the\n * slice.\n * @param {number} [end] The offset to use as the end of the slice.\n * @return {Object} An object with `start` and `end` properties, reflecting\n * the effective boundaries to use given the size of the blob.\n *\n * @private\n */\nfunction calculateEffectiveBoundaries(blob, start, end) {\n    if (process.env.NODE_ENV !== 'production') {\n        assert.isInstance(blob, Blob, {\n            moduleName: 'workbox-range-requests',\n            funcName: 'calculateEffectiveBoundaries',\n            paramName: 'blob',\n        });\n    }\n    const blobSize = blob.size;\n    if ((end && end > blobSize) || (start && start < 0)) {\n        throw new WorkboxError('range-not-satisfiable', {\n            size: blobSize,\n            end,\n            start,\n        });\n    }\n    let effectiveStart;\n    let effectiveEnd;\n    if (start !== undefined && end !== undefined) {\n        effectiveStart = start;\n        // Range values are inclusive, so add 1 to the value.\n        effectiveEnd = end + 1;\n    }\n    else if (start !== undefined && end === undefined) {\n        effectiveStart = start;\n        effectiveEnd = blobSize;\n    }\n    else if (end !== undefined && start === undefined) {\n        effectiveStart = blobSize - end;\n        effectiveEnd = blobSize;\n    }\n    return {\n        start: effectiveStart,\n        end: effectiveEnd,\n    };\n}\nexport { calculateEffectiveBoundaries };\n","/** @fileoverview Functions used by multiple content-specific cache modules */\n\nimport {decompressSync, strFromU8} from 'fflate';\nimport {createPartialResponse} from 'workbox-range-requests';\n\nimport version from '../../version';\nimport {getEarlyTaxid, slug, getDir} from '../../lib';\nimport {organismMetadata} from '../organism-metadata';\n\nasync function fetchByteRangesByName(url) {\n  const byteRangesByName = {};\n\n  const path = `${url.replace('.tsv.gz', '')}.tsv.li.gz`;\n\n  const response = await cacheFetch(path);\n  const text = await response.text();\n  const lines = text.split('\\n');\n  for (let i = 0; i < lines.length - 1; i++) {\n    const [gene, rawOffset] = lines[i].split('\\t');\n    if (gene[0] === '#') continue;\n    const offset = parseInt(rawOffset);\n    const offsetEnd = parseInt(lines[i + 1].split('\\t')[1]);\n    byteRangesByName[gene] = [offset, offsetEnd];\n  }\n\n  return byteRangesByName;\n}\n\n/** Reports if current organism has a gene structure cache */\nexport function supportsCache(orgName, cacheName) {\n  const metadata = parseOrgMetadata(orgName);\n  const cacheProp = 'has' + cacheName + 'Cache';\n  return metadata[cacheProp] && metadata[cacheProp] === true;\n}\n\n/** Get URL for gene structure cache file */\nexport function getCacheUrl(orgName, cacheDir, cacheType, fileType='tsv') {\n  const organism = slug(orgName);\n  if (!cacheDir) {\n    cacheDir = getDir('cache/' + cacheType + '/');\n  } else {\n    cacheDir += cacheType + '/';\n  }\n\n  const cacheUrl =\n    cacheDir + organism + '-' + cacheType + '.' + fileType + '.gz';\n\n  return cacheUrl;\n}\n\n/**\n * Build full ID from prefix (e.g. ENSG or IPR) and slim ID (e.g. 223972)\n *\n * Example output ID: ENSG00000223972\n * */\nexport function getFullId(prefix, slimId, fullNumLength=11) {\n\n  // C. elegans (prefix: WBGene) has special IDs, e.g. WBGene00197333\n  if (prefix === 'WBGene') fullNumLength = 8;\n\n  // Zero-pad the slim ID, e.g. 223972 -> 00000223972\n  const zeroPaddedId = slimId.padStart(fullNumLength, '0');\n\n  return prefix + zeroPaddedId;\n}\n\n\nasync function getServiceWorkerCache() {\n  const currentIdeogram = `ideogram-${version}`;\n\n  // Delete other versions of Ideogram cache; there should be 1 per dodmain\n  const cacheNames = await caches.keys();\n  cacheNames.forEach(name => {\n    if (name.startsWith('ideogram-') && name !== currentIdeogram) {\n      caches.delete(name);\n    }\n  });\n\n  const cache = await caches.open(currentIdeogram);\n\n  return cache;\n}\n\nexport async function cacheFetch(url) {\n\n  const cache = await getServiceWorkerCache();\n  window.ideoCache = cache;\n  window.createPartialResponse = createPartialResponse;\n\n  const decompressedUrl = url.replace('.gz', '');\n  const response = await cache.match(decompressedUrl);\n  if (typeof response === 'undefined') {\n    // If cache miss, then fetch, decompress, and put response in cache\n    const rawResponse = await fetch(url);\n    const blob = await rawResponse.blob();\n    const uint8Array = new Uint8Array(await blob.arrayBuffer());\n    const data = strFromU8(decompressSync(uint8Array));\n    const contentLength = data.length;\n    const decompressedResponse = new Response(\n      new Blob([data], {type: 'text/tab-separated-values'}),\n      {headers: new Headers({'Content-Length': contentLength})}\n    );\n    await cache.put(decompressedUrl, decompressedResponse);\n    return await cache.match(decompressedUrl);\n  }\n  return await cache.match(decompressedUrl);\n}\n\nexport async function cacheRangeFetch(url, byteRange) {\n  url = url.replace('.gz', '');\n\n  // +/- 1 to trim newlines\n  const rangeStart = byteRange[0] + 1;\n  const rangeEnd = byteRange[1] - 1;\n\n  const headers = new Headers({\n    'content-type': 'multipart/byteranges',\n    'range': `bytes=${rangeStart}-${rangeEnd}`\n  });\n\n  const request = new Request(url, {headers});\n\n  const cache = await getServiceWorkerCache();\n\n  const fullResponse = await cache.match(request);\n  const partialResponse = await createPartialResponse(request, fullResponse);\n\n  const text = await partialResponse.text();\n\n  return text;\n}\n\nwindow.cacheRangeFetch = cacheRangeFetch;\n\n/** Get organism's metadata fields */\nexport function parseOrgMetadata(orgName) {\n  const taxid = getEarlyTaxid(orgName);\n  return organismMetadata[taxid] || {};\n}\n\n/** Fetch URL from service worker cache, call given parsing function */\nexport async function fetchAndParse(\n  cacheUrl, perfTimes, parseFn, orgName=null\n) {\n  const fetchStartTime = performance.now();\n  const response = await cacheFetch(cacheUrl);\n  let data;\n  if (cacheUrl.includes('.json')) {\n    data = await response.json();\n  } else {\n    data = await response.text();\n  }\n  const fetchEndTime = performance.now();\n  perfTimes.fetch = Math.round(fetchEndTime - fetchStartTime);\n\n  let parsedCache;\n  if (cacheUrl.includes('tissue')) {\n    const byteRangesByName = await fetchByteRangesByName(cacheUrl);\n    parsedCache = parseFn(data, perfTimes, byteRangesByName);\n  } else {\n    parsedCache = parseFn(data, perfTimes, orgName);\n  }\n\n  perfTimes.parseCache = Math.round(performance.now() - fetchEndTime);\n\n  return [parsedCache, perfTimes];\n}\n\n/** Print size and time of given parsed cache */\nexport function inspectWorker(cacheName, json) {\n  const size = new TextEncoder().encode(JSON.stringify(json)).length;\n  const kiloBytes = size / 1024;\n  const megaBytes = kiloBytes / 1024;\n  console.log(`Parsed ${cacheName}Cache size: ${megaBytes} MiB`);\n  console.timeEnd(`${cacheName}CacheWorker`);\n}\n","import {fetchAndParse, inspectWorker} from './cache-lib';\n\n/** Parse compressed feature subparts to more easily computable format */\nfunction deserializeSubparts(rawSubparts, subpartKeys) {\n  const subparts = [];\n  for (let i = 0; i < rawSubparts.length; i++) {\n    const rawSubpart = rawSubparts[i].split(';');\n    const subpartType = subpartKeys[parseInt(rawSubpart[0])];\n    const start = parseInt(rawSubpart[1]);\n    const length = parseInt(rawSubpart[2]);\n    const subpart = [subpartType, start, length];\n    subparts.push(subpart);\n  }\n  return subparts;\n}\n\n/** Parse metainformation header lines, i.e. those beginning  \"## \"\" */\nfunction parseMetainformationHeader(line) {\n  const splitHead = line.split(' keys: ');\n  if (splitHead.length < 2) return [null];\n  const metaHeader = splitHead[0].split('## ')[1];\n  const keys = {};\n  splitHead[1].split(', ').forEach(entry => {\n    const splitEntry = entry.split(' = ');\n    keys[splitEntry[0]] = splitEntry[1];\n  });\n  return [metaHeader, keys];\n}\n\n/** Parse a gene structure cache TSV file, return array of useful transforms */\nexport function parseGeneStructureCache(rawTsv, perfTimes) {\n  const featuresByGene = {};\n\n  let t0 = performance.now();\n  const lines = rawTsv.split(/\\r\\n|\\n/);\n  perfTimes.rawTsvSplit = Math.round(performance.now() - t0);\n\n  let biotypeKeys, subpartKeys;\n\n  t0 = performance.now();\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (line === '') continue; // Skip empty lines\n\n    // Parse header\n    if (line[0] === '#') {\n\n      // Parse metainformation headers\n      if (line[1] === '#') {\n        const [metaHeader, keys] = parseMetainformationHeader(line);\n        if (metaHeader === 'biotype') {\n          biotypeKeys = keys;\n        } else if (metaHeader === 'subpart') {\n          subpartKeys = keys;\n        }\n      }\n      continue;\n    }\n    const splitLine = line.trim().split(/\\t/);\n\n    const [\n      name, biotypeCompressed, strand\n    ] = splitLine.slice(0, 3);\n\n    const gene = name.split('-').slice(0, -1).join('-');\n\n    const rawSubparts = splitLine.slice(3);\n    const subparts = deserializeSubparts(rawSubparts, subpartKeys);\n\n    const biotype = biotypeKeys[biotypeCompressed];\n\n    // E.g. ACE2-201, protein_coding, -, <array of exon or UTR arrays>\n    const feature = {\n      name,\n      biotype,\n      strand,\n      subparts\n    };\n\n    if (gene in featuresByGene) {\n      featuresByGene[gene].push(feature);\n    } else {\n      featuresByGene[gene] = [feature];\n    }\n\n  };\n  const t1 = performance.now();\n  perfTimes.parseCacheLoop = Math.round(t1 - t0);\n\n  return featuresByGene;\n}\n\n// Uncomment when workers work outside localhost\n// addEventListener('message', async event => {\n//   console.time('geneStructureCacheWorker');\n//   const [cacheUrl, perfTimes, debug] = event.data;\n//   const result = await fetchAndParse(cacheUrl, perfTimes, parseCache);\n//   postMessage(result);\n//   if (debug) inspectWorker('geneStructure', result[0]);\n// });\n","import {fetchAndParse, inspectWorker, getFullId} from './cache-lib';\n\n/** Parse compressed protein to more easily computable format */\nfunction deserializeProtein(rawProtein, domainKeys) {\n  const domains = [];\n  for (let i = 0; i < rawProtein.length; i++) {\n    const rawDomain = rawProtein[i].split(';');\n    // const domainID = getFullId('IPR', rawDomain[0], 6);\n    const domainName = domainKeys[rawDomain[0]];\n    const start = parseInt(rawDomain[1]);\n    const length = parseInt(rawDomain[2]);\n    const domain = [domainName, start, length];\n    domains.push(domain);\n  }\n  return domains;\n}\n\n/** Parse metainformation header lines, i.e. those beginning  \"## \"\" */\nfunction parseMetainformationHeader(line) {\n  const splitHead = line.split(' keys: ');\n  if (splitHead.length < 2) return [null];\n  const metaHeader = splitHead[0].split('## ')[1];\n  const keys = {};\n  splitHead[1].split('; ').forEach(entry => {\n    const splitEntry = entry.split(' = ');\n    keys[splitEntry[0]] = splitEntry[1];\n  });\n  return [metaHeader, keys];\n}\n\n/** Parse a protein cache TSV file, return array of useful transforms */\nexport function parseProteinCache(rawTsv, perfTimes) {\n  const featuresByGene = {};\n\n  let t0 = performance.now();\n  const lines = rawTsv.split(/\\r\\n|\\n/);\n  perfTimes.rawTsvSplit = Math.round(performance.now() - t0);\n\n  let domainKeys;\n\n  t0 = performance.now();\n\n  let gene = null;\n  let refTxBaseNum;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (line === '') continue; // Skip empty lines\n\n    // Parse header\n    if (line[0] === '#') {\n\n      // Parse metainformation headers\n      if (line[1] === '#') {\n        const [metaHeader, keys] = parseMetainformationHeader(line);\n        if (metaHeader === 'domain') {\n          domainKeys = keys;\n        }\n      }\n      continue;\n    }\n    const splitLine = line.trim().split(/\\t/);\n\n    let transcriptName = splitLine[0];\n    if (isNaN(transcriptName)) {\n      const splitTxName = transcriptName.split('-');\n      const txNum = splitTxName.slice(-1)[0]; // e.g. 208 in ACE2-208\n      const highestDigit = parseInt(txNum[0]); // e.g. 2 in 208\n      const numDigits = txNum.length;\n      refTxBaseNum = highestDigit * (10 ** (numDigits - 1));\n      gene = splitTxName.slice(0, -1).join('-');\n    } else {\n      transcriptName = refTxBaseNum + parseInt(transcriptName);\n      transcriptName = gene + '-' + transcriptName;\n    }\n\n    const rawProtein = splitLine.slice(1);\n    const protein = deserializeProtein(rawProtein, domainKeys);\n\n    // E.g. ACE2-201, <array of proteins <protein name, protein ID, start, length>>\n    const feature = {\n      transcriptName,\n      protein\n    };\n\n    if (gene in featuresByGene) {\n      featuresByGene[gene].push(feature);\n    } else {\n      featuresByGene[gene] = [feature];\n    }\n\n  };\n  const t1 = performance.now();\n  perfTimes.parseCacheLoop = Math.round(t1 - t0);\n\n  return featuresByGene;\n}\n\n// Uncomment when workers work outside localhost\n// addEventListener('message', async event => {\n//   console.time('proteinCacheWorker');\n//   const [cacheUrl, perfTimes, debug] = event.data;\n//   const result = await fetchAndParse(cacheUrl, perfTimes, parseCache);\n//   postMessage(result);\n//   if (debug) inspectWorker('proteinStructure', result[0]);\n// });\n","import {\n  fetchAndParse, getFullId, inspectWorker,\n  cacheFetch, cacheRangeFetch, getCacheUrl\n} from './cache-lib';\n\n\nfunction parseTissueKeys(rawTissuesString) {\n  const tissueNames = [];\n  const tissueColors = [];\n  const tissueSamples = [];\n  rawTissuesString.split(';').forEach(entry => {\n    const splitEntry = entry.split(',');\n    tissueNames.push(splitEntry[0]);\n    tissueColors.push(splitEntry[1]);\n    tissueSamples.push(splitEntry[2]);\n  });\n  return [tissueNames, tissueColors, tissueSamples];\n}\n\n/** Transform a stringified list of integers into an actual list of integers */\nfunction processIds(ids) {\n  const processedIds = [];\n  const splitIds = ids.split(',');\n  for (let i = 0; i < splitIds.length; i++) {\n    processedIds.push(parseInt(splitIds[i], 10));\n  }\n  return processedIds;\n}\n\nasync function getTissueExpressions(gene, ideo) {\n  const cache = ideo.tissueCache;\n  const byteRange = cache.byteRangesByName[gene];\n\n  // Easier debuggability\n  if (!ideo.cacheRangeFetch) ideo.cacheRangeFetch = cacheRangeFetch;\n\n  if (!byteRange) return null;\n\n  const config = ideo.config;\n  let cacheDir = null;\n  if (config.cacheDir) cacheDir = config.cacheDir;\n  const cacheType = 'tissues';\n  const extension = 'tsv';\n\n  const orgName = 'homo-sapiens';\n  const cacheUrl = getCacheUrl(orgName, cacheDir, cacheType, extension);\n\n  const geneDataLine = await cacheRangeFetch(cacheUrl, byteRange);\n\n  const tissueExpressions = [];\n  const rawExpressions = geneDataLine.split('\\t').slice(1);\n  for (let i = 0; i < rawExpressions.length; i++) {\n    const rawValues = rawExpressions[i].split(';').map(\n      v => v === '' ? 0 : v // inflate empty string to 0-integer\n    );\n    const numValues = rawValues.length;\n    if (numValues === 15) {\n      rawValues.splice(1, 0, 0); // Insert number 0 at position 1\n    } else if (numValues === 14) {\n      // Min. and Q1 are 0\n      rawValues.splice(1, 0, 0);\n      rawValues.splice(1, 0, 0);\n    } else if (numValues === 13) {\n      // Min., Q1, and median are 0\n      rawValues.splice(1, 0, 0);\n      rawValues.splice(1, 0, 0);\n      rawValues.splice(1, 0, 0);\n    }\n    const tissueId = rawValues[0];\n    const boxMetrics = rawValues.slice(1, 6);\n    const min = parseFloat(boxMetrics[0]);\n    const q1 = parseFloat(boxMetrics[1]);\n    const median = parseFloat(boxMetrics[2]);\n    const q3 = parseFloat(boxMetrics[3]);\n    const max = parseFloat(boxMetrics[4]);\n    const quantiles = rawValues.slice(6).map(v => parseInt(v));\n    const expression = {\n      min, q1, median, q3, max,\n      quantiles\n    };\n    const tissue = cache.tissueNames[tissueId];\n    const color = cache.tissueColors[tissueId];\n    const samples = parseInt(cache.tissueSamples[tissueId]);\n    tissueExpressions.push({tissue, expression, color, samples});\n  }\n\n  return tissueExpressions;\n}\n\n/** Parse a tissue cache TSV file */\nexport function parseTissueCache(rawTsv, perfTimes, byteRangesByName) {\n  let tissueNames;\n  let tissueColors;\n  let tissueSamples;\n\n  let t0 = performance.now();\n  const lines = rawTsv.split(/\\r\\n|\\n/);\n  perfTimes.rawTsvSplit = Math.round(performance.now() - t0);\n\n  t0 = performance.now();\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (line === '') continue; // Skip empty lines\n    if (line[0] === '#') {\n      if (line.slice(0, 10) === '## tissues') {\n        const parsedTissueKeys = parseTissueKeys(line.split('tissues: ')[1]);\n        [tissueNames, tissueColors, tissueSamples] = parsedTissueKeys;\n      }\n      continue;\n    }\n\n  };\n  const t1 = performance.now();\n  perfTimes.parseCacheLoop = Math.round(t1 - t0);\n\n  return {\n    getTissueExpressions,\n    byteRangesByName,\n    tissueNames,\n    tissueColors,\n    tissueSamples\n  };\n}\n\n// Uncomment when workers work outside localhost\n// addEventListener('message', async event => {\n//   console.time('tissueCacheWorker');\n//   const [cacheUrl, perfTimes, debug] = event.data;\n//   const result = await fetchAndParse(cacheUrl, perfTimes, parseCache);\n//   postMessage(result);\n//   if (debug) inspectWorker('paralog', result[0]);\n// });\n","import {\n  supportsCache, getCacheUrl, fetchAndParse,\n  cacheFetch\n} from './cache-lib';\n\n// Uncomment when workers work outside localhost\n// const geneCacheWorker = new Worker(\n//   new URL('./gene-cache-worker.js', import.meta.url), {type: 'module'}\n// );\n// const paralogCacheWorker = new Worker(\n//   new URL('./paralog-cache-worker.js', import.meta.url), {type: 'module'}\n// );\n// const interactionCacheWorker = new Worker(\n//   new URL('./interaction-cache-worker.js', import.meta.url), {type: 'module'}\n// );\n// const geneStructureCacheWorker = new Worker(\n//   new URL('./gene-structure-cache-worker.js', import.meta.url), {type: 'module'}\n// );\n\nimport {parseGeneCache} from './gene-cache-worker';\nimport {parseParalogCache} from './paralog-cache-worker';\nimport {parseInteractionCache} from './interaction-cache-worker';\nimport {parseGeneStructureCache} from './gene-structure-cache-worker';\nimport {parseProteinCache} from './protein-cache-worker';\nimport {parseSynonymCache} from './synonym-cache-worker';\nimport {parseTissueCache} from './tissue-cache-worker';\n\n/**\n * Populates in-memory content caches from on-disk service worker (SW) caches.\n *\n * This warms the following content caches:\n * - Gene cache: gene symbol -> full name, Ensembl ID, genomic coordinates\n * - Paralog cache: gene symbol -> paralogs (evolutionarily related genes)\n * - Interaction cache: gene symbol -> adjacent genes in biochemical pathways\n *\n * And, optionally:\n * - Gene structure cache: gene symbol -> canonical transcript, exons, UTRs\n * - Protein cache: gene symbol -> protein domains & families, per transcript\n * - Synonym cache: gene symbol -> list of synonyms, a.k.a. aliases\n *\n * Used for related genes kit now, likely worth generalizing in the future.\n *\n * This approach makes navigating related genes ideogram instant and\n * possible completely offline (i.e. a progressive web component) -- but only\n * once caches are populated.\n */\nexport async function initCaches(ideo) {\n\n  const config = ideo.config;\n  if (!config.useCache) return;\n\n  const organism = config.organism;\n\n  let cacheDir = null;\n  if (config.cacheDir) cacheDir = config.cacheDir;\n\n  if (config.awaitCache) {\n    // Start all these in parallel.  Only initGeneCache blocks; it internally\n    // resolves a Promise, whereas the others return upon completing their\n    // respective initializations.\n    const cachePromise = Promise.all([\n      cacheFactory('gene', organism, ideo, cacheDir),\n      cacheFactory('paralog', organism, ideo, cacheDir),\n      cacheFactory('interaction', organism, ideo, cacheDir),\n      cacheFactory('synonym', organism, ideo, cacheDir),\n      cacheFactory('tissue', organism, ideo, cacheDir)\n    ]);\n\n    if (config.showGeneStructureInTooltip) {\n      cacheFactory('geneStructure', organism, ideo, cacheDir);\n      cacheFactory('protein', organism, ideo, cacheDir);\n    }\n\n    return cachePromise;\n\n  } else {\n    cacheFactory('gene', organism, ideo, cacheDir);\n    cacheFactory('paralog', organism, ideo, cacheDir);\n    cacheFactory('interaction', organism, ideo, cacheDir);\n    if (config.showGeneStructureInTooltip) {\n      cacheFactory('geneStructure', organism, ideo, cacheDir);\n      cacheFactory('protein', organism, ideo, cacheDir);\n      cacheFactory('synonym', organism, ideo, cacheDir);\n      cacheFactory('tissue', organism, ideo, cacheDir);\n    }\n  }\n}\n\nconst allCacheProps = {\n  gene: {\n    metadata: 'Gene', dir: 'genes',\n    fn: setGeneCache,\n    // worker: geneCacheWorker // Uncomment when workers work\n    parseFn: parseGeneCache // Remove when workers work\n  },\n  paralog: {\n    metadata: 'Paralog', dir: 'paralogs',\n    fn: setParalogCache,\n    // worker: paralogCacheWorker // Uncomment when workers work\n    parseFn: parseParalogCache // Remove when workers work\n  },\n  interaction: {\n    metadata: 'Interaction', dir: 'interactions',\n    fn: setInteractionCache, extension: 'json',\n    // worker: interactionCacheWorker, // Uncomment when workers work\n    parseFn: parseInteractionCache // Remove when workers work\n  },\n  geneStructure: {\n    metadata: 'GeneStructure', dir: 'gene-structures',\n    fn: setGeneStructureCache,\n    // worker: geneStructureCacheWorker // Uncomment when workers work\n    parseFn: parseGeneStructureCache // Remove when workers work\n  },\n  protein: {\n    metadata: 'Protein', dir: 'proteins',\n    fn: setProteinCache,\n    // worker: proteinCacheWorker // Uncomment when workers work\n    parseFn: parseProteinCache // Remove when workers work\n  },\n  synonym: {\n    metadata: 'Synonym', dir: 'synonyms',\n    fn: setSynonymCache,\n    // worker: synonymCacheWorker // Uncomment when workers work\n    parseFn: parseSynonymCache // Remove when workers work\n  },\n  tissue: {\n    metadata: 'Tissue', dir: 'tissues',\n    fn: setTissueCache,\n    // worker: tissueCacheWorker // Uncomment when workers work\n    parseFn: parseTissueCache // Remove when workers work\n  }\n};\n\nfunction setGeneCache(parsedCache, ideo) {\n  const [\n    interestingNames, nameCaseMap, namesById, fullNamesById,\n    idsByName, lociByName, lociById\n    //, sortedAnnots\n  ] = parsedCache;\n\n  ideo.geneCache = {\n    interestingNames, // Array ordered by general or scholarly interest\n    nameCaseMap, // Maps of lowercase gene names to proper gene names\n    namesById,\n    fullNamesById,\n    idsByName,\n    lociByName, // Object of gene positions, keyed by gene name\n    lociById\n    //, sortedAnnots // Ideogram annotations sorted by genomic position\n  };\n}\n\nfunction setParalogCache(parsedCache, ideo) {\n  const paralogsByName = parsedCache;\n  // Array of paralog Ensembl IDs by (uppercase) gene name\n  ideo.paralogCache = {paralogsByName};\n}\n\nfunction setInteractionCache(parsedCache, ideo) {\n  const interactionsByName = parsedCache;\n  ideo.interactionCache = interactionsByName;\n}\n\nfunction setGeneStructureCache(parsedCache, ideo) {\n  const featuresByGene = parsedCache;\n  ideo.geneStructureCache = featuresByGene;\n}\n\nfunction setProteinCache(parsedCache, ideo) {\n  ideo.proteinCache = parsedCache;\n}\n\nfunction setSynonymCache(parsedCache, ideo) {\n  ideo.synonymCache = parsedCache;\n}\n\nfunction setTissueCache(parsedCache, ideo) {\n  ideo.tissueCache = parsedCache;\n}\n\nasync function cacheFactory(cacheName, orgName, ideo, cacheDir=null) {\n\n  const cacheProps = allCacheProps[cacheName];\n  const debug = ideo.config.debug;\n\n  /**\n * Fetch cached gene data, transform it usefully, and set it as ideo prop\n */\n  const startTime = performance.now();\n  let perfTimes = {};\n\n  let parsedCache;\n\n  // Skip initialization if files needed to make cache don't exist\n  if (!supportsCache(orgName, cacheProps.metadata)) return;\n\n  const staticProp = cacheName + 'Cache';\n  // Skip initialization if cache is already populated\n  if (Ideogram[staticProp] && Ideogram[staticProp][orgName]) {\n    // Simplify chief use case, i.e. for single organism\n    ideo[staticProp] = Ideogram[staticProp][orgName];\n    return;\n  }\n\n  if (!Ideogram[staticProp]) {\n    Ideogram[staticProp] = {};\n  }\n\n  const extension = cacheProps?.extension ?? 'tsv';\n  const cacheUrl = getCacheUrl(orgName, cacheDir, cacheProps.dir, extension);\n\n  [parsedCache, perfTimes] =\n    await fetchAndParse(cacheUrl, perfTimes, cacheProps.parseFn, orgName);\n\n  // const cacheWorker = cacheProps.worker;\n  if (debug) console.time(`${cacheName}Cache total`);\n  return new Promise(resolve => {\n  //   const message = [cacheUrl, perfTimes, debug];\n  //   if (cacheName === 'interaction') message.push(orgName);\n  //   cacheWorker.postMessage(message);\n  //   cacheWorker.addEventListener('message', event => {\n  //     [parsedCache, perfTimes] = event.data;\n      cacheProps.fn(parsedCache, ideo, orgName);\n      Ideogram[staticProp][orgName] = ideo[staticProp];\n\n      if (debug) {\n        console.timeEnd(`${cacheName}Cache total`);\n        perfTimes.total = Math.round(performance.now() - startTime);\n        const preamble = 'perfTimes in init' + cacheProps.metadata + 'Cache:';\n        console.log(preamble, perfTimes);\n      }\n\n      resolve();\n    // });\n  });\n}\n","import {fetchAndParse, getFullId, inspectWorker} from './cache-lib';\n\n/**\n * Convert pre-annotation arrays to annotation objects\n * sorted by genomic position.\n */\nfunction parseAnnots(preAnnots) {\n  const chromosomes = {};\n\n  for (let i = 0; i < preAnnots.length; i++) {\n    const [chromosome, start, stop, ensemblId, gene] = preAnnots[i];\n\n    if (!(chromosome in chromosomes)) {\n      chromosomes[chromosome] = {chr: chromosome, annots: []};\n    } else {\n      const annot = {name: gene, start, stop, ensemblId};\n      chromosomes[chromosome].annots.push(annot);\n    }\n  }\n\n  const annotsSortedByPosition = {};\n\n  Object.entries(chromosomes).forEach(([chr, annotsByChr]) => {\n    annotsSortedByPosition[chr] = {\n      chr,\n      annots: annotsByChr.annots.sort((a, b) => a.start - b.start)\n    };\n  });\n\n  return annotsSortedByPosition;\n}\n\n/** Parse a gene cache TSV file, return array of useful transforms */\nexport function parseGeneCache(rawTsv, perfTimes) {\n  const names = [];\n  const nameCaseMap = {};\n  const namesById = {};\n  const fullNamesById = {};\n  const idsByName = {};\n  const lociByName = {};\n  const lociById = {};\n  const preAnnots = [];\n\n  // If the gene has among top 2% expression in a tissue (per GTEx), that's\n  // tracked here.\n  const tissueIdsByName = {};\n\n  let ensemblPrefix;\n\n  let t0 = performance.now();\n  const lines = rawTsv.split(/\\r\\n|\\n/);\n  perfTimes.rawTsvSplit = Math.round(performance.now() - t0);\n\n  t0 = performance.now();\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (line === '') continue; // Skip empty lines\n    if (line[0] === '#') {\n      if (line.slice(0, 9) === '## prefix') {\n        ensemblPrefix = line.split('prefix: ')[1];\n      }\n      continue;\n    }\n    const [\n      chromosome, rawStart, rawLength, slimEnsemblId, gene,\n      rawFullName, tissueIds\n    ] = line.trim().split(/\\t/);\n    const fullName = decodeURIComponent(rawFullName);\n    const start = parseInt(rawStart);\n    const stop = start + parseInt(rawLength);\n    const ensemblId = getFullId(ensemblPrefix, slimEnsemblId);\n    preAnnots.push([chromosome, start, stop, ensemblId, gene, fullName]);\n    const locus = [chromosome, start, stop];\n\n    names.push(gene);\n    nameCaseMap[gene.toLowerCase()] = gene;\n    namesById[ensemblId] = gene;\n    fullNamesById[ensemblId] = fullName;\n    idsByName[gene] = ensemblId;\n    lociByName[gene] = locus;\n    lociById[ensemblId] = locus;\n\n    if (tissueIds !== undefined) {\n      const processedTissueIds = [];\n      const splitTissueIds = tissueIds.split(',');\n      for (let i = 0; i < splitTissueIds.length; i++) {\n        processedTissueIds.push(parseInt(splitTissueIds[i], 10));\n      }\n      tissueIdsByName[gene] = processedTissueIds;\n    }\n  };\n  const t1 = performance.now();\n  perfTimes.parseCacheLoop = Math.round(t1 - t0);\n\n  // const sortedAnnots = parseAnnots(preAnnots);\n  perfTimes.parseAnnots = Math.round(performance.now() - t1);\n\n  return [\n    names, nameCaseMap, namesById,\n    fullNamesById,\n    idsByName, lociByName, lociById\n    // , sortedAnnots\n  ];\n}\n\n// Uncomment when workers work outside localhost\n// addEventListener('message', async event => {\n//   console.time('geneCacheWorker');\n//   // console.log('in gene cache worker message handler');\n//   const [cacheUrl, perfTimes, debug] = event.data;\n//   const result = await fetchAndParse(cacheUrl, perfTimes, parseCache);\n//   postMessage(result);\n//   if (debug) inspectWorker('gene', result[0]);\n// });\n","import {fetchAndParse, getFullId, inspectWorker} from './cache-lib';\n\n/** Parse a paralog cache TSV file, return array of useful transforms */\nexport function parseParalogCache(rawTsv, perfTimes) {\n  const paralogsByName = {};\n  let ensemblPrefix;\n\n  let t0 = performance.now();\n  const lines = rawTsv.split(/\\r\\n|\\n/);\n  perfTimes.rawTsvSplit = Math.round(performance.now() - t0);\n\n  t0 = performance.now();\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (line === '') continue; // Skip empty lines\n    if (line[0] === '#') {\n      if (line.slice(0, 9) === '## prefix') {\n        ensemblPrefix = line.split('prefix: ')[1];\n      }\n      continue;\n    }\n    const columns = line.trim().split(/\\t/);\n    const gene = columns[0];\n    const geneSlimId = columns[1];\n\n    const paralogs = [];\n    if (columns[2][0] === '_') {\n      const pointer = columns[2].slice(1).toUpperCase();\n      const paralogSuperList = paralogsByName[pointer];\n      const geneId = getFullId(ensemblPrefix, geneSlimId);\n      for (let j = 0; j < paralogSuperList.length; j++) {\n        const id = paralogSuperList[j];\n        if (id !== geneId) {\n          paralogs.push(id);\n        }\n      }\n      paralogs.unshift(getFullId(ensemblPrefix, columns[3]));\n    } else {\n      const slimEnsemblIds = columns.slice(2);\n      for (let j = 0; j < slimEnsemblIds.length; j++) {\n        const slimId = slimEnsemblIds[j];\n        if (slimId !== geneSlimId) {\n          paralogs.push(getFullId(ensemblPrefix, slimId));\n        }\n      }\n    }\n\n    paralogsByName[gene.toUpperCase()] = paralogs;\n  };\n  const t1 = performance.now();\n  perfTimes.parseCacheLoop = Math.round(t1 - t0);\n\n  return paralogsByName;\n}\n\n// Uncomment when workers work outside localhost\n// addEventListener('message', async event => {\n//   console.time('paralogCacheWorker');\n//   const [cacheUrl, perfTimes, debug] = event.data;\n//   const result = await fetchAndParse(cacheUrl, perfTimes, parseCache);\n//   postMessage(result);\n//   if (debug) inspectWorker('paralog', result[0]);\n// });\n","import {fetchAndParse, inspectWorker} from './cache-lib';\n\n/** Parse an interaction cache JSON file, return array of useful transforms */\nexport function parseInteractionCache(rawJson, perfTimes, orgName) {\n  let t0 = performance.now();\n  const interactionsByName = {};\n  const tmp = orgName.replace('-', ' ');\n  const desluggedOrg = tmp[0].toUpperCase() + tmp.slice(1);\n\n  t0 = performance.now();\n  for (const gene in rawJson['interactions']) {\n    const ixnLists = rawJson['interactions'][gene];\n    interactionsByName[gene] = {result: []};\n    for (let i = 0; i < ixnLists.length; i++) {\n      const compressedIxn = ixnLists[i];\n      const slimPwId = compressedIxn[0];\n      interactionsByName[gene].result.push({\n        fields: {\n          left: {values: compressedIxn[1]},\n          right: {values: compressedIxn[2]}\n        },\n        id: 'WP' + slimPwId,\n        name: rawJson['pathwayNamesById'][slimPwId],\n        species: desluggedOrg\n      });\n    }\n  }\n  const t1 = performance.now();\n  perfTimes.parseCacheLoop = Math.round(t1 - t0);\n\n  return interactionsByName;\n}\n\n// Uncomment when workers work outside localhost\n// addEventListener('message', async event => {\n//   console.time('interactionCacheWorker');\n//   const [cacheUrl, perfTimes, debug, orgName] = event.data;\n//   const result = await fetchAndParse(cacheUrl, perfTimes, parseCache, orgName);\n//   postMessage(result);\n//   if (debug) inspectWorker('interaction', result[0]);\n// });\n","import {fetchAndParse, inspectWorker} from './cache-lib';\n\n/** Parse synonym cache TSV data, return array of useful transforms */\nexport function parseSynonymCache(rawTsv, perfTimes) {\n  const byGene = {};\n  // const nameCaseMap = {};\n\n  let t0 = performance.now();\n  const lines = rawTsv.split(/\\r\\n|\\n/);\n  perfTimes.rawTsvSplit = Math.round(performance.now() - t0);\n\n  t0 = performance.now();\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (line === '' || line[0] === '#') continue; // Skip empty lines, headers\n\n    const splitLine = line.trim().split(/\\t/);\n\n    const gene = splitLine[0];\n    const synonyms = splitLine.slice(1);\n\n    byGene[gene] = synonyms;\n\n    // For now, initialization is JITed in related-genes.js, as use is rare.\n    // nameCaseMap[gene.toLowerCase()] = synonyms.map(s => s.toLowerCase());\n  };\n  const t1 = performance.now();\n  perfTimes.parseCacheLoop = Math.round(t1 - t0);\n\n  return {byGene};\n}\n\n// Uncomment when workers work outside localhost\n// addEventListener('message', async event => {\n//   console.time('geneSynonymCacheWorker');\n//   const [cacheUrl, perfTimes, debug] = event.data;\n//   const result = await fetchAndParse(cacheUrl, perfTimes, parseCache);\n//   postMessage(result);\n//   if (debug) inspectWorker('geneStructure', result[0]);\n// });\n","import {d3} from '../lib';\nimport collinearizeChromosomes from '../collinear';\nimport {initCaches} from './caches/cache';\n\nfunction processLabels(config, ideo) {\n  var i, chrID, t0C, t1C;\n\n  if (config.showBandLabels === true) {\n    t0C = new Date().getTime();\n    ideo.hideUnshownBandLabels();\n    t1C = new Date().getTime();\n    if (config.debug) {\n      console.log('Time in showing bands: ' + (t1C - t0C) + ' ms');\n    }\n\n    if (config.orientation === 'vertical') {\n      for (i = 0; i < ideo.chromosomesArray.length; i++) {\n        chrID = '#' + ideo.chromosomesArray[i].id;\n        ideo.rotateChromosomeLabels(d3.select(chrID), i);\n      }\n    }\n  }\n\n  if (config.showChromosomeLabels === true) {\n    ideo.drawChromosomeLabels(ideo.chromosomes);\n  }\n}\n\nfunction processAnnots(ideo) {\n  if (typeof ideo.timeout !== 'undefined') window.clearTimeout(ideo.timeout);\n\n  ideo.rawAnnots = ideo.setOriginalTrackIndexes(ideo.rawAnnots);\n\n  if (ideo.config.annotationsDisplayedTracks) {\n    ideo.annots =\n      ideo.updateDisplayedTracks(ideo.config.annotationsDisplayedTracks);\n  } else {\n    ideo.annots = ideo.processAnnotData(ideo.rawAnnots);\n    if (ideo.config.filterable) ideo.initCrossFilter();\n    ideo.drawProcessedAnnots(ideo.annots);\n  }\n}\n\n/**\n * Load (potentially large) annotation dataset, then process it.\n */\nfunction waitForAndProcessAnnots(ideo) {\n  if (ideo.rawAnnots) {\n    processAnnots(ideo);\n  } else {\n    (function checkAnnotData() {\n      ideo.timeout = setTimeout(function() {\n        if (\n          !ideo.rawAnnots ||\n          (ideo.rawAnnots && typeof ideo.rawAnnots.then !== 'undefined')\n        ) {\n          // Ensure rawAnnots is defined and not a Promise (not \"then\"-able)\n          checkAnnotData();\n        } else {\n          processAnnots(ideo);\n        }\n      }, 50);\n    })();\n  }\n}\n\nfunction reportDebugTimings(config, t0, t0A) {\n\n  var t1A = new Date().getTime();\n  if (config.debug) {\n    console.log('Time in drawChromosome: ' + (t1A - t0A) + ' ms');\n  }\n\n  var t1 = new Date().getTime();\n  if (config.debug) {\n    console.log('Time constructing ideogram: ' + (t1 - t0) + ' ms');\n  }\n}\n\n/**\n * Completes high-level initialization.\n * Draws chromosomes and band labels, rotating as needed;\n * processes and draws annotations;\n * creates brush, emits notification of load completion, etc.\n */\nfunction finishInit(t0) {\n  var t0A = new Date().getTime(),\n    ideo = this,\n    config = ideo.config,\n    confAnnots = config.annotations;\n\n  ideo.initDrawChromosomes();\n\n  if (config.annotationsPath) waitForAndProcessAnnots(ideo);\n\n  processLabels(config, ideo);\n\n  // Create a brush or a click cursor if specified\n  if (config.brush) ideo.createBrush(config.brush);\n  else if (config.cursorPosition) ideo.createClickCursor(config.cursorPosition);\n\n  if (confAnnots) {\n    if (Array.isArray(confAnnots)) {\n      ideo.drawAnnots(confAnnots);\n    } else {\n      // Enable client-side-defined annotations to be formatted\n      // like the wider variety of server-side-defined annotations.\n      // Supports https://github.com/eweitz/ideogram/issues/137\n      ideo.rawAnnots = confAnnots;\n      ideo.afterRawAnnots();\n      processAnnots(ideo);\n    }\n  }\n\n  reportDebugTimings(config, t0, t0A);\n\n  ideo.setOverflowScroll();\n\n  if (config.geometry === 'collinear') collinearizeChromosomes(ideo);\n\n  if (ideo.config.debug) console.time('initCache: Ideogram');\n  initCaches(ideo).then(() => {\n    if (ideo.config.debug) console.timeEnd('initCache: Ideogram');\n    if (ideo.onLoadCallback) ideo.onLoadCallback();\n  });\n}\n\nexport {finishInit};\n","export class Ploidy {\n\n  constructor(config) {\n    this._config = config;\n    this._description = this._normalize(this._config.ploidyDesc);\n  }\n\n  // Get number of chromosomes in a chromosome set\n  getChromosomesNumber(setIndex) {\n    if (this._config.ploidyDesc) {\n      var chrSetCode = this._config.ploidyDesc[setIndex];\n      if (chrSetCode instanceof Object) {\n        return Object.keys(chrSetCode)[0].length;\n      } else {\n        return chrSetCode.length;\n      }\n    } else {\n      return this._config.ploidy || 1;\n    }\n  }\n\n  // Normalize use defined description\n  _normalize(description) {\n    var key, descValue,\n      normalized = [];\n\n    if (!description) return description;\n\n    // Loop through description and normalize\n    for (key in description) {\n      descValue = description[key];\n      if (typeof descValue === 'string') {\n        if (this._config.orientation === 'vertical') {\n          descValue = descValue.split('').reverse();\n        }\n        normalized.push({\n          ancestors: descValue,\n          existence: this._getexistenceArray(descValue.length)\n        });\n      } else {\n        normalized.push({\n          ancestors: Object.keys(descValue)[0],\n          existence: descValue[Object.keys(descValue)[0]]\n        });\n      }\n    }\n\n    return normalized;\n  }\n\n  // Get array filled by '11' elements\n  _getexistenceArray(length) {\n    var array = [];\n\n    for (var i = 0; i < length; i++) {\n      array.push('11');\n    }\n\n    return array;\n  }\n\n  getSetSize(chrSetIndex) {\n    if (this._description) {\n      return this._description[chrSetIndex].ancestors.length;\n    } else {\n      return 1;\n    }\n  }\n\n  // Get ancestor letter\n  getAncestor(chrSetIndex, chrIndex) {\n    if (this._description) {\n      return this._description[chrSetIndex].ancestors[chrIndex];\n    } else {\n      return '';\n    }\n  }\n\n  // Check if chromosome's arm should be rendered.\n  // If no description was provided, method returns true and\n  // something another depending on user provided description.\n  exists(chrSetIndex, chrIndex, armIndex) {\n    if (this._description) {\n      var desc =\n        this._description[chrSetIndex].existence[chrIndex][armIndex];\n      return Number(desc) > 0;\n    } else {\n      return true;\n    }\n  }\n\n}\n","import {d3} from '../lib';\n\n/**\n * Chromosome's view utility class\n */\nexport class ChromosomeUtil {\n\n  constructor(node) {\n    this._node = node;\n  }\n\n  getLabel() {\n    var label =\n      d3\n        .select(this._node.parentNode)\n        .select('text.chrLabel')\n        .text();\n    return label;\n  }\n\n  /**\n   * Get chromosome set label\n   */\n  getSetLabel() {\n    var setLabel =\n      d3\n        .select(this._node.parentNode)\n        .select('text.chrSetLabel')\n        .text();\n    return setLabel;\n  }\n}\n","import {d3} from '../lib';\nimport {ChromosomeUtil} from './../views/chromosome-util';\n\nclass Layout {\n\n  constructor(config, ideo) {\n    this._config = config;\n    this._ideo = ideo;\n    this._ploidy = this._ideo._ploidy;\n    this._translate = undefined;\n\n    if ('chrSetMargin' in config) {\n      this.chrSetMargin = config.chrSetMargin;\n    } else {\n      var chrMargin = this._config.chrMargin;\n      this.chrSetMargin = (this._config.ploidy > 1 ? chrMargin : 0);\n    }\n\n    // Chromosome band's size.\n    this._tickSize = 8;\n\n    // Chromosome rotation state.\n    this._isRotated = false;\n  }\n\n  // Get chart left margin\n  _getLeftMargin() {\n    return this.margin.left;\n  }\n\n  // Get rotated chromosome y scale\n  _getYScale() {\n    // 20 is width of rotated chromosome.\n    return 20 / this._config.chrWidth;\n  }\n\n  // Get chromosome labels\n  getChromosomeLabels(chrElement) {\n    var util = new ChromosomeUtil(chrElement),\n      labels = [];\n\n    if (this._ideo.config.ploidy > 1) {\n      labels.push(util.getSetLabel());\n    }\n    labels.push(util.getLabel());\n\n    return labels.filter(function(d) {\n      return d.length > 0;\n    });\n  }\n\n  getChromosomeBandLabelTranslate(band) {\n    var x, y, translate,\n      ideo = this._ideo,\n      tickSize = this._tickSize,\n      orientation = ideo.config.orientation;\n\n    if (orientation === 'vertical') {\n      x = tickSize;\n      y = ideo.round(2 + band.px.start + band.px.width / 2);\n      translate = 'rotate(-90)translate(' + x + ',' + y + ')';\n    } else if (orientation === 'horizontal') {\n      x = ideo.round(-tickSize + band.px.start + band.px.width / 2);\n      y = -10;\n      translate = 'translate(' + x + ',' + y + ')';\n    }\n\n    return {\n      x: x,\n      y: y,\n      translate: translate\n    };\n  }\n\n  didRotate(chrIndex, chrElement) {\n    var ideo, taxid, chrName, bands, chrModel, oldWidth,\n      chrSetElement, transform, scale, scaleRE;\n\n    ideo = this._ideo;\n    taxid = ideo.config.taxid;\n    chrName = chrElement.id.split('-')[0].replace('chr', '');\n    chrModel = ideo.chromosomes[taxid][chrName];\n    bands = chrModel.bands;\n\n    chrSetElement = d3.select(chrElement.parentNode);\n    transform = chrSetElement.attr('transform');\n    scaleRE = /scale\\(.*\\)/;\n    scale = scaleRE.exec(transform);\n    transform = transform.replace(scale, '');\n    chrSetElement.attr('transform', transform);\n\n    oldWidth = chrModel.width;\n\n    chrModel = ideo.getChromosomeModel(bands, chrName, taxid, chrIndex);\n\n    chrModel.oldWidth = oldWidth;\n\n    ideo.chromosomes[taxid][chrName] = chrModel;\n    ideo.drawChromosome(chrModel);\n\n    ideo.handleRotateOnClick();\n\n    if (ideo.rawAnnots) {\n      if (ideo.displayedTrackIndexes) {\n        ideo.updateDisplayedTracks(ideo.displayedTrackIndexes);\n      } else {\n        ideo.annots = ideo.processAnnotData(ideo.rawAnnots);\n        ideo.drawProcessedAnnots(ideo.annots);\n\n        if (ideo.config.filterable) {\n          ideo.initCrossFilter();\n        }\n      }\n    }\n\n    if (ideo.config.showBandLabels === true) {\n      ideo.drawBandLabels(ideo.chromosomes);\n      ideo.hideUnshownBandLabels();\n    }\n\n    if (ideo.onDidRotateCallback) {\n      ideo.onDidRotateCallback(chrModel);\n    }\n  }\n\n  rotate(chrSetIndex, chrIndex, chrElement) {\n    var ideo, otherChrs, ideoBounds, labelSelectors;\n    ideo = this._ideo;\n\n    labelSelectors = (\n      ideo.selector + ' .chrSetLabel, ' + ideo.selector + ' .chrLabel'\n    );\n\n    ideoBounds = document.querySelector(ideo.selector).getBoundingClientRect();\n\n    // Find chromosomes which should be hidden\n    otherChrs = d3.selectAll(ideo.selector + ' g.chromosome')\n      .filter(function() {return this !== chrElement;});\n\n    if (this._isRotated) {\n\n      this._isRotated = false;\n\n      ideo.config.chrHeight = ideo.config.chrHeightOriginal;\n      ideo.config.chrWidth = ideo.config.chrWidthOriginal;\n      ideo.config.annotationHeight = ideo.config.annotationHeightOriginal;\n\n      // Rotate chromosome back\n      this.rotateBack(chrSetIndex, chrIndex, chrElement, function() {\n        // Show all other chromosomes and chromosome labels\n        otherChrs.style('display', null);\n        d3.selectAll(labelSelectors).style('display', null);\n        ideo._layout.didRotate(chrIndex, chrElement);\n      });\n\n    } else {\n\n      this._isRotated = true;\n\n      // Hide all other chromosomes and chromosome labels\n      otherChrs.style('display', 'none');\n      d3.selectAll(labelSelectors).style('display', 'none');\n\n      // Rotate chromosome\n      this.rotateForward(chrSetIndex, chrIndex, chrElement, function() {\n\n        var chrHeight, elementLength, windowLength;\n\n        ideo.config.chrHeightOriginal = ideo.config.chrHeight;\n        ideo.config.chrWidthOriginal = ideo.config.chrWidth;\n        ideo.config.annotationHeightOriginal = ideo.config.annotationHeight;\n\n        const settingsGearWidth = 20;\n\n        if (ideo._layout._class === 'VerticalLayout') {\n          elementLength = ideoBounds.width - settingsGearWidth;\n          windowLength = window.innerWidth - settingsGearWidth;\n        } else {\n          elementLength = ideoBounds.height - 10;\n          windowLength = window.innerHeight - 10;\n        }\n\n        // Set chromosome height to window length or ideogram element length,\n        // whichever is smaller.  This keeps whole chromosome viewable, while\n        // also ensuring the height doesn't exceed what the user specified.\n        if (windowLength < elementLength) {\n          chrHeight = windowLength;\n        } else {\n          chrHeight = elementLength;\n        }\n        chrHeight -= ideo.config.chrMargin * 2;\n        ideo.config.chrHeight = chrHeight;\n\n        // Account for chromosome label\n        // TODO: Make this dynamic, not hard-coded\n        ideo.config.chrWidth *= 2.3;\n\n        ideo.config.annotationHeight *= 1.7;\n\n        ideo._layout.didRotate(chrIndex, chrElement);\n      });\n    }\n  }\n\n  getChromosomeLabelClass() {\n    if (this._config.ploidy === 1) {\n      return 'chrLabel';\n    } else {\n      return 'chrSetLabel';\n    }\n  }\n\n  _getAdditionalOffset() {\n    var config = this._config;\n    var numTracks = config.annotationsNumTracks || config.numAnnotTracks || 1;\n    return (config.annotationHeight || 0) * numTracks;\n  }\n\n  _getChromosomeSetSize(chrSetIndex) {\n    // Get last chromosome set size.\n    var setSize = this._ploidy.getSetSize(chrSetIndex);\n\n    // Increase offset by last chromosome set size\n    return (\n      setSize * this._config.chrWidth * 2 + (this.chrSetMargin)\n    );\n  }\n\n  // Get chromosome set label anchor property\n  getChromosomeSetLabelAnchor() {\n    return 'middle';\n  }\n\n  // Get chromosome label y position.\n  getChromosomeLabelYPosition() {\n    return -5.5;\n  }\n\n  getChromosomeSetLabelYPosition(chrIndex) {\n    if (this._config.ploidy === 1) {\n      return this.getChromosomeLabelYPosition(chrIndex);\n    } else {\n      return -2 * this._config.chrWidth;\n    }\n  }\n\n}\n\nexport default Layout;\n","/**\n* @fileoverview Vertical layout class\n* Ideogram instances with vertical layout are oriented with each chromosome\n* starting at top and ending at bottom, and aligned as columns.\n*/\n\nimport {d3} from '../lib';\nimport Layout from './layout';\n\nclass VerticalLayout extends Layout {\n\n  constructor(config, ideo) {\n    super(config, ideo);\n    this._class = 'VerticalLayout';\n    // Layout margins\n    this.margin = {\n      top: 30,\n      left: 15\n    };\n  }\n\n  rotateForward(chrSetIndex, chrIndex, chrElement, callback) {\n    // TODO: Integrate chrSetIndex and chrIndex to support polyploid rotation.\n\n    var self = this;\n\n    var xOffset = 20;\n\n    var scale = this.getChromosomeScale(chrElement);\n\n    var transform =\n      'translate(' + xOffset + ', 25) ' + scale;\n\n    d3.select(chrElement.parentNode)\n      .transition()\n      .attr('transform', transform)\n      .on('end', callback);\n\n    // Append new chromosome labels\n    var labels = this.getChromosomeLabels(chrElement);\n    var y = (xOffset + self._config.chrWidth) * 1.3;\n    d3.select(this._ideo.getSvg())\n      .append('g')\n      .attr('class', 'tmp')\n      .selectAll('text')\n      .data(labels)\n      .enter()\n      .append('text')\n      .attr('class', function(d, i) {\n        return i === 0 && labels.length === 2 ? 'chrSetLabel' : null;\n      })\n      .attr('x', 0)\n      .attr('y', y).style('opacity', 0)\n      .text(String)\n      .transition()\n      .style('opacity', 1);\n\n    this._ideo.config.orientation = 'horizontal';\n  }\n\n  rotateBack(setIndex, chrIndex, chrElement, callback) {\n\n    var scale = this.getChromosomeScaleBack(chrElement);\n    var translate = this.getChromosomeSetTranslate(setIndex);\n\n    d3.select(chrElement.parentNode)\n      .transition()\n      .attr('transform', translate + ' ' + scale)\n      .on('end', callback);\n\n    d3.selectAll(this._ideo.selector + ' g.tmp')\n      .style('opacity', 0)\n      .remove();\n\n    this._ideo.config.orientation = 'vertical';\n  }\n\n  getHeight() {\n    return this._config.chrHeight + this.margin.top * 1.5;\n  }\n\n  getWidth() {\n    return '97%';\n  }\n\n  getChromosomeBandTickY1() {\n    return 2;\n  }\n\n  getChromosomeBandTickY2() {\n    return 10;\n  }\n\n  getChromosomeSetLabelTranslate() {\n    return 'rotate(-90)';\n  }\n\n  getChromosomeBandLabelAnchor() {\n    return null;\n  }\n\n  getChromosomeScale(chrElement) {\n    var ideoBox, chrBox, scaleX, scaleY;\n\n    ideoBox = d3.select(this._ideo.selector).node().getBoundingClientRect();\n    chrBox = chrElement.getBoundingClientRect();\n\n    scaleX = (ideoBox.width / chrBox.height) * 0.97;\n    scaleY = this._getYScale();\n\n    return 'scale(' + scaleX + ', ' + scaleY + ')';\n  }\n\n  getChromosomeScaleBack(chrElement) {\n    var scale, scaleX, scaleY, chrName, chrModel, taxid, ideo, config;\n\n    ideo = this._ideo;\n    config = ideo.config;\n    taxid = config.taxid;\n\n    chrName = chrElement.id.split('-')[0].replace('chr', '');\n    chrModel = this._ideo.chromosomes[taxid][chrName];\n    scaleX = (chrModel.oldWidth / (config.chrHeight * 3)) * 0.97;\n    scaleY = 1 / this._getYScale();\n    scale = 'scale(' + scaleX + ', ' + scaleY + ')';\n    return scale;\n  }\n\n  getChromosomeSetTranslate(setIndex) {\n    var marginTop = this.margin.top;\n    var chromosomeSetYTranslate = this.getChromosomeSetYTranslate(setIndex);\n    return (\n      'rotate(90) ' +\n      'translate(' + marginTop + ', -' + chromosomeSetYTranslate + ')'\n    );\n  }\n\n  getChromosomeSetYTranslate(setIndex) {\n    // Get additional padding caused by annotation/histogram tracks\n    var pad = this._getAdditionalOffset(),\n      config = this._config,\n      margin = config.chrMargin,\n      width = config.chrWidth,\n      translate;\n\n    // If no detailed description provided just use one formula for all cases\n    if (!config.ploidyDesc) {\n      // TODO:\n      // This part of code contains a lot magic numbers and if\n      // statements for exactly corresponing to original ideogram examples.\n      // But all this stuff should be removed. Calculation of translate\n      // should be a simple formula applied for all cases listed below.\n      // Now they are diffirent because of Layout:_getAdditionalOffset do\n      // not meet for cases when no annotation, when annotation exists and\n      // when histogram used\n\n      if (config.annotationsLayout === 'histogram') {\n        var barWidth = config.barWidth;\n        return margin + setIndex * (margin + width + 3) + barWidth * 2;\n      } else {\n        const decorPad =\n          'legendPad' in config ? config.legendPad : 0;\n        translate = width + setIndex * (margin + width) + pad * 2 + decorPad;\n        if (pad > 0) {\n          return translate;\n        } else {\n          return translate + 4 + (2 * setIndex);\n        }\n      }\n    }\n\n    // If detailed description provided start to calculate offsets\n    // for each chromosome set separately. This should be done only once\n    if (!this._translate) {\n      // First offset equals to zero\n      this._translate = [this._ploidy.getSetSize(0) * width * 2];\n      var prevTranslate;\n      // Loop through description set\n      for (var i = 1; i < this._config.ploidyDesc.length; i++) {\n        prevTranslate = this._translate[i - 1];\n        this._translate[i] = prevTranslate + this._getChromosomeSetSize(i - 1);\n      }\n    }\n\n    return this._translate[setIndex];\n  }\n\n  getChromosomeSetLabelXPosition() {\n    return (this._config.chrWidth * this._config.ploidy) / -2;\n  }\n\n  getChromosomeLabelXPosition() {\n    return this._config.chrWidth / -2;\n  }\n}\n\nexport default VerticalLayout;\n","/**\n* @fileoverview Horizontal layout class\n* Ideogram instances with horizontal layout are oriented with each chromosome\n* starting at left and ending at right, and aligned as rows.\n*/\n\nimport {d3} from '../lib';\nimport Layout from './layout';\n\nclass HorizontalLayout extends Layout {\n\n  constructor(config, ideo) {\n    super(config, ideo);\n    this._class = 'HorizontalLayout';\n    this.margin = {\n      left: 20,\n      top: 30\n    };\n  }\n\n  _getLeftMargin() {\n    var margin = Layout.prototype._getLeftMargin.call(this);\n    if (this._config.ploidy > 1) {\n      margin *= 1.8;\n    }\n\n    return margin;\n  }\n\n  rotateForward(setIndex, chrIndex, chrElement, callback) {\n\n    var xOffset, yOffset, transform, labels;\n\n    xOffset = 30;\n\n    yOffset = xOffset + 7.5;\n\n    transform = (\n      'rotate(90) ' +\n      'translate(' + xOffset + ', -' + yOffset + ') '\n    );\n\n    d3.select(chrElement.parentNode)\n      .transition()\n      .attr('transform', transform)\n      .on('end', callback);\n\n    // Append new chromosome labels\n    labels = this.getChromosomeLabels(chrElement);\n    d3.select(this._ideo.getSvg())\n      .append('g')\n      .attr('class', 'tmp')\n      .selectAll('text')\n      .data(labels)\n      .enter()\n      .append('text')\n      .attr('class', function(d, i) {\n        return i === 0 && labels.length === 2 ? 'chrSetLabel' : null;\n      })\n      .attr('x', xOffset - 4)\n      .attr('y', function(d, i) {\n        return (i + 1 + labels.length % 2) * 12;\n      })\n      .style('text-anchor', 'middle')\n      .style('opacity', 0)\n      .text(String)\n      .transition()\n      .style('opacity', 1);\n\n    this._ideo.config.orientation = 'vertical';\n  }\n\n  rotateBack(setIndex, chrIndex, chrElement, callback) {\n    var translate = this.getChromosomeSetTranslate(setIndex);\n\n    d3.select(chrElement.parentNode)\n      .transition()\n      .attr('transform', translate)\n      .on('end', callback);\n\n    d3.selectAll(this._ideo.selector + ' g.tmp')\n      .style('opacity', 0)\n      .remove();\n\n    this._ideo.config.orientation = 'horizontal';\n  }\n\n  getHeight(taxid) {\n    if (typeof taxid === 'undefined') taxid = this._config.taxids[0];\n    // Get last chromosome set offset.\n    var numChromosomes = this._config.chromosomes[taxid].length;\n    var lastSetOffset = this.getChromosomeSetYTranslate(numChromosomes - 1);\n\n    // Get last chromosome set size.\n    var lastSetSize = this._getChromosomeSetSize(numChromosomes - 1);\n\n    // Increase offset by last chromosome set size\n    lastSetOffset += lastSetSize;\n\n    return lastSetOffset + this._getAdditionalOffset() * 2;\n  }\n\n  getWidth() {\n    return this._config.chrHeight + this.margin.top * 1.5;\n  }\n\n  getChromosomeSetLabelAnchor() {\n    return 'end';\n  }\n\n  getChromosomeBandLabelAnchor() {\n    return null;\n  }\n\n  getChromosomeBandTickY1() {\n    return 2;\n  }\n\n  getChromosomeBandTickY2() {\n    return 10;\n  }\n\n  getChromosomeSetLabelTranslate() {\n    return null;\n  }\n\n  getChromosomeSetTranslate(setIndex) {\n    var leftMargin = this._getLeftMargin();\n    var yTranslate = this.getChromosomeSetYTranslate(setIndex);\n    return 'translate(' + leftMargin + ', ' + yTranslate + ')';\n  }\n\n  getChromosomeSetYTranslate(setIndex) {\n    // If no detailed description provided just use one formula for all cases.\n    if (!this._config.ploidyDesc) {\n      return this._config.chrMargin * (setIndex + 1);\n    }\n\n    // Id detailed description provided start to calculate offsets\n    //  for each chromosome set separately. This should be done only once.\n    if (!this._translate) {\n      // First offset equals to zero.\n      this._translate = [1];\n\n      // Loop through description set\n      for (var i = 1; i < this._config.ploidyDesc.length; i++) {\n        this._translate[i] =\n          this._translate[i - 1] + this._getChromosomeSetSize(i - 1);\n      }\n    }\n\n    return this._translate[setIndex];\n  }\n\n  getChromosomeSetLabelXPosition(i) {\n    if (this._config.ploidy === 1) {\n      return this.getChromosomeLabelXPosition(i);\n    } else {\n      return -20;\n    }\n  }\n\n  getChromosomeSetLabelYPosition(i) {\n    var setSize = this._ploidy.getSetSize(i),\n      config = this._config,\n      chrMargin = config.chrMargin,\n      chrWidth = config.chrWidth,\n      y;\n\n    if (config.ploidy === 1) {\n      y = chrWidth / 2 + 3;\n    } else {\n      y = (setSize * chrMargin) / 2;\n    }\n\n    return y;\n  }\n\n  getChromosomeLabelXPosition() {\n    return -8;\n  }\n\n  getChromosomeLabelYPosition() {\n    return this._config.chrWidth;\n  }\n\n}\n\nexport default HorizontalLayout;\n","/**\n* @fileoverview Paired layout class\n* Ideograms with paired layout group each chromosome in a chromosome set.\n* This enables ploidy support beyond the default haploid; e.g. diploid genomes.\n*/\n\nimport Layout from './layout';\n\nclass PairedLayout extends Layout {\n\n  constructor(config, ideo) {\n    super(config, ideo);\n\n    this._class = 'PairedLayout';\n\n    this.margin = {\n      left: 30\n    };\n  }\n\n  getHeight() {\n    return this._config.chrHeight + this.margin.left * 1.5;\n  }\n\n  getWidth() {\n    return '97%';\n  }\n\n  getChromosomeBandTickY1(chrIndex) {\n    return chrIndex % 2 ? this._config.chrWidth : this._config.chrWidth * 2;\n  }\n\n  getChromosomeBandTickY2(chrIndex) {\n    var width = this._config.chrWidth;\n    return chrIndex % 2 ? width - this._tickSize : width * 2 + this._tickSize;\n  }\n\n  getChromosomeBandLabelAnchor(chrIndex) {\n    return chrIndex % 2 ? null : 'end';\n  }\n\n  getChromosomeBandLabelTranslate(band, chrIndex) {\n    var x = chrIndex % 2 ? 10 : -this._config.chrWidth - 10;\n    var y = this._ideo.round(band.px.start + band.px.width / 2) + 3;\n\n    return {\n      x: y,\n      y: y,\n      translate: 'rotate(-90) translate(' + x + ', ' + y + ')'\n    };\n  }\n\n  getChromosomeLabelXPosition() {\n    return -this._tickSize;\n  }\n\n  getChromosomeSetLabelXPosition() {\n    return this._config.chrWidth / -2;\n  }\n\n  getChromosomeSetLabelTranslate() {\n    return 'rotate(-90)';\n  }\n\n  getChromosomeSetTranslate(setIndex) {\n    var chromosomeSetYTranslate = this.getChromosomeSetYTranslate(setIndex);\n    return (\n      'rotate(90) ' +\n      'translate(' + this.margin.left + ', -' + chromosomeSetYTranslate + ')'\n    );\n  }\n\n  getChromosomeSetYTranslate(setIndex) {\n    return 200 * (setIndex + 1);\n  }\n\n}\n\nexport default PairedLayout;\n","import Layout from './layout';\n\nclass SmallLayout extends Layout {\n\n  constructor(config, ideo) {\n    super(config, ideo);\n\n    this._class = 'SmallLayout';\n\n    this.margin = {\n      left: 36.5,\n      top: 10\n    };\n\n    var taxid = this._ideo.getTaxid(this._ideo.config.organism);\n\n    this.chrs = config.chromosomes[taxid];\n    var numChrs = this.chrs.length;\n\n    // Number of chromosomes per row\n    this.chrsPerRow = Math.ceil(numChrs / config.rows);\n  }\n\n  // rotateForward(setIndex, chrIndex, chrElement, callback) {\n  //   var ideoBox =\n  //      d3.select(this._ideo.selector).node().getBoundingClientRect();\n  //   var chrBox = chrElement.getBoundingClientRect();\n  //\n  //   var scaleX = (ideoBox.width / chrBox.height) * 0.97;\n  //   var scaleY = this._getYScale();\n  //\n  //   transform = 'translate(5, 25) scale(' + scaleX + ', ' + scaleY + ')';\n  //\n  //   d3.select(chrElement.parentNode)\n  //     .transition()\n  //     .attr('transform', transform)\n  //     .on('end', callback);\n  // }\n  //\n  // rotateBack(setIndex, chrIndex, chrElement, callback) {\n  //   var translate = this.getChromosomeSetTranslate(setIndex);\n  //\n  //   d3.select(chrElement.parentNode)\n  //     .transition()\n  //     .attr('transform', translate)\n  //     .on('end', callback);\n  // }\n\n  /**\n   * eweitz 2020-04-13:\n   * This height metric is crude because it is calculated before\n   * the height (\"width\") of each chromosome is calculated.\n   *\n   * It calculates height by multiplying the max height of all chromosomes\n   * (specified in the Ideogram configuration object) by the number of rows.\n   * This ensures the ideogram height doesn't truncate in cases like dog\n   * (where chrX on the second row is longer than chr1 on the first), but it\n   * often leaves too much space on the second row, e.g. for human.\n   *\n   * Ideally, ideogram height would be cumulative height per row, plus top\n   * margin.  This would require calling getHeight _after_ all chromosomes\n   * have had their height (technically, chr.width) assigned.  See draft new\n   * getHeight method below this getHeight method.\n  */\n  getHeight() {\n    var config = this._config;\n    var chrHeight = config.chrHeight * 1.25;\n    return this._config.rows * (chrHeight + this.margin.top);\n  }\n\n  /**\n   * eweitz 2020-04-13:\n   * Draft refinement of getHeight.  See note in classic version above.\n   *\n   * Total height is cumulative height per row, plus top margin\n   */\n  // getHeight() {\n  //   let height = 0;\n  //   const rows = this._config.rows;\n  //   const chrEntries = Object.entries(this.chrs);\n\n  //   for (let i = 0; i < rows; i++) {\n  //     let rowHeight = 0;\n  //     // Starting and ending indexes of chromosomes of this row\n  //     const startIndex = this.chrsPerRow * i;\n  //     const endIndex = this.chrsPerRow * (i + 1) - 1;\n\n  //     for (let j = startIndex; j < endIndex; j++) {\n  //       const thisChrHeight = chrEntries[j][1].width;\n  //       if (thisChrHeight > rowHeight) {\n  //         rowHeight = thisChrHeight;\n  //       }\n  //     }\n  //     height += rowHeight + this.margin.top;\n  //   }\n\n  //   return height;\n  // }\n\n  getWidth() {\n    return '97%';\n  }\n\n  getChromosomeBandLabelTranslate() {\n\n  }\n\n  getChromosomeSetLabelTranslate() {\n    return 'rotate(-90)';\n  }\n\n  getChromosomeSetTranslate(setIndex) {\n    var xOffset, yOffset;\n\n    if (setIndex > this.chrsPerRow - 1) {\n      xOffset = this.margin.left + this._config.chrHeight * 1.3;\n      yOffset = this.getChromosomeSetYTranslate(setIndex - this.chrsPerRow);\n    } else {\n      xOffset = this.margin.left;\n      yOffset = this.getChromosomeSetYTranslate(setIndex);\n    }\n\n    return 'rotate(90) translate(' + xOffset + ', -' + yOffset + ')';\n  }\n\n  getChromosomeSetYTranslate(setIndex) {\n    // Get additional padding caused by annotation tracks\n    var additionalPadding = this._getAdditionalOffset() * 0.3;\n    // If no detailed description provided just use one formula for all cases\n    return (\n      this.margin.left * (setIndex) + this._config.chrWidth +\n      additionalPadding * 2 + additionalPadding * setIndex\n    );\n  }\n\n  getChromosomeSetLabelXPosition(setIndex) {\n    return (\n      ((this._ploidy.getSetSize(setIndex) * this._config.chrWidth + 20) / -2) +\n      (this._config.ploidy > 1 ? 0 : this._config.chrWidth)\n    );\n  }\n\n  getChromosomeLabelXPosition() {\n    return this._config.chrWidth / -2;\n  }\n\n}\n\nexport default SmallLayout;\n","import {d3} from '../lib';\nimport {Ploidy} from '../ploidy';\nimport {getLayout} from '../layouts/layout-adapter';\n\n/**\n * If ploidy description is a string, then convert it to the canonical\n * array format.  String ploidyDesc is used when depicting e.g. parental\n * origin each member of chromosome pair in a human genome.\n * See ploidy-basic.html for usage example.\n */\nfunction setPloidy(ideo) {\n  if (\n    'ploidyDesc' in ideo.config &&\n    typeof ideo.config.ploidyDesc === 'string'\n  ) {\n    var tmp = [];\n    for (var i = 0; i < ideo.numChromosomes; i++) {\n      tmp.push(ideo.config.ploidyDesc);\n    }\n    ideo.config.ploidyDesc = tmp;\n  }\n  // Organism ploidy description\n  ideo._ploidy = new Ploidy(ideo.config);\n}\n\nfunction getContainerSvgClass(ideo) {\n  var svgClass = '';\n  if (ideo.config.showChromosomeLabels) {\n    if (ideo.config.orientation === 'horizontal') {\n      svgClass += 'labeledLeft ';\n    } else {\n      svgClass += 'labeled ';\n    }\n  }\n\n  if (ideo.config.rotatable === false) {\n    svgClass += 'no-rotate ';\n  }\n\n  if (\n    ideo.config.annotationsLayout &&\n    ideo.config.annotationsLayout === 'overlay'\n  ) {\n    svgClass += 'faint';\n  }\n\n  return svgClass;\n}\n\n/** Hide tooltip upon pressing \"esc\" on keyboard */\nfunction handleEscape(event) {\n  if (event.keyCode === 27) { // \"Escape\" key pressed\n    const tooltip = document.querySelector('#_ideogramTooltip');\n    if (!tooltip) return;\n    tooltip.style.opacity = 0;\n  }\n}\n\n/**\n * Write tooltip div setup with default styling.\n */\nfunction writeTooltipContainer(ideo) {\n  d3.select(ideo.config.container + ' #_ideogramOuterWrap').append('div')\n    .attr('class', '_ideogramTooltip')\n    .attr('id', '_ideogramTooltip')\n    .style('opacity', 0)\n    .style('position', 'fixed')\n    .style('text-align', 'center')\n    .style('padding', '4px')\n    .style('font', '12px sans-serif')\n    .style('background', 'white')\n    .style('border', '1px solid black')\n    .style('border-radius', '5px')\n    .style('z-index', '1000')\n    .style('margin-left', '-2px'); // Mitigate crowding, e.g. BRCA1 for RAD51\n\n  document.removeEventListener('keydown', handleEscape);\n  document.addEventListener('keydown', handleEscape);\n}\n\nfunction writeContainerDom(ideo) {\n\n  // Remove any previous container content\n  d3.selectAll(ideo.config.container + ' #_ideogramOuterWrap').remove();\n\n  d3.select(ideo.config.container)\n    .append('div')\n    .attr('id', '_ideogramOuterWrap')\n    .append('div')\n    .attr('id', '_ideogramTrackLabelContainer')\n    .style('position', 'absolute');\n\n  d3.select(ideo.config.container + ' #_ideogramOuterWrap').append('div')\n    .attr('id', '_ideogramMiddleWrap') // needed for overflow and scrolling\n    .style('position', 'relative')\n    .style('overflow-x', 'auto')\n    .style('transform', 'translateZ(0)') // add compositing layer for ideogram\n    .append('div')\n    .attr('id', '_ideogramInnerWrap') // needed for overflow and scrolling\n    .append('svg')\n    .attr('id', '_ideogram')\n    .attr('class', getContainerSvgClass(ideo))\n    .attr('width', ideo._layout.getWidth())\n    .attr('height', ideo._layout.getHeight())\n    .html(ideo.getBandColorGradients());\n}\n\n/**\n * Writes the HTML elements that contain this ideogram instance.\n */\nfunction writeContainer(t0) {\n  var ideo = this;\n\n  if (ideo.config.annotationsPath) {\n    ideo.fetchAnnots(ideo.config.annotationsPath);\n  }\n\n  setPloidy(ideo);\n\n  ideo._layout = getLayout(ideo);\n\n  writeContainerDom(ideo);\n\n  ideo.isOnlyIdeogram = document.querySelectorAll('#_ideogram').length === 1;\n  writeTooltipContainer(ideo);\n  ideo.finishInit(t0);\n}\n\nexport {writeContainer};\n","import VerticalLayout from './vertical-layout';\nimport HorizontalLayout from './horizontal-layout';\nimport PairedLayout from './paired-layout';\nimport SmallLayout from './small-layout';\n\nfunction getLayout(ideo) {\n  var config = ideo.config;\n\n  if ('perspective' in config && config.perspective === 'comparative') {\n    return new PairedLayout(config, ideo);\n  } else if ('rows' in config && config.rows > 1) {\n    return new SmallLayout(config, ideo);\n  } else if (config.orientation === 'vertical') {\n    return new VerticalLayout(config, ideo);\n  } else if (config.orientation === 'horizontal') {\n    return new HorizontalLayout(config, ideo);\n  } else {\n    return new VerticalLayout(config, ideo);\n  }\n}\n\nexport {getLayout};\n","import {hasNonGenBankAssembly, fetchWithRetry} from '../lib';\n\nvar lastBandDataUrl = '';\n\nfunction getBandUrl(bandDataFileNames, taxid, ideo) {\n  return ideo.config.dataDir + bandDataFileNames[taxid];\n}\n\nfunction shouldFetchBands(bandDataFileNames, taxid, ideo) {\n  var bandDataUrl = getBandUrl(bandDataFileNames, taxid, ideo);\n  return (\n    !(typeof window.chrBands !== 'undefined' && lastBandDataUrl === '') ||\n    lastBandDataUrl !== bandDataUrl\n  ) &&\n  hasNonGenBankAssembly(ideo) &&\n  taxid in bandDataFileNames;\n}\n\nfunction setBandData(url, fileNames, chrBands, ideo) {\n  var taxid, fetchedTaxid, fileName;\n\n  // Ensures correct taxid is processed in response callback;\n  // using simply upstream 'taxid' variable gives the last\n  // *requested* taxid, which fails when dealing with multiple taxa.\n  for (taxid in fileNames) {\n    fileName = fileNames[taxid];\n    if (url.includes(fileName) && fileName !== '') {\n      fetchedTaxid = taxid;\n    }\n  }\n\n  ideo.bandData[fetchedTaxid] = chrBands;\n}\n\nfunction fetchBands(bandDataFileNames, taxid, t0, ideo) {\n  var bandDataUrl = getBandUrl(bandDataFileNames, taxid, ideo);\n\n  if (!ideo.numBandDataResponses) ideo.numBandDataResponses = 0;\n\n  return fetchWithRetry(bandDataUrl)\n    .then(function(response) {\n      return response.json().then(function(rawBands) {\n        lastBandDataUrl = bandDataUrl;\n\n        delete window.chrBands; // Remove any previous chrBands variable\n        window.chrBands = rawBands.chrBands;\n\n        setBandData(response.url, bandDataFileNames, chrBands, ideo);\n      });\n    });\n}\n\nexport {shouldFetchBands, fetchBands};\n","/**\n * @fileoveriew Methods for initialization\n */\n\nimport {d3, slug} from '../lib';\nimport {configure} from './configure';\nimport {finishInit} from './finish-init';\nimport {writeContainer} from './write-container';\nimport {shouldFetchBands, fetchBands} from '../bands/fetch';\nimport {organismMetadata} from './organism-metadata';\n\nfunction isHeterogameticChromosome(chrModel, chrIndex, ideo) {\n  var ploidy = ideo.config.ploidy;\n  return (\n    'sex' in ideo.config &&\n      (\n        ploidy === 2 && ideo.sexChromosomes.index + 1 === chrIndex ||\n        ideo.config.sex === 'female' && chrModel.name === 'Y'\n      )\n  );\n}\n\nfunction prepareChromosomes(bandsArray, chrs, taxid, ideo) {\n  var j, bands, chromosome, chrModel, chrIndex;\n\n  for (j = 0; j < chrs.length; j++) {\n    chromosome = chrs[j];\n    if (typeof bandsArray !== 'undefined') bands = bandsArray[j];\n\n    chrIndex = j + ideo.config.taxids.indexOf(taxid);\n    chrModel = ideo.getChromosomeModel(bands, chromosome, taxid, chrIndex);\n\n    if (typeof chromosome !== 'string') {\n      chromosome = chromosome.name.split(' ').slice(-1)[0].replace('chr', '');\n    }\n\n    ideo.chromosomes[taxid][chromosome] = chrModel;\n    ideo.chromosomesArray.push(chrModel);\n\n    if (isHeterogameticChromosome(chrModel, j, ideo)) continue;\n\n    ideo.drawChromosome(chrModel);\n  }\n}\n\nfunction setCoordinateSystem(chrs, ideo) {\n  if (\n    typeof chrBands !== 'undefined' &&\n    chrs.length >= chrBands.length / 2\n  ) {\n    ideo.coordinateSystem = 'bp';\n  }\n}\n\n/**\n * Configures chromosome data and calls downstream chromosome drawing functions\n */\nfunction initDrawChromosomes() {\n  var taxid, i, chrs, bandsArray,\n    ideo = this,\n    taxids = ideo.config.taxids;\n\n  for (i = 0; i < taxids.length; i++) {\n    taxid = taxids[i];\n    chrs = ideo.config.chromosomes[taxid];\n\n    bandsArray = ideo.bandsArray[taxid];\n\n    if (!ideo.config.showNonNuclearChromosomes) {\n      // Remove MT\n      // TODO: Handle other non-nuclear chromosomes, e.g. CP, AP\n      chrs = chrs.filter(chr => chr !== 'MT');\n      if (typeof bandsArray !== 'undefined') {\n        bandsArray = bandsArray.filter(bands => {\n          return bands[0].chr !== 'MT';\n        });\n      }\n    }\n\n    setCoordinateSystem(chrs, ideo);\n\n    ideo.chromosomes[taxid] = {};\n    ideo.setSexChromosomes(chrs);\n\n    prepareChromosomes(bandsArray, chrs, taxid, ideo);\n\n    if (ideo.config.showBandLabels) ideo.drawBandLabels(ideo.chromosomes);\n    ideo.handleRotateOnClick();\n    ideo._gotChrModels = true; // Prevent issue with errant rat centromeres\n  }\n}\n\n/**\n * Attach any click handlers to rotate and toggle chromosomes\n */\nfunction handleRotateOnClick() {\n  var ideo = this;\n\n  if (!('rotatable' in ideo.config && ideo.config.rotatable === false)) {\n    d3.selectAll(ideo.selector + ' .chromosome-set').on('click', function() {\n      // Handles click on chromosome graphic or label.\n      // Label click needed to toggle e.g. human MT\n      const element = this.children[1];\n\n      ideo.rotateAndToggleDisplay(element);\n    });\n  } else {\n    d3.selectAll(ideo.selector).style('cursor', 'default');\n  }\n}\n\n/**\n * Called when Ideogram has finished initializing.\n * Accounts for certain ideogram properties not being set until\n * asynchronous requests succeed, etc.\n */\nfunction onLoad() {\n  call(this.onLoadCallback);\n}\n\nfunction getBandFileName(taxid, accession, ideo) {\n  var organism = ideo.organisms[taxid];\n  var bandFileName = [slug(organism.scientificName)];\n  var assemblies = organism.assemblies;\n  var resolution = ideo.config.resolution;\n\n  if (accession !== assemblies.default) {\n    bandFileName.push(accession);\n  }\n  if (\n    taxid === '9606' &&\n    (accession in assemblies === 'false' &&\n      Object.values(assemblies).includes(config.assembly) ||\n      (resolution !== '' && resolution !== 850))\n  ) {\n    bandFileName.push(resolution);\n  }\n\n  bandFileName = bandFileName.join('-');\n\n  var fullyBandedTaxids = ['9606', '10090', '10116'];\n  if (fullyBandedTaxids.includes(taxid) && !ideo.config.showFullyBanded) {\n    bandFileName += '-no-bands';\n  }\n\n  bandFileName += '.json';\n\n  return bandFileName;\n}\n\nfunction getBandFileNames(taxid, bandFileNames, ideo) {\n  var organism, assemblies, accession, bandFileName,\n    config = ideo.config;\n\n  organism = ideo.organisms[taxid];\n\n  if (!config.assembly) ideo.config.assembly = 'default';\n\n  assemblies = organism.assemblies;\n\n  if (ideo.assemblyIsAccession()) {\n    accession = config.assembly;\n  } else {\n    accession = assemblies[config.assembly];\n  }\n\n  bandFileName = getBandFileName(taxid, accession, ideo);\n  var isCustomOrganism = taxid === '-1';\n\n  if (taxid in ideo.organismsWithBands || isCustomOrganism) {\n    bandFileNames[taxid] = bandFileName;\n  }\n  return bandFileNames;\n}\n\nfunction prepareContainer(taxid, bandFileNames, t0, ideo) {\n\n  if (shouldFetchBands(bandFileNames, taxid, ideo)) {\n    return fetchBands(bandFileNames, taxid, t0, ideo).then(function() {\n      return ideo.processBandData(taxid);\n    });\n  } else {\n    return new Promise(function(resolve) {\n      ideo.processBandData(taxid);\n      resolve([taxid, undefined]);\n    });\n  }\n}\n\nfunction initializeTaxids(ideo) {\n  return new Promise(function(resolve) {\n    var organism = ideo.config.organism;\n    if (typeof organism === 'number') {\n      // 'organism' is a taxid, e.g. 9606\n      ideo.getOrganismFromEutils(organism, function() {\n        ideo.getTaxids(resolve);\n      });\n    } else {\n      ideo.getTaxids(resolve);\n    }\n\n  });\n}\n\nfunction getBandsAndPrepareContainer(taxids, t0, ideo) {\n  var bandFileNames, i, taxid,\n    promises = [];\n\n  bandFileNames = {};\n  for (taxid in organismMetadata) {\n    bandFileNames[taxid] = '';\n  }\n\n  for (i = 0; i < taxids.length; i++) {\n    taxid = String(taxids[i]);\n    bandFileNames = getBandFileNames(taxid, bandFileNames, ideo);\n    promises.push(prepareContainer(taxid, bandFileNames, t0, ideo));\n  }\n\n  Promise.all(promises).then(function(taxidsAndBandsArrays) {\n    var taxidAndBandsArray, taxid, bandsArray;\n\n    for (i = 0; i < taxidsAndBandsArrays.length; i++) {\n      taxidAndBandsArray = taxidsAndBandsArrays[i];\n      taxid = taxidAndBandsArray[0];\n      bandsArray = taxidAndBandsArray[1];\n\n      if ('bandsArray' in ideo === false) {\n        ideo.bandsArray = {};\n      }\n\n      ideo.bandsArray[taxid] = bandsArray;\n    }\n    ideo.writeContainer(t0);\n  });\n}\n\n/**\n * Initializes an ideogram.\n * Sets some high-level properties based on instance configuration,\n * fetches band and annotation data if needed, and\n * writes an SVG element to the document to contain the ideogram\n */\n// Prevents race condition when init is called multiple times in\n// quick succession.\n// See https://github.com/eweitz/ideogram/pull/154.\nvar ideoNext = {};\nvar ideoQueued = {};\nvar ideoWait = {};\n\nfunction init(ideo) {\n  ideo = ideo || this;\n  var containerId = ideo.config.container;\n\n  if (ideoWait[containerId]) {\n    ideoQueued[containerId] = true;\n    ideoNext[containerId] = ideo;\n  } else {\n    ideoWait[containerId] = true;\n    initializeTaxids(ideo)\n      .then(function(taxids) {\n\n        var taxid = taxids[0];\n        ideo.config.taxid = taxid;\n        ideo.config.taxids = taxids;\n\n        ideo.organismScientificName =\n          ideo.getScientificName(ideo.config.taxid);\n\n        var t0 = new Date().getTime();\n        getBandsAndPrepareContainer(taxids, t0, ideo);\n\n        ideoWait[containerId] = false;\n        if (ideoQueued[containerId]) {\n          ideoQueued[containerId] = false;\n          init(ideoNext[containerId]);\n        }\n      });\n  }\n}\n\nexport {\n  configure, initDrawChromosomes, handleRotateOnClick,\n  onLoad, init, finishInit, writeContainer\n};\n","/**\n * @fileoverview Parse raw Ideogram.js annotations from a BED file\n * BED documentation: https://genome.ucsc.edu/FAQ/FAQformat#format1\n */\n\nexport class BedParser {\n\n  constructor(bed, ideo) {\n    this.rawAnnots = this.parseBed(bed, ideo);\n  }\n\n  // http://stackoverflow.com/a/5624139\n  static componentToHex(c) {\n    var hex = parseInt(c, 10).toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  }\n\n  static rgbToHex(r, g, b) {\n    return (\n      '#' +\n      BedParser.componentToHex(r) +\n      BedParser.componentToHex(g) +\n      BedParser.componentToHex(b)\n    );\n  }\n\n  parseGenomicCoordinates(columns, ucscStyle) {\n    var chr, start, stop, length;\n\n    // These three columns (i.e. fields) are required\n    chr = columns[0];\n    start = parseInt(columns[1], 10);\n    stop = parseInt(columns[2], 10);\n\n    length = stop - start;\n\n    if (ucscStyle) {\n      chr = chr.slice(3);\n    }\n\n    return [chr, start, stop, length];\n  }\n\n  /**\n   * Parses an annotation from a tab-separated line of a BED file\n   */\n  parseAnnotFromTsvLine(tsvLine, chrs, ucscStyle) {\n    var annot, chrIndex, chr, start, rgb, color, label,\n      columns = tsvLine.split(/\\s/g);\n\n    [chr, start, stop, length] =\n      this.parseGenomicCoordinates(columns, ucscStyle);\n\n    chrIndex = chrs.indexOf(chr);\n    if (chrIndex === -1) return [null, null];\n\n    annot = ['', start, length, 0];\n\n    if (columns.length >= 4) {\n      label = columns[3];\n      annot[0] = label;\n    }\n\n    if (columns.length >= 8) {\n      rgb = columns[8].split(',');\n      color = BedParser.rgbToHex(rgb[0], rgb[1], rgb[2]);\n      annot.push(color);\n    }\n\n    return [chrIndex, annot];\n  }\n\n  parseRawAnnots(annots, bedStartIndex, tsvLines, chrs) {\n    var i, line, chrIndex, annot, keys, rawAnnots, ucscStyle;\n\n    ucscStyle = true;\n    if (isNaN(parseInt(tsvLines[bedStartIndex], 10)) === false) {\n      ucscStyle = false;\n    }\n\n    for (i = bedStartIndex; i < tsvLines.length; i++) {\n      line = tsvLines[i];\n      [chrIndex, annot] = this.parseAnnotFromTsvLine(line, chrs, ucscStyle);\n      if (chrIndex !== null) annots[chrIndex].annots.push(annot);\n    }\n\n    keys = ['name', 'start', 'length', 'trackIndex'];\n    if (tsvLines[bedStartIndex].length >= 8) keys.push('color');\n\n    rawAnnots = {keys: keys, annots: annots};\n\n    return rawAnnots;\n  }\n\n  /**\n  * Parses a BED file, returns raw annotations\n  */\n  parseBed(bed, ideo) {\n    var i, chrs, chr, bedStartIndex, rawAnnots,\n      annots = [],\n      tsvLines = bed.split(/\\r\\n|\\n/);\n\n    chrs = Object.keys(ideo.chromosomes[ideo.config.taxid]);\n\n    for (i = 0; i < chrs.length; i++) {\n      chr = chrs[i];\n      annots.push({chr: chr, annots: []});\n    }\n\n    bedStartIndex = 0; // 1 if BED has header (i.e. track line), 0 otherwise\n    if (tsvLines[0].slice(0, 3) === 'chr' || isNaN(parseInt(tsvLines[0], 10))) {\n      bedStartIndex = 1;\n    }\n\n    rawAnnots = this.parseRawAnnots(annots, bedStartIndex, tsvLines, chrs);\n    return rawAnnots;\n  }\n\n}\n","/**\n * @fileoverview Parse raw Ideogram.js annotations from a TSV file\n */\n\nimport {camel} from './../lib';\n\nexport class TsvParser {\n\n  constructor(tsv, ideo) {\n    this.rawAnnots = this.parseTsv(tsv, ideo);\n  }\n\n  parseGenomicCoordinates(columns) {\n    // These three columns (i.e. fields) are required\n    const chr = columns[1];\n    const start = parseInt(columns[2], 10);\n    const length = parseInt(columns[3], 10);\n\n    return [chr, start, length];\n  }\n\n  /**\n  * Parses a TSV file, returns raw annotations\n  */\n  parseTsv(tsv, ideo) {\n    const lines = tsv.split(/\\r\\n|\\n/);\n\n    const chrs = Object.keys(ideo.chromosomes[ideo.config.taxid]);\n\n    const annots = [];\n\n    for (let i = 0; i < chrs.length; i++) {\n      const chr = chrs[i];\n      annots.push({chr, annots: []});\n    }\n\n    let headers;\n    const innerKeysByField = {};\n    const customHeaders = [];\n\n    const numRequired = 4;\n    // let numColumns;\n\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i];\n      if (line === '') continue; // Skip empty lines\n\n      // Parse headers\n      if (line[0] === '#') {\n        if (line[1] === '#') {\n          // Parse inner field keys in metainformation lines\n          // E.g. ## differential_expression keys: gene;log2fc;pval_adj\n          const keySplit = line.split(' keys: ');\n          if (keySplit.length > 1) {\n            const field = keySplit[0].slice(3);\n            const keys = keySplit[1].split(';');\n            innerKeysByField[camel(field)] = keys;\n          }\n        } else {\n          // Slice/trim off \"# \", take columns 5 and onward, e.g.:\n          // full_name\\tmentions\\tdifferential_expression\\tinterest_rank\n          headers = line.slice(1).trim().split(/\\t/).map(h => camel(h));\n          // numColumns = headers.length;\n          const customs = headers.slice(numRequired);\n          customs.forEach((custom, i) => customHeaders.push(camel(custom)));\n        }\n        continue;\n      }\n\n      const columns = line.trim().split(/\\t/);\n      const name = columns[0];\n\n      const [chr, start, length] = this.parseGenomicCoordinates(columns);\n      const chrIndex = chrs.indexOf(chr);\n      if (chrIndex === -1) continue;\n\n      const customValues = columns.slice(numRequired);\n      for (let j = 0; j < numRequired; j++) {\n        const customHeader = customHeaders[j];\n        if (customHeader in innerKeysByField) {\n          const innerKeys = innerKeysByField[customHeader]\n          const block = columns[numRequired + j];\n          const group = block.split(';');\n          const customValue = [];\n          if (group[0] !== '') {\n            for (let k = 0; k < group.length; k++) {\n              const innerObj = {};\n              const innerValues = group[k].split('!');\n              for (let m = 0; m < innerValues.length; m++) {\n                const innerKey = innerKeys[m];\n                const innerValue = innerValues[m];\n                innerObj[camel(innerKey)] = innerValue;\n              }\n              customValue.push(innerObj);\n            }\n          }\n          customValues[j] = customValue;\n        }\n      }\n\n      const annot = [name, chr, start, length].concat(customValues);\n      annot.push(i); // Rank in initial file\n\n      annots[chrIndex].annots.push(annot);\n    };\n\n    headers.push('initRank');\n    const rawAnnots = {keys: headers, annots, innerKeysByField};\n    return rawAnnots;\n  }\n}\n","/**\n * @fileoverview Functions used by parallel and collinear heatmaps.\n */\n\nvar reservedTrackKeys = [\n  'name', 'start', 'length', 'trackIndex', 'trackIndexOriginal', 'color'\n];\n\nvar defaultHeatmapColors = {\n  3: ['00B', 'DDD', 'F00'],\n  5: ['00D', '66D', 'DDD', 'F88', 'F00'],\n  17: [\n    '00D', '00D', '00D', '00D', '00D', '44D', '44D', 'DDD', 'DDD',\n    'DDD', 'DDD', 'F88', 'F66', 'F22', 'F22', 'F00', 'F00', 'F00'\n  ]\n};\n\n/**\n * Get label text for displayed tracks from annotation container metadata,\n * heatmap keys, or annotation container keys\n */\nfunction getLabels(ideo) {\n  var annotKeys, labels, heatmaps, i;\n\n  if (ideo.rawAnnots.metadata && ideo.rawAnnots.metadata.trackLabels) {\n    labels = ideo.rawAnnots.metadata.trackLabels;\n  } else if (ideo.config.heatmaps) {\n    labels = [];\n    heatmaps = ideo.config.heatmaps;\n    for (i = 0; i < heatmaps.length; i++) {\n      labels.push(heatmaps[i].key);\n    }\n  } else {\n    annotKeys = ideo.rawAnnots.keys.slice(0);\n    labels = annotKeys.filter(d => !reservedTrackKeys.includes(d));\n  }\n\n  if (ideo.displayedTrackIndexes) {\n    labels = labels.filter(function(d, i) {\n      return ideo.displayedTrackIndexes.includes(i + 1);\n    });\n  }\n\n  return labels;\n}\n\n/**\n * Apply heatmap thresholds that are passed in as annotation metadata\n */\nfunction inflateThresholds(ideo) {\n  var thresholds, colors,\n    rawAnnots = ideo.rawAnnots;\n\n  if (\n    rawAnnots.metadata && !rawAnnots.metadata.heatmapThresholds &&\n    !ideo.config.heatmapThresholds\n  ) {\n    return;\n  }\n\n  if (ideo.config.heatmapThresholds) {\n    thresholds = ideo.config.heatmapThresholds;\n  } else {\n    thresholds = ideo.rawAnnots.metadata.heatmapThresholds;\n  }\n\n  colors = defaultHeatmapColors[thresholds.length + 1];\n  thresholds = thresholds.map((d, i) => {\n    return [d, '#' + colors[i]];\n  });\n\n  thresholds.push(['+', '#' + colors.slice(-1)[0]]);\n\n  return thresholds;\n}\n\n/**\n * Set needed configuration options from raw annotation data.\n * Simplifies heatmap API by inferring reasonable defaults.\n */\nfunction inflateHeatmaps(ideo) {\n  var i, labels, heatmaps, annotationTracks, rawAnnots, displayedTracks,\n    thresholds = ideo.config.heatmapThresholds;\n\n  heatmaps = [];\n  rawAnnots = ideo.rawAnnots;\n  labels = rawAnnots.keys.slice(3);\n\n  annotationTracks = [];\n  displayedTracks = [];\n  if (rawAnnots.metadata || !isNaN(thresholds[0])) {\n    thresholds = inflateThresholds(ideo);\n  }\n\n  for (i = 0; i < labels.length; i++) {\n    heatmaps.push({key: labels[i], thresholds: thresholds});\n    annotationTracks.push({id: labels[i]});\n    displayedTracks.push(i + 1);\n  }\n  ideo.config.annotationsNumTracks = labels.length;\n  ideo.config.annotationsDisplayedTracks = displayedTracks;\n  ideo.config.heatmaps = heatmaps;\n  ideo.config.annotationTracks = annotationTracks;\n}\n\n/**\n * Given annotation value (m), should it use the color in this threshold?\n */\nfunction shouldUseThresholdColor(m, numThresholds, value, prevThreshold,\n  threshold) {\n\n  return (\n    // If this is the last threshold, and\n    // its value is \"+\" and the value is above the previous threshold...\n    m === numThresholds && (\n      threshold === '+' && value > prevThreshold\n    ) ||\n\n    // ... or if the value matches the threshold...\n    value === threshold ||\n\n    // ... or if this isn't the first or last threshold, and\n    // the value is between this threshold and the previous one...\n    m !== 0 && m !== numThresholds && (\n      value <= threshold &&\n      value > prevThreshold\n    ) ||\n\n    // ... or if this is the first threshold and the value is\n    // at or below the threshold\n    m === 0 && value <= threshold\n  );\n}\n\n/**\n * Determine the color of the heatmap annotation.\n */\nfunction getHeatmapAnnotColor(thresholds, value) {\n  var m, numThresholds, thresholdList, threshold, tvNum, thresholdColor,\n    prevThreshold, useThresholdColor, color;\n\n  for (m = 0; m < thresholds.length; m++) {\n    numThresholds = thresholds.length - 1;\n    thresholdList = thresholds[m];\n    threshold = thresholdList[0];\n\n    // The threshold value is usually a number,\n    // but can also be a \"+\" character indicating that\n    // this threshold is anything greater than the previous threshold.\n    tvNum = parseFloat(threshold);\n    if (isNaN(tvNum) === false) threshold = tvNum;\n    if (m !== 0) prevThreshold = parseFloat(thresholds[m - 1][0]);\n    thresholdColor = thresholdList[1];\n\n    useThresholdColor = shouldUseThresholdColor(m, numThresholds, value,\n      prevThreshold, threshold);\n\n    if (useThresholdColor) color = thresholdColor;\n  }\n\n  return color;\n}\n\nexport {\n  getLabels, inflateHeatmaps, inflateThresholds, defaultHeatmapColors,\n  getHeatmapAnnotColor\n};\n","/**\n * @fileoverview Functions for collinear heatmaps of genome annotations.\n * See heatmap.js for more.\n */\n\nimport {d3} from '../lib';\nimport {writeTrackLabels} from './track-labels-collinear';\nimport {inflateHeatmaps} from './heatmap-lib';\n\n/**\n * Add canvases that will contain annotations.  One canvas per track.\n */\nfunction writeCanvases(chr, chrLeft, ideo) {\n  var j, trackLeft, trackWidth, canvas, context, id,\n    chrWidth = chr.width,\n    contextArray = [],\n    annotLabelHeight = ideo.config.annotLabelHeight,\n    numAnnotTracks = ideo.config.numAnnotTracks;\n\n  // Create a canvas for each annotation track on this chromosome\n  for (j = 0; j < numAnnotTracks; j++) {\n    trackWidth = ideo.config.annotationHeight + annotLabelHeight + 4;\n    id = chr.id + '-canvas-' + j; // e.g. chr1-9606-canvas-0\n    trackLeft = chrLeft;\n    if (chr.chrIndex > 0) {\n      trackLeft += (ideo.config.chrMargin * chr.chrIndex) - 1;\n    }\n    canvas = d3.select(ideo.config.container + ' #_ideogramInnerWrap')\n      .append('canvas')\n      .attr('id', id)\n      .attr('width', chrWidth + 1)\n      .attr('height', trackWidth)\n      .style('position', 'absolute')\n      .style('left', trackLeft + 'px')\n      .style('top', (trackWidth * j + 1) + 'px');\n    context = canvas.nodes()[0].getContext('2d');\n    contextArray.push([context, chr]);\n  }\n\n  return contextArray;\n}\n\n/**\n * Render annotations on the canvas\n */\nfunction fillCanvasAnnots(annots, contextArray, ideo) {\n  var j, annot, context, chr,\n    annotLabelHeight = ideo.config.annotLabelHeight,\n    annotHeight = ideo.config.annotationHeight,\n    demarcateChrs = ideo.config.demarcateCollinearChromosomes;\n\n  var trackWidth = annotHeight + annotLabelHeight + 4;\n\n  // Fill in the canvas(es) with annotation colors to draw a heatmap\n  for (j = 0; j < annots.length; j++) {\n    annot = annots[j];\n    context = contextArray[annot.trackIndex][0];\n    chr = contextArray[annot.trackIndex][1];\n    context.fillStyle = annot.color;\n    if (demarcateChrs) {\n      if (annot.startPx < 1 || annot.startPx > chr.width - 1) continue;\n      context.fillRect(annot.startPx, 1, 0.5, trackWidth);\n    } else {\n      context.fillRect(annot.startPx, annotLabelHeight + 1, 0.5, annotHeight);\n    }\n  }\n\n  if (demarcateChrs) {\n    for (j = 0; j < contextArray.length; j++) {\n      context = contextArray[j][0];\n      chr = contextArray[j][1];\n      context.fillStyle = '#555';\n      if (chr.chrIndex === 0) context.fillRect(0, 0, 1, trackWidth);\n      context.fillRect(chr.width - 1, 0, 1.1, trackWidth);\n      context.fillRect(0, 0, chr.width + 1, 1);\n      if (ideo.config.chrMargin) context.fillRect(0, 0, 1.1, trackWidth);\n    }\n  }\n}\n\n/**\n * Draw a 1D heatmap of annotations along each chromosome.\n * Ideal for representing very dense annotation sets in a granular manner\n * without subsampling.\n *\n * TODO:\n * - Support in 'vertical' orientation\n * - Support after rotating chromosome on click\n */\nfunction drawHeatmapsCollinear(annotContainers, ideo) {\n  var annots, chrLeft, contextArray, i, chr,\n    prevX = 0,\n    xBump = (ideo.config.showChromosomesLabels) ? 2 : -0.1;\n\n  d3.select(ideo.selector).classed('labeledLeft', false);\n  d3.selectAll(ideo.config.container + ' canvas').remove();\n\n  // Each \"annotationContainer\" represents annotations for a chromosome\n  for (i = 0; i < annotContainers.length; i++) {\n    annots = annotContainers[i].annots;\n    chr = ideo.chromosomesArray[i];\n    if (i === 0) {\n      chrLeft = 12;\n    } else {\n      chrLeft = prevX + ideo.chromosomesArray[i - 1].width + 14;\n      prevX += ideo.chromosomesArray[i - 1].width + xBump;\n    }\n    contextArray = writeCanvases(chr, chrLeft, ideo);\n    fillCanvasAnnots(annots, contextArray, ideo);\n  }\n\n  writeTrackLabels(ideo);\n\n  if (ideo.onDrawAnnotsCallback) ideo.onDrawAnnotsCallback();\n}\n\nexport {drawHeatmapsCollinear, inflateHeatmaps};\n","/**\n * @fileoverview Functions for 2D heatmaps of genome annotations.\n * 2D heatmaps enable showing many (100+) tracks of data in one dimension,\n * for features (e.g. genes) along a dimension of genomic coordinates in\n * chromosome context.\n *\n * TO DO:\n * - Horizontal orientation\n * - Multiple chromosomes\n * - Non-human organisms\n */\n\nimport {d3} from '../lib';\nimport {getHeatmapAnnotColor} from './heatmap-lib';\n\n/**\n * Add one canvas that will contain all annotations.  One canvas per chromosome.\n */\nfunction writeCanvas(chr, ideoHeight, width, ideo) {\n  var left, canvas, context, id;\n\n  id = chr.id + '-canvas'; // e.g. chr1-9606-canvas\n  left = (ideo.config.chrWidth * 2) + ideo.config.annotationHeight - 0.5;\n  canvas = d3.select(ideo.config.container + ' #_ideogramInnerWrap')\n    .append('canvas')\n    .attr('id', id)\n    .attr('width', width)\n    .attr('height', ideoHeight)\n    .style('position', 'absolute')\n    .style('left', left + 'px')\n    .style('top', '0px');\n  context = canvas.nodes()[0].getContext('2d');\n\n  return context;\n}\n\n/**\n * Render annotations on the canvas.\n *\n * These annotations are 2D; each annotation has many values, each on a track.\n */\nfunction fillCanvasAnnotValues(annot, context, ideo) {\n  var i, x, values,\n    annotHeight = ideo.config.annotationHeight,\n    ideoMarginTop = ideo._layout.margin.top;\n\n  values = annot.values;\n\n  // Fill canvas with annotation colors to draw the heatmap\n  for (i = 0; i < values.length; i++) {\n    context.fillStyle = values[i];\n    x = (i - 1) * annotHeight;\n    context.fillRect(x, annot.startPx + ideoMarginTop, annotHeight, 2);\n  }\n}\n\n/**\n * Draw a 2D heatmap of annotations along one chromosome.\n *\n * TODO:\n * - Support in 'horizontal' orientation\n * - Support after rotating chromosome on click\n */\nfunction drawHeatmaps2d(annotContainers, ideo) {\n  var annot, context, i, chr,\n    container = ideo.config.container,\n    ideoMarginTop = ideo._layout.margin.top,\n    ideoHeight = ideo.config.chrHeight + ideoMarginTop,\n    width = ideo.config.annotationHeight * annotContainers[0].values.length;\n\n  d3.selectAll(container + ' canvas').remove();\n\n  d3.select(container + ' #_ideogramInnerWrap')\n    .style('max-width', width + 'px');\n  d3.select(container + ' #_ideogram').attr('width', width);\n\n  chr = ideo.chromosomesArray[0];\n\n  context = writeCanvas(chr, ideoHeight, width, ideo);\n\n  // Each \"annotationContainer\" represents annotations for a chromosome\n  for (i = 0; i < annotContainers.length; i++) {\n    annot = annotContainers[i];\n    fillCanvasAnnotValues(annot, context, ideo);\n  }\n\n  if (ideo.onDrawAnnotsCallback) {\n    ideo.onDrawAnnotsCallback();\n  }\n}\n\nfunction add2dAnnotsForChr(annots, omittedAnnots, annotsByChr, chrModel,\n  m, keys, ideo) {\n  var j, k, annot, ra, stop, stopPx, color,\n    thresholds = ideo.config.heatmapThresholds;\n\n  for (j = 0; j < annotsByChr.annots.length; j++) {\n    ra = annotsByChr.annots[j];\n    annot = {};\n\n    annot.values = []; // one value per track\n\n    for (k = 0; k < 3; k++) {\n      annot[keys[k]] = ra[k];\n    }\n\n    for (k = 3; k < keys.length; k++) {\n      color = getHeatmapAnnotColor(thresholds, ra[k]);\n      annot.values.push(color);\n    }\n\n    stop = annot.start + annot.length;\n\n    annot.chr = annotsByChr.chr;\n    annot.chrIndex = m;\n    annot.startPx = ideo.convertBpToPx(chrModel, annot.start);\n    stopPx = ideo.convertBpToPx(chrModel, stop);\n    annot.px = Math.round((annot.startPx + stopPx) / 2);\n\n    annots.push(annot);\n  }\n\n  annots.shift();\n\n  return [annots, omittedAnnots];\n}\n\nexport {drawHeatmaps2d, add2dAnnotsForChr};\n","/**\n * @fileoverview Functions for labeling tracks of genome annotations.\n * Tracks are columns of annotations that run beside a chromosome.\n * Labeling tracks with descriptive names makes them easier to understand.\n */\n\nimport {d3} from '../lib';\nimport {getLabels} from './heatmap-lib';\n\n/**\n * Start a timer that, upon expiring, hides the track label.\n *\n * To enable users to copy label content to their clipboard, a timer is\n * used to control when the label disappears.  It starts when the user's\n * cursor leaves the track or the label.  If the user moves the cursor\n * back over the annot or label after the timer starts and before it expires,\n * then the timer is cleared.\n */\nfunction startHideTrackLabelTimeout(ideo) {\n  if (ideo.config.showTrackLabel === false) return;\n\n  ideo.hideTrackLabelTimeout = window.setTimeout(function() {\n    d3.select(ideo.config.container + ' #_ideogramTrackLabel').transition()\n      .duration(500)\n      .style('opacity', 0);\n  }, 250);\n}\n\n/**\n * Write label div setup with default styling.\n */\nfunction writeTrackLabelContainer(ideo) {\n  d3.select(ideo.config.container + ' #_ideogramTrackLabelContainer')\n    .append('div')\n    .attr('id', '_ideogramTrackLabel')\n    .style('opacity', 0)\n    .style('position', 'absolute')\n    .style('text-align', 'center')\n    .style('padding', '1px')\n    .style('font', '11px sans-serif')\n    .style('background', 'white')\n    .style('line-height', '10px')\n    .style('z-index', '9000');\n}\n\n/**\n * Display track labels on the page\n */\nfunction renderTrackLabels(top, left, ideo) {\n  d3.select(ideo.config.container + ' #_ideogramTrackLabel')\n    .style('opacity', 1) // Make label visible\n    .style('left', left + 'px')\n    .style('top', top + 'px')\n    .style('width', 'max-content')\n    .style('transform-origin', 'bottom left')\n    .style('text-align', 'left')\n    .on('mouseover', function() {\n      clearTimeout(ideo.hideTrackLabelTimeout);\n    })\n    .on('mouseout', function() {\n      startHideTrackLabelTimeout(ideo);\n    });\n}\n\n/**\n * Get left and top (x and y) offset for track label text\n */\nfunction getTrackLabelOffsets(labels, trackCanvas, ideo) {\n  var firstTrackId, firstTrack, trackBox, labelBox, ideoBox, left, top,\n    marginHack = 7; // TODO: Make this dynamic\n\n  firstTrackId = trackCanvas.id.split('-').slice(0, -1).join('-') + '-0';\n  firstTrack = d3.select(ideo.config.container + ' #' + firstTrackId)\n    .nodes()[0];\n  trackBox = firstTrack.getBoundingClientRect();\n\n  labelBox = d3.select(ideo.config.container + ' #_ideogramTrackLabel')\n    .nodes()[0].getBoundingClientRect();\n  ideoBox = d3.select(ideo.config.container).nodes()[0]\n    .getBoundingClientRect();\n\n  left = Math.round(trackBox.left + labelBox.width) - trackBox.width - 1;\n  left -= ideoBox.left - marginHack;\n  top = -(labels.split('<br>').length - 2) * trackBox.width + 2;\n\n  return [left, top];\n}\n\n/**\n * Show the label for this track\n */\nfunction showTrackLabel(trackCanvas, ideo) {\n  var labels, left, top;\n\n  clearTimeout(ideo.hideTrackLabelTimeout);\n\n  labels = getLabels(ideo);\n  labels = labels.join('<br>');\n\n  // Clear any previous positioning, write track label text to DOM\n  d3.select(ideo.config.container + ' #_ideogramTrackLabel')\n    .interrupt() // Stop any in-progress disapperance\n    .style('top', '')\n    .style('left', '')\n    .style('transform', null)\n    .style('transform', 'rotate(-90deg)')\n    .html(labels);\n\n  [left, top] = getTrackLabelOffsets(labels, trackCanvas, ideo);\n\n  renderTrackLabels(top, left, ideo);\n}\n\nexport {\n  startHideTrackLabelTimeout, writeTrackLabelContainer, showTrackLabel\n};\n","/**\n * @fileoverview Functions for 2D heatmaps of genome annotations.\n * Heatmaps provide an easy way to visualize very dense annotation data.\n * Unlike the rest of Ideogram's graphics, which use SVG, heatmaps are\n * rendered using the Canvas element.\n */\n\nimport {d3} from '../lib';\nimport {drawHeatmapsCollinear} from './heatmap-collinear';\nimport {drawHeatmaps2d} from './heatmap-2d';\nimport {getHeatmapAnnotColor} from './heatmap-lib';\n\nimport {\n  startHideTrackLabelTimeout, writeTrackLabelContainer, showTrackLabel\n} from './track-labels';\n\n/**\n * Add canvases that will contain annotations.  One canvas per track.\n */\nfunction writeCanvases(chr, chrLeft, ideoHeight, ideo) {\n  var j, trackLeft, trackWidth, canvas, context, id,\n    contextArray = [],\n    numAnnotTracks = ideo.config.numAnnotTracks;\n\n  var marginHack = 7; // TODO: Make this dynamic\n\n  // Create a canvas for each annotation track on this chromosome\n  for (j = 0; j < numAnnotTracks; j++) {\n    trackWidth = ideo.config.annotationHeight;\n    id = chr.id + '-canvas-' + j; // e.g. chr1-9606-canvas-0\n    trackLeft = chrLeft - trackWidth * (numAnnotTracks - j) - marginHack;\n    canvas = d3.select(ideo.config.container + ' #_ideogramInnerWrap')\n      .append('canvas')\n      .attr('id', id)\n      .attr('width', trackWidth)\n      .attr('height', ideoHeight)\n      .style('position', 'absolute')\n      .style('left', trackLeft + 'px');\n    context = canvas.nodes()[0].getContext('2d');\n    contextArray.push(context);\n  }\n\n  return contextArray;\n}\n\n/**\n * Render annotations on the canvas\n */\nfunction fillCanvasAnnots(annots, contextArray, chrWidth, ideoMarginTop) {\n  var j, annot, context, x;\n\n  // Fill in the canvas(es) with annotation colors to draw a heatmap\n  for (j = 0; j < annots.length; j++) {\n    annot = annots[j];\n    context = contextArray[annot.trackIndex];\n    context.fillStyle = annot.color;\n    x = annot.trackIndex - 1;\n    context.fillRect(x, annot.startPx + ideoMarginTop, chrWidth, 0.5);\n  }\n}\n\n/**\n * Draw a 1D heatmap of annotations along each chromosome.\n * Ideal for representing very dense annotation sets in a granular manner\n * without subsampling.\n *\n * TODO:\n * - Support in 'horizontal' orientation\n * - Support after rotating chromosome on click\n */\nfunction drawHeatmaps(annotContainers) {\n  var annots, chrLeft, contextArray, chrWidth, i, chr,\n    ideo = this,\n    config = ideo.config,\n    ideoMarginTop = ideo._layout.margin.top,\n    ideoHeight = config.chrHeight + ideoMarginTop;\n\n  if (config.geometry === 'collinear') {\n    return drawHeatmapsCollinear(annotContainers, ideo);\n  } else if (config.annotationsLayout === 'heatmap-2d') {\n    return drawHeatmaps2d(annotContainers, ideo);\n  }\n\n  d3.selectAll(ideo.config.container + ' canvas').remove();\n\n  writeTrackLabelContainer(ideo);\n\n  // Each \"annotationContainer\" represents annotations for a chromosome\n  for (i = 0; i < annotContainers.length; i++) {\n\n    annots = annotContainers[i].annots;\n    chr = ideo.chromosomesArray[i];\n    chrWidth = ideo.config.chrWidth;\n    chrLeft = ideo._layout.getChromosomeSetYTranslate(i);\n\n    contextArray = writeCanvases(chr, chrLeft, ideoHeight, ideo);\n    fillCanvasAnnots(annots, contextArray, chrWidth, ideoMarginTop);\n  }\n\n  d3.selectAll(ideo.config.container + ' canvas')\n    .on('mouseover', function() {showTrackLabel(this, ideo);})\n    .on('mouseout', function() {startHideTrackLabelTimeout(ideo);});\n\n  if (ideo.onDrawAnnotsCallback) {\n    ideo.onDrawAnnotsCallback();\n  }\n}\n\n/**\n * Set color and track index for raw annotation objects.\n */\nfunction getNewRawAnnots(heatmapKeyIndexes, rawAnnots, ideo) {\n  var j, k, ra, newRa, value, thresholds, color, trackIndex,\n    newRas = [];\n\n  for (j = 0; j < rawAnnots.length; j++) {\n    ra = rawAnnots[j];\n    for (k = 0; k < heatmapKeyIndexes.length; k++) {\n      newRa = ra.slice(0, 3); // name, start, length\n\n      value = ra[heatmapKeyIndexes[k]];\n      thresholds = ideo.config.heatmaps[k].thresholds;\n      color = getHeatmapAnnotColor(thresholds, value);\n\n      trackIndex = k;\n      newRa.push(trackIndex, color, value);\n      newRas.push(newRa);\n    }\n  }\n\n  return newRas;\n}\n\nfunction getNewRawAnnotContainers(heatmapKeyIndexes, rawAnnotBoxes, ideo) {\n  var raContainer, chr, rawAnnots, newRas, i,\n    newRaContainers = [];\n\n  for (i = 0; i < rawAnnotBoxes.length; i++) {\n    raContainer = rawAnnotBoxes[i];\n    chr = raContainer.chr;\n\n    rawAnnots = raContainer.annots;\n    newRas = getNewRawAnnots(heatmapKeyIndexes, rawAnnots, ideo);\n\n    newRaContainers.push({chr: chr, annots: newRas});\n  }\n  return newRaContainers;\n}\n\nfunction reportPerformance(t0, ideo) {\n  var t1 = new Date().getTime();\n  if (ideo.config.debug) {\n    console.log('Time in deserializeAnnotsForHeatmap: ' + (t1 - t0) + ' ms');\n  }\n}\n\n/**\n * Deserialize compressed annotation data into a format suited for heatmaps.\n *\n * This enables the annotations to be downloaded from a server without the\n * requested annotations JSON needing to explicitly specify track index or\n * color.  The track index and color are inferred from the \"heatmaps\" Ideogram\n * configuration option defined before ideogram initialization.\n *\n * This saves time for the user.\n *\n * @param rawAnnotsContainer {Object} Raw annotations as passed from server\n */\nfunction deserializeAnnotsForHeatmap(rawAnnotsContainer) {\n  var newRaContainers, heatmapKey, heatmapKeyIndexes, i,\n    t0 = new Date().getTime(),\n    keys = rawAnnotsContainer.keys,\n    rawAnnotBoxes = rawAnnotsContainer.annots,\n    ideo = this;\n\n  heatmapKeyIndexes = [];\n  for (i = 0; i < ideo.config.heatmaps.length; i++) {\n    heatmapKey = ideo.config.heatmaps[i].key;\n    heatmapKeyIndexes.push(keys.indexOf(heatmapKey));\n  }\n\n  newRaContainers =\n    getNewRawAnnotContainers(heatmapKeyIndexes, rawAnnotBoxes, ideo);\n\n  keys.splice(3, 0, 'trackIndex');\n  keys.splice(4, 0, 'color');\n\n  ideo.rawAnnots.keys = keys;\n  ideo.rawAnnots.annots = newRaContainers;\n\n  reportPerformance(t0, ideo);\n}\n\nexport {drawHeatmaps, deserializeAnnotsForHeatmap};\n","/**\n * @fileoverview Functions for labeling collinear tracks of genome annotations.\n * See track-labels.js for more.\n */\n\nimport {d3} from '../lib';\nimport {getLabels} from './heatmap-lib';\n\nfunction renderTrackLabels(labels, ideo) {\n  var i, x, y, labelContainer, markBump,\n    annotLabelHeight = ideo.config.annotLabelHeight,\n    demarcateChrs = ideo.config.demarcateCollinearChromosomes;\n\n  x = 11; // Close to chrLeft in heatmap-collinear.js.  For tabs.\n  markBump = (demarcateChrs ? 2 : 0); // Make labels flush with demarcations\n\n  labelContainer =\n    d3.select(ideo.config.container + ' #_ideogramTrackLabelContainer');\n  labelContainer.html('');\n\n  y = ideo.config.annotationHeight + annotLabelHeight + 4;\n\n  for (i = 0; i < labels.length; i++) {\n    labelContainer\n      .style('position', 'absolute')\n      .append('div')\n      .attr('class', '_ideogramTrackLabel')\n      .style('opacity', 1)\n      .style('position', 'absolute')\n      .style('text-align', 'center')\n      .style('padding', '1px')\n      .style('font', '11px sans-serif')\n      .style('background', 'white')\n      .style('line-height', '10px')\n      .style('z-index', '5')\n      .style('left', (x + markBump) + 'px')\n      .style('top', (y * i + markBump) + 'px')\n      .style('width', 'max-content')\n      .style('transform-origin', 'bottom left')\n      .style('text-align', 'left')\n      .html(labels[i]);\n  }\n\n}\n\n/**\n * Show the label for this track\n */\nfunction writeTrackLabels(ideo) {\n  var labels = getLabels(ideo);\n  renderTrackLabels(labels, ideo);\n}\n\nexport {writeTrackLabels};\n","import {d3, formatSiPrefix} from '../lib';\n// import {getShapes} from './draw';\n\n/**\n * Optional callback, invoked when annotations are loaded\n */\nfunction onLoadAnnots() {\n  call(this.onLoadAnnotsCallback);\n}\n\nfunction onBeforeDrawAnnots() {\n  call(this.onBeforeDrawAnnotsCallback);\n}\n\n/**\n * Optional callback, invoked when annotations are drawn\n */\nfunction onDrawAnnots() {\n  call(this.onDrawAnnotsCallback);\n}\n\nfunction hideAnnotTooltip() {\n  d3.select('._ideogramTooltip').transition()\n    .duration(500) // fade out for half second\n    .style('opacity', 0)\n    .style('pointer-events', 'none');\n}\n\n/**\n * Starts a timer that, upon expiring, hides the annotation tooltip.\n *\n * To enable users to copy tooltip content to their clipboard, a timer is\n * used to control when the tooltip disappears.  It starts when the user's\n * cursor leaves the annotation or the tooltip.  If the user moves the cursor\n * back over the annot or tooltip after the timer starts and before it expires,\n * then the timer is cleared.\n */\nfunction startHideAnnotTooltipTimeout() {\n  const ideo = this;\n\n  if (ideo.config.showAnnotTooltip === false) {\n    return;\n  }\n\n  // See \"Without this...\" note in gene-structure.js\n  const hideMs = ideo.oneTimeDelayTooltipHideMs ?? 250;\n  delete ideo.oneTimeDelayTooltipHideMs;\n\n  // Hide tooltip after `hideMs` milliseconds\n  ideo.hideAnnotTooltipTimeout = window.setTimeout(function() {\n    hideAnnotTooltip();\n  }, hideMs);\n\n  // Enable clients to not show tooltip immediately after clicking gene,\n  // e.g. in related genes kit\n  ideo.isTooltipCooling = true;\n  ideo.hideAnnotTooltipCounter = window.setTimeout(function() {\n    ideo.isTooltipCooling = false;\n  }, 500);\n}\n\nfunction renderTooltip(tooltip, content, matrix, yOffset, ideo) {\n  tooltip.html(content)\n    .style('opacity', 1) // Make tooltip visible\n    .style('left', matrix.e + 'px')\n    .style('top', (matrix.f - yOffset) + 'px')\n    .style('font-family', ideo.config.fontFamily)\n    .style('pointer-events', null) // Prevent bug in clicking chromosome\n    .on('mouseover', function() {\n      clearTimeout(ideo.hideAnnotTooltipTimeout);\n    })\n    .on('mouseout', function() {\n      ideo.startHideAnnotTooltipTimeout();\n    });\n}\n\nfunction getCoarseBpLength(annot) {\n  const length = Math.abs(annot.stop - annot.start);\n  return formatSiPrefix(length) + 'bp';\n}\n\nfunction getContentAndYOffset(annot, includeLength=false) {\n  var content, yOffset, range, displayName;\n\n  range = 'chr' + annot.chr + ':' + annot.start.toLocaleString();\n  if (annot.displayCoordinates) {\n    range = annot.displayCoordinates;\n  } else if (annot.length > 0) {\n    // Only show range if stop differs from start\n    range += '-' + annot.stop.toLocaleString();\n    if (includeLength) range += ' (' + getCoarseBpLength(annot) + ')';\n  }\n  content = `<span class=\"_ideoTooltipFooter\"><br />${range}</span>`;\n  yOffset = 24;\n\n  if (annot.name) {\n    displayName = annot.displayName ? annot.displayName : annot.name;\n    content = displayName + content;\n    yOffset += 8;\n  }\n\n  return [content, yOffset];\n}\n\n/**\n * Optional callback, invoked before showing annotation tooltip\n */\nfunction onWillShowAnnotTooltip(annot) {\n  call(this.onWillShowAnnotTooltipCallback, annot);\n}\n\nfunction onDidShowAnnotTooltip() {\n  call(this.onDidShowAnnotTooltipCallback);\n}\n\n/**\n * Optional callback, invoked on clicking annotation\n */\nfunction onClickAnnot(annot) {\n  this.prevClickedAnnot = annot;\n  this.onClickAnnotCallback(annot);\n}\n\n// /** Get list of annotation objects by names, e.g. [\"BRCA1\", \"APOE\"] */\n// function getAnnotsByName(annotNames, ideo) {\n//   return annotNames.map(name => getAnnotByName(name, ideo));\n// }\n\n/**\n * Shows a tooltip for the given annotation.\n *\n * See notes in startHideAnnotTooltipTimeout about show/hide logic.\n *\n * @param annot {Object} Processed annotation object\n * @param context {Object} \"This\" of the caller -- an SVG path DOM object\n */\nfunction showAnnotTooltip(annot, context) {\n  var matrix, content, yOffset, tooltip,\n    cx = Number(context.getAttribute('cx')),\n    cy = Number(context.getAttribute('cy')),\n    ideo = this;\n\n  if (ideo.config.showAnnotTooltip === false) return;\n\n  clearTimeout(ideo.hideAnnotTooltipTimeout);\n\n  if (ideo.onWillShowAnnotTooltipCallback) {\n    annot = ideo.onWillShowAnnotTooltipCallback(annot);\n  }\n\n  // Enable onWillShowAnnotTooltipCallback to cancel showing tooltip\n  if (annot === null) {\n    hideAnnotTooltip();\n    return;\n  }\n\n  ideo.prevTooltipAnnotName = annot.name;\n\n  tooltip = d3.select('._ideogramTooltip');\n  tooltip.interrupt(); // Stop any in-progress disapperance\n\n  matrix = context.getScreenCTM().translate(cx, cy);\n\n  const includeLength = true;\n  [content, yOffset] = getContentAndYOffset(annot, includeLength);\n\n  renderTooltip(tooltip, content, matrix, yOffset, ideo);\n\n  if (ideo.onDidShowAnnotTooltipCallback) {\n    ideo.onDidShowAnnotTooltipCallback();\n  }\n}\n\nexport {\n  onLoadAnnots, onBeforeDrawAnnots, onDrawAnnots, startHideAnnotTooltipTimeout,\n  onWillShowAnnotTooltip, showAnnotTooltip, onClickAnnot,\n  onDidShowAnnotTooltip\n};\n","import {d3, getFont, getTextSize, deepCopy, ensureContrast} from '../lib';\n\nimport {sortAnnotsByRank} from './annotations';\n\nconst allLabelStyle = `\n  <style>\n    #_ideogram .annot path, ._ideogramLabel {\n      cursor: pointer;\n    }\n\n    #_ideogram .annot path {\n      stroke-width: 1px;\n      stroke: white;\n      stroke-linejoin: bevel;\n    }\n\n    #_ideogram ._ideogramLabel._ideoActive {\n      fill: #77F !important;\n      stroke: #F0F0FF !important;\n    }\n\n    #_ideogram .annot > ._ideoActive {\n      stroke: #D0D0DD !important;\n      stroke-width: 1.5px;\n    }\n\n    #_ideogram ._ideogramLabel {\n      stroke: white;\n      stroke-width: 5px;\n      stroke-linejoin: round;\n      paint-order: stroke fill;\n      text-align: center;\n    }\n  </style>\n  `;\n\n/** Return DOM ID of annotation object */\nfunction getAnnotDomLabelId(annot) {\n  return 'ideogramLabel_' + annot.domId;\n}\n\nfunction changeAnnotState(state, labelId, annotId) {\n  d3.selectAll('._ideoActive').classed('_ideoActive', false);\n  d3.select('#' + labelId).attr('class', '_ideogramLabel ' + state);\n  d3.select('#' + annotId + ' > path').attr('class', state);\n}\n\nfunction triggerAnnotEvent(event, ideo) {\n  let labelId, annotId;\n  const target = event.target;\n  const type = event.type;\n\n  const targetClasses = Array.from(target.classList);\n  if (targetClasses.includes('_ideogramLabel')) {\n    labelId = target.id;\n    annotId = target.id.split('ideogramLabel_')[1];\n    d3.select('#' + annotId + ' path').dispatch(type);\n  } else {\n    const annotElement = target.parentElement;\n    labelId = 'ideogramLabel_' + annotElement.id;\n    annotId = annotElement.id;\n  }\n\n  if (type === 'mouseout') {\n    ideo.time.prevTooltipOff = performance.now();\n    ideo.time.prevTooltipAnnotDomId = annotId;\n  }\n\n  // On mouseover, activate immediately\n  // Otherwise, wait a moment (250 ms), then deactivate.\n  // Delayed deactivation mitigates flicker when moving from\n  // annot label to annot triangle.\n  if (type === 'mouseover') {\n    clearTimeout(window._ideoActiveTimeout);\n    changeAnnotState('_ideoActive', labelId, annotId);\n  } else {\n    window._ideoActiveTimeout = window.setTimeout(function() {\n      changeAnnotState('', labelId, annotId);\n    }, 250);\n  }\n}\n\nfunction renderLabel(annot, style, ideo) {\n\n  if (!ideo.didSetLabelStyle) {\n    document.querySelector('#_ideogramInnerWrap')\n      .insertAdjacentHTML('afterbegin', allLabelStyle);\n    ideo.didSetLabelStyle = true;\n  }\n\n  const id = getAnnotDomLabelId(annot);\n\n  const font = getFont(ideo);\n\n  let fill = annot.color === 'pink' ? '#CF406B' : annot.color;\n\n  fill = ensureContrast(fill);\n\n  d3.select('#_ideogram').append('text')\n    .attr('id', id)\n    .attr('class', '_ideogramLabel')\n    .attr('x', style.left)\n    .attr('y', style.top)\n    .style('font', font)\n    .style('fill', fill)\n    .style('pointer-events', null) // Prevent bug in clicking chromosome\n    .html(annot.name);\n}\n\n/** Get annotation object by name, e.g. \"BRCA1\" */\nfunction getAnnotByName(annotName, ideo) {\n  var annot;\n  var found = false;\n  ideo.annots.forEach((annotsByChr) => {\n    if (found) return;\n    annotsByChr.annots.forEach((thisAnnot) => {\n      if (found) return;\n      if (thisAnnot.name === annotName) {\n        annot = thisAnnot;\n        found = true;\n      }\n    });\n  });\n\n  return annot;\n}\n\n/** Get label's top and left offsets relative to chromosome, and width */\nfunction getAnnotLabelLayout(annot, ideo) {\n  var annotDom, annotRect, ideoRect, width, height, top, bottom, left, right,\n    config = ideo.config;\n\n  annotDom = document.querySelector('#' + annot.domId);\n\n  // Handles cases when annotation is not yet in DOM\n  if (annotDom === null) return null;\n\n  annotRect = annotDom.getBoundingClientRect();\n\n  ideoRect =\n    document.querySelector('#_ideogram').getBoundingClientRect();\n\n  const textSize = getTextSize(annot.name, ideo);\n  width = textSize.width;\n\n  // `pad` is a heuristic that accounts for:\n  // 1px left pad, 1px right pad, 1px right border, 1px left border\n  // as set in renderLabel\n  const pad = (config.fontFamily) ? 9 : 7;\n  width += pad;\n\n  const labelSize = config.annotLabelSize ? config.annotLabelSize : 13;\n\n  // Accounts for 1px top border, 1px bottom border as set in renderLabel\n  height = labelSize;\n\n  top = annotRect.top - ideoRect.top + height - 1;\n  bottom = top + height;\n  left = annotRect.left - ideoRect.left - width;\n  right = left + width;\n  name = annot.name;\n\n  return {top, bottom, right, left, width, height, name};\n}\n\n/**\n * Label an annotation.\n *\n * @param annotName {String} Name of annotation, e.g. \"BRCA1\"\n * @param backgroundColor {String} Background color.  Default: white.\n * @param backgroundColor {String} Border color.  Default: black.\n */\nfunction addAnnotLabel(annotName, backgroundColor, borderColor) {\n  var annot,\n    ideo = this;\n\n  annot = getAnnotByName(annotName, ideo);\n\n  const layout = getAnnotLabelLayout(annot, ideo);\n  if (layout === null) return;\n\n  const style = Object.assign(layout, {backgroundColor, borderColor});\n\n  renderLabel(annot, style, ideo);\n}\n\nfunction getIsXOverlap(o, n, p) {\n  const oLeft = o.left - p;\n  const nLeft = n.left - p;\n  const oRight = o.right + p;\n  const nRight = n.right + p;\n  // A) oLeft < nLeft && oLeft < nRight && oRight < nRight && oRight > nLeft\n  // o     o\n  // o     o\n  // o     o\n  //\n  //    n      n\n  //    n      n\n  //    n      n\n  //\n  // B) oLeft > nLeft && oLeft < nRight && oRight > nRight && oRight > nLeft\n  //    o     o\n  //    o     o\n  //    o     o\n  //\n  // n     n\n  // n     n\n  // n     n\n  //\n  // C) oLeft < nLeft && oLeft < nRight && oRight > nRight && oRight > nLeft\n  // o         o\n  // o         o\n  // o         o\n  //\n  //    n   n\n  //    n   n\n  //\n  // D) oLeft > nLeft && oLeft < nRight && oRight > nLeft && oRight < nRight\n  //    o   o\n  //    o   o\n  //    o   o\n  //\n  // n         n\n  // n         n\n  // n         n\n  return (\n    (oLeft <= nLeft && oLeft <= nRight && oRight <= nRight && oRight >= nLeft) ||\n    (oLeft >= nLeft && oLeft <= nRight && oRight >= nRight && oRight >= nLeft) ||\n    (oLeft <= nLeft && oLeft <= nRight && oRight >= nRight && oRight >= nLeft) ||\n    (oLeft >= nLeft && oLeft <= nRight && oRight >= nLeft && oRight <= nRight)\n  )\n}\n\nfunction getIsYOverlap(o, n, p) {\n    const oTop = o.top - p;\n    const nTop = n.top - p;\n    const oBottom = o.bottom + p;\n    const nBottom = n.bottom + p;\n    // Top of old annot (o) is above bottom of new annot (n),\n    // and bottom of old annot is below top of new annot\n    //\n    //  A) yOverlap = true\n    //      o.top < n.top && o.top < n.bottom && o.bottom < n.bottom && o.bottom > n.top\n    //    ooooo\n    //            nnnnn\n    //\n    //    ooooo\n    //            nnnnn\n    //\n    //  A.2)\n    //\n    //    ppppp\n    //    ppppp\n    //    ooooo\n    //\n    //            ppppp\n    //    ooooo   ppppp\n    //    ppppp   nnnnn\n    //    ppppp\n    //\n    //            nnnnn\n    //            ppppp\n    //            ppppp\n    //\n    //  B) yOverlap = true\n    //     o.top > n.top && o.top < n.bottom && o.bottom > n.bottom && o.bottom > n.top\n    //            nnnnn\n    //    ooooo\n    //\n    //            nnnnn\n    //    ooooo\n    //\n    //   B.2)\n    //\n    //            ppppp\n    //    ppppp   ppppp\n    //    ppppp   nnnnn\n    //    ooooo\n    //\n    //            nnnnn\n    //    ooooo   ppppp\n    //    ppppp   ppppp\n    //    ppppp\n    //\n    //\n    //  C) yOverlap = false\n    //     old.top < new.top && old.bottom < new.top\n    //    ooooo\n    //\n    //\n    //    ooooo\n    //\n    //          nnnnn\n    //\n    //\n    //          nnnnn\n    //\n    //  D) yOverlap = false\n    //          nnnnn\n    //\n    //\n    //          nnnnn\n    //\n    //    ooooo\n    //\n    //\n    //    ooooo\n    // sl.top - p < layout.bottom && sl.bottom > layout.top - p ||\n    // layout.top - p < sl.bottom && layout.bottom > sl.bottom\n\n    // XY overlap\n    // A)\n    //\n    //  ooooooo\n    //  o     o\n    //  o    nonnnnn\n    //  ooooooo    n\n    //       n     n\n    //       nnnnnnn\n    //\n    //\n    //  B)\n    //       ooooooo\n    //       o     o\n    //  nnnnnnn    o\n    //  n    onooooo\n    //  n     n\n    //  nnnnnnn\n    //\n    //  C)\n    //\n    //  ooooooo   nnnnnnn\n    //  o     o   n     n\n    //  o     o   n     n\n    //  ooooooo   nnnnnnn\n    //\n    //  D)\n    //\n    //  ooooooo\n    //  o     o\n    //  o     o\n    //  ooooooo\n    //\n    //  nnnnnnn\n    //  n     n\n    //  n     n\n    //  nnnnnnn\n    return (\n      // false\n      (oTop <= nTop && oTop <= nBottom && oBottom <= nBottom && oBottom >= nTop) ||\n      (oTop >= nTop && oTop <= nBottom && oBottom >= nBottom && oBottom >= nTop)\n    );\n\n    // (sl.top - p < layout.bottom || sl.bottom > layout.top - p) &&\n    // (layout.top - p < sl.bottom || layout.bottom > sl.bottom)\n}\n\n/** Label as many annotations as possible, without overlap */\nfunction fillAnnotLabels(sortedAnnots=[], numLabels=10) {\n  const ideo = this;\n\n  sortedAnnots = deepCopy(sortedAnnots); // copy by value\n\n  // Remove any pre-existing annotation labels, to avoid duplicates\n  ideo.clearAnnotLabels();\n\n  let spacedAnnots = [];\n  const spacedLayouts = [];\n\n  // sortedAnnots = applyRankCutoff(sortedAnnots, 100, ideo);\n\n  // sortedAnnots = sortedAnnots.sort(ideo.annotSortFunction);\n\n  if (sortedAnnots.length === 0) {\n    sortedAnnots = ideo.flattenAnnots();\n  }\n\n  const strokeWidth = 0; // like padding\n\n  sortedAnnots.forEach((annot, i) => {\n    const layout = getAnnotLabelLayout(annot, ideo);\n\n    if (layout === null) {\n      console.debug(annot.name + ' has null layout');\n      return;\n    }\n\n    const hasOverlap =\n      spacedLayouts.length > 0 && spacedLayouts.some((sl, j) => {\n        const xOverlap = getIsXOverlap(sl, layout, strokeWidth);\n        const yOverlap = getIsYOverlap(sl, layout, strokeWidth);\n\n        // if (annot.name === 'AKT1' || annot.name === 'XRCC3') {\n        //   const spacedAnnot = spacedAnnots[j].name;\n        //   if (spacedAnnot === 'HIF1A' || spacedAnnot === 'RAD51') {\n        //   // if (xOverlap && yOverlap) {\n        //     // console.log('sl.top - strokeWidth', sl.top - strokeWidth)\n        //     // console.log('sl.top - strokeWidth < layout.bottom')\n        //     // console.log(sl.top - strokeWidth < layout.bottom)\n        //     // console.log('sl.bottom > layout.top - strokeWidth')\n        //     // console.log(sl.bottom > layout.top - strokeWidth)\n        //     // console.log('layout.top - strokeWidth < sl.bottom')\n        //     // console.log(layout.top - strokeWidth < sl.bottom)\n        //     // console.log('layout.bottom > sl.bottom')\n        //     // console.log(layout.bottom > sl.bottom)\n        //     console.log(\n        //       'xOverlap, yOverlap, spacedAnnot, sl, annot.name, layout'\n        //     );\n        //     console.log(\n        //       xOverlap, yOverlap, spacedAnnot, sl, annot.name, layout\n        //     );\n        //   }\n        // }\n\n        // if (xOverlap && yOverlap) {\n        //   console.log('overlap! annot');\n        //   console.log(annot.name, annot.chr, annot.color);\n        // }\n        return xOverlap && yOverlap;\n      });\n\n    if (hasOverlap) return;\n\n    spacedAnnots.push(annot);\n    spacedLayouts.push(layout);\n  });\n\n  const config = ideo.config;\n  if (\n    'relatedGenesMode' in config &&\n    ['hints'].includes(config.relatedGenesMode)\n  ) {\n    numLabels = 20;\n  }\n  // spacedAnnots = applyRankCutoff(spacedAnnots, numLabels, ideo);\n  spacedAnnots = spacedAnnots.sort(ideo.annotSortFunction).slice(0, numLabels);\n\n\n  // Ensure highest-ranked annots are ordered last in SVG,\n  // to ensure the are written before lower-ranked annots\n  // (which, due to SVG z-index being tied to layering)\n  spacedAnnots.reverse();\n\n  spacedAnnots.forEach((annot) => {\n    ideo.addAnnotLabel(annot.name);\n  });\n\n  d3.selectAll('._ideogramLabel, .annot')\n    .on('mouseover', (event) => triggerAnnotEvent(event))\n    .on('mouseout', (event) => triggerAnnotEvent(event, ideo))\n    .on('click', (event) => triggerAnnotEvent(event));\n}\n\nfunction removeAnnotLabel(annotName) {\n  const ideo = this;\n  const annot = getAnnotByName(annotName, ideo);\n  const id = getAnnotDomLabelId(annot);\n  document.querySelector('#' + id).remove();\n}\n\nfunction clearAnnotLabels() {\n  const labels = document.querySelectorAll('._ideogramLabel');\n  labels.forEach((label) => {label.remove();});\n}\n\nexport {\n  addAnnotLabel, clearAnnotLabels, fillAnnotLabels, getAnnotLabelLayout,\n  removeAnnotLabel\n};\n","/**\n * Get containers to group individual annotations into higher-level \"bar\"\n * annotations.\n */\nfunction getRawBars(chrModels, ideo) {\n  var chr, chrModel, lastBand, numBins, bar, h, i, px,\n    barWidth = ideo.config.barWidth,\n    bars = [];\n\n  for (h = 0; h < ideo.chromosomesArray.length; h++) {\n    chr = ideo.chromosomesArray[h].name;\n    chrModel = chrModels[chr];\n    lastBand = chrModel.bands[chrModel.bands.length - 1];\n    numBins = Math.round(lastBand.px.stop / barWidth); // chrPxStop / barWidth\n    bar = {chr: chr, annots: []};\n\n    for (i = 0; i < numBins; i++) {\n      px = i * barWidth - ideo.bump;\n      bar.annots.push({\n        bp: ideo.convertPxToBp(chrModel, px + ideo.bump),\n        px: px,\n        count: 0,\n        chrIndex: chrModel.chrIndex,\n        chrName: chr,\n        color: ideo.config.annotationsColor,\n        annots: []\n      });\n    }\n    bars.push(bar);\n  }\n  return bars;\n}\n\n/**\n * Assign how many, and which annotations each histogram bar contains\n */\nfunction assignAnnotsToBars(annots, bars, chrModels, ideo) {\n  var chrAnnots, chrModel, barAnnots, h, i, annot, px, j, barPx, nextBarPx,\n    barWidth = ideo.config.barWidth;\n\n  for (h = 0; h < annots.length; h++) {\n    chrAnnots = annots[h].annots;\n    chrModel = chrModels[annots[h].chr]; // get chr by name\n    barAnnots = bars[chrModel.chrIndex].annots;\n    for (i = 0; i < chrAnnots.length; i++) {\n      annot = chrAnnots[i];\n      px = annot.px - ideo.bump;\n      for (j = 0; j < barAnnots.length; j++) {\n        barPx = barAnnots[j].px;\n        nextBarPx = barPx + barWidth;\n        if (j === barAnnots.length - 1) nextBarPx += barWidth;\n        if (px >= barPx && px < nextBarPx) {\n          bars[chrModel.chrIndex].annots[j].count += 1;\n          bars[chrModel.chrIndex].annots[j].annots.push(annot);\n          break;\n        }\n      }\n    }\n  }\n  return bars;\n}\n\nfunction setIdeoMaxAnnotsPerBar(bars, isFirstGet, ideo) {\n  var maxAnnotsPerBarAllChrs, i, maxAnnotsPerBar, annots, chr, j, barCount;\n\n  if (isFirstGet || ideo.config.histogramScaling === 'relative') {\n    maxAnnotsPerBarAllChrs = 0;\n    for (i = 0; i < bars.length; i++) {\n      maxAnnotsPerBar = 0;\n      annots = bars[i].annots;\n      chr = bars[i].chr;\n      for (j = 0; j < annots.length; j++) {\n        barCount = annots[j].count;\n        if (barCount > maxAnnotsPerBar) maxAnnotsPerBar = barCount;\n        if (barCount > maxAnnotsPerBarAllChrs) {\n          maxAnnotsPerBarAllChrs = barCount;\n        }\n      }\n      ideo.maxAnnotsPerBar[chr] = maxAnnotsPerBar;\n    }\n    ideo.maxAnnotsPerBarAllChrs = maxAnnotsPerBarAllChrs;\n  }\n}\n\n/**\n * Set each bar's height to be proportional to the height of the bar with the\n * most annotations\n */\nfunction setProportionalBarHeight(bars, ideo) {\n  var i, annots, chr, j, barCount, barCountRatio, height,\n    ideoIsRotated = ideo._layout._isRotated;\n\n  for (i = 0; i < bars.length; i++) {\n    annots = bars[i].annots;\n    chr = bars[i].chr;\n    for (j = 0; j < annots.length; j++) {\n      barCount = annots[j].count;\n      if (ideo.config.histogramScaling === 'relative') {\n        barCountRatio = barCount / ideo.maxAnnotsPerBar[chr];\n      } else {\n        barCountRatio = barCount / ideo.maxAnnotsPerBarAllChrs;\n      }\n      if (ideoIsRotated === false) {\n        height = barCountRatio * ideo.config.chrMargin;\n      } else {\n        height = barCountRatio * ideo.config.chrHeightOriginal * 3;\n      }\n      if (isNaN(height)) {\n        height = 0;\n      }\n      bars[i].annots[j].height = height;\n    }\n  }\n  return bars;\n}\n\nfunction reportGetHistogramBarPerformance(t0, ideo) {\n  var t1 = new Date().getTime();\n  if (ideo.config.debug) {\n    console.log('Time spent in getHistogramBars: ' + (t1 - t0) + ' ms');\n  }\n}\n\nfunction setIdeoHistogramScaling(ideo) {\n  if ('histogramScaling' in ideo.config === false) {\n    ideo.config.histogramScaling = 'absolute';\n  }\n}\n\n/**\n * Returns and sets bars used for histogram\n */\nfunction getHistogramBars(annots) {\n  var chrModels, bars,\n    isFirstGet = false,\n    t0 = new Date().getTime(),\n    ideo = this;\n\n  chrModels = ideo.chromosomes[ideo.config.taxid];\n\n  setIdeoHistogramScaling(ideo);\n\n  if (typeof ideo.maxAnnotsPerBar === 'undefined') {\n    ideo.maxAnnotsPerBar = {};\n    isFirstGet = true;\n  }\n\n  bars = getRawBars(chrModels, ideo);\n  bars = assignAnnotsToBars(annots, bars, chrModels, ideo);\n\n  setIdeoMaxAnnotsPerBar(bars, isFirstGet, ideo);\n  bars = setProportionalBarHeight(bars, ideo);\n\n  reportGetHistogramBarPerformance(t0, ideo);\n  ideo.bars = bars;\n  return bars;\n}\n\nfunction getHistogramPoints(d, chrWidth, chrWidths, ideo) {\n  var x1, x2, y1, y2;\n\n  x1 = d.px + ideo.bump;\n  x2 = d.px + ideo.config.barWidth + ideo.bump;\n  y1 = chrWidth;\n  y2 = chrWidth + d.height;\n\n  var thisChrWidth = chrWidths[d.chr];\n\n  if (x2 > thisChrWidth) {\n    x2 = thisChrWidth;\n  }\n\n  return (\n    x1 + ',' + y1 + ' ' +\n    x2 + ',' + y1 + ' ' +\n    x2 + ',' + y2 + ' ' +\n    x1 + ',' + y2\n  );\n}\n\nfunction writeHistogramAnnots(chrAnnot, ideo) {\n  var chrs, chr,\n    chrWidths = {},\n    chrWidth = ideo.config.chrWidth;\n\n  chrs = ideo.chromosomes[ideo.config.taxid];\n  for (chr in chrs) {\n    chrWidths[chr] = chrs[chr];\n  }\n\n  chrAnnot.append('polygon')\n    // .attr('id', function(d, i) { return d.id; })\n    .attr('class', 'annot')\n    .attr('points', function(d) {\n      return getHistogramPoints(d, chrWidth, chrWidths, ideo);\n    })\n    .attr('fill', function(d) {return d.color;});\n}\n\nexport {getHistogramBars, writeHistogramAnnots};\n","/**\n * @fileoverview Functions for drawing a legend for genome annotations.\n * A legend consists of rows, each with a colored icon and a text label.\n * Icons may have different shapes.  A legend may also have a name.\n */\n\nimport {d3, getTextSize, round} from '../lib';\n\nvar legendStyle =\n  '#_ideogramLegend {font: 12px Arial; overflow: auto; cursor: default;} ' +\n  '#_ideogramLegend svg {float: left;} ' +\n  '#_ideogramLegend ul {' +\n    'position: relative; left: -14px; list-style: none; float: left; ' +\n    'padding-left: 10px; margin: 0 0 1em 0; width: auto; border: none;' +\n  '} ' +\n  '#_ideogramLegend li {float: none; margin: 0;}' +\n  '#_ideogramLegend ul span {position: relative; left: -15px;} ';\n\nexport function getIcon(row, ideo) {\n  var icon, triangleAttrs, circleAttrs, rectAttrs,\n    fill = 'fill=\"' + row.color + '\" style=\"stroke: #AAA;\"',\n    shape = row.shape;\n\n  triangleAttrs = 'd=\"m7,3 l -5 9 l 9 0 z\"';\n  circleAttrs = 'd=\"m2,9a 4.5,4.5 0 1,0 9,0a 4.5,4.5 0 1,0 -9,0\"';\n  rectAttrs = 'height=\"10\" width=\"10\" y=\"3\"';\n\n  if ('shape' in row && ['circle', 'triangle'].includes(shape)) {\n    if (shape === 'circle') {\n      icon = '<path ' + circleAttrs + ' ' + fill + '></path>';\n    } else if (shape === 'triangle') {\n      var transform = '';\n      if (ideo.config.orientation === 'vertical') {\n        // Orient arrows in legend as they are in annotations\n        transform = ' transform=\"rotate(90, 7, 7)\"';\n      }\n      if (ideo.config.orientation === 'down') {\n        transform = ' transform=\"rotate(180, 7, 7)\"';\n      }\n      icon = '<path ' + triangleAttrs + transform + ' ' + fill + '></path>';\n    }\n  } else {\n    icon = '<rect ' + rectAttrs + ' ' + fill + '/>';\n  }\n\n  return icon;\n}\n\nfunction getListItems(labels, svg, list, nameHeight, ideo) {\n  var i, icon, y, row,\n    lineHeight = getLineHeight(ideo);\n\n  for (i = 0; i < list.rows.length; i++) {\n    row = list.rows[i];\n    labels += '<li class=\"_ideoLegendEntry\">' + row.name + '</li>';\n    y = lineHeight * (i - 1) + nameHeight + 1;\n    if ('name' in list) y += lineHeight;\n    icon = getIcon(row, ideo);\n    const transform = 'translate(0, ' + y + ')';\n    svg += '<g transform=\"' + transform + '\">' + icon + '</g>';\n  }\n\n  return [labels, svg];\n}\n\nfunction getLineHeight(ideo) {\n  return round(getTextSize('A', ideo).height) * 2 + 0.5;\n}\n\n/**\n * Display a legend for genome annotations, using `legend` configuration option\n */\nfunction writeLegend(ideo) {\n  var i, legend, svg, labels, list, content,\n    config = ideo.config,\n    lineHeight = getLineHeight(ideo);\n\n  d3.select(config.container + ' #_ideogramLegend').remove();\n\n  legend = config.legend;\n  content = '';\n\n  for (i = 0; i < legend.length; i++) {\n    list = legend[i];\n    let nameHeight = lineHeight;\n    if (list.nameHeight) {\n      nameHeight = list.nameHeight;\n    }\n    let nameStyle = '';\n    if (nameHeight) {\n      nameStyle =\n        `style=\"height: ${nameHeight}px; ` +\n        `position: relative; ` +\n        `left: -${nameHeight - 5}px;\"`;\n    }\n    if ('name' in list) {\n      labels =\n        `<li class=\"_ideoLegendName\" ${nameStyle}>` + list.name + `</li>`;\n    }\n    svg = '<svg id=\"_ideogramLegendSvg\" width=\"' + lineHeight + '\">';\n    [labels, svg] = getListItems(labels, svg, list, nameHeight, ideo);\n    svg += '</svg>';\n    content += svg + '<ul>' + labels + '</ul>';\n  }\n\n  var fontFamily = `font-family: ${config.fontFamily};`;\n  var lineHeightCss = `line-height: ${getLineHeight(ideo)}px;`;\n  legendStyle +=\n    `#_ideogramLegend {${fontFamily} ${lineHeightCss}}`;\n\n  var target = d3.select(config.container + ' #_ideogramOuterWrap');\n  target.append('style').html(legendStyle);\n  target.append('div').attr('id', '_ideogramLegend').html(content);\n}\n\nexport {writeLegend};\n","import {d3} from '../lib';\nimport {writeHistogramAnnots} from './histogram';\nimport {writeLegend} from './legend';\n\nfunction parseFriendlyAnnots(friendlyAnnots, rawAnnots) {\n  var i, j, annot, rawAnnot;\n\n  for (i = 0; i < friendlyAnnots.length; i++) {\n    annot = friendlyAnnots[i];\n\n    for (j = 0; j < rawAnnots.length; j++) {\n      if (annot.chr === rawAnnots[j].chr) {\n        rawAnnot = [\n          annot.name,\n          annot.start,\n          annot.stop - annot.start\n        ];\n        if ('color' in annot) rawAnnot.push(annot.color);\n        if ('shape' in annot) rawAnnot.push(annot.shape);\n        rawAnnots[j].annots.push(rawAnnot);\n        break;\n      }\n    }\n  }\n\n  return rawAnnots;\n}\n\nfunction parseFriendlyKeys(friendlyAnnots) {\n  var keys = ['name', 'start', 'length'];\n  if ('color' in friendlyAnnots[0]) {\n    keys.push('color');\n  }\n  if ('shape' in friendlyAnnots[0]) {\n    keys.push('shape');\n  }\n  return keys;\n}\n\n/**\n * Draws annotations defined by user\n */\nfunction drawAnnots(friendlyAnnots, layout, keep=false, isOtherLayout=false) {\n  var keys, chr,\n    rawAnnots = [],\n    ideo = this,\n    chrs = ideo.chromosomes[ideo.config.taxid]; // TODO: multiorganism\n\n  if (friendlyAnnots.length === 0) {\n    ideo.annots = [];\n    return;\n  }\n\n  if (\n    'annots' in friendlyAnnots[0] || // When filtering\n    'values' in friendlyAnnots[0] // When drawing cached expression matrices\n  ) {\n    return ideo.drawProcessedAnnots(friendlyAnnots, layout);\n  }\n\n  for (chr in chrs) {\n    rawAnnots.push({chr: chr, annots: []});\n  }\n  rawAnnots = parseFriendlyAnnots(friendlyAnnots, rawAnnots);\n\n  keys = parseFriendlyKeys(friendlyAnnots);\n\n  ideo.rawAnnots = {keys: keys, annots: rawAnnots};\n\n  const processedAnnots = ideo.processAnnotData(ideo.rawAnnots);\n  if (!isOtherLayout) {\n    ideo.annots = processedAnnots;\n  } else {\n    ideo.annotsOther = processedAnnots;\n  }\n\n  ideo.drawProcessedAnnots(processedAnnots, layout, keep);\n}\n\nfunction getShapes(annotHeight) {\n  var triangle, circle, rectangle, r;\n\n  triangle =\n    'm0,0 l -' + annotHeight + ' ' + (2 * annotHeight) +\n    ' l ' + (2 * annotHeight) + ' 0 z';\n\n  // From http://stackoverflow.com/a/10477334, with a minor change (\"m -r, r\")\n  // Circles are supported natively via <circle>, but having it as a path\n  // simplifies handling triangles, circles and other shapes in the same\n  // D3 call\n  r = annotHeight;\n  circle =\n    'm -' + r + ', ' + r +\n    'a ' + r + ',' + r + ' 0 1,0 ' + (r * 2) + ',0' +\n    'a ' + r + ',' + r + ' 0 1,0 -' + (r * 2) + ',0';\n\n  rectangle =\n    'm0,0 l 0 ' + (2 * annotHeight) +\n    'l ' + annotHeight + ' 0' +\n    'l 0 -' + (2 * annotHeight) + 'z';\n\n  return {triangle: triangle, circle: circle, rectangle: rectangle};\n}\n\nfunction getChrAnnotNodes(filledAnnots, ideo) {\n  return d3.selectAll(ideo.selector + ' .chromosome')\n    .data(filledAnnots)\n    .selectAll('path.annot')\n    .data(function(d) {\n      return d.annots;\n    })\n    .enter();\n}\n\nfunction determineShape(d, shapes) {\n  if (!d.shape || d.shape === 'triangle') {\n    return shapes.triangle;\n  } else if (d.shape === 'circle') {\n    return shapes.circle;\n  } else if (d.shape === 'rectangle') {\n    return shapes.rectangle;\n  } else {\n    return d.shape;\n  }\n}\n\nfunction writeTrackAnnots(chrAnnot, ideo) {\n  var shapes,\n    annotHeight = ideo.config.annotationHeight;\n\n  shapes = getShapes(annotHeight);\n\n  chrAnnot.append('g')\n    .attr('id', function(d) {return d.domId;})\n    .attr('class', 'annot')\n    .attr('transform', function(d) {\n      var y = ideo.config.chrWidth + (d.trackIndex * annotHeight * 2);\n      return 'translate(' + d.px + ',' + y + ')';\n    })\n    .append('path')\n    .attr('d', function(d) {return determineShape(d, shapes);})\n    .attr('fill', function(d) {return d.color;})\n    .on('mouseover', function(event, d) {ideo.showAnnotTooltip(d, this);})\n    .on('mouseout', function() {ideo.startHideAnnotTooltipTimeout();})\n    .on('click', function(event, d) {ideo.onClickAnnot(d);});\n}\n\n/**\n * Overlaid annotations appear directly on chromosomes\n */\nfunction writeOverlayAnnots(chrAnnot, ideo) {\n  chrAnnot.append('polygon')\n    .attr('id', function(d) {return d.id;})\n    .attr('class', 'annot')\n    .attr('points', function(d) {\n      var x1, x2,\n        chrWidth = ideo.config.chrWidth;\n\n      if (d.stopPx - d.startPx > 1) {\n        x1 = d.startPx;\n        x2 = d.stopPx;\n      } else {\n        x1 = d.px - 0.5;\n        x2 = d.px + 0.5;\n      }\n\n      return (\n        x1 + ',' + chrWidth + ' ' + x2 + ',' + chrWidth + ' ' +\n        x2 + ',0 ' + x1 + ',0'\n      );\n    })\n    .attr('fill', function(d) {return d.color;})\n    .on('mouseover', function(event, d) {ideo.showAnnotTooltip(d, this);})\n    .on('mouseout', function() {ideo.startHideAnnotTooltipTimeout();});\n}\n\nfunction warnIfTooManyAnnots(layout, annots) {\n  var i, numAnnots;\n\n  if (!/heatmap/.test(layout) && layout !== 'histogram') {\n    numAnnots = 0;\n    for (i = 0; i < annots.length; i++) {\n      numAnnots += annots[i].annots.length;\n    }\n    if (numAnnots > 2000) {\n      console.warn(\n        'Rendering more than 2000 annotations in Ideogram?\\n' +\n        'Try setting \"annotationsLayout\" to \"heatmap\" or \"histogram\" in your ' +\n        'Ideogram configuration object for better layout and performance.'\n      );\n    }\n  }\n}\n\nfunction drawAnnotsByLayoutType(layout, annots, ideo) {\n  var filledAnnots, chrAnnot;\n\n  warnIfTooManyAnnots(layout, annots);\n\n  if (layout === 'histogram') annots = ideo.getHistogramBars(annots);\n\n  filledAnnots = ideo.fillAnnots(annots);\n\n  chrAnnot = getChrAnnotNodes(filledAnnots, ideo);\n\n  if (layout === 'tracks') {\n    writeTrackAnnots(chrAnnot, ideo);\n  } else if (layout === 'overlay') {\n    writeOverlayAnnots(chrAnnot, ideo);\n  } else if (layout === 'histogram') {\n    writeHistogramAnnots(chrAnnot, ideo);\n  }\n}\n\n/**\n * Draws genome annotations on chromosomes.\n * Annotations can be rendered as either overlaid directly\n * on a chromosome, or along one or more \"tracks\"\n * running parallel to each chromosome.\n */\nfunction drawProcessedAnnots(annots, layout, keep=false) {\n  var ideo = this;\n\n  if (ideo.onBeforeDrawAnnotsCallback) {\n    ideo.onBeforeDrawAnnotsCallback();\n  }\n\n  if (!keep) {\n    d3.selectAll(ideo.selector + ' .annot').remove();\n  }\n\n  if (layout === undefined) layout = 'tracks';\n  if (ideo.config.annotationsLayout) layout = ideo.config.annotationsLayout;\n\n  if ('legend' in ideo.config) writeLegend(ideo);\n\n  if (/heatmap/.test(layout)) {\n    ideo.drawHeatmaps(annots);\n    return;\n  }\n\n  drawAnnotsByLayoutType(layout, annots, ideo);\n  if (ideo.onDrawAnnotsCallback) ideo.onDrawAnnotsCallback();\n}\n\nexport {drawAnnots, drawProcessedAnnots, getShapes};\n","import {d3} from '../lib';\n\nexport function writeSyntenicRegion(syntenies, regionID, ideo) {\n  return syntenies.append('g')\n    .attr('class', 'syntenicRegion')\n    .attr('id', regionID)\n    .on('click', function() {\n      var activeRegion = this;\n      var others = d3.selectAll(ideo.selector + ' .syntenicRegion')\n        .filter(function() {return (this !== activeRegion);});\n\n      others.classed('hidden', !others.classed('hidden'));\n    })\n    .on('mouseover', function() {\n      var activeRegion = this;\n      d3.selectAll(ideo.selector + ' .syntenicRegion')\n        .filter(function() {return (this !== activeRegion);})\n        .classed('ghost', true);\n    })\n    .on('mouseout', function() {\n      d3.selectAll(ideo.selector + ' .syntenicRegion')\n        .classed('ghost', false);\n    });\n}\n\nexport function writeSyntenicRegionPolygons(\n  syntenicRegion, x1, x2, r1, r2, regions\n) {\n  var color, opacity;\n\n  color = ('color' in regions) ? regions.color : '#CFC';\n  opacity = ('opacity' in regions) ? regions.opacity : 1;\n\n  syntenicRegion.append('polygon')\n    .attr('points',\n      x1 + ', ' + r1.startPx + ' ' +\n      x1 + ', ' + r1.stopPx + ' ' +\n      x2 + ', ' + r2.stopPx + ' ' +\n      x2 + ', ' + r2.startPx\n    )\n    .style('fill', color)\n    .style('fill-opacity', opacity);\n}\n\nexport function writeSyntenicRegionPolygonsHorizontal(\n  syntenicRegion, y1, y2, r1, r2, regions\n) {\n  var color, opacity;\n\n  color = ('color' in regions) ? regions.color : '#CFC';\n  opacity = ('opacity' in regions) ? regions.opacity : 1;\n\n  syntenicRegion.append('polygon')\n    .attr('points',\n      (r1.startPx - 15) + ', ' + y1 + ' ' +\n      (r1.stopPx - 15) + ', ' + y1 + ' ' +\n      (r2.stopPx - 15) + ', ' + y2 + ' ' +\n      (r2.startPx - 15) + ', ' + y2\n    )\n    .style('fill', color)\n    .style('fill-opacity', opacity);\n}\n\nexport function getRegionsR1AndR2(regions, ideo, xOffset = null) {\n  var r1, r2,\n    r1Offset, r2Offset;\n\n  r1 = regions.r1;\n  r2 = regions.r2;\n\n  if (typeof r1.chr === 'string') {\n    const taxids = ideo.config.taxids;\n    if (ideo.config.multiorganism) {\n      r1.chr = ideo.chromosomes[taxids[0]][r1.chr];\n      r2.chr = ideo.chromosomes[taxids[1]][r2.chr];\n    } else {\n      r1.chr = ideo.chromosomes[taxids[0]][r1.chr];\n      r2.chr = ideo.chromosomes[taxids[0]][r2.chr];\n    }\n  }\n\n  var r1ChrDom = document.querySelector('#' + r1.chr.id + '-chromosome-set');\n  var r1GenomeHorizontalXOffset = r1ChrDom.getCTM().e;\n  var r1GenomeVerticalXOffset = r1ChrDom.getCTM().f;\n  var r2ChrDom = document.querySelector('#' + r2.chr.id + '-chromosome-set');\n  // var r2GenomeOffset = r2ChrDom.getBoundingClientRect().top;\n  var r2GenomeHorizontalXOffset = r2ChrDom.getCTM().e;\n  var r2GenomeVerticalXOffset = r2ChrDom.getCTM().f;\n\n  if (xOffset === null) {\n    if (ideo.config.orientation === 'vertical') {\n      // When vertical collinear\n      // http://localhost:8080/examples/vanilla/compare-whole-genomes?chromosome-scale=absolute&orientation=vertical\n      r1Offset = r1GenomeVerticalXOffset - 12;\n      r2Offset = r2GenomeVerticalXOffset - 12;\n    } else {\n      // When horizontal collinear, e.g.\n      // http://localhost:8080/examples/vanilla/compare-whole-genomes?chromosome-scale=absolute&orientation=horizontal\n      r1Offset = r1GenomeHorizontalXOffset;\n      r2Offset = r2GenomeHorizontalXOffset;\n    }\n  } else {\n    // When horizontal parallel\n    r1Offset = xOffset;\n    r2Offset = xOffset;\n  }\n\n  r1.startPx = ideo.convertBpToPx(r1.chr, r1.start) + r1Offset;\n  r1.stopPx = ideo.convertBpToPx(r1.chr, r1.stop) + r1Offset;\n  r2.startPx = ideo.convertBpToPx(r2.chr, r2.start) + r2Offset;\n  r2.stopPx = ideo.convertBpToPx(r2.chr, r2.stop) + r2Offset;\n\n  return [r1, r2];\n}\n","import {d3} from '../lib';\nimport {\n  getRegionsR1AndR2, writeSyntenicRegionPolygons, writeSyntenicRegion\n} from './synteny-lib';\n\nfunction writeSyntenicRegionLines(syntenicRegion, x1, x2, r1, r2) {\n  syntenicRegion.append('line')\n    .attr('class', 'syntenyBorder')\n    .attr('x1', x1)\n    .attr('x2', x2)\n    .attr('y1', r1.startPx)\n    .attr('y2', r2.startPx);\n\n  syntenicRegion.append('line')\n    .attr('class', 'syntenyBorder')\n    .attr('x1', x1)\n    .attr('x2', x2)\n    .attr('y1', r1.stopPx)\n    .attr('y2', r2.stopPx);\n}\n\nfunction writeSyntenicRegions(syntenicRegions, syntenies, ideo) {\n  var i, regions, r1, r2, regionID, syntenicRegion, chrWidth, x1, x2;\n\n  for (i = 0; i < syntenicRegions.length; i++) {\n    regions = syntenicRegions[i];\n\n    [r1, r2] = getRegionsR1AndR2(regions, ideo);\n\n    regionID = (\n      r1.chr.id + '_' + r1.start + '_' + r1.stop + '_' +\n      '__' +\n      r2.chr.id + '_' + r2.start + '_' + r2.stop\n    );\n\n    syntenicRegion = writeSyntenicRegion(syntenies, regionID, ideo);\n\n    chrWidth = ideo.config.chrWidth;\n    x1 = chrWidth + 51;\n    x2 = chrWidth + 245; // Genomes are spaced ~200 pixels apart\n\n    writeSyntenicRegionPolygons(syntenicRegion, x1, x2, r1, r2, regions);\n    writeSyntenicRegionLines(syntenicRegion, x1, x2, r1, r2);\n  }\n}\n\nfunction reportPerformance(t0, ideo) {\n  var t1 = new Date().getTime();\n  if (ideo.config.debug) {\n    console.log('Time in drawSyntenicRegions: ' + (t1 - t0) + ' ms');\n  }\n}\n\n/**\n * Draws a trapezoid connecting a genomic range on\n * one chromosome to a genomic range on another chromosome;\n * a syntenic region.\n */\nfunction drawSyntenyCollinear(syntenicRegions, ideo) {\n  var syntenies,\n    t0 = new Date().getTime();\n\n  syntenies = d3.select(ideo.selector)\n    .insert('g', ':first-child')\n    .attr('class', 'synteny');\n\n  writeSyntenicRegions(syntenicRegions, syntenies, ideo);\n\n  reportPerformance(t0, ideo);\n}\n\nexport {drawSyntenyCollinear};\n","import {d3} from '../lib';\nimport {\n  getRegionsR1AndR2, writeSyntenicRegionPolygonsHorizontal, writeSyntenicRegion\n} from './synteny-lib';\n\nfunction writeSyntenicRegionLines(syntenicRegion, y1, y2, r1, r2) {\n  syntenicRegion.append('line')\n    .attr('class', 'syntenyBorder')\n    .attr('x1', r1.startPx - 15)\n    .attr('x2', r2.startPx - 15)\n    .attr('y1', y1)\n    .attr('y2', y2);\n\n  syntenicRegion.append('line')\n    .attr('class', 'syntenyBorder')\n    .attr('x1', r1.stopPx - 15)\n    .attr('x2', r2.stopPx - 15)\n    .attr('y1', y1)\n    .attr('y2', y2);\n}\n\nfunction writeSyntenicRegions(syntenicRegions, syntenies, ideo) {\n  var i, regions, r1, r2, regionID, syntenicRegion, chrWidth, y1, y2;\n\n  for (i = 0; i < syntenicRegions.length; i++) {\n    regions = syntenicRegions[i];\n\n    [r1, r2] = getRegionsR1AndR2(regions, ideo);\n\n    regionID = (\n      r1.chr.id + '_' + r1.start + '_' + r1.stop + '_' +\n      '__' +\n      r2.chr.id + '_' + r2.start + '_' + r2.stop\n    );\n\n    syntenicRegion = writeSyntenicRegion(syntenies, regionID, ideo);\n\n    chrWidth = ideo.config.chrWidth;\n    y1 = chrWidth + 31;\n    y2 = chrWidth + 191; // Genomes are spaced ~200 pixels apart\n\n    writeSyntenicRegionPolygonsHorizontal(\n      syntenicRegion, y1, y2, r1, r2, regions\n    );\n    writeSyntenicRegionLines(syntenicRegion, y1, y2, r1, r2);\n  }\n}\n\nfunction reportPerformance(t0, ideo) {\n  var t1 = new Date().getTime();\n  if (ideo.config.debug) {\n    console.log('Time in drawSyntenicRegions: ' + (t1 - t0) + ' ms');\n  }\n}\n\n/**\n * Draws a trapezoid connecting a genomic range on\n * one chromosome to a genomic range on another chromosome;\n * a syntenic region.\n */\nfunction drawSyntenyCollinearHorizontal(syntenicRegions, ideo) {\n  var syntenies,\n    t0 = new Date().getTime();\n\n  syntenies = d3.select(ideo.selector)\n    .insert('g', ':first-child')\n    .attr('class', 'synteny');\n\n  writeSyntenicRegions(syntenicRegions, syntenies, ideo);\n\n  reportPerformance(t0, ideo);\n}\n\nexport {drawSyntenyCollinearHorizontal};\n","import {d3} from '../lib';\nimport {drawSyntenyCollinear} from './synteny-collinear';\nimport {drawSyntenyCollinearHorizontal} from './synteny-collinear-horizontal';\nimport {\n  getRegionsR1AndR2, writeSyntenicRegionPolygons, writeSyntenicRegion\n} from './synteny-lib';\n\nfunction writeSyntenicRegionLines(syntenicRegion, x1, x2, r1, r2, regions) {\n\n  var stroke, width;\n  if (\n    Math.abs(r1.startPx - r1.startPx) < 2 &&\n    Math.abs(r1.stopPx - r1.stopPx) < 2\n  ) {\n    stroke = regions.color;\n    width = regions.width;\n  } else {\n    stroke = '';\n    width = '';\n  }\n\n  syntenicRegion.append('line')\n    .attr('class', 'syntenyBorder')\n    .attr('x1', x1)\n    .attr('x2', x2)\n    .attr('y1', r1.startPx)\n    .attr('y2', r2.startPx)\n    .style('stroke', stroke)\n    .style('stroke-width', width);\n\n  syntenicRegion.append('line')\n    .attr('class', 'syntenyBorder')\n    .attr('x1', x1)\n    .attr('x2', x2)\n    .attr('y1', r1.stopPx)\n    .attr('y2', r2.stopPx)\n    .style('stroke', stroke)\n    .style('stroke-width', stroke);\n}\n\nfunction writeSyntenicRegionLabels(syntenicRegion, x1, x2, r1, r2, regionId) {\n  var rangeIds = regionId.split('__').map(d => 'label_' + d);\n  if ('name' in r1) {\n    syntenicRegion.append('text')\n      .attr('id', rangeIds[0])\n      .attr('y', r1.startPx + 3)\n      .text(r1.name);\n    var r1Width =\n      document.querySelector('#' + rangeIds[0]).getBoundingClientRect().width;\n    d3.select('#' + rangeIds[0]).attr('x', x1 - 15 - r1Width);\n  }\n  if ('name' in r2) {\n    syntenicRegion.append('text')\n      .attr('id', rangeIds[1])\n      .text(r2.name)\n      .attr('x', x2 + 15)\n      .attr('y', r2.startPx + 3)\n      .text(r2.name);\n  }\n}\n\nfunction writeSyntenicRegions(syntenicRegions, syntenies, xOffset, ideo) {\n  var i, regions, r1, r2, regionID, syntenicRegion, chrWidth, x1, x2;\n\n  for (i = 0; i < syntenicRegions.length; i++) {\n    regions = syntenicRegions[i];\n\n    [r1, r2] = getRegionsR1AndR2(regions, ideo, xOffset);\n\n    regionID = (\n      r1.chr.id + '_' + r1.start + '_' + r1.stop + '_' +\n      '__' +\n      r2.chr.id + '_' + r2.start + '_' + r2.stop\n    );\n\n    syntenicRegion = writeSyntenicRegion(syntenies, regionID, ideo);\n\n    chrWidth = ideo.config.chrWidth;\n    x1 = ideo._layout.getChromosomeSetYTranslate(0);\n    x2 = ideo._layout.getChromosomeSetYTranslate(1) - chrWidth;\n\n    writeSyntenicRegionPolygons(syntenicRegion, x1, x2, r1, r2, regions);\n    writeSyntenicRegionLines(syntenicRegion, x1, x2, r1, r2, regions);\n    writeSyntenicRegionLabels(syntenicRegion, x1, x2, r1, r2, regionID);\n  }\n}\n\nfunction reportPerformance(t0, ideo) {\n  var t1 = new Date().getTime();\n  if (ideo.config.debug) {\n    console.log('Time in drawSyntenicRegions: ' + (t1 - t0) + ' ms');\n  }\n}\n\n/**\n * Draws a trapezoid connecting a genomic range on\n * one chromosome to a genomic range on another chromosome;\n * a syntenic region.\n */\nfunction drawSynteny(syntenicRegions) {\n  var syntenies, xOffset,\n    t0 = new Date().getTime(),\n    ideo = this,\n    config = ideo.config;\n\n  // Make synteny / orthologs readable from client apps\n  ideo.syntenicRegions = syntenicRegions;\n\n  if (\n    config.multiorganism &&\n    config.geometry === 'collinear'\n  ) {\n    if (config.orientation === 'vertical') {\n      return drawSyntenyCollinear(syntenicRegions, ideo);\n    } else {\n      return drawSyntenyCollinearHorizontal(syntenicRegions, ideo);\n    }\n  }\n\n  syntenies = d3.select(ideo.selector)\n    .insert('g', ':first-child')\n    .attr('class', 'synteny');\n\n  xOffset = ideo._layout.margin.left;\n\n  writeSyntenicRegions(syntenicRegions, syntenies, xOffset, ideo);\n\n  reportPerformance(t0, ideo);\n}\n\nexport {drawSynteny};\n","import {d3} from '../lib';\nimport collinearizeChromosomes from '../collinear';\n\n/**\n * Reset displayed tracks to those originally displayed\n */\nfunction restoreDefaultTracks() {\n  var ideo = this;\n  ideo.config.numAnnotTracks = ideo.config.annotationsNumTracks;\n  d3.selectAll(ideo.selector + ' .annot').remove();\n  ideo.drawAnnots(ideo.processAnnotData(ideo.rawAnnots));\n}\n\nfunction getDisplayedRawAnnotsByChr(annotsByChr, trackIndexes) {\n  var annot, displayedRawAnnotsByChr, annots, i, displayedAnnots, j,\n    trackIndex;\n\n  displayedRawAnnotsByChr = [];\n\n  // Filter displayed tracks by selected track indexes\n  for (i = 0; i < annotsByChr.length; i++) {\n    annots = annotsByChr[i];\n    displayedAnnots = [];\n    for (j = 0; j < annots.annots.length; j++) {\n      annot = annots.annots[j].slice(); // copy array by value\n      trackIndex = annot[3] + 1;\n      if (trackIndexes.includes(trackIndex)) {\n        annot[3] = trackIndexes.indexOf(trackIndex);\n        displayedAnnots.push(annot);\n      }\n    }\n    displayedRawAnnotsByChr.push({chr: annots.chr, annots: displayedAnnots});\n  }\n\n  return displayedRawAnnotsByChr;\n}\n\n/**\n * Adds or removes tracks from the displayed list of tracks.\n * Only works when raw annotations are dense.\n *\n * @param trackIndexes Array of indexes of tracks to display\n */\nfunction updateDisplayedTracks(trackIndexes) {\n  var displayedRawAnnotsByChr, displayedAnnots, rawAnnots,\n    ideo = this,\n    annotsByChr = ideo.rawAnnots.annots;\n\n  ideo.config.numAnnotTracks = trackIndexes.length;\n\n  displayedRawAnnotsByChr =\n    getDisplayedRawAnnotsByChr(annotsByChr, trackIndexes);\n  rawAnnots = {keys: ideo.rawAnnots.keys, annots: displayedRawAnnotsByChr};\n\n  if (ideo.config.geometry === 'collinear') {\n    collinearizeChromosomes(ideo);\n  }\n\n  displayedAnnots = ideo.processAnnotData(rawAnnots);\n\n  d3.selectAll(ideo.selector + ' .annot').remove();\n  ideo.displayedTrackIndexes = trackIndexes;\n  ideo.drawAnnots(displayedAnnots);\n\n  return displayedAnnots;\n}\n\nfunction getSetAnnotsByChr(annotsByChr, ideo) {\n  var i, j, annots, annot, setAnnots, trackIndexOriginal, numAvailTracks,\n    setAnnotsByChr = [];\n\n  numAvailTracks = 1;\n\n  for (i = 0; i < annotsByChr.length; i++) {\n    annots = annotsByChr[i];\n    setAnnots = [];\n    for (j = 0; j < annots.annots.length; j++) {\n      annot = annots.annots[j].slice();\n      trackIndexOriginal = annot[3];\n      if (trackIndexOriginal + 1 > numAvailTracks) {\n        numAvailTracks = trackIndexOriginal + 1;\n      }\n      annot.splice(4, 0, trackIndexOriginal);\n      setAnnots.push(annot);\n    }\n    setAnnotsByChr.push({chr: annots.chr, annots: setAnnots});\n  }\n\n  ideo.numAvailTracks = numAvailTracks;\n\n  return setAnnotsByChr;\n}\n\nfunction setOriginalTrackIndexes(rawAnnots) {\n  var keys, annotsByChr, setAnnotsByChr,\n    ideo = this;\n\n  keys = rawAnnots.keys;\n\n  // If this method is unnecessary, pass through\n  if (\n    keys.length < 4 ||\n    keys[3] !== 'trackIndex' ||\n    keys[4] === 'trackIndexOriginal'\n  ) {\n    return rawAnnots;\n  }\n\n  annotsByChr = rawAnnots.annots;\n  setAnnotsByChr = getSetAnnotsByChr(annotsByChr, ideo);\n\n  keys.splice(4, 0, 'trackIndexOriginal');\n  rawAnnots = {keys: keys, annots: setAnnotsByChr};\n  if (ideo.rawAnnots.metadata) rawAnnots.metadata = ideo.rawAnnots.metadata;\n\n  return rawAnnots;\n}\n\nexport {restoreDefaultTracks, setOriginalTrackIndexes, updateDisplayedTracks};\n","import {add2dAnnotsForChr} from './heatmap-2d';\nimport {setAnnotRanks} from './annotations';\n\n// Default colors for tracks of annotations\nvar colorMap = [\n  ['F00'], // If there is 1 track, then color it red.\n  ['F00', '88F'], // If 2 tracks, color one red and one light blue.\n  ['F00', 'CCC', '88F'], // If 3, color one red, one grey, one light blue.\n  ['F00', 'FA0', '0AF', '88F'], // And so on.\n  ['F00', 'FA0', 'CCC', '0AF', '88F'],\n  ['F00', 'FA0', '875', '578', '0AF', '88F'],\n  ['F00', 'FA0', '875', 'CCC', '578', '0AF', '88F'],\n  ['F00', 'FA0', '7A0', '875', '0A7', '578', '0AF', '88F'],\n  ['F00', 'FA0', '7A0', '875', 'CCC', '0A7', '578', '0AF', '88F'],\n  ['F00', 'FA0', '7A0', '875', '552', '255', '0A7', '578', '0AF', '88F']\n];\n\n/**\n * Ensure annotation containers are ordered by chromosome.\n */\nfunction orderAnnotContainers(annots, ideo) {\n  var unorderedAnnots, i, j, annot, chr, chrs;\n\n  unorderedAnnots = annots;\n  annots = [];\n  chrs = ideo.chromosomesArray;\n  for (i = 0; i < chrs.length; i++) {\n    chr = chrs[i].name;\n    for (j = 0; j < unorderedAnnots.length; j++) {\n      annot = unorderedAnnots[j];\n      if (annot.chr === chr) {\n        annots.push(annot);\n      }\n    }\n  }\n\n  return annots;\n}\n\n/**\n * Add client annotations, as in annotations-tracks.html\n */\nfunction addClientAnnot(annots, annot, ra, m, ideo) {\n  var annotTrack;\n\n  annot.trackIndex = ra[3];\n  annotTrack = ideo.config.annotationTracks[annot.trackIndex];\n  if (annotTrack.color) {\n    annot.color = annotTrack.color;\n  }\n  if (annotTrack.shape) {\n    annot.shape = annotTrack.shape;\n  }\n\n  annots[m].annots.push(annot);\n\n  return annots;\n}\n\n/**\n * Add sparse server annotations, as in annotations-track-filters.html\n */\nfunction addSparseServerAnnot(annot, ra, omittedAnnots, annots, m, ideo) {\n  var colors = colorMap[ideo.numAvailTracks - 1];\n\n  annot.trackIndex = ra[3];\n  annot.trackIndexOriginal = ra[4];\n  annot.color = '#' + colors[annot.trackIndexOriginal];\n\n  // Catch annots that will be omitted from display\n  if (annot.trackIndex > ideo.config.numTracks - 1) {\n    if (annot.trackIndex in omittedAnnots) {\n      omittedAnnots[annot.trackIndex].push(annot);\n    } else {\n      omittedAnnots[annot.trackIndex] = [annot];\n    }\n    return [annots, omittedAnnots];\n  }\n  annots[m].annots.push(annot);\n\n  return [annots, omittedAnnots];\n}\n\n/**\n * Basic client annotations, as in annotations-basic.html\n * and annotations-external.html\n */\nfunction addBasicClientAnnot(annots, annot, m, ideo) {\n  annot.trackIndex = 0;\n  if (!annot.color) {\n    annot.color = ideo.config.annotationsColor;\n  }\n  if (!annot.shape) {\n    annot.shape = 'triangle';\n  }\n  annots[m].annots.push(annot);\n\n  return annots;\n}\n\nfunction addAnnot(annot, keys, ra, omittedAnnots, annots, m, ideo) {\n\n  if (ideo.config.annotationTracks) {\n    annots = addClientAnnot(annots, annot, ra, m, ideo);\n  } else if (keys[3] === 'trackIndex' && ideo.numAvailTracks !== 1) {\n    [annots, omittedAnnots] =\n      addSparseServerAnnot(annot, ra, omittedAnnots, annots, m, ideo);\n  // } else if (\n  //   keys.length > 3 &&\n  //   keys[3] in {trackIndex: 1, color: 1, shape: 1} === false &&\n  //   keys[4] === 'trackIndexOriginal'\n  // ) {\n  //   annots = addDenseServerAnnot(keys, annots, annot, m);\n  } else {\n    annots = addBasicClientAnnot(annots, annot, m, ideo);\n  }\n\n  return [annots, omittedAnnots];\n}\n\nfunction getAnnotDomId(chrIndex, annotIndex) {\n  return '_c' + chrIndex + '_a' + annotIndex;\n}\n\nfunction addAnnotsForChr(annots, omittedAnnots, annotsByChr, chrModel,\n  m, keys, ideo) {\n  var j, k, annot, ra;\n\n  // Assign DOM ID if annots are rendered as individual DOM elements\n  const shouldAssignDomId = (\n    !ideo.config.annotationsLayout ||\n    ideo.config.annotationsLayout === 'tracks'\n  );\n\n  for (j = 0; j < annotsByChr.annots.length; j++) {\n    ra = annotsByChr.annots[j];\n    annot = {};\n\n    for (k = 0; k < keys.length; k++) {\n      annot[keys[k]] = ra[k];\n    }\n\n    annot.stop = annot.start + annot.length;\n\n    annot.chr = annotsByChr.chr;\n    annot.chrIndex = m;\n    annot.startPx = ideo.convertBpToPx(chrModel, annot.start);\n    annot.stopPx = ideo.convertBpToPx(chrModel, annot.stop);\n    annot.px = Math.round((annot.startPx + annot.stopPx) / 2);\n    if (shouldAssignDomId) annot.domId = getAnnotDomId(m, j);\n\n    [annots, omittedAnnots] =\n      addAnnot(annot, keys, ra, omittedAnnots, annots, m, ideo);\n  }\n\n  if (shouldAssignDomId) {\n    if (ideo.annotSortFunction) {\n      annots[m].annots = setAnnotRanks(annots[m].annots, ideo);\n      annots[m].annots.sort((a, b) => {\n        // Reverse-sort, so first annots are drawn last, and thus at top layer\n        return -ideo.annotSortFunction(a, b);\n      });\n    } else {\n      // Sort by genomic position, in ascending order\n      annots[m].annots.sort((a, b) => a[1] - b[1]);\n    }\n\n    for (j = 0; j < annots[m].annots.length; j++) {\n      annots[m].annots[j].domId = getAnnotDomId(m, j);\n    }\n  }\n\n  return [annots, omittedAnnots];\n}\n\nfunction warnOfUndefinedChromosome(annotsByChr) {\n  console.warn(\n    'Chromosome \"' + annotsByChr.chr + '\" undefined in ideogram; ' +\n    annotsByChr.annots.length + ' annotations not shown'\n  );\n}\n\nfunction addAnnots(rawAnnots, keys, ideo) {\n  var m, i, annotsByChr, chrModel,\n    annots = [],\n    omittedAnnots = {};\n\n  m = -1;\n  for (i = 0; i < rawAnnots.length; i++) {\n    annotsByChr = rawAnnots[i];\n    chrModel = ideo.chromosomes[ideo.config.taxid][annotsByChr.chr];\n\n    if (typeof chrModel === 'undefined') {\n      warnOfUndefinedChromosome(annotsByChr);\n      continue;\n    }\n\n    m++;\n    annots.push({chr: annotsByChr.chr, annots: []});\n\n    if (ideo.config.annotationsLayout !== 'heatmap-2d') {\n      [annots, omittedAnnots] =\n        addAnnotsForChr(annots, omittedAnnots, annotsByChr, chrModel, m,\n          keys, ideo);\n    } else {\n      [annots, omittedAnnots] =\n        add2dAnnotsForChr(annots, omittedAnnots, annotsByChr, chrModel, m,\n          keys, ideo);\n    }\n  }\n  return [annots, omittedAnnots];\n}\n\nfunction sendTrackAndAnnotWarnings(omittedAnnots, ideo) {\n  var numOmittedTracks,\n    layout = ideo.config.annotationsLayout,\n    numTracks = ideo.config.numAnnotTracks;\n\n  if (!/heatmap/.test(layout) && numTracks > 10) {\n    console.error(\n      'Ideogram only displays up to 10 tracks at a time.  ' +\n      'You specified ' + numTracks + ' tracks.  ' +\n      'Perhaps consider a different way to visualize your data.'\n    );\n  }\n\n  numOmittedTracks = Object.keys(omittedAnnots).length;\n  if (numOmittedTracks) {\n    console.warn(\n      'Ideogram configuration specified ' + numTracks + ' tracks, ' +\n      'but loaded annotations contain ' + numOmittedTracks + ' ' +\n      'extra tracks.'\n    );\n  }\n}\n\n/**\n * Proccesses genome annotation data.\n *\n * This method converts raw annotation data from server, which is structured as\n * an array of arrays, into a more verbose data structure consisting of an\n * array of objects.  It also adds pixel offset information.\n */\nfunction processAnnotData(rawAnnots) {\n  var keys, annots, omittedAnnots,\n    ideo = this;\n\n  keys = rawAnnots.keys;\n  rawAnnots = rawAnnots.annots;\n\n  [annots, omittedAnnots] = addAnnots(rawAnnots, keys, ideo);\n  annots = orderAnnotContainers(annots, ideo);\n\n  sendTrackAndAnnotWarnings(omittedAnnots, ideo);\n\n  return annots;\n}\n\nexport {processAnnotData, getAnnotDomId};\n","/**\n * @fileoverview Parse raw Ideogram.js annotations from an expression matrix.\n * This module handles dense gene expression matrixes.\n * In gene expression expressions, rows are genes and columns are cells.\n */\n\nexport class ExpressionMatrixParser {\n\n  /**\n   * @param {String} matrix Tab-delimited gene expression matrix\n   * @param {Object} coordinates Coordinates [chr, start, length] by gene name\n   * @param {Object} ideo Ideogram object\n   */\n  constructor(matrix, ideo) {\n    this.matrix = matrix;\n    this.ideo = ideo;\n  }\n\n  /**\n   * Initialize rawAnnots by fetching genomic coordinates, then merging them\n   * with the gene expression matrix supplied in constructor.\n   */\n  setRawAnnots() {\n    var parser, ideo, matrix;\n    parser = this;\n    ideo = this.ideo;\n    matrix = this.matrix;\n\n    return new Promise(function(resolve) {\n      parser.rawAnnots = parser.fetchCoordinates(ideo)\n        .then(function(coordinates) {\n          parser.coordinates = coordinates;\n          resolve(parser.parseExpressionMatrix(matrix, ideo));\n        });\n    });\n  }\n\n  /**\n   * Get chromosome, start and stop coordinates from genome annotation file\n   *\n   * TODO: Support non-human organisms\n   */\n  fetchCoordinates(ideo) {\n    var coordinates = {};\n\n    if (ideo.config.organism === 'human') {\n      var ensemblData =\n        ideo.config.dataDir +\n        '../../annotations/Homo_sapiens,_Ensembl_80.tsv';\n\n      return new Promise(function(resolve) {\n        ideo.fetch(ensemblData, 'text').then(function(data) {\n          // eslint-disable-next-line no-unused-vars\n          var tsvLines, i, start, stop, gene, chr, length;\n\n          tsvLines = data.split(/\\r\\n|\\n/).slice(1);\n          for (i = 0; i < tsvLines.length; i++) {\n            [start, stop, gene, , chr] = tsvLines[i].split(/\\s/g);\n            start = parseInt(start);\n            stop = parseInt(stop);\n            length = stop - start;\n            coordinates[gene] = [chr, start, length];\n          }\n          resolve(coordinates);\n        });\n      });\n    } else {\n      throw Error('Expression matrix parsing is only supported for human');\n    }\n  }\n\n  /**\n   * Parses an annotation from a tab-separated line of a matrix file\n   */\n  parseAnnotFromTsvLine(tsvLine, chrs) {\n    var annot, chrIndex, chr, start, gene, expressions,\n      columns = tsvLine.split(/\\s/g);\n\n    gene = columns[0];\n    if (gene in this.coordinates === false) return [null, null];\n\n    expressions = columns.slice(1).map(d => parseFloat(d));\n    [chr, start, length] = this.coordinates[gene];\n\n    chrIndex = chrs.indexOf(chr);\n    if (chrIndex === -1) return [null, null];\n\n    annot = [gene, start, length];\n    annot = annot.concat(expressions);\n\n    return [chrIndex, annot];\n  }\n\n  /**\n  * Parses a gene expression matrix file, returns raw annotations\n  */\n  parseExpressionMatrix(matrix, ideo) {\n    var i, chrs, rawAnnots, cells, line, chrIndex, annot, keys,\n      annots = [],\n      tsvLines = matrix.split(/\\r\\n|\\n/);\n\n    chrs = Object.keys(ideo.chromosomes[ideo.config.taxid]);\n    for (i = 0; i < chrs.length; i++) {\n      annots.push({chr: chrs[i], annots: []});\n    }\n\n    for (i = 1; i < tsvLines.length; i++) {\n      line = tsvLines[i];\n      [chrIndex, annot] = this.parseAnnotFromTsvLine(line, chrs);\n      if (chrIndex !== null) annots[chrIndex].annots.push(annot);\n    }\n\n    cells = tsvLines[0].split(/\\s/g);\n    keys = ['name', 'start', 'length'].concat(cells);\n    rawAnnots = {keys: keys, annots: annots};\n\n    return rawAnnots;\n  }\n\n}\n","function downloadAnnotations() {\n\n  const ideo = this;\n  const annots = {};\n\n  ideo.annots.forEach(chrAnnots => {\n    chrAnnots.annots.forEach(annot => {\n      const desc = ideo.annotDescriptions.annots[annot.name];\n\n      annots[annot.name] = [\n        annot.name, desc.ensemblId,\n        annot.chr, annot.start, annot.stop, annot.length,\n        desc.type\n      ];\n    });\n  });\n\n  const header = [\n    '# Gene name', 'Ensembl ID', 'Chromosome', 'Start', 'Stop', 'Length', 'Type'\n  ];\n  const rows = [header].concat(Object.values(annots));\n  const annotsTsv =\n    ideo.annotDescriptions.headers + '\\n#\\n' +\n    rows.map(row => row.join('\\t')).join('\\n');\n\n  const annotsHref =\n    'data:text/plain;charset=utf-8,' + encodeURIComponent(annotsTsv);\n\n  var evt = new MouseEvent('click', {\n    view: window,\n    bubbles: false,\n    cancelable: true\n  });\n\n  var a = document.createElement('a');\n  a.setAttribute('download', 'ideogram.tsv');\n  a.setAttribute('href', annotsHref);\n  a.setAttribute('target', '_blank');\n\n  // Enables easy testing\n  a.setAttribute('id', '_ideo-undisplayed-dl-annots-link');\n  a.setAttribute('style', 'display: none;');\n  document.body.appendChild(a);\n\n  a.dispatchEvent(evt);\n}\n\nexport {downloadAnnotations};\n","/**\n * @fileoverview Methods for ideogram annotations.\n * Annotations are graphical objects that represent features of interest\n * located on the chromosomes, e.g. genes or variations.  They can\n * appear beside a chromosome, overlaid on top of it, or between multiple\n * chromosomes.\n */\n\nimport {BedParser} from '../parsers/bed-parser';\nimport {TsvParser} from '../parsers/tsv-parser';\nimport {drawHeatmaps, deserializeAnnotsForHeatmap} from './heatmap';\nimport {inflateThresholds} from './heatmap-lib';\nimport {inflateHeatmaps} from './heatmap-collinear';\nimport {\n  onLoadAnnots, onDrawAnnots, startHideAnnotTooltipTimeout,\n  onWillShowAnnotTooltip, onDidShowAnnotTooltip, showAnnotTooltip, onClickAnnot\n} from './events';\n\nimport {\n  addAnnotLabel, removeAnnotLabel, fillAnnotLabels, clearAnnotLabels\n  // fadeOutAnnotLabels\n} from './labels';\n\nimport {drawAnnots, drawProcessedAnnots} from './draw';\nimport {getHistogramBars} from './histogram';\nimport {drawSynteny} from './synteny';\nimport {\n  restoreDefaultTracks, setOriginalTrackIndexes, updateDisplayedTracks\n} from './filter';\nimport {processAnnotData} from './process';\nimport {ExpressionMatrixParser} from '../parsers/expression-matrix-parser';\nimport {downloadAnnotations} from './download';\n\nfunction initNumTracksAndBarWidth(ideo, config) {\n\n  if (config.annotationTracks) {\n    ideo.config.numAnnotTracks = config.annotationTracks.length;\n  } else if (config.annotationsNumTracks) {\n    ideo.config.numAnnotTracks = config.annotationsNumTracks;\n  } else {\n    ideo.config.numAnnotTracks = 1;\n  }\n  ideo.config.annotTracksHeight =\n    config.annotationHeight * config.numAnnotTracks;\n\n  if (typeof config.barWidth === 'undefined') {\n    ideo.config.barWidth = 3;\n  }\n}\n\nfunction initTooltip(ideo, config) {\n  if (config.showAnnotTooltip !== false) {\n    ideo.config.showAnnotTooltip = true;\n  }\n\n  if (config.onWillShowAnnotTooltip) {\n    ideo.onWillShowAnnotTooltipCallback = config.onWillShowAnnotTooltip;\n  }\n\n  if (config.onDidShowAnnotTooltip) {\n    ideo.onDidShowAnnotTooltipCallback = config.onDidShowAnnotTooltip;\n  }\n}\n\nfunction initAnnotLabel(ideo, config) {\n  if (config.addAnnotLabel !== false) {\n    ideo.config.addAnnotLabel = true;\n  }\n\n  if (config.onWillAddAnnotLabel) {\n    ideo.onWillAddAnnotLabelCallback = config.onWillAddAnnotLabel;\n  }\n}\n\nfunction initAnnotHeight(ideo) {\n  var config = ideo.config;\n  var annotHeight;\n\n  if (!config.annotationHeight) {\n    if (config.annotationsLayout === 'heatmap') {\n      annotHeight = config.chrWidth - 1;\n    } else {\n      annotHeight = Math.round(config.chrHeight / 100);\n      if (annotHeight < 3) annotHeight = 3;\n    }\n    ideo.config.annotationHeight = annotHeight;\n  }\n}\n\n/**\n * Initializes various annotation settings.  Constructor help function.\n */\nfunction initAnnotSettings() {\n  var ideo = this,\n    config = ideo.config;\n\n  initAnnotHeight(ideo);\n\n  if (\n    config.annotationsPath || config.localAnnotationsPath ||\n    ideo.annots || config.annotations\n  ) {\n    initNumTracksAndBarWidth(ideo, config);\n  } else {\n    ideo.config.annotTracksHeight = 0;\n    ideo.config.numAnnotTracks = 0;\n  }\n\n  if (typeof config.annotationsColor === 'undefined') {\n    ideo.config.annotationsColor = '#F00';\n  }\n\n  if (config.onClickAnnot) {\n    ideo.onClickAnnotCallback = config.onClickAnnot;\n  }\n\n  initTooltip(ideo, config);\n  initAnnotLabel(ideo, config);\n}\n\nfunction validateAnnotsUrl(annotsUrl) {\n  var tmp, extension;\n\n  tmp = annotsUrl.split('?')[0].split('.');\n  extension = tmp[tmp.length - 1];\n\n  if (['bed', 'json', 'tsv'].includes(extension) === false) {\n    extension = extension.toUpperCase();\n    alert(\n      'Ideogram.js only supports BED and Ideogram JSON and TSV ' +\n      'at the moment.  ' +\n      'Sorry, check back soon for ' + extension + ' support!'\n    );\n    return;\n  }\n  return extension;\n}\n\n/** Find redundant chromosomes in raw annotations */\nfunction detectDuplicateChrsInRawAnnots(ideo) {\n  const seen = {};\n  const duplicates = [];\n  const chrs = ideo.rawAnnots.annots.map(annot => annot.chr);\n\n  chrs.forEach((chr) => {\n    if (chr in seen) duplicates.push(chr);\n    seen[chr] = 1;\n  });\n\n  if (duplicates.length > 0) {\n    const message =\n      `Duplicate chromosomes detected.\\n` +\n      `Chromosome list: ${chrs}.  Duplicates: ${duplicates}.\\n` +\n      `To fix this, edit your raw annotations JSON data to remove redundant ` +\n      `chromosomes.`;\n    throw Error(message);\n  }\n}\n\nfunction afterRawAnnots() {\n  var ideo = this,\n    config = ideo.config;\n\n  // Ensure annots are ordered by chromosome\n  ideo.rawAnnots.annots = ideo.rawAnnots.annots.sort(Ideogram.sortChromosomes);\n\n  if (ideo.onLoadAnnotsCallback) {\n    ideo.onLoadAnnotsCallback();\n  }\n\n  if (\n    'heatmapThresholds' in config ||\n    'metadata' in ideo.rawAnnots &&\n    'heatmapThresholds' in ideo.rawAnnots.metadata\n  ) {\n    if (config.annotationsLayout === 'heatmap') {\n      inflateHeatmaps(ideo);\n    } else if (config.annotationsLayout === 'heatmap-2d') {\n      ideo.config.heatmapThresholds = inflateThresholds(ideo);\n    }\n  }\n\n  if (config.heatmaps) {\n    ideo.deserializeAnnotsForHeatmap(ideo.rawAnnots);\n  }\n\n  detectDuplicateChrsInRawAnnots(ideo);\n}\n\n/**\n * Converts list of annotation-by-chromosome objects to list of annot objects\n */\nfunction flattenAnnots() {\n  const ideo = this;\n  return ideo.annots.reduce((accumulator, annots) => {\n    return [...accumulator, ...annots.annots];\n  }, []);\n}\n\n/**\n * Requests annotations URL via HTTP, sets ideo.rawAnnots for downstream\n * processing.\n *\n * @param annotsUrl Absolute or relative URL for native or BED annotations file\n */\nfunction fetchAnnots(annotsUrl) {\n  var extension, is2dHeatmap,\n    ideo = this,\n    config = ideo.config;\n\n  is2dHeatmap = config.annotationsLayout === 'heatmap-2d';\n\n  var extension = validateAnnotsUrl(annotsUrl);\n\n  if (annotsUrl.slice(0, 4) !== 'http' && !is2dHeatmap && extension !== 'tsv') {\n    ideo.fetch(annotsUrl)\n      .then(function(data) {\n        ideo.rawAnnotsResponse = data; // Preserve truly raw response content\n        ideo.rawAnnots = data; // Sometimes gets partially processed\n        ideo.afterRawAnnots();\n      });\n    return;\n  }\n\n  extension = (is2dHeatmap ? '' : extension);\n\n  ideo.fetch(annotsUrl, 'text')\n    .then(function(text) {\n      ideo.rawAnnotsResponse = text;\n      if (is2dHeatmap) {\n        var parser = new ExpressionMatrixParser(text, ideo);\n        parser.setRawAnnots().then(function(d) {\n          ideo.rawAnnots = d;\n          ideo.afterRawAnnots();\n        });\n      } else {\n        if (extension === 'tsv') {\n          ideo.rawAnnots = new TsvParser(text, ideo).rawAnnots;\n        } else if (extension === 'bed') {\n          ideo.rawAnnots = new BedParser(text, ideo).rawAnnots;\n        } else {\n          ideo.rawAnnots = JSON.parse(text);\n        }\n        ideo.afterRawAnnots();\n      }\n    });\n}\n\n/**\n * Fills out annotations data structure such that its top-level list of arrays\n * matches that of this ideogram's chromosomes list in order and number\n * Fixes https://github.com/eweitz/ideogram/issues/66\n */\nfunction fillAnnots(annots) {\n  var filledAnnots, chrs, chrArray, i, chr, annot, chrIndex;\n\n  filledAnnots = [];\n  chrs = [];\n  chrArray = this.chromosomesArray;\n\n  for (i = 0; i < chrArray.length; i++) {\n    chr = chrArray[i].name;\n    chrs.push(chr);\n    filledAnnots.push({chr: chr, annots: []});\n  }\n\n  for (i = 0; i < annots.length; i++) {\n    annot = annots[i];\n    chrIndex = chrs.indexOf(annot.chr);\n    if (chrIndex !== -1) {\n      filledAnnots[chrIndex] = annot;\n    }\n  }\n\n  return filledAnnots;\n}\n\nexport function applyRankCutoff(annots, cutoff, ideo) {\n  const rankedAnnots = sortAnnotsByRank(annots, ideo);\n\n  // Take the top N ranked genes, where N is `cutoff`\n  annots = rankedAnnots.slice(0, cutoff);\n\n  return annots;\n}\n\nexport function setAnnotRanks(annots, ideo) {\n  if (annots.length === 0) return annots;\n  if ('initRank' in annots[0] === false) {\n    if ('geneCache' in ideo === false) return annots;\n\n    const ranks = ideo.geneCache.interestingNames;\n\n    return annots.map(annot => {\n      if (ranks.includes(annot.name)) {\n        annot.rank = ranks.indexOf(annot.name) + 1;\n      } else {\n        annot.rank = 1E10;\n      }\n      return annot;\n    });\n  } else {\n    return annots.map(annot => {\n      annot.rank = annot.initRank;\n      return annot;\n    });\n  }\n}\n\nexport function sortAnnotsByRank(annots, ideo) {\n\n  if (ideo) {\n    annots = setAnnotRanks(annots, ideo);\n  }\n  // Ranks annots by popularity\n  return annots.sort((a, b) => {\n\n    // // Search gene is most important, regardless of popularity\n    // if (a.color === 'red') return -1;\n    // if (b.color === 'red') return 1;\n\n    // Rank 3 is more important than rank 30\n    return a.rank - b.rank;\n  });\n}\n\nexport {\n  onLoadAnnots, onDrawAnnots, processAnnotData, restoreDefaultTracks,\n  updateDisplayedTracks, initAnnotSettings, fetchAnnots, drawAnnots,\n  getHistogramBars, drawHeatmaps, deserializeAnnotsForHeatmap, fillAnnots,\n  drawProcessedAnnots, drawSynteny, startHideAnnotTooltipTimeout,\n  showAnnotTooltip, onWillShowAnnotTooltip, onDidShowAnnotTooltip,\n  setOriginalTrackIndexes,\n  afterRawAnnots, onClickAnnot, downloadAnnotations, addAnnotLabel,\n  removeAnnotLabel, fillAnnotLabels, clearAnnotLabels, flattenAnnots\n  // fadeOutAnnotLabels\n};\n","/** Adds boxes behind a list of chromosomes; can indicate selection, etc. */\nfunction highlight(chrNames, color='red') {\n  const ideo = this;\n  const taxid = ideo.config.taxid;\n\n  const highlightsHtml = chrNames.map(chrName => {\n    const chrId = ideo.chromosomes[taxid][chrName].id;\n    const chrSet = `${ideo.selector} #${chrId}-chromosome-set`;\n    const chrDom = document.querySelector(chrSet);\n    const rect = chrDom.getBoundingClientRect();\n\n    const style = `style=\"\n      stroke-width: 1px;\n      stroke: ${color};\n      fill: ${color};\n      fill-opacity: 0.05;\n      position: absolute;\n      rx: 4;\n      ry: 4;\n      height: ${rect.width + 15}px;\n      width: ${rect.height + 15}px\"`;\n\n    const left = chrDom.transform.baseVal[1].matrix.f - 7.5;\n    const transform = `transform=\"rotate(90) translate(10, ${left})\"`;\n    const id = `id=\"ideo-highlight-${chrId}\"`;\n\n    return `<rect class=\"ideo-highlight\" ${id} ${style} ${transform}/>`;\n  }).join();\n\n  const ideoDom = document.querySelector(ideo.selector);\n  ideoDom.insertAdjacentHTML('afterBegin', highlightsHtml);\n}\n\n/** Removes highlight from a list of chromosomes (or all chromosomes)  */\nfunction unhighlight(chrNames) {\n  const ideo = this;\n\n  let highlightsSelector = `${ideo.selector} .ideo-highlight`;\n  if (typeof chrNames !== 'undefined') {\n    const taxid = ideo.config.taxid;\n    highlightsSelector = chrNames.map(chrName => {\n      const chrId = ideo.chromosomes[taxid][chrName].id;\n      return `${ideo.selector} #ideo-highlight-${chrId}`;\n    });\n  }\n\n  document.querySelectorAll(highlightsSelector).forEach((element) => {\n    element.remove();\n  });\n\n}\n\nexport {highlight, unhighlight};\n","// The E-Utilies In Depth: Parameters, Syntax and More:\n// https://www.ncbi.nlm.nih.gov/books/NBK25499/\n\nvar apiKey = '&api_key=7e33ac6a08a6955ec3b83d214d22b21a2808';\n\nvar eutils = 'https://eutils.ncbi.nlm.nih.gov/entrez/eutils/';\nvar esearch = eutils + 'esearch.fcgi?retmode=json' + apiKey;\nvar esummary = eutils + 'esummary.fcgi?retmode=json' + apiKey;\nvar elink = eutils + 'elink.fcgi?retmode=json' + apiKey;\n\nfunction getAssemblySearchUrl(taxid, ideo) {\n  var termStem, asmSearchUrl;\n\n  if (ideo.assemblyIsAccession()) {\n    termStem = ideo.config.assembly + '%22[Assembly%20Accession]';\n  } else {\n    termStem = (\n      taxid + '%22[taxid]' +\n      'AND%20(%22latest%20refseq%22[filter])%20'\n    );\n  }\n\n  asmSearchUrl =\n    ideo.esearch +\n    '&db=assembly' +\n    '&term=%22' + termStem +\n    'AND%20(%22chromosome%20level%22[filter]%20' +\n    'OR%20%22complete%20genome%22[filter])';\n\n  return asmSearchUrl;\n}\n\nexport {esearch, esummary, elink, getAssemblySearchUrl};\n","import {d3, slug, fetchWithRetry} from '../lib';\n\n/**\n *  Returns NCBI Taxonomy identifier (taxid) for organism name\n */\nfunction getTaxidFromEutils(orgName, ideo) {\n  var taxonomySearch, taxid;\n\n  taxonomySearch = ideo.esearch + '&db=taxonomy&term=' + orgName;\n\n  return d3.json(taxonomySearch).then(function(data) {\n    var idlist = data.esearchresult.idlist;\n    if (idlist.length === 0) {\n      var warning =\n        'Organism \"' + orgName + '\" is generally unknown; it was not found ' +\n        'in the NCBI Taxonomy database.  If you did not intend to specify a ' +\n        'novel or custom taxon, then try using the organism\\'s ' +\n        'scientific name, e.g. Homo sapiens or Arabidopsis thaliana.';\n      throw warning;\n    } else {\n      taxid = data.esearchresult.idlist[0];\n      return [orgName, taxid];\n    }\n  });\n}\n\n/**\n * Returns organism common name given an NCBI Taxonomy ID\n *\n * @param taxid NCBI Taxonomy ID\n * @param callback Function to call upon completing ESearch request\n */\nfunction getOrganismFromEutils(taxid, callback) {\n  var organism, taxonomySearch,\n    ideo = this;\n\n  taxid = ideo.config.organism;\n\n  taxonomySearch = ideo.esummary + '&db=taxonomy&id=' + taxid;\n\n  d3.json(taxonomySearch).then(function(data) {\n    organism = data.result[String(taxid)].commonname;\n    ideo.config.organism = organism;\n    return callback(organism);\n  });\n}\n\nfunction setTaxidData(taxid, ideo) {\n\n  var dataDir, urlOrg, taxids;\n\n  if (ideo.assemblyIsAccession()) {\n    return new Promise(function(resolve) {\n      ideo.coordinateSystem = 'bp';\n      ideo.getAssemblyAndChromosomesFromEutils(taxid, resolve);\n    });\n  }\n\n  dataDir = ideo.config.dataDir;\n  urlOrg = slug(ideo.organisms[taxid].scientificName);\n\n  taxids = [taxid];\n\n  var fullyBandedTaxids = ['9606', '10090', '10116'];\n  if (fullyBandedTaxids.includes(taxid) && !ideo.config.showFullyBanded) {\n    urlOrg += '-no-bands';\n  }\n  var chromosomesUrl = dataDir + urlOrg + '.json';\n\n  var promise2 = new Promise((resolve, reject) => {\n    return fetchWithRetry(chromosomesUrl)\n      .then(response => {\n        return response.json().then(function(json) {\n          resolve(json);\n        });\n      })\n      .catch((errorMessage) => {\n        reject(errorMessage);\n      });\n  });\n\n  return promise2\n    .then(function(chrData) {\n      // Check if chromosome data exists locally.\n      // This is used for pre-processed centromere data,\n      // which is not accessible via EUtils.  See get_chromosomes.py.\n      var chrBands = chrData.chrBands\n\n      var asmAndChrTaxidsArray = [''],\n        chromosomes = [],\n        seenChrs = {},\n        chr, maxLength, splitBand, length;\n\n      ideo.bandData[chrData.taxid] = chrBands;\n\n      for (var i = 0; i < chrBands.length; i++) {\n        splitBand = chrBands[i].split(' ');\n        chr = splitBand[0];\n        length = splitBand.slice(-1)[0];\n        if (chr in seenChrs) {\n          continue;\n        } else {\n          chromosomes.push({name: chr, type: 'nuclear', length: length});\n          seenChrs[chr] = 1;\n        }\n      }\n      chromosomes = chromosomes.sort(Ideogram.sortChromosomes);\n      maxLength = {bp: 0, iscn: 0};\n      chromosomes.forEach(chr => {\n        if (chr.length > maxLength.bp) maxLength.bp = chr.length;\n      });\n      ideo.maxLength[taxid] = maxLength;\n      asmAndChrTaxidsArray.push(chromosomes);\n      asmAndChrTaxidsArray.push(taxids);\n      return asmAndChrTaxidsArray;\n    },\n    function() {\n      // If request in `then` errs (404), fetch data from EUtils\n      return new Promise(function(resolve) {\n        ideo.coordinateSystem = 'bp';\n        ideo.getAssemblyAndChromosomesFromEutils(taxid, resolve);\n      });\n    });\n}\n\nfunction setAssemblyAndChromosomes(taxid, resolve, ideo) {\n  var assembly, chrs, originalChrs, orgName, filteredChrs,\n    config = ideo.config;\n\n  setTaxidData(taxid, ideo)\n    .then(function(asmChrTaxidsArray) {\n      assembly = asmChrTaxidsArray[0];\n      chrs = asmChrTaxidsArray[1];\n\n      if ('chromosomes' in config === false || config.chromosomes === null) {\n        ideo.config.chromosomes = {};\n        ideo.config.chromosomes[taxid] = chrs;\n      } else {\n        if (config.multiorganism) {\n          if (taxid in config.chromosomes) {\n            // Encountered when either organism has centromere data\n            originalChrs = config.chromosomes[taxid];\n          } else {\n            // Encountered when neither organism has centromere data\n            orgName = slug(ideo.getScientificName(taxid));\n            ideo.config.chromosomes[taxid] =\n              config.chromosomes[orgName].slice();\n            originalChrs = ideo.config.chromosomes[taxid];\n            // delete ideo.config.chromosomes[orgName];\n          }\n        } else {\n          originalChrs = config.chromosomes;\n        }\n\n        filteredChrs = chrs.filter(d => originalChrs.includes(d.name));\n        ideo.config.chromosomes[taxid] = filteredChrs;\n      }\n      ideo.chromosomes[taxid] = ideo.config.chromosomes[taxid].slice();\n      ideo.organisms[taxid].assemblies = {\n        default: assembly\n      };\n      resolve();\n    });\n}\n\n/**\n * Determine if organism is natively supported, using its name.\n */\nfunction isOrganismSupported(org, ideo) {\n  var taxid, ideoOrg;\n\n  for (taxid in ideo.organisms) {\n    ideoOrg = ideo.organisms[taxid];\n    if (\n      taxid === slug(org) ||\n      slug(ideoOrg.commonName) === slug(org) ||\n      slug(ideoOrg.scientificName) === slug(org)\n    ) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Augment \"organisms\" metadata with for any requested organism that is\n * not natively supported (i.e., not in organism-metadata.js).\n*/\nfunction populateNonNativeOrg(orgs, ideo) {\n  var org, promise, i,\n    getTaxidFromEutilsPromises = [],\n    augmentedOrganismMetadata = {};\n\n  for (i = 0; i < orgs.length; i++) {\n    org = orgs[i];\n    if (isOrganismSupported(org, ideo) === false) {\n      promise = getTaxidFromEutils(org, ideo)\n        .then(function(orgNameAndTaxid) {\n\n          var taxid = orgNameAndTaxid[1],\n            orgName = orgNameAndTaxid[0],\n            name, scientificName;\n\n          name = orgName.replace('-', ' ');\n          scientificName = name[0].toUpperCase() + name.slice(1);\n\n          augmentedOrganismMetadata[taxid] = {\n            scientificName: scientificName,\n            commonName: '',\n            assemblies: {default: ''}\n          };\n\n          Object.assign(ideo.organisms, augmentedOrganismMetadata);\n        }, function(warning) {\n          console.warn(warning);\n          var customMetadata = {\n            scientificName: org,\n            commonName: org,\n            assemblies: {default: ''}\n          };\n\n          // Use a negative number as unofficial taxid for custom organism.\n          // Use case: https://github.com/eweitz/ideogram/issues/265\n          //\n          // If support for *multiple* custom specifies is ever\n          // needed, we can decrement from -1.\n          ideo.organisms['-1'] = customMetadata;\n          augmentedOrganismMetadata['-1'] = customMetadata;\n        });\n    } else {\n      promise = new Promise(function(resolve) {\n        var taxid = ideo.getTaxid(org);\n        augmentedOrganismMetadata[taxid] = ideo.organisms[taxid];\n        resolve();\n      });\n    }\n    getTaxidFromEutilsPromises.push(promise);\n  }\n\n  return Promise.all(getTaxidFromEutilsPromises).then(function() {\n    return augmentedOrganismMetadata;\n  });\n}\n\nfunction prepareTmpChrsAndTaxids(ideo) {\n  var orgs, taxids, tmpChrs, org, taxid, chrsOrgSlugs,\n    config = ideo.config;\n\n  taxids = [];\n  tmpChrs = {};\n  orgs = (config.multiorganism) ? config.organism : [config.organism];\n\n  return populateNonNativeOrg(orgs, ideo).then(function(orgMetadata) {\n    var orgFields = orgMetadata[taxid];\n\n    for (taxid in orgMetadata) {\n      orgFields = orgMetadata[taxid];\n      taxids.push(taxid);\n      if (config.multiorganism) {\n        if (typeof config.chromosomes !== 'undefined') {\n          chrsOrgSlugs = Object.keys(config.chromosomes).map(org => slug(org));\n          // Adjusts 'chromosomes' configuration parameter to make object\n          // keys use taxid instead of common organism name\n          if (chrsOrgSlugs.includes(slug(orgFields.scientificName))) {\n            org = orgFields.scientificName;\n          } else if (chrsOrgSlugs.includes(slug(orgFields.commonName))) {\n            org = orgFields.commonName;\n          }\n          if (slug(org) in config.chromosomes) {\n            tmpChrs[taxid] = config.chromosomes[slug(org)];\n          } else {\n            tmpChrs[taxid] = config.chromosomes[org.toLowerCase()];\n          }\n        } else {\n          tmpChrs = null;\n        }\n      }\n    }\n    return [tmpChrs, taxids];\n  });\n}\n\n/**\n * Sort taxids by the \"organism\" configuration option\n *\n * TODO: Handle taxid being passed as organism\n */\nfunction sortTaxidsByOriginalOrganismOption(ideo) {\n  var configOrganisms, sortedTaxids, i;\n  configOrganisms = ideo.config.organism;\n  sortedTaxids = [];\n  if (Array.isArray(configOrganisms)) {\n    // Handling multi-organism ideogram\n    for (i = 0; i < configOrganisms.length; i++) {\n      sortedTaxids.push(ideo.getTaxid(configOrganisms[i]));\n    }\n  } else {\n    // Handling single-organism ideogram\n    sortedTaxids.push(ideo.getTaxid(configOrganisms));\n  }\n  return sortedTaxids;\n}\n\nfunction getTaxidsForOrganismsInConfig(callback, ideo) {\n\n  prepareTmpChrsAndTaxids(ideo).then(function([tmpChrs, taxids]) {\n    var i, taxid, promise, assemblies, asmAccs,\n      config = ideo.config,\n      asmAndChrPromises = [];\n\n    for (i = 0; i < taxids.length; i++) {\n      taxid = taxids[i];\n      assemblies = ideo.organisms[taxid].assemblies;\n      asmAccs = Object.values(assemblies);\n      if (\n        assemblies.default === '' ||\n        ideo.assemblyIsAccession() && !asmAccs.includes(config.assembly)\n      ) {\n        promise = new Promise(function(resolve) {\n          setAssemblyAndChromosomes(taxid, resolve, ideo);\n        });\n      } else {\n        ideo.config.taxids = taxids;\n        if (ideo.config.multiorganism) {\n          ideo.config.chromosomes = tmpChrs;\n        }\n        promise = new Promise(function(resolve) {\n          resolve();\n        });\n      }\n\n      asmAndChrPromises.push(promise);\n    }\n\n    Promise.all(asmAndChrPromises).then(function() {\n      taxids = sortTaxidsByOriginalOrganismOption(ideo);\n      ideo.config.taxids = taxids;\n      return callback(taxids);\n    });\n  });\n}\n\nfunction getIsMultiorganism(taxidInit, ideo) {\n  return (\n    ('organism' in ideo.config && ideo.config.organism instanceof Array) ||\n    (taxidInit && ideo.config.taxid instanceof Array)\n  );\n}\n\n/**\n * Configure Ideogram taxids when 'organism' is not in ideo.config\n */\nfunction getTaxidsForOrganismsNotInConfig(taxidInit, callback, ideo) {\n  var taxids;\n\n  if (ideo.config.multiorganism) {\n    if (taxidInit) {\n      taxids = ideo.config.taxid;\n    }\n  } else {\n    if (taxidInit) {\n      taxids = [ideo.config.taxid];\n    }\n    ideo.config.taxids = taxids;\n  }\n  callback(taxids);\n}\n\n/**\n * Returns an array of taxids for the current ideogram\n * Also sets configuration parameters related to taxid(s), whether ideogram is\n * multiorganism, and adjusts chromosomes parameters as needed\n **/\nfunction getTaxids(callback) {\n  var taxidInit,\n    ideo = this;\n\n  taxidInit = 'taxid' in ideo.config;\n\n  ideo.config.multiorganism = getIsMultiorganism(taxidInit, ideo);\n\n  if (ideo.config.multiorganism) ideo.coordinateSystem = 'bp';\n\n  if ('organism' in ideo.config) {\n    const org = ideo.config.organism;\n    if (typeof org === 'string') {\n      // Canonicalize e.g. \"Homo sapiens\" to \"homo-sapiens\"\n      ideo.config.organism = slug(org.toLowerCase());\n    }\n\n    getTaxidsForOrganismsInConfig(callback, ideo);\n  } else {\n    getTaxidsForOrganismsNotInConfig(taxidInit, callback, ideo);\n  }\n}\n\nexport {\n  getTaxids, getOrganismFromEutils\n};\n","import {d3} from '../lib';\nimport {\n  esearch, esummary, elink, getAssemblySearchUrl\n} from './eutils-config.js';\nimport {\n  getTaxids, getOrganismFromEutils\n} from './organisms.js';\n\n/**\n * Get a URL to ESearch the NCBI Nucleotide DB for an Assembly UID\n */\nfunction getESearchUrlForChromosomes(asmUid, ideo) {\n  var qs;\n\n  // Get a list of IDs for the chromosomes in this genome.\n  //\n  // Query chromosomes sequences in Nucleotide DB (nuccore) via\n  // Assembly DB E-Utils link.\n  qs = ('&db=nuccore&dbfrom=assembly&linkname=assembly_nuccore&' +\n    'cmd=neighbor_history&from_uid=' + asmUid);\n\n  return d3.json(ideo.elink + qs)\n    .then(function(data) {\n      var webenv = data.linksets[0].webenv;\n      qs =\n        '&db=nuccore' +\n        '&term=%231+AND+%28' +\n          'sequence_from_chromosome[Properties]+OR+' +\n          'sequence_from_plastid[Properties]+OR+' +\n          'sequence_from_mitochondrion[Properties]%29' +\n        '&WebEnv=' + webenv + '&usehistory=y&retmax=1000';\n      return ideo.esearch + qs;\n    });\n}\n\n/**\n * Request basic data on a list of chromosome IDs from ESearch\n */\nfunction fetchNucleotideSummary(data, ideo) {\n  var ids, ntSummary;\n  ids = data.esearchresult.idlist.join(',');\n  ntSummary = ideo.esummary + '&db=nucleotide&id=' + ids;\n  return d3.json(ntSummary);\n}\n\n/**\n * Get name and type for mitochondrial chromosome\n *\n * See example of \"MT\" in yeast:\n * https://eweitz.github.io/ideogram/eukaryotes?org=saccharomyces-cerevisiae\n */\nfunction parseMitochondrion(result, ideo) {\n  var type, cnIndex, chrName;\n\n  if (ideo.config.showNonNuclearChromosomes) {\n    type = result.genome;\n    cnIndex = result.subtype.split('|').indexOf('plasmid');\n    if (cnIndex === -1) {\n      chrName = 'MT';\n    } else {\n      // Seen in e.g. rice genome IRGSP-1.0 (GCF_001433935.1),\n      // From https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?retmode=json&db=nucleotide&id=996703432,996703431,996703430,996703429,996703428,996703427,996703426,996703425,996703424,996703423,996703422,996703421,194033210,11466763,7524755\n      // genome: 'mitochondrion',\n      // subtype: 'cell_line|plasmid',\n      // subname: 'A-58 CMS|B1',\n      chrName = result.subname.split('|')[cnIndex];\n    }\n  } else {\n    return [null, null];\n  }\n\n  return [chrName, type];\n}\n\n/**\n * Get name and type for chloroplastic chromosome.\n *\n * Plants have chloroplasts.  See e.g. green algae:\n * https://eweitz.github.io/ideogram/eukaryotes?org=micromonas-commoda\n */\nfunction parseChloroplastOrPlastid(ideo) {\n  // Plastid encountered with rice genome IRGSP-1.0 (GCF_001433935.1)\n  if (ideo.config.showNonNuclearChromosomes) {\n    return ['CP', 'chloroplast'];\n  }\n  return [null, null];\n}\n\n/**\n * Get name and type for apicoplast chromosome\n *\n * Plasmodium falciparum (malaria parasite) has such a chromosome, see e.g.:\n * https://eweitz.github.io/ideogram/eukaryotes?org=plasmodium-falciparum\n */\nfunction parseApicoplast(ideo) {\n  if (ideo.config.showNonNuclearChromosomes) {\n    return ['AP', 'apicoplast'];\n  }\n  return [null, null];\n}\n\n/**\n * Get name and type for nuclear chromosome\n *\n * These are typical chromosomes, like chromosome 1.\n */\nfunction parseNuclear(result) {\n  var type, cnIndex, chrName;\n\n  type = 'nuclear';\n  cnIndex = result.subtype.split('|').indexOf('chromosome');\n  chrName = result.subname.split('|')[cnIndex];\n\n  if (typeof chrName !== 'undefined' && chrName.substr(0, 3) === 'chr') {\n    // Convert \"chr12\" to \"12\", e.g. for banana (GCF_000313855.2)\n    chrName = chrName.substr(3);\n  }\n\n  return [chrName, type];\n}\n\n/**\n * Get name and type of any chromosome object from NCBI Nucleotide ESummary\n */\nfunction getChrNameAndType(result, ideo) {\n  var genome = result.genome;\n  if (genome === 'mitochondrion') {\n    return parseMitochondrion(result, ideo);\n  } else if (genome === 'chloroplast' || genome === 'plastid') {\n    return parseChloroplastOrPlastid(ideo);\n  } else if (genome === 'apicoplast') {\n    return parseApicoplast(ideo);\n  } else {\n    return parseNuclear(result);\n  }\n}\n\nfunction parseChromosome(result, ideo) {\n  var chrName, type, chromosome;\n\n  [chrName, type] = getChrNameAndType(result, ideo);\n\n  chromosome = {\n    name: chrName,\n    length: result.slen,\n    type: type\n  };\n\n  return chromosome;\n}\n\nfunction parseChromosomes(results, taxid, ideo) {\n  var x, chromosome, seenChrId, maxLength,\n    seenChrs = {},\n    chromosomes = [];\n\n  for (x in results) {\n    // omit list of result uids\n    if (x === 'uids') continue;\n\n    chromosome = parseChromosome(results[x], ideo);\n    seenChrId = chromosome.name + '_' + chromosome.length;\n    if (chromosome.type !== null && seenChrId in seenChrs === false) {\n      // seenChrs accounts for duplicate chromosomes seen with\n      // pig (Sus scrofa), likely GenBank and RefSeq copies.\n      chromosomes.push(chromosome);\n    }\n\n    seenChrs[seenChrId] = 1;\n  }\n\n  chromosomes = chromosomes.sort(Ideogram.sortChromosomes);\n\n  maxLength = {bp: 0, iscn: 0};\n  chromosomes.forEach(chr => {\n    if (chr.length > maxLength.bp) maxLength.bp = chr.length;\n  });\n  if (maxLength.bp > ideo.maxLength.bp) ideo.maxLength.bp = maxLength.bp;\n  ideo.maxLength[taxid] = maxLength;\n  ideo.coordinateSystem = 'bp';\n\n  return chromosomes;\n}\n\n/**\n * Request ESummary data from an ESearch on a genome assembly\n */\nfunction fetchAssemblySummary(data, ideo) {\n  var asmUid, asmSummaryUrl;\n\n  // NCBI Assembly database's internal identifier (uid) for this assembly\n  asmUid = data.esearchresult.idlist[0];\n  asmSummaryUrl = ideo.esummary + '&db=assembly&id=' + asmUid;\n\n  return d3.json(asmSummaryUrl);\n}\n\n/**\n * Returns assembly accession, as well as names and lengths of chromosomes for\n * an organism's best-known genome assembly, or for a specified assembly.\n *\n * Gets data from NCBI EUtils web API.\n *\n * @param callback Function to call upon completion of this async method\n */\nfunction getAssemblyAndChromosomesFromEutils(taxid, callback) {\n  var assemblyAccession,\n    ideo = this;\n\n  // Search for assembly, then\n  // get summary of that assembly, then\n  // get search URL for chromosomes in that assembly, then\n  // get search results containing chromosome IDs, then\n  // get summaries of each of those chromosome IDs, then\n  // format the chromosome summaries and pass them into callback function.\n  var asmSearchUrl = getAssemblySearchUrl(taxid, ideo);\n  d3.json(asmSearchUrl)\n    .then(function(data) {return fetchAssemblySummary(data, ideo);})\n    .then(function(data) {\n      var asmUid = data.result.uids[0];\n      assemblyAccession = data.result[asmUid];\n      return getESearchUrlForChromosomes(asmUid, ideo);\n    }).then(function(esearchUrl) {return d3.json(esearchUrl);})\n    .then(function(data) {return fetchNucleotideSummary(data, ideo);})\n    .then(function(data) {\n      var chromosomes = parseChromosomes(data.result, taxid, ideo);\n      return callback([assemblyAccession, chromosomes]);\n    }, function(rejectedReason) {\n      console.warn(rejectedReason);\n    });\n}\n\nexport {\n  esearch, esummary, elink, getOrganismFromEutils,\n  getTaxids, getAssemblyAndChromosomesFromEutils\n};\n","/**\n * @fileoverview Methods to show (or hide) cytogenetic banding data\n */\n\nimport {d3} from '../lib';\n\nfunction hideUnshownBandLabels() {\n  var ideo = this;\n  var bandsToShow = ideo.bandsToShow.join(',');\n\n  // Handles edge-case when ideogram consists of one chromosome\n  // that lacks bands in a genome that has bands (e.g. MT in human)\n  if (ideo.bandsToShow.length === 0) return;\n\n  // d3.selectAll resolves to querySelectorAll (QSA).\n  // QSA takes a surprisingly long time to complete,\n  // and scales with the number of selectors.\n  // Most bands are hidden, so we can optimize by\n  // Hiding all bands, then QSA'ing and displaying the\n  // relatively few bands that are shown.\n  d3.selectAll(ideo.selector + ' .bandLabel, .bandLabelStalk')\n    .style('display', 'none');\n  d3.selectAll(bandsToShow).style('display', '');\n}\n\nfunction getPrevRight(prevLabelXRight, prevHiddenBoxIndex, i,\n  textOffsets, chrModel) {\n  var prevTextBoxLeft, prevTextBoxWidth;\n\n  if (prevHiddenBoxIndex !== i) {\n    // This getBoundingClientRect() forces Chrome's\n    // 'Recalculate Style' and 'Layout', which takes 30-40 ms on Chrome.\n    // TODO: This forced synchronous layout would be nice to eliminate.\n    // prevTextBox = texts[i].getBoundingClientRect();\n    // prevLabelXRight = prevTextBox.left + prevTextBox.width;\n\n    // TODO: Account for number of characters in prevTextBoxWidth,\n    // maybe also zoom.\n    prevTextBoxLeft = textOffsets[chrModel.id][i];\n    prevTextBoxWidth = 36;\n\n    prevLabelXRight = prevTextBoxLeft + prevTextBoxWidth;\n  }\n\n  return prevLabelXRight;\n}\n\nfunction updateShown(indexesToShow, overlapRight, left, pad, prevRight, i,\n  isBefore) {\n  var hiddenIndex, doSkip,\n    thisRight = isBefore ? overlapRight : prevRight;\n\n  if (left < pad + thisRight) {\n    overlapRight = prevRight;\n    hiddenIndex = i;\n    doSkip = isBefore;\n  } else {\n    indexesToShow.push(i);\n  }\n\n  return [indexesToShow, overlapRight, hiddenIndex, doSkip];\n}\n\nfunction getIndexesToShow(offsets, chrModel) {\n  var i, hiddenIndex, left, prevRight, doSkip,\n    indexesToShow = [],\n    textsLength = offsets[chrModel.id].length,\n    overlapRight = 0, // Right X coordinate of overlapping label\n    pad = 5; // text padding\n\n  for (i = 0; i < textsLength; i++) {\n    // Ensures band labels don't overlap\n    left = offsets[chrModel.id][i];\n\n    [indexesToShow, overlapRight, hiddenIndex, doSkip] =\n      updateShown(indexesToShow, overlapRight, left, pad, prevRight, i, true);\n    if (doSkip) continue;\n\n    prevRight = getPrevRight(prevRight, hiddenIndex, i, offsets, chrModel);\n\n    [indexesToShow, overlapRight, hiddenIndex, doSkip] =\n      updateShown(indexesToShow, overlapRight, left, pad, prevRight, i, false);\n  }\n\n  return indexesToShow;\n}\n\n/**\n * Sets band labels to display on each chromosome, avoiding label overlap\n */\nfunction setBandsToShow(chrs, textOffsets) {\n  var index, i, j, indexesToShow, chrModel, selectorsToShow, ithLength,\n    ideo = this;\n\n  ideo.bandsToShow = [];\n\n  for (i = 0; i < chrs.length; i++) {\n\n    chrModel = chrs[i];\n\n    indexesToShow = getIndexesToShow(textOffsets, chrModel);\n\n    selectorsToShow = [];\n    ithLength = indexesToShow.length;\n\n    for (j = 0; j < ithLength; j++) {\n      index = indexesToShow[j];\n      selectorsToShow.push('#' + chrModel.id + ' .bsbsl-' + index);\n    }\n\n    ideo.bandsToShow = ideo.bandsToShow.concat(selectorsToShow);\n  }\n}\n\nexport {hideUnshownBandLabels, setBandsToShow};\n","/**\n * @fileoverview Methods to draw cytogenetic bands and their labels\n *\n */\n\nimport {d3} from '../lib';\nimport {hideUnshownBandLabels, setBandsToShow} from './show';\nimport {staticColors, staticGradients} from './styles';\nimport {configuredCss} from './../init/configure';\n\n/**\n * Draws text of cytoband label\n */\nfunction drawBandLabelText(chr, bandsToLabel, chrModel, textOffsets) {\n  var ideo = this,\n    layout = ideo._layout,\n    chrIndex = chrModel.chrIndex;\n\n  chr.selectAll('text')\n    .data(bandsToLabel)\n    .enter()\n    .append('g')\n    .attr('class', function(d, i) {\n      return 'bandLabel bsbsl-' + i;\n    })\n    .attr('transform', function(d) {\n      var transform = layout.getChromosomeBandLabelTranslate(d, chrIndex);\n\n      if (ideo.config.orientation === 'horizontal') {\n        textOffsets[chrModel.id].push(transform.x + 13);\n      } else {\n        textOffsets[chrModel.id].push(transform.y + 6);\n      }\n\n      return transform.translate;\n    })\n    .append('text')\n    .attr('text-anchor', layout.getChromosomeBandLabelAnchor(chrIndex))\n    .text(function(d) {return d.name;});\n\n  return textOffsets;\n}\n\n/**\n * Draws line between cytoband and its text label\n */\nfunction drawBandLabelStalk(chr, bandsToLabel, chrModel, textOffsets) {\n  var ideo = this;\n\n  chr.selectAll('line.bandLabelStalk')\n    .data(bandsToLabel)\n    .enter()\n    .append('g')\n    .attr('class', function(d, i) {\n      return 'bandLabelStalk bsbsl-' + i;\n    })\n    .attr('transform', function(d) {\n      var x, y;\n\n      x = ideo.round(d.px.start + d.px.width / 2);\n      y = -10;\n\n      textOffsets[chrModel.id].push(x + 13);\n\n      return 'translate(' + x + ',' + y + ')';\n    })\n    .append('line')\n    .attr('x1', 0)\n    .attr('y1', ideo._layout.getChromosomeBandTickY1(chrModel.chrIndex))\n    .attr('x2', 0)\n    .attr('y2', ideo._layout.getChromosomeBandTickY2(chrModel.chrIndex));\n}\n\nfunction getChrModels(chromosomes) {\n  var taxid, chr,\n    chrModels = [];\n\n  for (taxid in chromosomes) {\n    for (chr in chromosomes[taxid]) {\n      chrModels.push(chromosomes[taxid][chr]);\n    }\n  }\n\n  return chrModels;\n}\n\n/**\n * Draws text and stalks for cytogenetic band labels.\n *\n * Band labels are text like \"p11.11\".\n * Stalks are small lines that visually connect labels to their bands.\n */\nfunction drawBandLabels(chromosomes) {\n  var i, chr, chrModel, chrModels, bandsToLabel,\n    ideo = this,\n    textOffsets = {};\n\n  chrModels = getChrModels(chromosomes);\n\n  for (i = 0; i < chrModels.length; i++) {\n    chrModel = chrModels[i];\n    chr = d3.select(ideo.selector + ' #' + chrModel.id);\n    textOffsets[chrModel.id] = [];\n\n    // Don't show \"pter\" label for telocentric chromosomes, e.g. mouse\n    bandsToLabel = chrModel.bands.filter(d => d.name !== 'pter');\n\n    textOffsets =\n      ideo.drawBandLabelText(chr, bandsToLabel, chrModel, textOffsets);\n\n    ideo.drawBandLabelStalk(chr, bandsToLabel, chrModel, textOffsets);\n  }\n\n  ideo.setBandsToShow(chrModels, textOffsets);\n}\n\nfunction getStainAndColors(i, colors) {\n  var stain, color1, color2, color3;\n\n  stain = colors[i][0];\n  color1 = colors[i][1];\n  color2 = colors[i][2];\n  color3 = colors[i][3];\n\n  return [stain, color1, color2, color3];\n}\n\nfunction getGradients(colors) {\n  var i, stain, color1, color2, color3,\n    gradients = '';\n\n  for (i = 0; i < colors.length; i++) {\n    [stain, color1, color2, color3] = getStainAndColors(i, colors);\n    gradients +=\n      '<linearGradient id=\"' + stain + '\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">';\n    if (stain === 'gneg') {\n      gradients +=\n        '<stop offset=\"70%\" stop-color=\"' + color2 + '\" />' +\n        '<stop offset=\"95%\" stop-color=\"' + color3 + '\" />' +\n        '<stop offset=\"100%\" stop-color=\"' + color1 + '\" />';\n    } else {\n      gradients +=\n        '<stop offset=\"5%\" stop-color=\"' + color1 + '\" />' +\n        '<stop offset=\"15%\" stop-color=\"' + color2 + '\" />' +\n        '<stop offset=\"60%\" stop-color=\"' + color3 + '\" />';\n    }\n    gradients +=\n      '</linearGradient>';\n  }\n\n  return gradients;\n}\n\n/**\n * Returns SVG gradients that give chromosomes a polished look\n */\nfunction getBandColorGradients() {\n  var css,\n    gradients = '';\n\n  gradients = getGradients(staticColors);\n\n  css = `<style>${configuredCss}</style>`;\n\n  gradients += staticGradients;\n  gradients = '<defs>' + gradients + '</defs>';\n  gradients = css + gradients;\n\n  return gradients;\n}\n\nexport {\n  drawBandLabels, getBandColorGradients, hideUnshownBandLabels, setBandsToShow,\n  drawBandLabelText, drawBandLabelStalk\n};\n","\nfunction getDelimiterTsvLinesAndInit(source, content) {\n  var delimiter, tsvLines, init;\n\n  if (typeof chrBands === 'undefined' && source !== 'native') {\n    delimiter = /\\t/;\n    tsvLines = content.split(/\\r\\n|\\n/);\n    init = 1;\n  } else {\n    delimiter = / /;\n    tsvLines = content;\n    init = 0;\n  }\n\n  return [delimiter, tsvLines, init];\n}\n\nfunction updateChromosomes(chromosomes) {\n  var tmp, i;\n\n  if (chromosomes instanceof Array && typeof chromosomes[0] === 'object') {\n    tmp = [];\n    for (i = 0; i < chromosomes.length; i++) {\n      tmp.push(chromosomes[i].name);\n    }\n    chromosomes = tmp;\n  }\n  return chromosomes;\n}\n\nfunction getLineObject(chr, columns, stain, taxid) {\n  return {\n    chr: chr,\n    bp: {\n      start: parseInt(columns[5], 10),\n      stop: parseInt(columns[6], 10)\n    },\n    iscn: {\n      start: parseInt(columns[3], 10),\n      stop: parseInt(columns[4], 10)\n    },\n    px: {\n      start: -1,\n      stop: -1,\n      width: -1\n    },\n    name: columns[1] + columns[2],\n    stain: stain,\n    taxid: taxid\n  };\n}\n\nfunction getStain(columns) {\n  var stain = columns[7];\n  // For e.g. acen and gvar, columns[8] (density) is undefined\n  if (columns[8]) stain += columns[8];\n  return stain;\n}\n\nfunction updateLines(lines, columns, taxid) {\n  var chr, stain, line;\n\n  chr = columns[0];\n  if (chr in lines === false) lines[chr] = [];\n\n  stain = getStain(columns);\n\n  line = getLineObject(chr, columns, stain, taxid);\n  lines[chr].push(line);\n\n  return lines;\n}\n\n/**\n * Reports if a cytogenetic band should be included in parse results\n *\n * TODO:\n * Normalize ideogram.chromosomes upstream.\n *\n * This function is complex because ideogram.chromosomes is (likely\n * unnecessarily) complex.  The \"ideogram.chromosomes\" object can\n * take many forms depending on the use case, and this results in\n * hard-to-reason-about functions like this.\n *\n * Normalizing ideogram.chromosomes to a common format somewhere upstream\n * would likely make this specific function and Ideogram in general much\n * more maintainable.\n */\nfunction shouldSkipBand(chrs, chr, taxid, ideo) {\n\n  var hasChrs, chrsAreList, chrNotInList, chrsAreObject,\n    innerChrsAreStrings, matchingChrObjs, chrNotInObject,\n    multiorganism = ideo.config.multiorganism;\n\n  hasChrs = typeof chrs !== 'undefined' && chrs !== null;\n  if (!hasChrs) return false;\n\n  chrsAreList = Array.isArray(chrs);\n  chrNotInList = chrsAreList && chrs.indexOf(chr) === -1;\n  chrsAreObject = typeof chrs === 'object';\n\n  if (chrsAreList && !chrsAreObject && chrNotInList) return true;\n\n  if (taxid in chrs === false && multiorganism) return false;\n\n  if (!multiorganism) {\n    // Encountered in single organism when showing subset of all chromosomes,\n    // e.g. only human X and Y as in https://eweitz.github.io/ideogram/homology-basic\n    matchingChrObjs = chrs.filter(thisChr => thisChr === chr);\n    chrNotInObject = matchingChrObjs.length === 0;\n  } else {\n    innerChrsAreStrings = typeof chrs[taxid][0] === 'string';\n    if (innerChrsAreStrings) {\n      chrNotInObject = chrs[taxid].includes(chr) === false;\n    } else {\n      matchingChrObjs = chrs[taxid].filter(thisChr => thisChr.name === chr);\n      chrNotInObject = matchingChrObjs.length === 0;\n    }\n  }\n  return chrNotInObject;\n\n}\n\n/**\n * Parses cytogenetic band data from a TSV file, or, if band data is\n * prefetched, from an array\n *\n * NCBI:\n * #chromosome arm band iscn_start iscn_stop bp_start bp_stop stain density\n * ftp://ftp.ncbi.nlm.nih.gov/pub/gdp/ideogram_9606_GCF_000001305.14_550_V1\n */\nfunction parseBands(taxid, chromosomes, ideo) {\n  var delimiter, tsvLines, columns, chr, i, init, source, content,\n    lines = {};\n\n  content = ideo.bandData[taxid];\n\n  if (Array.isArray(content)) source = 'native';\n\n  chromosomes = updateChromosomes(chromosomes);\n\n  // Destructure assignment fails oddly when transpiled.  2019-05-23\n  var result = getDelimiterTsvLinesAndInit(source, content);\n  delimiter = result[0];\n  tsvLines = result[1];\n  init = result[2];\n\n  for (i = init; i < tsvLines.length; i++) {\n    columns = tsvLines[i].split(delimiter);\n\n    chr = columns[0];\n    if (shouldSkipBand(chromosomes, chr, taxid, ideo)) {\n      // If specific chromosomes are configured, then skip processing all\n      // other fetched chromosomes.\n      continue;\n    }\n\n    lines = updateLines(lines, columns, taxid);\n  }\n\n  return lines;\n}\n\nexport {parseBands};\n","/**\n * @fileoverview Methods for processing chromosome length and banding data.\n *\n * Ideogram.js depicts chromosomes using data on their length, name, and\n * (if dealing with a very well-studied organism) cytogenetic banding data.\n * This file processes cytoband data that comes from biological research\n * institutions.\n *\n * For background on cytogenetic bands and how they are used in genomics, see:\n * https://ghr.nlm.nih.gov/primer/howgeneswork/genelocation\n *\n */\n\nimport {\n  drawBandLabels, getBandColorGradients, hideUnshownBandLabels, setBandsToShow,\n  drawBandLabelText, drawBandLabelStalk\n} from './draw';\nimport {parseBands} from './parse';\nimport {organismMetadata} from '../init/organism-metadata';\n\n/**\n * Gets bands array for given chromosomes, sets ideo.maxLength\n */\nfunction getBandsArray(chromosome, bandsByChr, taxid, ideo) {\n  var bands, chrLength,\n    bandsArray = [];\n\n  bands = bandsByChr[chromosome];\n  bandsArray.push(bands);\n\n  chrLength = {\n    iscn: bands[bands.length - 1].iscn.stop,\n    bp: bands[bands.length - 1].bp.stop\n  };\n\n  if (taxid in ideo.maxLength === false) {\n    ideo.maxLength[taxid] = {bp: 0, iscn: 0};\n  }\n\n  if (chrLength.iscn > ideo.maxLength[taxid].iscn) {\n    ideo.maxLength[taxid].iscn = chrLength.iscn;\n    if (chrLength.iscn > ideo.maxLength.iscn) {\n      ideo.maxLength.iscn = chrLength.iscn;\n    }\n  }\n\n  if (chrLength.bp > ideo.maxLength[taxid].bp) {\n    ideo.maxLength[taxid].bp = chrLength.bp;\n    if (chrLength.bp > ideo.maxLength.bp) {\n      ideo.maxLength.bp = chrLength.bp;\n    }\n  }\n\n  return bandsArray;\n}\n\n/**\n * Updates bandsArray, sets ideo.config.chromosomes and ideo.numChromosomes\n */\nfunction setChrsByTaxidsWithBands(taxid, chrs, bandsArray, ideo) {\n  var bandsByChr, chromosome, k, chrBandsArray;\n\n  bandsByChr = parseBands(taxid, chrs, ideo);\n\n  chrs = Object.keys(bandsByChr).sort(Ideogram.sortChromosomes);\n\n  if (\n    'chromosomes' in ideo.config === false ||\n    ideo.config.chromosomes === null\n  ) {\n    ideo.config.chromosomes = {};\n  }\n  if (chrs.length > 0) {\n    ideo.config.chromosomes[taxid] = chrs.slice();\n  }\n  ideo.numChromosomes += ideo.config.chromosomes[taxid].length;\n\n  for (k = 0; k < chrs.length; k++) {\n    chromosome = chrs[k];\n    chrBandsArray = getBandsArray(chromosome, bandsByChr, taxid, ideo);\n    bandsArray = bandsArray.concat(chrBandsArray);\n  }\n\n  return bandsArray;\n}\n\nfunction setChromosomesByTaxid(taxid, chrs, bandsArray, ideo) {\n  var chr, i;\n\n  if (\n    taxid in ideo.bandData ||\n    taxid in organismMetadata &&\n    ideo.assemblyIsAccession() === false\n  ) {\n    bandsArray = setChrsByTaxidsWithBands(taxid, chrs, bandsArray, ideo);\n  } else {\n    // If lacking band-level data\n    ideo.numChromosomes += chrs.length;\n\n    for (i = 0; i < chrs.length; i++) {\n      chr = chrs[i];\n      if (chr.length > ideo.maxLength.bp) ideo.maxLength.bp = chr.length;\n    }\n  }\n\n  return bandsArray;\n}\n\nfunction reportPerformance(t0, ideo) {\n  var t1 = new Date().getTime();\n  if (ideo.config.debug) {\n    console.log('Time in processBandData: ' + (t1 - t0) + ' ms');\n  }\n}\n\n/**\n * Completes default ideogram initialization by calling downstream functions\n * to process raw band data into full JSON objects, render chromosome and\n * cytoband figures and labels, apply initial graphical transformations,\n * hide overlapping band labels, and execute callbacks defined by client code\n */\nfunction processBandData(taxid) {\n  var bandsArray, chrs,\n    ideo = this,\n    config = ideo.config,\n    t0 = new Date().getTime();\n\n  bandsArray = [];\n\n  if ('chromosomes' in config) {\n    if (config.multiorganism) {\n      // Copy object\n      chrs = config.chromosomes;\n    } else if (taxid in config.chromosomes) {\n      // Copy array by value\n      chrs = config.chromosomes[taxid].slice();\n    } else {\n      // Copy array by value.  Needed for e.g. \"Homology, basic\"\n      chrs = config.chromosomes.slice();\n    }\n  }\n\n  bandsArray = setChromosomesByTaxid(taxid, chrs, bandsArray, ideo);\n\n  reportPerformance(t0, ideo);\n  return [taxid, bandsArray];\n}\n\nexport {\n  drawBandLabels, getBandColorGradients, processBandData,\n  setBandsToShow, hideUnshownBandLabels, drawBandLabelText, drawBandLabelStalk\n};\n","/**\n * @fileoverview Methods to create and handle a brush on a chromosome.\n *\n * Ideogram.js enables users to display a box around part of a chromosome\n * that represents a \"currently selected\" region.  The user can move this\n * box like a sliding window, e.g. by clicking and dragging the mouse.\n *\n * For background, see:\n * https://github.com/d3/d3-brush\n */\n\nimport {d3} from './lib';\n\n/**\n * Custom event handler, fired upon dragging sliding window on chromosome\n */\nfunction onBrushMove() {\n  call(this.onBrushMoveCallback);\n}\n\nfunction onBrushEnd() {\n  call(this.onBrushEndCallback);\n}\n\nfunction setBrush(bpDomain, pxRange, xOffset, width, ideo) {\n  var xScale,\n    length = ideo.config.chrHeight;\n\n  xScale = d3.scaleLinear().domain(bpDomain).range(pxRange);\n\n  ideo.brush = d3.brushX()\n    .extent([[xOffset, 0], [length + xOffset, width]])\n    .on('brush', _onBrushMove)\n    .on('end', _onBrushEnd);\n\n  function _onBrushMove({selection}) {\n    var extent = selection.map(xScale.invert),\n      from = Math.floor(extent[0]),\n      to = Math.ceil(extent[1]);\n\n    ideo.selectedRegion = {from: from, to: to, extent: (to - from)};\n\n    if (ideo.onBrushMoveCallback) {\n      ideo.onBrushMoveCallback();\n    }\n  }\n\n  function _onBrushEnd({selection}) {\n    if (ideo.onBrushEndCallback) {\n      ideo.onBrushEndCallback();\n    }\n  }\n}\n\nfunction getBasePairDomainAndPixelRange(chrModel, xOffset) {\n  var band, i,\n    bpDomain = [1],\n    pxRange = [1],\n    lastBand = chrModel.bands.slice(-1)[0];\n\n  for (i = 0; i < chrModel.bands.length; i++) {\n    band = chrModel.bands[i];\n    bpDomain.push(band.bp.start);\n    pxRange.push(band.px.start + xOffset);\n  }\n\n  bpDomain.push(lastBand.bp.stop - 1);\n  pxRange.push(lastBand.px.stop + xOffset);\n\n  return [bpDomain, pxRange];\n}\n\n/**\n * Account for calls like createBrush('chr1:104325484-119977655')\n */\nfunction refineGenomicCoordinates(chr, from, to) {\n  var nameSplit, fromToSplit;\n\n  // Account for calls like createBrush('chr1:104325484-119977655')\n  nameSplit = chr.split(':');\n  fromToSplit = chr.split('-');\n  if (nameSplit.length > 1 && fromToSplit.length > 1) {\n    chr = nameSplit[0].replace('chr', '');\n    fromToSplit = nameSplit[1].split('-');\n    from = parseInt(fromToSplit[0]);\n    to = parseInt(fromToSplit[1] - 1);\n  }\n\n  return [chr, from, to];\n}\n\nfunction getChrModel(chr, ideo) {\n  var i, cm, chrModel;\n\n  for (i = 0; i < ideo.chromosomesArray.length; i++) {\n    cm = ideo.chromosomesArray[i];\n    if (cm.name === chr) {\n      chrModel = cm;\n      return chrModel;\n    }\n  }\n}\n\nfunction writeBrush(chrModel, from, to, xOffset, width, ideo) {\n  var x0, x1, yTranslate, yOffset;\n\n  x0 = ideo.convertBpToPx(chrModel, from) + xOffset;\n  x1 = ideo.convertBpToPx(chrModel, to) + xOffset;\n\n  yTranslate = ideo._layout.getChromosomeSetYTranslate(0);\n  yOffset = yTranslate + (ideo.config.chrWidth - width) / 2;\n\n  d3.select(ideo.selector).append('g')\n    .attr('class', 'brush')\n    .attr('transform', 'translate(0, ' + yOffset + ')')\n    .call(ideo.brush)\n    .call(ideo.brush.move, [x0, x1]);\n}\n\nfunction setSelectedRegion(from, to, ideo) {\n  // Genomics web UIs are 1-based, fully closed.\n  // I.e. If start = 20 bp and stop = 10 bp, then extent = 11 bp.\n  // Details:\n  // http://genome.ucsc.edu/blog/the-ucsc-genome-browser-coordinate-counting-systems/\n  // https://www.biostars.org/p/84686/\n  var extent = to - from + 1;\n  ideo.selectedRegion = {from: from, to: to, extent: extent};\n}\n\n/**\n * Creates a sliding window along a chromosome\n *\n * @param chr Chromosome name (e.g. 1) or range, e.g. chr1:104325484-119977655\n * @param from Genomic start coordinate in base pairs, e.g. 104325484\n * @param to Genomic end coordinate in base pairs, e.g. 119977655\n */\nfunction createBrush(chr, from, to) {\n  var chrModel, chrLengthBp, bpDomain, pxRange, lastBand,\n    ideo = this,\n    width = ideo.config.chrWidth + 6.5,\n    xOffset = ideo._layout.margin.left;\n\n  [chr, from, to] = refineGenomicCoordinates(chr, from, to);\n\n  chrModel = getChrModel(chr, ideo);\n\n  [bpDomain, pxRange] = getBasePairDomainAndPixelRange(chrModel, xOffset);\n\n  lastBand = chrModel.bands.slice(-1)[0];\n  chrLengthBp = lastBand.bp.stop;\n\n  if (typeof from === 'undefined') from = Math.floor(chrLengthBp / 10);\n  if (typeof to === 'undefined') to = Math.ceil(from * 2);\n\n  setBrush(bpDomain, pxRange, xOffset, width, ideo);\n\n  setSelectedRegion(from, to, ideo);\n  writeBrush(chrModel, from, to, xOffset, width, ideo);\n}\n\nexport {onBrushMove, onBrushEnd, createBrush};\n","/**\n * @fileoverview Allows a click event handler to be attached to the ideogram\n *\n * This works similar to the \"brush\" which allows a region to be selected.\n * The click handler does not allow a region, but a precise location.\n *\n */\n\nimport {d3} from './lib';\n\n/**\n * Custom event handler, fired upon clicks on the chromosome (to change\n * position)\n */\nfunction onCursorMove() {\n  call(this.onCursorMoveCallback);\n}\n\nfunction setCursor(position, bpDomain, pxRange, xOffset, width, ideo) {\n  var xScale;\n\n  xScale = d3.scaleLinear().domain(bpDomain).range(pxRange);\n\n  if (!('rotatable' in ideo.config && ideo.config.rotatable === false)) {\n    console.warn('Using the cursor with rotate is not supported.');\n  }\n\n  var yTranslate = ideo._layout.getChromosomeSetYTranslate(0);\n  var yOffset = yTranslate + (ideo.config.chrWidth - width) / 2;\n\n  // TODO: check if newPosition is valid value (in range)\n\n  var cursorBrush = d3.select(ideo.selector).append('g')\n    .attr('class', 'brush')\n    .attr('transform', 'translate(0, ' + yOffset + ')')\n    .append('rect')\n    .attr('class', 'cursor')\n    .attr('x', xScale(position))\n    .attr('y', 0)\n    .attr('width', 1) // this could be a configuration param\n    .attr('height', 30); // MAGIC NUMBER! need help with this one\n\n  // call the callback for the first time (onLoad)\n  if (ideo.onCursorMove) {\n    ideo.onCursorMoveCallback(position);\n  }\n\n  if (!ideo.setCursorPosition) {\n    ideo.setCursorPosition = function(newPosition) {\n      // TODO: check if newPosition is valid value (in range)\n      cursorBrush.attr('x', xScale(newPosition));\n      if (ideo.onCursorMove) {\n        ideo.onCursorMoveCallback(newPosition);\n      }\n    };\n  }\n\n  d3.selectAll(ideo.selector + ' .chromosome').on('click', function(event) {\n    var x = event.offsetX; // minimum value seems to be 25\n\n    // adjust for screen (6 is a magic number that seems to work)\n    x -=6;\n\n    // move the cursor\n    cursorBrush.attr('x', x);\n\n    // calculate the new position and perform callback\n    var newPosition = Math.floor(xScale.invert(x));\n    if (ideo.onCursorMove) {\n      ideo.onCursorMoveCallback(newPosition);\n    }\n  });\n}\n\nfunction getBasePairDomainAndPixelRange(chrModel, xOffset) {\n  var band, i,\n    bpDomain = [1],\n    pxRange = [1],\n    lastBand = chrModel.bands.slice(-1)[0];\n\n  for (i = 0; i < chrModel.bands.length; i++) {\n    band = chrModel.bands[i];\n    bpDomain.push(band.bp.start);\n    pxRange.push(band.px.start + xOffset);\n  }\n\n  bpDomain.push(lastBand.bp.stop - 1);\n  pxRange.push(lastBand.px.stop + xOffset);\n\n  return [bpDomain, pxRange];\n}\n\nfunction getChrModel(chr, ideo) {\n  var i, cm, chrModel;\n\n  for (i = 0; i < ideo.chromosomesArray.length; i++) {\n    cm = ideo.chromosomesArray[i];\n    if (cm.name === chr) {\n      chrModel = cm;\n      return chrModel;\n    }\n  }\n}\n\n/**\n * Creates a clickable cursor along a chromosome.\n *\n * @param position Genomic start coordinate in base pairs, e.g. 104325484\n */\nfunction createClickCursor(position) {\n  var chrModel, bpDomain,\n    pxRange,\n    ideo = this,\n    width = ideo.config.chrWidth + 6.5, // 6.5 magic number?\n    xOffset = ideo._layout.margin.left;\n\n  if (typeof position === 'undefined') {\n    return false;\n  }\n\n  chrModel = getChrModel(ideo.config.chromosome, ideo);\n  [bpDomain, pxRange] = getBasePairDomainAndPixelRange(chrModel, xOffset);\n\n  // call setCursor to complete the job.\n  setCursor(position, bpDomain, pxRange, xOffset, width, ideo);\n}\n\nexport {onCursorMove, createClickCursor};\n","/**\n * @fileoverview Instance methods for sex chromosomes (allosomes).\n *\n * This module provides methods for drawing karyotypically normal\n * male and female mammalian genomes.\n */\n\n/**\n * Appends SVG elements depicting sex chromosomes to the document.\n */\nfunction drawSexChromosomes(container, chrIndex) {\n  var bandsArray, taxid, chrs,\n    sexChromosomeIndexes, sciLength,\n    chromosome, bands, chrModel, sci, homologIndex;\n\n  bandsArray = this.bandsArray;\n  taxid = this.config.taxid;\n  chrs = this.config.chromosomes[taxid];\n\n  if (this.config.sex === 'male') {\n    sexChromosomeIndexes = [1, 0];\n  } else {\n    sexChromosomeIndexes = [0, 0];\n  }\n\n  sciLength = sexChromosomeIndexes.length;\n\n  for (homologIndex = 0; homologIndex < sciLength; homologIndex++) {\n    sci = sexChromosomeIndexes[homologIndex] + chrIndex;\n    chromosome = chrs[sci];\n    bands = bandsArray[taxid][sci];\n    chrModel = this.getChromosomeModel(bands, chromosome, taxid, sci);\n    this.appendHomolog(chrModel, chrIndex, homologIndex, container);\n  }\n}\n\n/**\n * Sets instance properties regarding sex chromosomes.\n * Currently only supported for mammals.\n * TODO: Support all sexually reproducing taxa\n *   XY sex-determination (mammals):\n *     - Male: XY <- heterogametic\n *     - Female: XX\n *   ZW sex-determination (birds):\n *     - Male: ZZ\n *     - Female: ZW <- heterogametic\n *   X0 sex-determination (some insects):\n *     - Male: X0, i.e. only X <- heterogametic?\n *     - Female: XX\n * TODO: Support sex chromosome aneuploidies in mammals\n *     - Turner syndrome: X0\n *     - Klinefelter syndome: XXY\n *  More types:\n *  https://en.wikipedia.org/wiki/Category:Sex_chromosome_aneuploidies\n */\nfunction setSexChromosomes(chrs) {\n  var chr, i,\n    ideo = this,\n    sexChrs = {X: 1, Y: 1};\n\n  if (this.config.ploidy !== 2 || !this.config.sex) return;\n\n  ideo.sexChromosomes.list = [];\n\n  for (i = 0; i < chrs.length; i++) {\n    chr = chrs[i];\n    if (ideo.config.sex === 'male' && chr in sexChrs) {\n      ideo.sexChromosomes.list.push(chr);\n      if (!ideo.sexChromosomes.index) {\n        ideo.sexChromosomes.index = i;\n      }\n    } else if (chr === 'X') {\n      ideo.sexChromosomes.list.push(chr, chr);\n      ideo.sexChromosomes.index = i;\n    }\n  }\n}\n\nexport {drawSexChromosomes, setSexChromosomes};\n","/**\n * @fileoverview Methods to convert to and from different types of coordinates.\n *\n * Ideogram.js uses multiple coordinate systems, e.g. base pairs (bp) and\n * pixels (px).  These methods interconvert between those coordinate systems.\n *\n * TODO:\n * - Add methods to interconvert between ISCN coordinates and base pairs,\n * pixels.\n */\n\nfunction throwBpToPxError(bp, chr, band) {\n  throw new Error(\n    'Base pair out of range.  ' +\n    'bp: ' + bp + '; length of chr' + chr.name + ': ' + band.bp.stop\n  );\n}\n\nfunction getPx(chr, bp) {\n  var i, px, band, bpToIscnScale, iscn, iscnStart, iscnStop, iscnLength,\n    bpStart, bpStop, bpLength, pxStart, pxLength;\n\n  for (i = 0; i < chr.bands.length; i++) {\n    band = chr.bands[i];\n    bpStart = band.bp.start;\n    bpStop = band.bp.stop;\n    bpLength = bpStop - bpStart;\n    iscnStart = band.iscn.start;\n    iscnStop = band.iscn.stop;\n    iscnLength = iscnStop - iscnStart;\n    pxStart = band.px.start;\n    pxLength = band.px.width;\n\n    if (bp >= bpStart && bp <= bpStop) {\n      bpToIscnScale = iscnLength / bpLength;\n      iscn = iscnStart + (bp - bpStart) * bpToIscnScale;\n      px = pxStart + (pxLength * (iscn - iscnStart) / (iscnLength));\n\n      return [px, band];\n    }\n  }\n  return [null, band];\n}\n\n/**\n * Converts base pair coordinates to pixel offsets.\n * Bp-to-pixel scales differ among cytogenetic bands.\n *\n * For example, if we want to depict a gene on a chromosome, then we need\n * to convert the gene's location in base pairs to a location in pixels offset\n * from the start of the chromosome.\n */\nfunction convertBpToPx(chr, bp) {\n  var band, px;\n\n  if (chr.bands.length > 1 || chr.name === 'MT') {\n    [px, band] = getPx(chr, bp);\n    if (px !== null) return px;\n  } else if (bp >= 1 && bp <= chr.length) {\n    px = chr.scale.bp * bp;\n    return px;\n  }\n\n  throwBpToPxError(bp, chr, band);\n}\n\nfunction throwPxToBpError(px, chr, pxStop) {\n  throw new Error(\n    'Pixel out of range.  ' +\n    'px: ' + px + '; length of chr' + chr.name + ': ' + pxStop\n  );\n}\n\nfunction getBp(iscnStop, iscnStart, px, pxStop, pxStart, band, iscnLength) {\n  var pxLength, bpLength, pxToIscnScale, iscn, bp;\n\n  iscnLength = iscnStop - iscnStart;\n  pxLength = pxStop - pxStart;\n  bpLength = band.bp.stop - band.bp.start;\n\n  pxToIscnScale = iscnLength / pxLength;\n  iscn = iscnStart + (px - pxStart) * pxToIscnScale;\n\n  bp = band.bp.start + (bpLength * (iscn - iscnStart) / iscnLength);\n\n  return Math.round(bp);\n}\n\n/**\n * Converts pixel offsets to base pair coordinates.\n * Pixel-to-bp scales differ among cytogenetic bands.\n *\n * For example, if we want to determine the genomic location a user clicked on\n * (e.g. when creating a brush / sliding window region), then we need to\n * convert pixels to base pairs.\n */\nfunction convertPxToBp(chr, px) {\n  var i, band, bp, pxStart, pxStop, iscnStart, iscnStop, iscnLength;\n\n  if (px === 0) {\n    px = chr.bands[0].px.start;\n  }\n\n  for (i = 0; i < chr.bands.length; i++) {\n    band = chr.bands[i];\n\n    pxStart = band.px.start;\n    pxStop = band.px.stop;\n    iscnStart = band.iscn.start;\n    iscnStop = band.iscn.stop;\n\n    if (px >= pxStart && px <= pxStop) {\n      bp = getBp(iscnStop, iscnStart, px, pxStop, pxStart, band, iscnLength);\n      return bp;\n    }\n  }\n  throwPxToBpError(px, chr, pxStop);\n}\n\nexport {convertBpToPx, convertPxToBp};\n","let array8 = arrayUntyped,\n    array16 = arrayUntyped,\n    array32 = arrayUntyped,\n    arrayLengthen = arrayLengthenUntyped,\n    arrayWiden = arrayWidenUntyped;\nif (typeof Uint8Array !== \"undefined\") {\n  array8 = function(n) { return new Uint8Array(n); };\n  array16 = function(n) { return new Uint16Array(n); };\n  array32 = function(n) { return new Uint32Array(n); };\n\n  arrayLengthen = function(array, length) {\n    if (array.length >= length) return array;\n    var copy = new array.constructor(length);\n    copy.set(array);\n    return copy;\n  };\n\n  arrayWiden = function(array, width) {\n    var copy;\n    switch (width) {\n      case 16: copy = array16(array.length); break;\n      case 32: copy = array32(array.length); break;\n      default: throw new Error(\"invalid array width!\");\n    }\n    copy.set(array);\n    return copy;\n  };\n}\n\nfunction arrayUntyped(n) {\n  var array = new Array(n), i = -1;\n  while (++i < n) array[i] = 0;\n  return array;\n}\n\nfunction arrayLengthenUntyped(array, length) {\n  var n = array.length;\n  while (n < length) array[n++] = 0;\n  return array;\n}\n\nfunction arrayWidenUntyped(array, width) {\n  if (width > 32) throw new Error(\"invalid array width!\");\n  return array;\n}\n\n// An arbitrarily-wide array of bitmasks\nfunction bitarray(n) {\n  this.length = n;\n  this.subarrays = 1;\n  this.width = 8;\n  this.masks = {\n    0: 0\n  }\n\n  this[0] = array8(n);\n}\n\nbitarray.prototype.lengthen = function(n) {\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    this[i] = arrayLengthen(this[i], n);\n  }\n  this.length = n;\n};\n\n// Reserve a new bit index in the array, returns {offset, one}\nbitarray.prototype.add = function() {\n  var m, w, one, i, len;\n\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    m = this.masks[i];\n    w = this.width - (32 * i);\n    // isolate the rightmost zero bit and return it as an unsigned int of 32 bits, if NaN or -1, return a 0 \n    one = (~m & (m + 1)) >>> 0;\n\n    if (w >= 32 && !one) {\n      continue;\n    }\n\n    if (w < 32 && (one & (1 << w))) {\n      // widen this subarray\n      this[i] = arrayWiden(this[i], w <<= 1);\n      this.width = 32 * i + w;\n    }\n\n    this.masks[i] |= one;\n\n    return {\n      offset: i,\n      one: one\n    };\n  }\n\n  // add a new subarray\n  this[this.subarrays] = array8(this.length);\n  this.masks[this.subarrays] = 1;\n  this.width += 8;\n  return {\n    offset: this.subarrays++,\n    one: 1\n  };\n};\n\n// Copy record from index src to index dest\nbitarray.prototype.copy = function(dest, src) {\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    this[i][dest] = this[i][src];\n  }\n};\n\n// Truncate the array to the given length\nbitarray.prototype.truncate = function(n) {\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    for (var j = this.length - 1; j >= n; j--) {\n      this[i][j] = 0;\n    }\n  }\n  this.length = n;\n};\n\n// Checks that all bits for the given index are 0\nbitarray.prototype.zero = function(n) {\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    if (this[i][n]) {\n      return false;\n    }\n  }\n  return true;\n};\n\n// Checks that all bits for the given index are 0 except for possibly one\nbitarray.prototype.zeroExcept = function(n, offset, zero) {\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    if (i === offset ? this[i][n] & zero : this[i][n]) {\n      return false;\n    }\n  }\n  return true;\n};\n\n// Checks that all bits for the given index are 0 except for the specified mask.\n// The mask should be an array of the same size as the filter subarrays width.\nbitarray.prototype.zeroExceptMask = function(n, mask) {\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    if (this[i][n] & mask[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// Checks that only the specified bit is set for the given index\nbitarray.prototype.only = function(n, offset, one) {\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    if (this[i][n] != (i === offset ? one : 0)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n// Checks that only the specified bit is set for the given index except for possibly one other\nbitarray.prototype.onlyExcept = function(n, offset, zero, onlyOffset, onlyOne) {\n  var mask;\n  var i, len;\n  for (i = 0, len = this.subarrays; i < len; ++i) {\n    mask = this[i][n];\n    if (i === offset)\n      mask &= zero;\n    if (mask != (i === onlyOffset ? onlyOne : 0)) {\n      return false;\n    }\n  }\n  return true;\n};\n\nexport default {\n  array8: arrayUntyped,\n  array16: arrayUntyped,\n  array32: arrayUntyped,\n  arrayLengthen: arrayLengthenUntyped,\n  arrayWiden: arrayWidenUntyped,\n  bitarray: bitarray\n};\n","const filterExact = (bisect, value) => {\n  return function(values) {\n    var n = values.length;\n    return [bisect.left(values, value, 0, n), bisect.right(values, value, 0, n)];\n  };\n}\n\nconst filterRange = (bisect, range) => {\n  var min = range[0],\n      max = range[1];\n  return function(values) {\n    var n = values.length;\n    return [bisect.left(values, min, 0, n), bisect.left(values, max, 0, n)];\n  };\n}\n\nconst filterAll = values => {\n  return [0, values.length];\n}\n\nexport default {\n  filterExact,\n  filterRange,\n  filterAll\n};\n","export default d => {\n  return d;\n};\n","export default () =>  {\n  return null;\n}\n","export default () => {\n  return 0;\n}\n","import identity from './identity';\n\nfunction heap_by(f) {\n\n  // Builds a binary heap within the specified array a[lo:hi]. The heap has the\n  // property such that the parent a[lo+i] is always less than or equal to its\n  // two children: a[lo+2*i+1] and a[lo+2*i+2].\n  function heap(a, lo, hi) {\n    var n = hi - lo,\n        i = (n >>> 1) + 1;\n    while (--i > 0) sift(a, i, n, lo);\n    return a;\n  }\n\n  // Sorts the specified array a[lo:hi] in descending order, assuming it is\n  // already a heap.\n  function sort(a, lo, hi) {\n    var n = hi - lo,\n        t;\n    while (--n > 0) t = a[lo], a[lo] = a[lo + n], a[lo + n] = t, sift(a, 1, n, lo);\n    return a;\n  }\n\n  // Sifts the element a[lo+i-1] down the heap, where the heap is the contiguous\n  // slice of array a[lo:lo+n]. This method can also be used to update the heap\n  // incrementally, without incurring the full cost of reconstructing the heap.\n  function sift(a, i, n, lo) {\n    var d = a[--lo + i],\n        x = f(d),\n        child;\n    while ((child = i << 1) <= n) {\n      if (child < n && f(a[lo + child]) > f(a[lo + child + 1])) child++;\n      if (x <= f(a[lo + child])) break;\n      a[lo + i] = a[lo + child];\n      i = child;\n    }\n    a[lo + i] = d;\n  }\n\n  heap.sort = sort;\n  return heap;\n}\n\nconst h = heap_by(identity);\nh.by = heap_by;\n\nexport default h;\n","import identity from './identity';\nimport xFilterHeap from './heap';\n\nfunction heapselect_by(f) {\n  var heap = xFilterHeap.by(f);\n\n  // Returns a new array containing the top k elements in the array a[lo:hi].\n  // The returned array is not sorted, but maintains the heap property. If k is\n  // greater than hi - lo, then fewer than k elements will be returned. The\n  // order of elements in a is unchanged by this operation.\n  function heapselect(a, lo, hi, k) {\n    var queue = new Array(k = Math.min(hi - lo, k)),\n        min,\n        i,\n        d;\n\n    for (i = 0; i < k; ++i) queue[i] = a[lo++];\n    heap(queue, 0, k);\n\n    if (lo < hi) {\n      min = f(queue[0]);\n      do {\n        if (f(d = a[lo]) > min) {\n          queue[0] = d;\n          min = f(heap(queue, 0, k)[0]);\n        }\n      } while (++lo < hi);\n    }\n\n    return queue;\n  }\n\n  return heapselect;\n}\n\n\nconst h = heapselect_by(identity);\nh.by = heapselect_by; // assign the raw function to the export as well\n\nexport default h;\n","import identity from './identity';\n\nfunction bisect_by(f) {\n\n  // Locate the insertion point for x in a to maintain sorted order. The\n  // arguments lo and hi may be used to specify a subset of the array which\n  // should be considered; by default the entire array is used. If x is already\n  // present in a, the insertion point will be before (to the left of) any\n  // existing entries. The return value is suitable for use as the first\n  // argument to `array.splice` assuming that a is already sorted.\n  //\n  // The returned insertion point i partitions the array a into two halves so\n  // that all v < x for v in a[lo:i] for the left side and all v >= x for v in\n  // a[i:hi] for the right side.\n  function bisectLeft(a, x, lo, hi) {\n    while (lo < hi) {\n      var mid = lo + hi >>> 1;\n      if (f(a[mid]) < x) lo = mid + 1;\n      else hi = mid;\n    }\n    return lo;\n  }\n\n  // Similar to bisectLeft, but returns an insertion point which comes after (to\n  // the right of) any existing entries of x in a.\n  //\n  // The returned insertion point i partitions the array into two halves so that\n  // all v <= x for v in a[lo:i] for the left side and all v > x for v in\n  // a[i:hi] for the right side.\n  function bisectRight(a, x, lo, hi) {\n    while (lo < hi) {\n      var mid = lo + hi >>> 1;\n      if (x < f(a[mid])) hi = mid;\n      else lo = mid + 1;\n    }\n    return lo;\n  }\n\n  bisectRight.right = bisectRight;\n  bisectRight.left = bisectLeft;\n  return bisectRight;\n}\n\nconst bisect = bisect_by(identity);\nbisect.by = bisect_by; // assign the raw function to the export as well\n\nexport default bisect;\n\n","export default (array, index, deep) => {\n  for (var i = 0, n = index.length, copy = deep ? JSON.parse(JSON.stringify(array)) : new Array(n); i < n; ++i) {\n    copy[i] = array[index[i]];\n  }\n  return copy;\n}\n","const reduceIncrement = p => {\n  return p + 1;\n}\n\nconst reduceDecrement = p => {\n  return p - 1;\n}\n\nconst reduceAdd = f => {\n  return function(p, v) {\n    return p + +f(v);\n  };\n}\n\nconst reduceSubtract = f => {\n  return function(p, v) {\n    return p - f(v);\n  };\n}\n\nexport default {\n  reduceIncrement,\n  reduceDecrement,\n  reduceAdd,\n  reduceSubtract\n};\n","import deep from \"@ranfdev/deepobj\"\n// Note(cg): result was previsouly using lodash.result, not ESM compatible.\n \nconst get = (obj, prop) => {\n  const value = obj[prop];\n  return (typeof value === 'function') ? value.call(obj) : value;\n}\n\n/**\n * get value of object at a deep path.\n * if the resolved value is a function,\n * it's invoked with the `this` binding of \n * its parent object and its result is returned. \n *  \n * @param  {Object} obj  the object (e.g. { 'a': [{ 'b': { 'c1': 3, 'c2': 4} }], 'd': {e:1} }; )\n * @param  {String} path deep path (e.g. `d.e`` or `a[0].b.c1`. Dot notation (a.0.b)is also supported)\n * @return {Any}      the resolved value\n */\nconst reg = /\\[([\\w\\d]+)\\]/g;\nexport default (obj, path) => {\n  return deep(get, obj, path.replace(reg, '.$1'))\n}\n","import xfilterArray from './array';\nimport xfilterFilter from './filter';\nimport cr_identity from './identity';\nimport cr_null from './null';\nimport cr_zero from './zero';\nimport xfilterHeapselect from './heapselect';\nimport xfilterHeap from './heap';\nimport bisect from './bisect';\nimport permute from './permute';\nimport xfilterReduce from './reduce';\nimport result from './result';\n\n// constants\nvar REMOVED_INDEX = -1;\n\ncrossfilter.heap = xfilterHeap;\ncrossfilter.heapselect = xfilterHeapselect;\ncrossfilter.bisect = bisect;\ncrossfilter.permute = permute;\nexport default crossfilter;\n\nfunction crossfilter() {\n  var crossfilter = {\n    add: add,\n    remove: removeData,\n    dimension: dimension,\n    groupAll: groupAll,\n    size: size,\n    all: all,\n    allFiltered: allFiltered,\n    onChange: onChange,\n    isElementFiltered: isElementFiltered\n  };\n\n  var data = [], // the records\n      n = 0, // the number of records; data.length\n      filters, // 1 is filtered out\n      filterListeners = [], // when the filters change\n      dataListeners = [], // when data is added\n      removeDataListeners = [], // when data is removed\n      callbacks = [];\n\n  filters = new xfilterArray.bitarray(0);\n\n  // Adds the specified new records to this crossfilter.\n  function add(newData) {\n    var n0 = n,\n        n1 = newData.length;\n\n    // If there's actually new data to add…\n    // Merge the new data into the existing data.\n    // Lengthen the filter bitset to handle the new records.\n    // Notify listeners (dimensions and groups) that new data is available.\n    if (n1) {\n      data = data.concat(newData);\n      filters.lengthen(n += n1);\n      dataListeners.forEach(function(l) { l(newData, n0, n1); });\n      triggerOnChange('dataAdded');\n    }\n\n    return crossfilter;\n  }\n\n  // Removes all records that match the current filters, or if a predicate function is passed,\n  // removes all records matching the predicate (ignoring filters).\n  function removeData(predicate) {\n    var // Mapping from old record indexes to new indexes (after records removed)\n        newIndex = new Array(n),\n        removed = [],\n        usePred = typeof predicate === 'function',\n        shouldRemove = function (i) {\n          return usePred ? predicate(data[i], i) : filters.zero(i)\n        };\n\n    for (var index1 = 0, index2 = 0; index1 < n; ++index1) {\n      if ( shouldRemove(index1) ) {\n        removed.push(index1);\n        newIndex[index1] = REMOVED_INDEX;\n      } else {\n        newIndex[index1] = index2++;\n      }\n    }\n\n    // Remove all matching records from groups.\n    filterListeners.forEach(function(l) { l(-1, -1, [], removed, true); });\n\n    // Update indexes.\n    removeDataListeners.forEach(function(l) { l(newIndex); });\n\n    // Remove old filters and data by overwriting.\n    for (var index3 = 0, index4 = 0; index3 < n; ++index3) {\n      if ( newIndex[index3] !== REMOVED_INDEX ) {\n        if (index3 !== index4) filters.copy(index4, index3), data[index4] = data[index3];\n        ++index4;\n      }\n    }\n\n    data.length = n = index4;\n    filters.truncate(index4);\n    triggerOnChange('dataRemoved');\n  }\n\n  function maskForDimensions(dimensions) {\n    var n,\n        d,\n        len,\n        id,\n        mask = Array(filters.subarrays);\n    for (n = 0; n < filters.subarrays; n++) { mask[n] = ~0; }\n    for (d = 0, len = dimensions.length; d < len; d++) {\n      // The top bits of the ID are the subarray offset and the lower bits are the bit\n      // offset of the \"one\" mask.\n      id = dimensions[d].id();\n      mask[id >> 7] &= ~(0x1 << (id & 0x3f));\n    }\n    return mask;\n  }\n\n  // Return true if the data element at index i is filtered IN.\n  // Optionally, ignore the filters of any dimensions in the ignore_dimensions list.\n  function isElementFiltered(i, ignore_dimensions) {\n    var mask = maskForDimensions(ignore_dimensions || []);\n    return filters.zeroExceptMask(i,mask);\n  }\n\n  // Adds a new dimension with the specified value accessor function.\n  function dimension(value, iterable) {\n\n    if (typeof value === 'string') {\n      var accessorPath = value;\n      value = function(d) { return result(d, accessorPath); };\n    }\n\n    var dimension = {\n      filter: filter,\n      filterExact: filterExact,\n      filterRange: filterRange,\n      filterFunction: filterFunction,\n      filterAll: filterAll,\n      currentFilter: currentFilter,\n      hasCurrentFilter: hasCurrentFilter,\n      top: top,\n      bottom: bottom,\n      group: group,\n      groupAll: groupAll,\n      dispose: dispose,\n      remove: dispose, // for backwards-compatibility\n      accessor: value,\n      id: function() { return id; }\n    };\n\n    var one, // lowest unset bit as mask, e.g., 00001000\n        zero, // inverted one, e.g., 11110111\n        offset, // offset into the filters arrays\n        id, // unique ID for this dimension (reused when dimensions are disposed)\n        values, // sorted, cached array\n        index, // maps sorted value index -> record index (in data)\n        newValues, // temporary array storing newly-added values\n        newIndex, // temporary array storing newly-added index\n        iterablesIndexCount,\n        iterablesIndexFilterStatus,\n        iterablesEmptyRows = [],\n        sortRange = function(n) {\n          return cr_range(n).sort(function(A, B) {\n            var a = newValues[A], b = newValues[B];\n            return a < b ? -1 : a > b ? 1 : A - B;\n          });\n        },\n        refilter = xfilterFilter.filterAll, // for recomputing filter\n        refilterFunction, // the custom filter function in use\n        filterValue, // the value used for filtering (value, array, function or undefined)\n        filterValuePresent, // true if filterValue contains something\n        indexListeners = [], // when data is added\n        dimensionGroups = [],\n        lo0 = 0,\n        hi0 = 0,\n        t = 0,\n        k;\n\n    // Updating a dimension is a two-stage process. First, we must update the\n    // associated filters for the newly-added records. Once all dimensions have\n    // updated their filters, the groups are notified to update.\n    dataListeners.unshift(preAdd);\n    dataListeners.push(postAdd);\n\n    removeDataListeners.push(removeData);\n\n    // Add a new dimension in the filter bitmap and store the offset and bitmask.\n    var tmp = filters.add();\n    offset = tmp.offset;\n    one = tmp.one;\n    zero = ~one;\n\n    // Create a unique ID for the dimension\n    // IDs will be re-used if dimensions are disposed.\n    // For internal use the ID is the subarray offset shifted left 7 bits or'd with the\n    // bit offset of the set bit in the dimension's \"one\" mask.\n    id = (offset << 7) | (Math.log(one) / Math.log(2));\n\n    preAdd(data, 0, n);\n    postAdd(data, 0, n);\n\n    // Incorporates the specified new records into this dimension.\n    // This function is responsible for updating filters, values, and index.\n    function preAdd(newData, n0, n1) {\n      var newIterablesIndexCount,\n          newIterablesIndexFilterStatus;\n\n      if (iterable){\n        // Count all the values\n        t = 0;\n        j = 0;\n        k = [];\n\n        for (var i0 = 0; i0 < newData.length; i0++) {\n          for(j = 0, k = value(newData[i0]); j < k.length; j++) {\n            t++;\n          }\n        }\n\n        newValues = [];\n        newIterablesIndexCount = cr_range(newData.length);\n        newIterablesIndexFilterStatus = cr_index(t,1);\n        var unsortedIndex = cr_range(t);\n\n        for (var l = 0, index1 = 0; index1 < newData.length; index1++) {\n          k = value(newData[index1])\n          //\n          if(!k.length){\n            newIterablesIndexCount[index1] = 0;\n            iterablesEmptyRows.push(index1 + n0);\n            continue;\n          }\n          newIterablesIndexCount[index1] = k.length\n          for (j = 0; j < k.length; j++) {\n            newValues.push(k[j]);\n            unsortedIndex[l] = index1;\n            l++;\n          }\n        }\n\n        // Create the Sort map used to sort both the values and the valueToData indices\n        var sortMap = sortRange(t);\n\n        // Use the sortMap to sort the newValues\n        newValues = permute(newValues, sortMap);\n\n\n        // Use the sortMap to sort the unsortedIndex map\n        // newIndex should be a map of sortedValue -> crossfilterData\n        newIndex = permute(unsortedIndex, sortMap)\n\n      } else{\n        // Permute new values into natural order using a standard sorted index.\n        newValues = newData.map(value);\n        newIndex = sortRange(n1);\n        newValues = permute(newValues, newIndex);\n      }\n\n      // Bisect newValues to determine which new records are selected.\n      var bounds = refilter(newValues), lo1 = bounds[0], hi1 = bounds[1];\n\n      var index2, index3, index4;\n      if(iterable) {\n        n1 = t;\n        if (refilterFunction) {\n          for (index2 = 0; index2 < n1; ++index2) {\n            if (!refilterFunction(newValues[index2], index2)) {\n              if(--newIterablesIndexCount[newIndex[index2]] === 0) {\n                filters[offset][newIndex[index2] + n0] |= one;\n              }\n              newIterablesIndexFilterStatus[index2] = 1;\n            }\n          }\n        } else {\n          for (index3 = 0; index3 < lo1; ++index3) {\n            if(--newIterablesIndexCount[newIndex[index3]] === 0) {\n              filters[offset][newIndex[index3] + n0] |= one;\n            }\n            newIterablesIndexFilterStatus[index3] = 1;\n          }\n          for (index4 = hi1; index4 < n1; ++index4) {\n            if(--newIterablesIndexCount[newIndex[index4]] === 0) {\n              filters[offset][newIndex[index4] + n0] |= one;\n            }\n            newIterablesIndexFilterStatus[index4] = 1;\n          }\n        }\n      } else {\n        if (refilterFunction) {\n          for (index2 = 0; index2 < n1; ++index2) {\n            if (!refilterFunction(newValues[index2], index2)) {\n              filters[offset][newIndex[index2] + n0] |= one;\n            }\n          }\n        } else {\n          for (index3 = 0; index3 < lo1; ++index3) {\n            filters[offset][newIndex[index3] + n0] |= one;\n          }\n          for (index4 = hi1; index4 < n1; ++index4) {\n            filters[offset][newIndex[index4] + n0] |= one;\n          }\n        }\n      }\n\n      // If this dimension previously had no data, then we don't need to do the\n      // more expensive merge operation; use the new values and index as-is.\n      if (!n0) {\n        values = newValues;\n        index = newIndex;\n        iterablesIndexCount = newIterablesIndexCount;\n        iterablesIndexFilterStatus = newIterablesIndexFilterStatus;\n        lo0 = lo1;\n        hi0 = hi1;\n        return;\n      }\n\n\n\n      var oldValues = values,\n        oldIndex = index,\n        oldIterablesIndexFilterStatus = iterablesIndexFilterStatus,\n        old_n0,\n        i1 = 0;\n\n      i0 = 0;\n\n      if(iterable){\n        old_n0 = n0\n        n0 = oldValues.length;\n        n1 = t\n      }\n\n      // Otherwise, create new arrays into which to merge new and old.\n      values = iterable ? new Array(n0 + n1) : new Array(n);\n      index = iterable ? new Array(n0 + n1) : cr_index(n, n);\n      if(iterable) iterablesIndexFilterStatus = cr_index(n0 + n1, 1);\n\n      // Concatenate the newIterablesIndexCount onto the old one.\n      if(iterable) {\n        var oldiiclength = iterablesIndexCount.length;\n        iterablesIndexCount = xfilterArray.arrayLengthen(iterablesIndexCount, n);\n        for(var j=0; j+oldiiclength < n; j++) {\n          iterablesIndexCount[j+oldiiclength] = newIterablesIndexCount[j];\n        }\n      }\n\n      // Merge the old and new sorted values, and old and new index.\n      var index5 = 0;\n      for (; i0 < n0 && i1 < n1; ++index5) {\n        if (oldValues[i0] < newValues[i1]) {\n          values[index5] = oldValues[i0];\n          if(iterable) iterablesIndexFilterStatus[index5] = oldIterablesIndexFilterStatus[i0];\n          index[index5] = oldIndex[i0++];\n        } else {\n          values[index5] = newValues[i1];\n          if(iterable) iterablesIndexFilterStatus[index5] = newIterablesIndexFilterStatus[i1];\n          index[index5] = newIndex[i1++] + (iterable ? old_n0 : n0);\n        }\n      }\n\n      // Add any remaining old values.\n      for (; i0 < n0; ++i0, ++index5) {\n        values[index5] = oldValues[i0];\n        if(iterable) iterablesIndexFilterStatus[index5] = oldIterablesIndexFilterStatus[i0];\n        index[index5] = oldIndex[i0];\n      }\n\n      // Add any remaining new values.\n      for (; i1 < n1; ++i1, ++index5) {\n        values[index5] = newValues[i1];\n        if(iterable) iterablesIndexFilterStatus[index5] = newIterablesIndexFilterStatus[i1];\n        index[index5] = newIndex[i1] + (iterable ? old_n0 : n0);\n      }\n\n      // Bisect again to recompute lo0 and hi0.\n      bounds = refilter(values), lo0 = bounds[0], hi0 = bounds[1];\n    }\n\n    // When all filters have updated, notify index listeners of the new values.\n    function postAdd(newData, n0, n1) {\n      indexListeners.forEach(function(l) { l(newValues, newIndex, n0, n1); });\n      newValues = newIndex = null;\n    }\n\n    function removeData(reIndex) {\n      if (iterable) {\n        for (var i0 = 0, i1 = 0; i0 < iterablesEmptyRows.length; i0++) {\n          if (reIndex[iterablesEmptyRows[i0]] !== REMOVED_INDEX) {\n            iterablesEmptyRows[i1] = reIndex[iterablesEmptyRows[i0]];\n            i1++;\n          }\n        }\n        iterablesEmptyRows.length = i1;\n        for (i0 = 0, i1 = 0; i0 < n; i0++) {\n          if (reIndex[i0] !== REMOVED_INDEX) {\n            if (i1 !== i0) iterablesIndexCount[i1] = iterablesIndexCount[i0];\n            i1++;\n          }\n        }\n        iterablesIndexCount = iterablesIndexCount.slice(0, i1);\n      }\n      // Rewrite our index, overwriting removed values\n      var n0 = values.length;\n      for (var i = 0, j = 0, oldDataIndex; i < n0; ++i) {\n        oldDataIndex = index[i];\n        if (reIndex[oldDataIndex] !== REMOVED_INDEX) {\n          if (i !== j) values[j] = values[i];\n          index[j] = reIndex[oldDataIndex];\n          if (iterable) {\n            iterablesIndexFilterStatus[j] = iterablesIndexFilterStatus[i];\n          }\n          ++j;\n        }\n      }\n      values.length = j;\n      if (iterable) iterablesIndexFilterStatus = iterablesIndexFilterStatus.slice(0, j);\n      while (j < n0) index[j++] = 0;\n\n      // Bisect again to recompute lo0 and hi0.\n      var bounds = refilter(values);\n      lo0 = bounds[0], hi0 = bounds[1];\n    }\n\n    // Updates the selected values based on the specified bounds [lo, hi].\n    // This implementation is used by all the public filter methods.\n    function filterIndexBounds(bounds) {\n\n      var lo1 = bounds[0],\n          hi1 = bounds[1];\n\n      if (refilterFunction) {\n        refilterFunction = null;\n        filterIndexFunction(function(d, i) { return lo1 <= i && i < hi1; }, bounds[0] === 0 && bounds[1] === values.length);\n        lo0 = lo1;\n        hi0 = hi1;\n        return dimension;\n      }\n\n      var i,\n          j,\n          k,\n          added = [],\n          removed = [],\n          valueIndexAdded = [],\n          valueIndexRemoved = [];\n\n\n      // Fast incremental update based on previous lo index.\n      if (lo1 < lo0) {\n        for (i = lo1, j = Math.min(lo0, hi1); i < j; ++i) {\n          added.push(index[i]);\n          valueIndexAdded.push(i);\n        }\n      } else if (lo1 > lo0) {\n        for (i = lo0, j = Math.min(lo1, hi0); i < j; ++i) {\n          removed.push(index[i]);\n          valueIndexRemoved.push(i);\n        }\n      }\n\n      // Fast incremental update based on previous hi index.\n      if (hi1 > hi0) {\n        for (i = Math.max(lo1, hi0), j = hi1; i < j; ++i) {\n          added.push(index[i]);\n          valueIndexAdded.push(i);\n        }\n      } else if (hi1 < hi0) {\n        for (i = Math.max(lo0, hi1), j = hi0; i < j; ++i) {\n          removed.push(index[i]);\n          valueIndexRemoved.push(i);\n        }\n      }\n\n      if(!iterable) {\n        // Flip filters normally.\n\n        for(i=0; i<added.length; i++) {\n          filters[offset][added[i]] ^= one;\n        }\n\n        for(i=0; i<removed.length; i++) {\n          filters[offset][removed[i]] ^= one;\n        }\n\n      } else {\n        // For iterables, we need to figure out if the row has been completely removed vs partially included\n        // Only count a row as added if it is not already being aggregated. Only count a row\n        // as removed if the last element being aggregated is removed.\n\n        var newAdded = [];\n        var newRemoved = [];\n        for (i = 0; i < added.length; i++) {\n          iterablesIndexCount[added[i]]++\n          iterablesIndexFilterStatus[valueIndexAdded[i]] = 0;\n          if(iterablesIndexCount[added[i]] === 1) {\n            filters[offset][added[i]] ^= one;\n            newAdded.push(added[i]);\n          }\n        }\n        for (i = 0; i < removed.length; i++) {\n          iterablesIndexCount[removed[i]]--\n          iterablesIndexFilterStatus[valueIndexRemoved[i]] = 1;\n          if(iterablesIndexCount[removed[i]] === 0) {\n            filters[offset][removed[i]] ^= one;\n            newRemoved.push(removed[i]);\n          }\n        }\n\n        added = newAdded;\n        removed = newRemoved;\n\n        // Now handle empty rows.\n        if(refilter === xfilterFilter.filterAll) {\n          for(i = 0; i < iterablesEmptyRows.length; i++) {\n            if((filters[offset][k = iterablesEmptyRows[i]] & one)) {\n              // Was not in the filter, so set the filter and add\n              filters[offset][k] ^= one;\n              added.push(k);\n            }\n          }\n        } else {\n          // filter in place - remove empty rows if necessary\n          for(i = 0; i < iterablesEmptyRows.length; i++) {\n            if(!(filters[offset][k = iterablesEmptyRows[i]] & one)) {\n              // Was in the filter, so set the filter and remove\n              filters[offset][k] ^= one;\n              removed.push(k);\n            }\n          }\n        }\n      }\n\n      lo0 = lo1;\n      hi0 = hi1;\n      filterListeners.forEach(function(l) { l(one, offset, added, removed); });\n      triggerOnChange('filtered');\n      return dimension;\n    }\n\n    // Filters this dimension using the specified range, value, or null.\n    // If the range is null, this is equivalent to filterAll.\n    // If the range is an array, this is equivalent to filterRange.\n    // Otherwise, this is equivalent to filterExact.\n    function filter(range) {\n      return range == null\n          ? filterAll() : Array.isArray(range)\n          ? filterRange(range) : typeof range === \"function\"\n          ? filterFunction(range)\n          : filterExact(range);\n    }\n\n    // Filters this dimension to select the exact value.\n    function filterExact(value) {\n      filterValue = value;\n      filterValuePresent = true;\n      return filterIndexBounds((refilter = xfilterFilter.filterExact(bisect, value))(values));\n    }\n\n    // Filters this dimension to select the specified range [lo, hi].\n    // The lower bound is inclusive, and the upper bound is exclusive.\n    function filterRange(range) {\n      filterValue = range;\n      filterValuePresent = true;\n      return filterIndexBounds((refilter = xfilterFilter.filterRange(bisect, range))(values));\n    }\n\n    // Clears any filters on this dimension.\n    function filterAll() {\n      filterValue = undefined;\n      filterValuePresent = false;\n      return filterIndexBounds((refilter = xfilterFilter.filterAll)(values));\n    }\n\n    // Filters this dimension using an arbitrary function.\n    function filterFunction(f) {\n      filterValue = f;\n      filterValuePresent = true;\n      \n      refilterFunction = f;\n      refilter = xfilterFilter.filterAll;\n\n      filterIndexFunction(f, false);\n\n      var bounds = refilter(values);\n      lo0 = bounds[0], hi0 = bounds[1];\n\n      return dimension;\n    }\n\n    function filterIndexFunction(f, filterAll) {\n      var i,\n          k,\n          x,\n          added = [],\n          removed = [],\n          valueIndexAdded = [],\n          valueIndexRemoved = [],\n          indexLength = values.length;\n\n      if(!iterable) {\n        for (i = 0; i < indexLength; ++i) {\n          if (!(filters[offset][k = index[i]] & one) ^ !!(x = f(values[i], i))) {\n            if (x) added.push(k);\n            else removed.push(k);\n          }\n        }\n      }\n\n      if(iterable) {\n        for(i=0; i < indexLength; ++i) {\n          if(f(values[i], i)) {\n            added.push(index[i]);\n            valueIndexAdded.push(i);\n          } else {\n            removed.push(index[i]);\n            valueIndexRemoved.push(i);\n          }\n        }\n      }\n\n      if(!iterable) {\n        for(i=0; i<added.length; i++) {\n          if(filters[offset][added[i]] & one) filters[offset][added[i]] &= zero;\n        }\n\n        for(i=0; i<removed.length; i++) {\n          if(!(filters[offset][removed[i]] & one)) filters[offset][removed[i]] |= one;\n        }\n      } else {\n\n        var newAdded = [];\n        var newRemoved = [];\n        for (i = 0; i < added.length; i++) {\n          // First check this particular value needs to be added\n          if(iterablesIndexFilterStatus[valueIndexAdded[i]] === 1) {\n            iterablesIndexCount[added[i]]++\n            iterablesIndexFilterStatus[valueIndexAdded[i]] = 0;\n            if(iterablesIndexCount[added[i]] === 1) {\n              filters[offset][added[i]] ^= one;\n              newAdded.push(added[i]);\n            }\n          }\n        }\n        for (i = 0; i < removed.length; i++) {\n          // First check this particular value needs to be removed\n          if(iterablesIndexFilterStatus[valueIndexRemoved[i]] === 0) {\n            iterablesIndexCount[removed[i]]--\n            iterablesIndexFilterStatus[valueIndexRemoved[i]] = 1;\n            if(iterablesIndexCount[removed[i]] === 0) {\n              filters[offset][removed[i]] ^= one;\n              newRemoved.push(removed[i]);\n            }\n          }\n        }\n\n        added = newAdded;\n        removed = newRemoved;\n\n        // Now handle empty rows.\n        if(filterAll) {\n          for(i = 0; i < iterablesEmptyRows.length; i++) {\n            if((filters[offset][k = iterablesEmptyRows[i]] & one)) {\n              // Was not in the filter, so set the filter and add\n              filters[offset][k] ^= one;\n              added.push(k);\n            }\n          }\n        } else {\n          // filter in place - remove empty rows if necessary\n          for(i = 0; i < iterablesEmptyRows.length; i++) {\n            if(!(filters[offset][k = iterablesEmptyRows[i]] & one)) {\n              // Was in the filter, so set the filter and remove\n              filters[offset][k] ^= one;\n              removed.push(k);\n            }\n          }\n        }\n      }\n\n      filterListeners.forEach(function(l) { l(one, offset, added, removed); });\n      triggerOnChange('filtered');\n    }\n    \n    function currentFilter() {\n      return filterValue;\n    }\n    \n    function hasCurrentFilter() {\n      return filterValuePresent;\n    }\n\n    // Returns the top K selected records based on this dimension's order.\n    // Note: observes this dimension's filter, unlike group and groupAll.\n    function top(k, top_offset) {\n      var array = [],\n          i = hi0,\n          j,\n          toSkip = 0;\n\n      if(top_offset && top_offset > 0) toSkip = top_offset;\n\n      while (--i >= lo0 && k > 0) {\n        if (filters.zero(j = index[i])) {\n          if(toSkip > 0) {\n            //skip matching row\n            --toSkip;\n          } else {\n            array.push(data[j]);\n            --k;\n          }\n        }\n      }\n\n      if(iterable){\n        for(i = 0; i < iterablesEmptyRows.length && k > 0; i++) {\n          // Add row with empty iterable column at the end\n          if(filters.zero(j = iterablesEmptyRows[i])) {\n            if(toSkip > 0) {\n              //skip matching row\n              --toSkip;\n            } else {\n              array.push(data[j]);\n              --k;\n            }\n          }\n        }\n      }\n\n      return array;\n    }\n\n    // Returns the bottom K selected records based on this dimension's order.\n    // Note: observes this dimension's filter, unlike group and groupAll.\n    function bottom(k, bottom_offset) {\n      var array = [],\n          i,\n          j,\n          toSkip = 0;\n\n      if(bottom_offset && bottom_offset > 0) toSkip = bottom_offset;\n\n      if(iterable) {\n        // Add row with empty iterable column at the top\n        for(i = 0; i < iterablesEmptyRows.length && k > 0; i++) {\n          if(filters.zero(j = iterablesEmptyRows[i])) {\n            if(toSkip > 0) {\n              //skip matching row\n              --toSkip;\n            } else {\n              array.push(data[j]);\n              --k;\n            }\n          }\n        }\n      }\n\n      i = lo0;\n\n      while (i < hi0 && k > 0) {\n        if (filters.zero(j = index[i])) {\n          if(toSkip > 0) {\n            //skip matching row\n            --toSkip;\n          } else {\n            array.push(data[j]);\n            --k;\n          }\n        }\n        i++;\n      }\n\n      return array;\n    }\n\n    // Adds a new group to this dimension, using the specified key function.\n    function group(key) {\n      var group = {\n        top: top,\n        all: all,\n        reduce: reduce,\n        reduceCount: reduceCount,\n        reduceSum: reduceSum,\n        order: order,\n        orderNatural: orderNatural,\n        size: size,\n        dispose: dispose,\n        remove: dispose // for backwards-compatibility\n      };\n\n      // Ensure that this group will be removed when the dimension is removed.\n      dimensionGroups.push(group);\n\n      var groups, // array of {key, value}\n          groupIndex, // object id ↦ group id\n          groupWidth = 8,\n          groupCapacity = capacity(groupWidth),\n          k = 0, // cardinality\n          select,\n          heap,\n          reduceAdd,\n          reduceRemove,\n          reduceInitial,\n          update = cr_null,\n          reset = cr_null,\n          resetNeeded = true,\n          groupAll = key === cr_null,\n          n0old;\n\n      if (arguments.length < 1) key = cr_identity;\n\n      // The group listens to the crossfilter for when any dimension changes, so\n      // that it can update the associated reduce values. It must also listen to\n      // the parent dimension for when data is added, and compute new keys.\n      filterListeners.push(update);\n      indexListeners.push(add);\n      removeDataListeners.push(removeData);\n\n      // Incorporate any existing data into the grouping.\n      add(values, index, 0, n);\n\n      // Incorporates the specified new values into this group.\n      // This function is responsible for updating groups and groupIndex.\n      function add(newValues, newIndex, n0, n1) {\n\n        if(iterable) {\n          n0old = n0\n          n0 = values.length - newValues.length\n          n1 = newValues.length;\n        }\n\n        var oldGroups = groups,\n            reIndex = iterable ? [] : cr_index(k, groupCapacity),\n            add = reduceAdd,\n            remove = reduceRemove,\n            initial = reduceInitial,\n            k0 = k, // old cardinality\n            i0 = 0, // index of old group\n            i1 = 0, // index of new record\n            j, // object id\n            g0, // old group\n            x0, // old key\n            x1, // new key\n            g, // group to add\n            x; // key of group to add\n\n        // If a reset is needed, we don't need to update the reduce values.\n        if (resetNeeded) add = initial = cr_null;\n        if (resetNeeded) remove = initial = cr_null;\n\n        // Reset the new groups (k is a lower bound).\n        // Also, make sure that groupIndex exists and is long enough.\n        groups = new Array(k), k = 0;\n        if(iterable){\n          groupIndex = k0 ? groupIndex : [];\n        }\n        else{\n          groupIndex = k0 > 1 ? xfilterArray.arrayLengthen(groupIndex, n) : cr_index(n, groupCapacity);\n        }\n\n\n        // Get the first old key (x0 of g0), if it exists.\n        if (k0) x0 = (g0 = oldGroups[0]).key;\n\n        // Find the first new key (x1), skipping NaN keys.\n        while (i1 < n1 && !((x1 = key(newValues[i1])) >= x1)) ++i1;\n\n        // While new keys remain…\n        while (i1 < n1) {\n\n          // Determine the lesser of the two current keys; new and old.\n          // If there are no old keys remaining, then always add the new key.\n          if (g0 && x0 <= x1) {\n            g = g0, x = x0;\n\n            // Record the new index of the old group.\n            reIndex[i0] = k;\n\n            // Retrieve the next old key.\n            g0 = oldGroups[++i0];\n            if (g0) x0 = g0.key;\n          } else {\n            g = {key: x1, value: initial()}, x = x1;\n          }\n\n          // Add the lesser group.\n          groups[k] = g;\n\n          // Add any selected records belonging to the added group, while\n          // advancing the new key and populating the associated group index.\n\n          while (x1 <= x) {\n            j = newIndex[i1] + (iterable ? n0old : n0)\n\n\n            if(iterable){\n              if(groupIndex[j]){\n                groupIndex[j].push(k)\n              }\n              else{\n                groupIndex[j] = [k]\n              }\n            }\n            else{\n              groupIndex[j] = k;\n            }\n\n            // Always add new values to groups. Only remove when not in filter.\n            // This gives groups full information on data life-cycle.\n            g.value = add(g.value, data[j], true);\n            if (!filters.zeroExcept(j, offset, zero)) g.value = remove(g.value, data[j], false);\n            if (++i1 >= n1) break;\n            x1 = key(newValues[i1]);\n          }\n\n          groupIncrement();\n        }\n\n        // Add any remaining old groups that were greater th1an all new keys.\n        // No incremental reduce is needed; these groups have no new records.\n        // Also record the new index of the old group.\n        while (i0 < k0) {\n          groups[reIndex[i0] = k] = oldGroups[i0++];\n          groupIncrement();\n        }\n\n\n        // Fill in gaps with empty arrays where there may have been rows with empty iterables\n        if(iterable){\n          for (var index1 = 0; index1 < n; index1++) {\n            if(!groupIndex[index1]){\n              groupIndex[index1] = [];\n            }\n          }\n        }\n\n        // If we added any new groups before any old groups,\n        // update the group index of all the old records.\n        if(k > i0){\n          if(iterable){\n            for (i0 = 0; i0 < n0old; ++i0) {\n              for (index1 = 0; index1 < groupIndex[i0].length; index1++) {\n                groupIndex[i0][index1] = reIndex[groupIndex[i0][index1]];\n              }\n            }\n          }\n          else{\n            for (i0 = 0; i0 < n0; ++i0) {\n              groupIndex[i0] = reIndex[groupIndex[i0]];\n            }\n          }\n        }\n\n        // Modify the update and reset behavior based on the cardinality.\n        // If the cardinality is less than or equal to one, then the groupIndex\n        // is not needed. If the cardinality is zero, then there are no records\n        // and therefore no groups to update or reset. Note that we also must\n        // change the registered listener to point to the new method.\n        j = filterListeners.indexOf(update);\n        if (k > 1 || iterable) {\n          update = updateMany;\n          reset = resetMany;\n        } else {\n          if (!k && groupAll) {\n            k = 1;\n            groups = [{key: null, value: initial()}];\n          }\n          if (k === 1) {\n            update = updateOne;\n            reset = resetOne;\n          } else {\n            update = cr_null;\n            reset = cr_null;\n          }\n          groupIndex = null;\n        }\n        filterListeners[j] = update;\n\n        // Count the number of added groups,\n        // and widen the group index as needed.\n        function groupIncrement() {\n          if(iterable){\n            k++\n            return\n          }\n          if (++k === groupCapacity) {\n            reIndex = xfilterArray.arrayWiden(reIndex, groupWidth <<= 1);\n            groupIndex = xfilterArray.arrayWiden(groupIndex, groupWidth);\n            groupCapacity = capacity(groupWidth);\n          }\n        }\n      }\n\n      function removeData(reIndex) {\n        if (k > 1 || iterable) {\n          var oldK = k,\n              oldGroups = groups,\n              seenGroups = cr_index(oldK, oldK),\n              i,\n              i0,\n              j;\n\n          // Filter out non-matches by copying matching group index entries to\n          // the beginning of the array.\n          if (!iterable) {\n            for (i = 0, j = 0; i < n; ++i) {\n              if (reIndex[i] !== REMOVED_INDEX) {\n                seenGroups[groupIndex[j] = groupIndex[i]] = 1;\n                ++j;\n              }\n            }\n          } else {\n            for (i = 0, j = 0; i < n; ++i) {\n              if (reIndex[i] !== REMOVED_INDEX) {\n                groupIndex[j] = groupIndex[i];\n                for (i0 = 0; i0 < groupIndex[j].length; i0++) {\n                  seenGroups[groupIndex[j][i0]] = 1;\n                }\n                ++j;\n              }\n            }\n          }\n\n          // Reassemble groups including only those groups that were referred\n          // to by matching group index entries.  Note the new group index in\n          // seenGroups.\n          groups = [], k = 0;\n          for (i = 0; i < oldK; ++i) {\n            if (seenGroups[i]) {\n              seenGroups[i] = k++;\n              groups.push(oldGroups[i]);\n            }\n          }\n\n          if (k > 1 || iterable) {\n            // Reindex the group index using seenGroups to find the new index.\n            if (!iterable) {\n              for (i = 0; i < j; ++i) groupIndex[i] = seenGroups[groupIndex[i]];\n            } else {\n              for (i = 0; i < j; ++i) {\n                for (i0 = 0; i0 < groupIndex[i].length; ++i0) {\n                  groupIndex[i][i0] = seenGroups[groupIndex[i][i0]];\n                }\n              }\n            }\n          } else {\n            groupIndex = null;\n          }\n          filterListeners[filterListeners.indexOf(update)] = k > 1 || iterable\n              ? (reset = resetMany, update = updateMany)\n              : k === 1 ? (reset = resetOne, update = updateOne)\n              : reset = update = cr_null;\n        } else if (k === 1) {\n          if (groupAll) return;\n          for (var index3 = 0; index3 < n; ++index3) if (reIndex[index3] !== REMOVED_INDEX) return;\n          groups = [], k = 0;\n          filterListeners[filterListeners.indexOf(update)] =\n          update = reset = cr_null;\n        }\n      }\n\n      // Reduces the specified selected or deselected records.\n      // This function is only used when the cardinality is greater than 1.\n      // notFilter indicates a crossfilter.add/remove operation.\n      function updateMany(filterOne, filterOffset, added, removed, notFilter) {\n\n        if ((filterOne === one && filterOffset === offset) || resetNeeded) return;\n\n        var i,\n            j,\n            k,\n            n,\n            g;\n\n        if(iterable){\n          // Add the added values.\n          for (i = 0, n = added.length; i < n; ++i) {\n            if (filters.zeroExcept(k = added[i], offset, zero)) {\n              for (j = 0; j < groupIndex[k].length; j++) {\n                g = groups[groupIndex[k][j]];\n                g.value = reduceAdd(g.value, data[k], false, j);\n              }\n            }\n          }\n\n          // Remove the removed values.\n          for (i = 0, n = removed.length; i < n; ++i) {\n            if (filters.onlyExcept(k = removed[i], offset, zero, filterOffset, filterOne)) {\n              for (j = 0; j < groupIndex[k].length; j++) {\n                g = groups[groupIndex[k][j]];\n                g.value = reduceRemove(g.value, data[k], notFilter, j);\n              }\n            }\n          }\n          return;\n        }\n\n        // Add the added values.\n        for (i = 0, n = added.length; i < n; ++i) {\n          if (filters.zeroExcept(k = added[i], offset, zero)) {\n            g = groups[groupIndex[k]];\n            g.value = reduceAdd(g.value, data[k], false);\n          }\n        }\n\n        // Remove the removed values.\n        for (i = 0, n = removed.length; i < n; ++i) {\n          if (filters.onlyExcept(k = removed[i], offset, zero, filterOffset, filterOne)) {\n            g = groups[groupIndex[k]];\n            g.value = reduceRemove(g.value, data[k], notFilter);\n          }\n        }\n      }\n\n      // Reduces the specified selected or deselected records.\n      // This function is only used when the cardinality is 1.\n      // notFilter indicates a crossfilter.add/remove operation.\n      function updateOne(filterOne, filterOffset, added, removed, notFilter) {\n        if ((filterOne === one && filterOffset === offset) || resetNeeded) return;\n\n        var i,\n            k,\n            n,\n            g = groups[0];\n\n        // Add the added values.\n        for (i = 0, n = added.length; i < n; ++i) {\n          if (filters.zeroExcept(k = added[i], offset, zero)) {\n            g.value = reduceAdd(g.value, data[k], false);\n          }\n        }\n\n        // Remove the removed values.\n        for (i = 0, n = removed.length; i < n; ++i) {\n          if (filters.onlyExcept(k = removed[i], offset, zero, filterOffset, filterOne)) {\n            g.value = reduceRemove(g.value, data[k], notFilter);\n          }\n        }\n      }\n\n      // Recomputes the group reduce values from scratch.\n      // This function is only used when the cardinality is greater than 1.\n      function resetMany() {\n        var i,\n            j,\n            g;\n\n        // Reset all group values.\n        for (i = 0; i < k; ++i) {\n          groups[i].value = reduceInitial();\n        }\n\n        // We add all records and then remove filtered records so that reducers\n        // can build an 'unfiltered' view even if there are already filters in\n        // place on other dimensions.\n        if(iterable){\n          for (i = 0; i < n; ++i) {\n            for (j = 0; j < groupIndex[i].length; j++) {\n              g = groups[groupIndex[i][j]];\n              g.value = reduceAdd(g.value, data[i], true, j);\n            }\n          }\n          for (i = 0; i < n; ++i) {\n            if (!filters.zeroExcept(i, offset, zero)) {\n              for (j = 0; j < groupIndex[i].length; j++) {\n                g = groups[groupIndex[i][j]];\n                g.value = reduceRemove(g.value, data[i], false, j);\n              }\n            }\n          }\n          return;\n        }\n\n        for (i = 0; i < n; ++i) {\n          g = groups[groupIndex[i]];\n          g.value = reduceAdd(g.value, data[i], true);\n        }\n        for (i = 0; i < n; ++i) {\n          if (!filters.zeroExcept(i, offset, zero)) {\n            g = groups[groupIndex[i]];\n            g.value = reduceRemove(g.value, data[i], false);\n          }\n        }\n      }\n\n      // Recomputes the group reduce values from scratch.\n      // This function is only used when the cardinality is 1.\n      function resetOne() {\n        var i,\n            g = groups[0];\n\n        // Reset the singleton group values.\n        g.value = reduceInitial();\n\n        // We add all records and then remove filtered records so that reducers\n        // can build an 'unfiltered' view even if there are already filters in\n        // place on other dimensions.\n        for (i = 0; i < n; ++i) {\n          g.value = reduceAdd(g.value, data[i], true);\n        }\n\n        for (i = 0; i < n; ++i) {\n          if (!filters.zeroExcept(i, offset, zero)) {\n            g.value = reduceRemove(g.value, data[i], false);\n          }\n        }\n      }\n\n      // Returns the array of group values, in the dimension's natural order.\n      function all() {\n        if (resetNeeded) reset(), resetNeeded = false;\n        return groups;\n      }\n\n      // Returns a new array containing the top K group values, in reduce order.\n      function top(k) {\n        var top = select(all(), 0, groups.length, k);\n        return heap.sort(top, 0, top.length);\n      }\n\n      // Sets the reduce behavior for this group to use the specified functions.\n      // This method lazily recomputes the reduce values, waiting until needed.\n      function reduce(add, remove, initial) {\n        reduceAdd = add;\n        reduceRemove = remove;\n        reduceInitial = initial;\n        resetNeeded = true;\n        return group;\n      }\n\n      // A convenience method for reducing by count.\n      function reduceCount() {\n        return reduce(xfilterReduce.reduceIncrement, xfilterReduce.reduceDecrement, cr_zero);\n      }\n\n      // A convenience method for reducing by sum(value).\n      function reduceSum(value) {\n        return reduce(xfilterReduce.reduceAdd(value), xfilterReduce.reduceSubtract(value), cr_zero);\n      }\n\n      // Sets the reduce order, using the specified accessor.\n      function order(value) {\n        select = xfilterHeapselect.by(valueOf);\n        heap = xfilterHeap.by(valueOf);\n        function valueOf(d) { return value(d.value); }\n        return group;\n      }\n\n      // A convenience method for natural ordering by reduce value.\n      function orderNatural() {\n        return order(cr_identity);\n      }\n\n      // Returns the cardinality of this group, irrespective of any filters.\n      function size() {\n        return k;\n      }\n\n      // Removes this group and associated event listeners.\n      function dispose() {\n        var i = filterListeners.indexOf(update);\n        if (i >= 0) filterListeners.splice(i, 1);\n        i = indexListeners.indexOf(add);\n        if (i >= 0) indexListeners.splice(i, 1);\n        i = removeDataListeners.indexOf(removeData);\n        if (i >= 0) removeDataListeners.splice(i, 1);\n        i = dimensionGroups.indexOf(group);\n        if (i >= 0) dimensionGroups.splice(i, 1);\n        return group;\n      }\n\n      return reduceCount().orderNatural();\n    }\n\n    // A convenience function for generating a singleton group.\n    function groupAll() {\n      var g = group(cr_null), all = g.all;\n      delete g.all;\n      delete g.top;\n      delete g.order;\n      delete g.orderNatural;\n      delete g.size;\n      g.value = function() { return all()[0].value; };\n      return g;\n    }\n\n    // Removes this dimension and associated groups and event listeners.\n    function dispose() {\n      dimensionGroups.forEach(function(group) { group.dispose(); });\n      var i = dataListeners.indexOf(preAdd);\n      if (i >= 0) dataListeners.splice(i, 1);\n      i = dataListeners.indexOf(postAdd);\n      if (i >= 0) dataListeners.splice(i, 1);\n      i = removeDataListeners.indexOf(removeData);\n      if (i >= 0) removeDataListeners.splice(i, 1);\n      filters.masks[offset] &= zero;\n      return filterAll();\n    }\n\n    return dimension;\n  }\n\n  // A convenience method for groupAll on a dummy dimension.\n  // This implementation can be optimized since it always has cardinality 1.\n  function groupAll() {\n    var group = {\n      reduce: reduce,\n      reduceCount: reduceCount,\n      reduceSum: reduceSum,\n      value: value,\n      dispose: dispose,\n      remove: dispose // for backwards-compatibility\n    };\n\n    var reduceValue,\n        reduceAdd,\n        reduceRemove,\n        reduceInitial,\n        resetNeeded = true;\n\n    // The group listens to the crossfilter for when any dimension changes, so\n    // that it can update the reduce value. It must also listen to the parent\n    // dimension for when data is added.\n    filterListeners.push(update);\n    dataListeners.push(add);\n\n    // For consistency; actually a no-op since resetNeeded is true.\n    add(data, 0, n);\n\n    // Incorporates the specified new values into this group.\n    function add(newData, n0) {\n      var i;\n\n      if (resetNeeded) return;\n\n      // Cycle through all the values.\n      for (i = n0; i < n; ++i) {\n\n        // Add all values all the time.\n        reduceValue = reduceAdd(reduceValue, data[i], true);\n\n        // Remove the value if filtered.\n        if (!filters.zero(i)) {\n          reduceValue = reduceRemove(reduceValue, data[i], false);\n        }\n      }\n    }\n\n    // Reduces the specified selected or deselected records.\n    function update(filterOne, filterOffset, added, removed, notFilter) {\n      var i,\n          k,\n          n;\n\n      if (resetNeeded) return;\n\n      // Add the added values.\n      for (i = 0, n = added.length; i < n; ++i) {\n        if (filters.zero(k = added[i])) {\n          reduceValue = reduceAdd(reduceValue, data[k], notFilter);\n        }\n      }\n\n      // Remove the removed values.\n      for (i = 0, n = removed.length; i < n; ++i) {\n        if (filters.only(k = removed[i], filterOffset, filterOne)) {\n          reduceValue = reduceRemove(reduceValue, data[k], notFilter);\n        }\n      }\n    }\n\n    // Recomputes the group reduce value from scratch.\n    function reset() {\n      var i;\n\n      reduceValue = reduceInitial();\n\n      // Cycle through all the values.\n      for (i = 0; i < n; ++i) {\n\n        // Add all values all the time.\n        reduceValue = reduceAdd(reduceValue, data[i], true);\n\n        // Remove the value if it is filtered.\n        if (!filters.zero(i)) {\n          reduceValue = reduceRemove(reduceValue, data[i], false);\n        }\n      }\n    }\n\n    // Sets the reduce behavior for this group to use the specified functions.\n    // This method lazily recomputes the reduce value, waiting until needed.\n    function reduce(add, remove, initial) {\n      reduceAdd = add;\n      reduceRemove = remove;\n      reduceInitial = initial;\n      resetNeeded = true;\n      return group;\n    }\n\n    // A convenience method for reducing by count.\n    function reduceCount() {\n      return reduce(xfilterReduce.reduceIncrement, xfilterReduce.reduceDecrement, cr_zero);\n    }\n\n    // A convenience method for reducing by sum(value).\n    function reduceSum(value) {\n      return reduce(xfilterReduce.reduceAdd(value), xfilterReduce.reduceSubtract(value), cr_zero);\n    }\n\n    // Returns the computed reduce value.\n    function value() {\n      if (resetNeeded) reset(), resetNeeded = false;\n      return reduceValue;\n    }\n\n    // Removes this group and associated event listeners.\n    function dispose() {\n      var i = filterListeners.indexOf(update);\n      if (i >= 0) filterListeners.splice(i, 1);\n      i = dataListeners.indexOf(add);\n      if (i >= 0) dataListeners.splice(i, 1);\n      return group;\n    }\n\n    return reduceCount();\n  }\n\n  // Returns the number of records in this crossfilter, irrespective of any filters.\n  function size() {\n    return n;\n  }\n\n  // Returns the raw row data contained in this crossfilter\n  function all(){\n    return data;\n  }\n\n  // Returns row data with all dimension filters applied, except for filters in ignore_dimensions\n  function allFiltered(ignore_dimensions) {\n    var array = [],\n        i = 0,\n        mask = maskForDimensions(ignore_dimensions || []);\n\n      for (i = 0; i < n; i++) {\n        if (filters.zeroExceptMask(i, mask)) {\n          array.push(data[i]);\n        }\n      }\n\n      return array;\n  }\n\n  function onChange(cb){\n    if(typeof cb !== 'function'){\n      /* eslint no-console: 0 */\n      console.warn('onChange callback parameter must be a function!');\n      return;\n    }\n    callbacks.push(cb);\n    return function(){\n      callbacks.splice(callbacks.indexOf(cb), 1);\n    };\n  }\n\n  function triggerOnChange(eventName){\n    for (var i = 0; i < callbacks.length; i++) {\n      callbacks[i](eventName);\n    }\n  }\n\n  return arguments.length\n      ? add(arguments[0])\n      : crossfilter;\n}\n\n// Returns an array of size n, big enough to store ids up to m.\nfunction cr_index(n, m) {\n  return (m < 0x101\n      ? xfilterArray.array8 : m < 0x10001\n      ? xfilterArray.array16\n      : xfilterArray.array32)(n);\n}\n\n// Constructs a new array of size n, with sequential values from 0 to n - 1.\nfunction cr_range(n) {\n  var range = cr_index(n, n);\n  for (var i = -1; ++i < n;) range[i] = i;\n  return range;\n}\n\nfunction capacity(w) {\n  return w === 8\n      ? 0x100 : w === 16\n      ? 0x10000\n      : 0x100000000;\n}\n","export default function(t,e,i,n,r){for(r in n=(i=i.split(\".\")).splice(-1,1),i)e=e[i[r]]=e[i[r]]||{};return t(e,n)};\n//# sourceMappingURL=deepobj.m.js.map\n","import {d3} from './lib';\nimport crossfilter from 'crossfilter2';\n\n/* Decompresses ideogram's annotations for crossfilter initialization\nBy default, annotations are clustered by chromosome, e.g.\n[\n  {\"chr\": \"1\", \"annots\": [{\"from\": 100, \"to\", 101, \"chr\": \"1\", ...}, ...]},\n  {\"chr\": \"2\", \"annots\": [{\"from\": 500, \"to\", 501, \"chr\": \"2\", ...}, ...]},\n  ...\n]\nThis method flattens that structure to e.g.\n[\n  {\"from\": 100, \"to\": 101, \"chr\": \"1\", ...},\n  ...\n  {\"from\": 500, \"to\": 501, \"chr\": \"2\", ...},\n]\nSee also: packAnnots\n*/\nfunction unpackAnnots() {\n  var chr, annots, i,\n    unpackedAnnots = [],\n    ideo = this,\n    chrs = ideo.annots;\n\n  for (i = 0; i < chrs.length; i++) {\n    chr = chrs[i];\n    annots = chr.annots;\n    unpackedAnnots = unpackedAnnots.concat(annots);\n  }\n\n  return unpackedAnnots;\n}\n\n/*\n  Compresses annots back to default state.  Inverse of unpackAnnots.\n*/\nfunction packAnnots(unpackedAnnots) {\n  var chr, annot, i,\n    annots = [],\n    ideo = this,\n    chrs = ideo.annots;\n\n  for (chr in chrs) {\n    annots.push({chr: chrs[chr].chr, annots: []});\n  }\n\n  for (i = 0; i < unpackedAnnots.length; i++) {\n    annot = unpackedAnnots[i];\n    annots[annot.chrIndex].annots.push(annot);\n  }\n\n  return annots;\n}\n\n/*\n  Initializes crossfilter.  Needed for client-side filtering.\n  More: https://github.com/square/crossfilter/wiki/API-Reference\n*/\nfunction initCrossFilter() {\n  var i, facet,\n    ideo = this,\n    keys = ideo.rawAnnots.keys;\n\n  ideo.unpackedAnnots = ideo.unpackAnnots();\n  ideo.crossfilter = crossfilter(ideo.unpackedAnnots);\n\n  ideo.annotsByFacet = {};\n  ideo.facets = keys.slice(3, keys.length);\n\n  for (i = 0; i < ideo.facets.length; i++) {\n    facet = ideo.facets[i];\n    ideo.annotsByFacet[facet] =\n      ideo.crossfilter.dimension(function(d) {\n        return d[facet];\n      });\n  }\n\n  if ('filterSelections' in ideo) {\n    ideo.filterAnnots(ideo.filterSelections);\n  }\n\n  ideo.filteredAnnots = ideo.annots;\n}\n\nfunction getFilteredResults(selections, ideo) {\n  var fn, i, facet, results, filter,\n    counts = {};\n\n  if (Object.keys(selections).length === 0) {\n    results = ideo.unpackedAnnots;\n  } else {\n    for (i = 0; i < ideo.facets.length; i++) {\n      facet = ideo.facets[i];\n      if (facet in selections) {\n        filter = selections[facet];\n        if (Array.isArray(filter)) {\n          fn = function(d) {\n            // Filter is numeric range\n            if (filter.length === 2) {\n              // [min, max]\n              return filter[0] <= d && d < filter[1];\n            } else if (filter.length === 4) {\n              // [min1, max1, min2, max2]\n              return (\n                filter[0] <= d && d < filter[1] ||\n                filter[2] <= d && d < filter[3]\n              );\n            }\n          };\n        } else {\n          fn = function(d) {\n            // Filter is set of categories\n            return (d in filter);\n          };\n        }\n      } else {\n        fn = null;\n      }\n      ideo.annotsByFacet[facet].filter(fn);\n      counts[facet] = ideo.annotsByFacet[facet].group().top(Infinity);\n    }\n    results = ideo.annotsByFacet[facet].top(Infinity);\n  }\n\n  return [results, counts];\n}\n\n/*\n  Filters annotations based on the given selections.\n  \"selections\" is an object of objects, e.g.\n\n    {\n      \"tissue-type\": {          <-- a facet\n        \"cerebral-cortex\": 1,   <-- a filter; \"1\" means it is selected\n        \"liver\": 1\n      },\n      \"gene-type\": {\n        mirna\": 1\n      }\n    }\n\n  Translation:\n  select where:\n      (tissue-type is cerebral-cortex OR liver) and (gene-type is mirna)\n\n  TODO:\n    * Filter counts\n    * Integrate server-side filtering for very large datasets\n*/\nfunction filterAnnots(selections) {\n  var i, facet, results, counts,\n    t0 = Date.now(),\n    ideo = this;\n\n  ideo.filterSelections = selections;\n  [results, counts] = getFilteredResults(selections, ideo);\n\n  for (i < 0; i < ideo.facets.length; i++) {\n    ideo.annotsByFacet[facet].filterAll(); // clear filters\n  }\n\n  results = ideo.packAnnots(results);\n\n  delete ideo.maxAnnotsPerBar;\n  delete ideo.maxAnnotsPerBarAllChrs;\n\n  ideo.filteredAnnots = results;\n\n  d3.selectAll(ideo.selector + ' polygon.annot').remove();\n  ideo.drawAnnots(results);\n\n  console.log('Time in filterAnnots: ' + (Date.now() - t0) + ' ms');\n\n  return counts;\n}\n\nexport {unpackAnnots, packAnnots, initCrossFilter, filterAnnots};\n","function getPixelAndOtherData(bands, chr, hasBands, ideo) {\n  var i, band, csLength, width, maxLength,\n    pxStop = 0,\n    taxid = chr.id.split('-')[1],\n    cs = ideo.coordinateSystem,\n    chrHeight = ideo.config.chrHeight;\n\n  for (i = 0; i < bands.length; i++) {\n    band = bands[i];\n    csLength = band[cs].stop - band[cs].start;\n\n    // If ideogram is rotated (and thus showing only one chromosome),\n    // then set its width independent of the longest chromosome in this\n    // genome.\n    if (ideo._layout._isRotated) {\n      width = chrHeight * csLength / chr.length;\n    } else {\n      if (ideo.config.chromosomeScale === 'relative') {\n        maxLength = ideo.maxLength[taxid][cs];\n      } else {\n        maxLength = ideo.maxLength[cs];\n      }\n      width = chrHeight * chr.length / maxLength * csLength / chr.length;\n    }\n    bands[i].px = {start: pxStop, stop: pxStop + width, width: width};\n\n    pxStop = bands[i].px.stop;\n\n    if (hasBands && band.stain === 'acen' && band.name[0] === 'p') {\n      chr.pcenIndex = i;\n    }\n  }\n  return [bands, chr, pxStop];\n}\n\n/**\n * TODO:\n * A chromosome-level scale property is likely\n * nonsensical for any chromosomes that have cytogenetic band data.\n * Different bands tend to have ratios between number of base pairs\n * and physical length.\n *\n * However, a chromosome-level scale property is likely\n * necessary for chromosomes that do not have band data.\n *\n * This needs further review.\n */\nfunction getChrScale(chr, hasBands, ideo) {\n  var chrHeight = ideo.config.chrHeight,\n    chrLength = chr.length,\n    maxLength = ideo.maxLength,\n    taxid = chr.id.split('-')[1],\n    scale = {};\n\n  scale.bp = chrHeight / maxLength.bp;\n\n  if (ideo.config.multiorganism === true) {\n    // chr.scale.bp = band.iscn.stop / band.bp.stop;\n    if (ideo.config.chromosomeScale === 'relative') {\n      scale.iscn = chrHeight * chrLength / maxLength[taxid].bp;\n      scale.bp = chrHeight / maxLength[taxid].bp;\n    } else {\n      scale.iscn = chrHeight * chrLength / maxLength.bp;\n    }\n  } else if (hasBands) {\n    scale.iscn = chrHeight / maxLength.iscn;\n  }\n\n  return scale;\n}\n\nfunction getChromosomePixels(chr) {\n  var bands, chrHeight, pxStop, hasBands, maxLength,\n    taxid = chr.id.split('-')[1],\n    ideo = this;\n\n  bands = chr.bands;\n  chrHeight = ideo.config.chrHeight;\n  pxStop = 0;\n  hasBands = (typeof bands !== 'undefined');\n\n  if (hasBands) {\n    [bands, chr, pxStop] = getPixelAndOtherData(bands, chr, hasBands, ideo);\n  } else {\n    if (ideo.config.chromosomeScale === 'relative') {\n      maxLength = ideo.maxLength[taxid][ideo.coordinateSystem];\n    } else {\n      maxLength = ideo.maxLength[ideo.coordinateSystem];\n    }\n    pxStop = chrHeight * chr.length / maxLength;\n  }\n\n  chr.width = pxStop;\n  chr.scale = getChrScale(chr, hasBands, ideo);\n  chr.bands = bands;\n\n  return chr;\n}\n\nfunction getChrModelScaffold(chr, bands, chrName, ideo) {\n  var hasBands = (typeof bands !== 'undefined');\n\n  if (hasBands) {\n    const lastBand = bands.slice(-1)[0];\n    chr.name = chrName;\n    chr.length = lastBand[ideo.coordinateSystem].stop;\n\n    // Accounts for case where this chromosome\n    chr.bpLength = lastBand.bp.stop;\n\n    chr.type = 'nuclear';\n  } else {\n    chr = chrName;\n  }\n\n  return chr;\n}\n\n/**\n * Encountered when processing an assembly that has chromosomes with\n * centromere data, but this chromosome does not.\n * Example: chromosome F1 in Felis catus.\n */\nfunction deleteExtraneousBands(chr, hasBands) {\n  if (hasBands && chr.bands.length === 1) {\n    delete chr.bands;\n  }\n  return chr;\n}\n\nfunction getCentromerePosition(hasBands, bands) {\n\n  if (hasBands === false) return '';\n\n  // As with Macaca mulatta chromosome Y\n  const firstBand = bands[0];\n  const lastBand = bands.slice(-1)[0];\n  const chrLength = lastBand.bp.stop - firstBand.bp.start;\n  const smallLength = chrLength/20;\n\n  if (\n    // As with almost all mouse chromosome, chimpanzee chr22\n    firstBand.name[0] === 'p' && bands[1].name[0] === 'q' &&\n    firstBand.bp.stop - firstBand.bp.start < smallLength\n  ) {\n    return 'telocentric-p';\n  }\n\n  const penultimateBand = bands.slice(-2)[0];\n\n  if (\n    penultimateBand.name[0] === 'p' && lastBand.name[0] === 'q' &&\n    lastBand.bp.stop - lastBand.bp.start < smallLength\n  ) {\n    // As with Macaca mulatta chromosome Y\n    return 'telocentric-q';\n  }\n\n  return '';\n}\n\n/**\n * Generates a model object for each chromosome containing information on\n * its name, DOM ID, length in base pairs or ISCN coordinates, cytogenetic\n * bands, centromere position, etc.\n */\nfunction getChromosomeModel(bands, chrName, taxid, chrIndex) {\n  var hasBands, org,\n    chr = {},\n    ideo = this;\n\n  hasBands = (typeof bands !== 'undefined');\n\n  chr = getChrModelScaffold(chr, bands, chrName, ideo);\n\n  chr.chrIndex = chrIndex;\n  chr.id = 'chr' + chr.name + '-' + taxid;\n\n  if (ideo.config.fullChromosomeLabels === true) {\n    org = this.organisms[taxid];\n    chr.name = org.scientificName + ' chr' + chr.name;\n  }\n\n  chr.bands = bands;\n  chr = ideo.getChromosomePixels(chr);\n  chr.centromerePosition = getCentromerePosition(hasBands, bands);\n\n  chr = deleteExtraneousBands(chr, hasBands);\n\n  return chr;\n}\n\nexport {getChromosomeModel, getChromosomePixels};\n","// import {getSettings, handleSettingsHeaderClick} from './settings-ui';\nimport version from '../version';\nimport {downloadPng} from '../lib';\n\nconst style = `\n  <style>\n\n    #gear {\n      position: absolute;\n      right: 3px;\n      top: 24px;\n      z-index: 8001;\n      cursor: pointer;\n      height: 18px;\n      width: 18px;\n    }\n\n    #tools {\n      position: absolute;\n      width: 120px;\n      right: 27px;\n      top: 16px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      border: 1px solid #CCC;\n      border-radius: 4px;\n      box-shadow: -2px 4px 6px #CCC;\n    }\n\n    #tools ul {\n      margin-block-start: 0;\n      margin-block-end: 0;\n      padding-inline-start: 0;\n    }\n\n    #tools li, #download li {\n      padding: 2px 12px 2px 12px;\n      cursor: pointer;\n    }\n\n    #tools li:hover,\n    #tools li.active,\n    #download li:hover {\n      background: #DDD;\n    }\n\n    #tools li.ideo-disabled,\n    #tools li.active.ideo-disabled,\n    #download li.ideo-disabled {\n      background: #FFF;\n      color: #CCC;\n      cursor: default;\n    }\n\n    #download {\n      position: absolute;\n      right: 3px;\n      top: 16px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      padding-inline-start: 0;\n    }\n\n    #settings {\n      position: absolute;\n      right: 3px;\n      top: 16px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      padding-inline-start: 0;\n    }\n\n    #about {\n      position: absolute;\n      right: 24px;\n      top: -8px;\n      z-index: 8000;\n      background: white;\n      width: 300px;\n      border: 1px solid #CCC;\n      padding: 10px;\n      border-radius: 4px;\n      box-shadow: -2px 4px 6px #CCC;\n      cursor: default;\n    }\n\n    #close {\n      float: right;\n      border: 1px solid #DDD;\n      border-radius: 4px;\n      padding: 0 6px;\n      background: #EEE;\n      font-weight: bold;\n      cursor: pointer;\n    }\n\n    #settings label {\n      display: inline;\n      text-decoration: underline;\n      text-decoration-style: dotted;\n      cursor: pointer;\n    }\n\n    #download {\n      position: absolute;\n      width: 120px;\n      top: -2px;\n      right: 120px;\n      z-index: 8000;\n      background: white;\n      margin: 0;\n      border: 1px solid #CCC;\n      border-radius: 4px;\n      box-shadow: -2px 4px 6px #CCC;\n    }\n\n    li {\n      list-style-type: none;\n    }\n\n    #settings .no-underline {\n      text-decoration: none;\n    }\n\n    #settings .setting {\n      margin-right: 8px;\n    }\n\n    #settings input[type=\"checkbox\"], #settings input[type=\"radio\"] {\n      position: relative;\n      top: 2px;\n    }\n\n    .area-header {\n      font-size: 16px;\n      font-weight: bold;\n      margin-bottom: 10px;\n      clear: both;\n    }\n\n    .area-content {\n      display: flex;\n      flex-wrap: wrap;\n    }\n\n    .area-content > div {\n      margin-right: 30px;\n      margin-bottom: 15px;\n    }\n\n    .tab-panel input[type=\"number\"] {\n      width: 50px;\n    }\n\n    .tab-panel ul {\n      width: 600px;\n      list-style: none;\n      border-bottom: 1px solid #CCC;\n      box-sizing: border-box;\n      margin-bottom: 0;\n      padding-left: 0;\n    }\n\n    .tab-panel .nav:before, .tab-panel .nav:after {\n      content: \" \";\n      display: table;\n      clear: both;\n    }\n\n    .tab-panel li {\n      float: left;\n      margin-right: 2px;\n      display: block;\n      margin-bottom: -1px;\n    }\n\n    .tab-panel li > a {\n      padding: 10px 15px;\n      text-decoration: none;\n      border-radius: 4px 4px 0 0;\n      display: block;\n      position: relative;\n    }\n\n    .tab-panel li.active > a {\n      border: 1px solid #CCC;\n      border-bottom: none;\n      background-color: white;\n    }\n\n    .tab-panel .tab-content {\n      width: 600px;\n    }\n\n    .tab-panel .tab-content > div {\n      display: none;\n      padding-top: 20px;\n      clear: both;\n    }\n\n    .tab-panel .tab-content > div {\n      padding: 20px 10px 5px 10px;\n    }\n\n    .tab-panel .tab-content > div.active {\n      display: block;\n      border: 1px solid #CCC;\n      border-top: none;\n    }\n\n  </style>`;\n\n// eslint-disable-next-line max-len\nconst gearIcon = '<svg viewBox=\"0 0 512 512\"><path fill=\"#AAA\" d=\"M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z\"/></svg>';\n// Font Awesome Free 5.2.0 by @fontawesome - https://fontawesome.com\n// License - https://fontawesome.com/license (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)\n\nfunction deactivate(items) {\n  items.forEach(item => {item.classList.remove('active');});\n}\n\nfunction closeTools() {\n  const toolHeaders = document.querySelectorAll('#tools > ul > li');\n  deactivate(toolHeaders);\n  const itemsToClose =\n    document.querySelectorAll('.ideo-modal, .ideo-tool-panel');\n  itemsToClose.forEach(item => {item.remove();});\n\n  document.querySelector('#tools').style.display = 'none';\n}\n\n/**\n * As needed, hide tool panels that are triggered by hovering\n */\nfunction handleHideForHoverables(trigger, tool, toolHeader, toolHeaders) {\n  if (trigger === 'mouseenter') {\n\n    // Hide panel when hover leaves tool header, if new target element\n    // is part of the tools UI (and not the panel itself)\n    toolHeader.addEventListener('mouseleave', event => {\n      const toElement = event.toElement;\n      const toId = toElement.id;\n      const panelElement = document.querySelector('.ideo-tool-panel');\n      const toolsElement = document.querySelector('#tools');\n      if (\n        toolsElement.contains(toElement) &&\n        panelElement && !panelElement.contains(toElement) &&\n        toId !== tool\n      ) {\n        deactivate(toolHeaders);\n        panelElement.remove();\n      }\n    });\n  }\n}\n\n/** Determine action that should trigger a tool panel to display */\nfunction getTrigger(toolHeader) {\n  const shouldHover =\n    Array.from(toolHeader.classList).includes('ideo-tool-hover');\n  const trigger = shouldHover ? 'mouseenter' : 'click';\n  return trigger;\n}\n\n/** Shows clicked tool as active, displays resulting panel */\nfunction handleToolClick(ideo) {\n  const toolHeaders = document.querySelectorAll('#tools > ul > li');\n\n  toolHeaders.forEach(toolHeader => {\n    const trigger = getTrigger(toolHeader);\n\n    toolHeader.addEventListener(trigger, event => {\n\n      // Show only clicked tool header as active\n      deactivate(toolHeaders);\n      toolHeader.classList += ' active';\n\n      const tool = toolHeader.id.split('-')[0];\n      const panel = getPanel(tool, ideo);\n\n      if (trigger === 'mouseenter') {\n        toolHeader.insertAdjacentHTML('beforeend', panel);\n        handleHideForHoverables(trigger, tool, toolHeader, toolHeaders);\n\n        if (tool === 'download') {\n          document.querySelector('#download-image')\n            .addEventListener('click', event => {\n              closeTools();\n              downloadPng(ideo);\n            });\n\n          document.querySelector('#download-annots')\n            .addEventListener('click', event => {\n              const element = document.querySelector('#download-annots');\n              const classes = Array.from(element.classList);\n              if (classes.includes('ideo-disabled') === false) {\n                closeTools();\n                ideo.downloadAnnotations();\n              }\n            });\n        }\n      } else {\n        document.querySelector('#gear').insertAdjacentHTML('beforeend', panel);\n      }\n    });\n  });\n\n  // Upon clicking \"close\" (x), remove tools UI\n  document.querySelectorAll('#close').forEach(closeButton => {\n    closeButton.addEventListener('click', () => {closeTools();});\n  });\n\n}\n\nfunction handleGearClick(ideo) {\n  document.querySelector('#gear')\n    .addEventListener('click', event => {\n      var options = document.querySelector('#tools');\n      if (options.style.display === 'none') {\n        options.style.display = '';\n        hideOnClickOutside();\n      } else {\n        options.style.display = 'none';\n        closeTools();\n      }\n    });\n\n  handleToolClick(ideo);\n\n  // handleSettingsHeaderClick(ideo);\n}\n\nfunction showGearOnIdeogramHover(ideo) {\n  const container = document.querySelector(ideo.selector);\n  const gear = document.querySelector('#gear');\n  const panel = document.querySelector('#tools');\n\n  container.addEventListener('mouseover', () => gear.style.display = '');\n  container.addEventListener('mouseout', () => {\n    // Hide gear only if panel is not shown\n    if (panel.style.display === 'none') {\n      gear.style.display = 'none';\n    }\n  });\n\n  gear.addEventListener('mouseover', () => gear.style.display = '');\n}\n\nfunction getPanel(tool, ideo) {\n  var panel;\n  // if (tool === 'settings') panel = getSettings();\n  if (tool === 'download') panel = getDownload(ideo);\n  if (tool === 'about') panel = getAbout();\n  return panel.trim();\n}\n\nfunction getDownload(ideo) {\n\n  const numAnnots = document.querySelectorAll('.annot').length;\n  const annotsClass = (numAnnots > 0) ? '' : 'ideo-disabled';\n\n  return `\n    <div id=\"download\" class=\"ideo-tool-panel\">\n      <li id=\"download-image\">Image</li>\n      <li id=\"download-annots\" class=\"${annotsClass}\">Annotations</li>\n    </div>\n  `;\n}\n\nfunction getAbout() {\n  const ideogramLink = `\n    <a href=\"https://github.com/eweitz/ideogram\" target=\"_blank\" rel=\"noopener\">\n      Ideogram.js</a>`;\n  const closeButton = '<span id=\"close\">x</span>';\n  return `\n    <div id=\"about\" class=\"ideo-modal\">\n      ${ideogramLink}, version ${version} ${closeButton}<br/>\n      <i>Chromosome visualization for the web</i>\n    </div>`;\n}\n\nfunction hideOnClickOutside(selector) {\n  const elements = document.querySelectorAll('#gear, #tools');\n  const outsideClickListener = event => {\n    let clickedOutsideCount = 0;\n    elements.forEach((element) => {\n      if (!element.contains(event.target)) {\n        clickedOutsideCount += 1;\n      }\n    });\n    if (clickedOutsideCount === elements.length) {\n      closeTools();\n      removeClickListener();\n    }\n  };\n\n  const removeClickListener = () => {\n    document.removeEventListener('click', outsideClickListener);\n  };\n\n  document.addEventListener('click', outsideClickListener);\n}\n\nfunction initTools(ideo) {\n\n  const triangle = '<span style=\"float: right\">&blacktriangleright;</span>';\n\n  const toolsHtml = `\n    ${style}\n    <div id=\"gear\" style=\"display: none\">${gearIcon}</div>\n    <div id=\"tools\" style=\"display: none\">\n      <ul>\n        <li id=\"download-tool\" class=\"ideo-tool-hover\">Download ${triangle}</li>\n        <li id=\"about-tool\">About</li>\n      </ul>\n    </div>`;\n\n\n  document.querySelector(ideo.selector)\n    .insertAdjacentHTML('beforebegin', toolsHtml);\n\n  handleGearClick(ideo);\n\n  showGearOnIdeogramHover(ideo);\n}\n\nexport {initTools};\n\n","/* eslint-disable no-use-before-define */\n\nexport class ModelAdapter {\n\n  constructor(model) {\n    this._model = model;\n    this._class = 'ModelAdapter';\n  }\n\n  static getInstance(model) {\n    if (model.bands) {\n      return new ModelAdapter(model);\n    } else {\n      return new ModelNoBandsAdapter(model);\n    }\n  }\n\n  getModel() {\n    return this._model;\n  }\n\n  getCssClass() {\n    return '';\n  }\n}\n\nexport class ModelNoBandsAdapter extends ModelAdapter {\n\n  constructor(model) {\n    super(model);\n    this._class = 'ModelNoBandsAdapter';\n  }\n\n  getModel() {\n    this._model.bands = [];\n\n    const isMT = this._model.name === 'MT'; // Is mitochondrial chromosome\n    const width = this._model.width;\n\n    if (width > 1 || isMT) {\n      // Add single band to bands array\n      this._model.bands.push({\n        name: 'q',\n        px: {\n          start: 0,\n          stop: width,\n          width: width\n        },\n        bp: {\n          start: 1,\n          stop: this._model.bpLength ?? this._model.length\n        },\n        iscn: {\n          start: 1,\n          stop: this._model.length\n        }\n      });\n    }\n\n    return this._model;\n  }\n\n  getCssClass() {\n    return 'noBands';\n  }\n\n}\n","import {Ploidy} from './ploidy';\n\nexport class Color {\n\n  constructor(config) {\n    // Ideogram config\n    this._config = config;\n    this._ploidy = new Ploidy(this._config);\n  }\n\n  getArmColor(chrSetIndex, chrIndex, armIndex) {\n    if (this._config.armColors) {\n      return this._config.armColors[armIndex];\n    } else if (this._config.ancestors) {\n      return this._getPolyploidArmColor(chrSetIndex, chrIndex, armIndex);\n    } else {\n      return null;\n    }\n  }\n\n  getBorderColor(chrSetIndex, chrIndex, armIndex) {\n    const config = this._config;\n    const color = config.chrBorderColor ? config.chrBorderColor : '#000';\n    if (chrIndex < config.ploidy) {\n      return color;\n    } else if (this._ploidy.exists(chrSetIndex, chrIndex, armIndex)) {\n      return color;\n    } else {\n      return '#fff';\n    }\n  }\n\n  getFillColor() {\n    const config = this._config;\n    if (!config.chrFillColor) return '#AAA';\n    const color = config.chrFillColor;\n    if (typeof color === 'string') {\n      return {arm: color, centromere: ''};\n    } else {\n      return color;\n    };\n  }\n\n  _getPolyploidArmColor(chrSetIndex, chrIndex, armIndex) {\n    if (!this._ploidy.exists(chrSetIndex, chrIndex, armIndex)) {\n      return 'transparent';\n    } else {\n      var ancestor =\n        this._ploidy.getAncestor(chrSetIndex, chrIndex, armIndex);\n      return this._config.ancestors[ancestor];\n    }\n  }\n\n}\n","export class Range {\n\n  /**\n  * Chromosome range.\n  * @public\n  * @class\n  * @param {Object} data - range data.\n  * @param {Integer} data.chr - chromosome index.\n  * @param {Integer[]} [data.ploidy] - array which controls on which\n  *                                    chromosomes range should appear in case\n  *                                    of ploidy.\n  * @param {Integer} data.start - range start.\n  * @param {Integer} data.stop - range end.\n  * @param {String} data.color - range color.\n  */\n  constructor(data) {\n    this._data = data;\n    this.start = data.start;\n    this.stop = data.stop;\n    this.length = this.stop - this.start;\n  }\n\n  getColor(chrIndex) {\n    if (!('ploidy' in this._data)) {\n      return this._getColor(chrIndex);\n    } else if ('ploidy' in this._data && this._data.ploidy[chrIndex]) {\n      return this._getColor(chrIndex);\n    } else {\n      return 'transparent';\n    }\n  }\n\n  _getColor(chrIndex) {\n    if (Array.isArray(this._data.color)) {\n      return this._data.color[chrIndex];\n    } else {\n      return this._data.color;\n    }\n  }\n\n}\n","/* eslint-disable no-use-before-define */\nimport {Color} from './../color';\nimport {Range} from './../range';\n\nexport class Chromosome {\n\n  constructor(adapter, config, ideo) {\n    this._adapter = adapter;\n    this._model = this._adapter.getModel();\n    this._config = config;\n    this._ideo = ideo;\n    this._color = new Color(this._config);\n    this._bumpCoefficient = 5;\n  }\n\n  /**\n   * Factory method\n   */\n  static getInstance(adapter, config, ideo) {\n    const centromerePosition = adapter.getModel().centromerePosition;\n    if (centromerePosition === 'telocentric-p') {\n      return new TelocentricPChromosome(adapter, config, ideo);\n    } else if (centromerePosition === 'telocentric-q') {\n      return new TelocentricQChromosome(adapter, config, ideo);\n    } else {\n      return new MetacentricChromosome(adapter, config, ideo);\n    }\n  }\n\n  _addPArmShape(clipPath, isPArmRendered) {\n    if (isPArmRendered) {\n      return clipPath.concat(this._getPArmShape());\n    } else {\n      return clipPath;\n    }\n  }\n\n  _addQArmShape(clipPath, isQArmRendered) {\n    if (isQArmRendered) {\n      return clipPath.concat(this._getQArmShape());\n    } else {\n      return clipPath;\n    }\n  }\n\n  /**\n   * Append bands container and apply clip-path to it\n   */\n  render(container, chrSetIndex, chrIndex) {\n\n    var self, isPArmRendered, isQArmRendered, clipPath, opacity, fill,\n      isFullyBanded;\n\n    self = this;\n\n    container = container.append('g')\n      .attr('class', 'bands')\n      .attr('clip-path',\n        'url(#' + this._model.id + '-chromosome-set-clippath)'\n      );\n\n    // Render chromosome arms\n    isPArmRendered = this._renderArm(container, chrSetIndex, chrIndex, 'p');\n    isQArmRendered = this._renderArm(container, chrSetIndex, chrIndex, 'q');\n\n    // Render range set\n    this._renderRangeSet(container, chrSetIndex, chrIndex);\n\n    // Push arms shape string into clipPath array\n    clipPath = [];\n    clipPath = this._addPArmShape(clipPath, isPArmRendered);\n    clipPath = this._addQArmShape(clipPath, isQArmRendered);\n\n    opacity = '0';\n    fill = '';\n    isFullyBanded = this.isFullyBanded();\n    if (\n      'ancestors' in this._ideo.config &&\n      !('rangeSet' in this._ideo.config)\n    ) {\n      // E.g. diploid human genome (with translucent overlay)\n      fill = self._color.getArmColor(chrSetIndex, chrIndex, 0);\n      if (isFullyBanded) {\n        opacity = '0.5';\n      }\n    } else if (isFullyBanded) {\n      // E.g. mouse reference genome\n      opacity = null;\n      fill = 'transparent';\n    } else if (!('ancestors' in this._ideo.config)) {\n      // E.g. chimpanzee assembly Pan_tro 3.0\n      opacity = '1';\n    }\n\n    let centromereFill;\n    if (this._ideo.config.chrFillColor) {\n      const fillColor = self._color.getFillColor();\n      fill = fillColor.arm;\n      centromereFill = fillColor.centromere;\n    }\n\n    // Render chromosome border\n    container.append('g')\n      .attr('class', 'chromosome-border')\n      .selectAll('path')\n      .data(clipPath)\n      .enter()\n      .append('path')\n      .attr('fill', fill)\n      .style('fill-opacity', opacity)\n      .style('fill', function(d) {\n        if (d.class === 'acen' && centromereFill) {\n          return centromereFill;\n        }\n      })\n      .attr('stroke', function(d, i) {\n        return self._color.getBorderColor(chrSetIndex, chrIndex, i);\n      })\n      .attr('stroke-width', function(d) {\n        return ('strokeWidth' in d ? d.strokeWidth : 1);\n      })\n      .attr('d', function(d) {\n        return d.path;\n      }).attr('class', function(d) {\n        return d.class;\n      });\n\n    return clipPath;\n  }\n\n  _renderRangeSet(container, chrSetIndex, chrIndex) {\n\n    var self, rangeSet, rangesContainer, ideo;\n\n    if (!('rangeSet' in this._config)) {\n      return;\n    }\n\n    rangeSet = this._config.rangeSet.filter(function(range) {\n      return range.chr - 1 === chrSetIndex;\n    }).map(function(range) {\n      return new Range(range);\n    });\n\n    rangesContainer = container.append('g').attr('class', 'range-set');\n\n    self = this;\n    ideo = self._ideo;\n\n    rangesContainer.selectAll('rect.range')\n      .data(rangeSet)\n      .enter()\n      .append('rect')\n      .attr('class', 'range')\n      .attr('x', function(range) {\n        return ideo.convertBpToPx(self._model, range.start);\n      }).attr('y', 0)\n      .attr('width', function(range) {\n        return ideo.convertBpToPx(self._model, range.length);\n      }).attr('height', this._config.chrWidth)\n      .style('fill', function(range) {\n        return range.getColor(chrIndex);\n      });\n  }\n\n  /**\n   * Get chromosome's shape main values\n   */\n  _getShapeData() {\n\n    var firstQBand, i, lastBand, rightTerminalPosition;\n\n    // First q band from bands sequence\n    for (i = 0; i < this._model.bands.length; i++) {\n      if (this._model.bands[i].name[0] === 'q') {\n        firstQBand = this._model.bands[i];\n        break;\n      }\n    }\n\n    // Chromosome's right position\n    lastBand = this._model.bands.length - 1;\n    rightTerminalPosition = this._model.bands[lastBand].px.stop;\n\n    // Properties description:\n    // x1 - left terminal start position\n    // x2 - centromere position\n    // x3 - right terminal end position\n    // w - chromosome width\n    // b - bump size\n    return {\n      x1: 0,\n      x2: firstQBand ? firstQBand.px.start : rightTerminalPosition,\n      x3: rightTerminalPosition,\n      w: this._config.chrWidth,\n      b: this._config.chrWidth / this._bumpCoefficient\n    };\n  }\n\n  _getPArmShape() {\n    var d = this._getShapeData(),\n      x = d.x2 - d.b;\n\n    if (this.isFullyBanded() || 'ancestors' in this._ideo.config) {\n      // Encountered when chromosome has any of:\n      //  - One placeholder \"band\", e.g. pig genome GCF_000003025.5\n      //  - Many (> 2) bands, e.g. human reference genome\n      //  - Ancestor colors in ploidy configuration, as in ploidy-basic.html\n      return {\n        class: '',\n        path:\n          'M' + d.b + ',0 ' +\n          'L' + x + ',0 ' +\n          'Q' + (d.x2 + d.b) + ',' + (d.w / 2) + ',' + x + ',' + d.w + ' ' +\n          'L' + d.b + ',' + d.w + ' ' +\n          'Q-' + d.b + ',' + (d.w / 2) + ',' + d.b + ',0'\n      };\n    } else {\n      // e.g. chimpanzee assembly Pan_tro 3.0\n      return [{\n        class: '',\n        path:\n          'M' + d.b + ',0 ' +\n          'L' + (x - 2) + ',0 ' +\n          'L' + (x - 2) + ',' + d.w + ' ' +\n          'L' + d.b + ',' + d.w + ' ' +\n          'Q-' + d.b + ',' + (d.w / 2) + ',' + d.b + ',0'\n      }, {\n        class: 'acen',\n        path:\n          'M' + x + ',0 ' +\n          'Q' + (d.x2 + d.b) + ',' + (d.w / 2) + ',' + x + ',' + d.w + ' ' +\n          'L' + x + ',' + d.w + ' ' +\n          'L' + (x - 2) + ',' + d.w + ' ' +\n          'L' + (x - 2) + ',0'\n      }];\n    }\n  }\n\n  _getQArmShape() {\n    var d = this._getShapeData(),\n      x = d.x3 - d.b,\n      x2b = d.x2 + d.b;\n\n    if (this.isFullyBanded() || 'ancestors' in this._ideo.config) {\n      return {\n        class: '',\n        path:\n          'M' + x2b + ',0 ' +\n          'L' + x + ',0 ' +\n          'Q' + (d.x3 + d.b) + ',' + (d.w / 2) + ',' + x + ',' + d.w + ' ' +\n          'L' + x2b + ',' + d.w + ' ' +\n          'Q' + (d.x2 - d.b) + ',' + (d.w / 2) + ',' + x2b + ',0'\n      };\n    } else {\n      // e.g. chimpanzee assembly Pan_tro 3.0\n      return [{\n        path:\n          'M' + x2b + ',0 ' +\n          'L' + x + ',0 ' +\n          'Q' + (d.x3 + d.b) + ',' + (d.w / 2) + ',' + x + ',' + d.w + ' ' +\n          'L' + x2b + ',' + d.w + ' ' +\n          'L' + x2b + ',0'\n      }, {\n        class: 'acen',\n        path:\n          'M' + x2b + ',0' +\n          'Q' + (d.x2 - d.b) + ',' + (d.w / 2) + ',' + x2b + ',' + d.w + ' ' +\n          'L' + x2b + ',' + d.w +\n          'L' + (x2b + 2) + ',' + d.w +\n          'L' + (x2b + 2) + ',0'\n      }];\n    }\n  }\n\n  isFullyBanded() {\n    return (\n      this._model.bands &&\n      (this._model.bands.length !== 2 || this._model.bands[0].name[0] === 'q')\n    );\n  }\n\n  /**\n   * Render arm bands\n   */\n  _renderBands(container, chrSetIndex, chrIndex, bands, arm) {\n\n    var self, armIndex, fill;\n\n    self = this;\n    armIndex = arm === 'p' ? 0 : 1;\n    fill = '';\n\n    if ('ancestors' in self._ideo.config && !(self.isFullyBanded())) {\n      fill = self._color.getArmColor(chrSetIndex, chrIndex, armIndex);\n    }\n\n    container.selectAll('path.band.' + arm)\n      .data(bands)\n      .enter()\n      .append('path')\n      .attr('id', function(d) {\n        return self._model.id + '-' + d.name.replace('.', '-');\n      })\n      .attr('class', function(d) {\n        return 'band ' + arm + '-band ' + d.stain;\n      })\n      .attr('d', function(d) {\n        var start, length;\n\n        start = self._ideo.round(d.px.start);\n        length = self._ideo.round(d.px.width);\n\n        return 'M ' + start + ', 0' +\n              'l ' + length + ' 0 ' +\n              'l 0 ' + self._config.chrWidth + ' ' +\n              'l -' + length + ' 0 z';\n      })\n      .style('fill', fill);\n  }\n\n  /**\n   * Render a chromosome arm.\n   * Returns boolean indicating if any bands were rendered.\n   */\n  _renderArm(container, chrSetIndex, chrIndex, arm) {\n    var bands = this._model.bands.filter(function(band) {\n      return band.name[0] === arm;\n    });\n\n    this._renderBands(container, chrSetIndex, chrIndex, bands, arm);\n\n    return Boolean(bands.length);\n  }\n}\n\nexport class MetacentricChromosome extends Chromosome {\n\n  constructor(model, config, ideo) {\n    super(model, config, ideo);\n    this._class = 'MetacentricChromosome';\n  }\n}\n\nexport class TelocentricPChromosome extends Chromosome {\n\n  constructor(model, config, ideo) {\n    // alert('p')\n    super(model, config, ideo);\n    this._class = 'TelocentricPChromosome';\n    this._pArmOffset = 3;\n  }\n\n  _addPArmShape(clipPath) {\n    return clipPath.concat(this._getPArmShape());\n  }\n\n  _getPArmShape() {\n    // Properties description:\n    // x1 - left terminal start position\n    // x2 - centromere position\n    // x3 - right terminal end position\n    // w - chromosome width\n    // b - bump size\n    var d = this._getShapeData();\n    d.o = this._pArmOffset;\n\n    return [{\n      class: 'acen',\n      path: 'M' + (d.x2 + 2) + ',1' +\n      'L' + (d.x2 + d.o + 3.25) + ',1 ' +\n      'L' + (d.x2 + d.o + 3.25) + ',' + (d.w - 1) + ' ' +\n      'L' + (d.x2 + 2) + ',' + (d.w - 1)\n    }, {\n      class: 'gpos66',\n      path: 'M' + (d.x2 - d.o + 5) + ',0' +\n      'L' + (d.x2 - d.o + 3) + ',0 ' +\n      'L' + (d.x2 - d.o + 3) + ',' + d.w + ' ' +\n      'L' + (d.x2 - d.o + 5) + ',' + d.w,\n      strokeWidth: 0.5\n    }];\n  }\n\n  _getQArmShape() {\n    // Properties description:\n    // x1 - left terminal start position\n    // x2 - centromere position\n    // x3 - right terminal end position\n    // w - chromosome width\n    // b - bump size\n    var d = this._getShapeData(),\n      x = d.x3 - d.b,\n      o = this._pArmOffset + 3;\n\n    return {\n      class: '',\n      path:\n      'M' + (d.x2 + o) + ',0 ' +\n      'L' + x + ',0 ' +\n      'Q' + (d.x3 + d.b) + ',' + (d.w / 2) + ',' + x + ',' + d.w + ' ' +\n      'L' + (d.x2 + o) + ',' + d.w\n    };\n  }\n}\n\nexport class TelocentricQChromosome extends Chromosome {\n\n  constructor(model, config, ideo) {\n    // alert('q')\n    super(model, config, ideo);\n    this._class = 'TelocentricQChromosome';\n    this._qArmOffset = 3;\n  }\n\n  _getPArmShape() {\n    // Properties description:\n    // x1 - left terminal start position\n    // x2 - centromere position\n    // x3 - right terminal end position\n    // w - chromosome width\n    // b - bump size\n\n    var d = this._getShapeData(),\n      x = d.x3 - d.b,\n      o = this._qArmOffset;\n\n    return {\n      class: '',\n      path:\n      // 'M1,0, ' +\n      'M' + (d.x2 + o) + ',0 ' +\n      'L' + (x + o) + ',0 ' +\n      'L' + (x + o) + ',' + d.w + ' ' +\n      'L' + d.b + ',' + d.w + ' ' +\n      'Q-' + d.b + ',' + (d.w / 2) + ',' + d.b + ',0'\n    };\n  }\n\n  _addQArmShape(clipPath) {\n    return clipPath.concat(this._getQArmShape());\n  }\n\n  _getQArmShape() {\n    // Properties description:\n    // x1 - left terminal start position\n    // x2 - centromere position\n    // x3 - right terminal end position\n    // w - chromosome width\n    // b - bump size\n    var d = this._getShapeData();\n    d.o = this._qArmOffset;\n\n    return [{\n      class: 'acen',\n      path: 'M' + (d.x2 + 2) + ',1 ' +\n      'L' + (d.x2 + d.o + 3.25) + ',1 ' +\n      'L' + (d.x2 + d.o + 3.25) + ',' + (d.w - 1) + ' ' +\n      'L' + (d.x2 + 2) + ',' + (d.w - 1)\n    }, {\n      class: 'gpos66',\n      path: 'M' + (d.x2 + d.o + 5) + ',0 ' +\n      'L' + (d.x2 + d.o + 3) + ',0 ' +\n      'L' + (d.x2 + d.o + 3) + ',' + d.w + ' ' +\n      'L' + (d.x2 + d.o + 5) + ',' + d.w,\n      strokeWidth: 0.5\n    }];\n  }\n}\n","import {d3} from '../lib';\nimport {initTools} from '../tools/tools';\nimport {ModelAdapter} from '../model-adapter';\nimport {Chromosome} from './chromosome';\n\n/**\n * Adds a copy of a chromosome (i.e. a homologous chromosome, homolog) to DOM\n *\n * @param chrModel\n * @param chrIndex\n * @param homologIndex\n * @param container\n */\nfunction appendHomolog(chrModel, chrIndex, homologIndex, container) {\n\n  var homologOffset, chromosome, shape, defs, adapter;\n\n  defs = d3.select(this.selector + ' defs');\n  // Get chromosome model adapter class\n  adapter = ModelAdapter.getInstance(chrModel);\n\n  // How far this copy of the chromosome is from another\n  homologOffset = homologIndex * this.config.chrMargin;\n\n  // Append chromosome's container\n  chromosome = container\n    .append('g')\n    .attr('id', chrModel.id)\n    .attr('class', 'chromosome ' + adapter.getCssClass())\n    .attr('transform', 'translate(0, ' + homologOffset + ')');\n\n  // Render chromosome\n  shape = Chromosome.getInstance(adapter, this.config, this)\n    .render(chromosome, chrIndex, homologIndex);\n\n  d3.select('#' + chrModel.id + '-chromosome-set-clippath').remove();\n\n  defs.append('clipPath')\n    .attr('id', chrModel.id + '-chromosome-set-clippath')\n    .selectAll('path')\n    .data(shape)\n    .enter()\n    .append('path')\n    .attr('d', function(d) {return d.path;})\n    .attr('class', function(d) {return d.class;});\n\n\n  if (chrModel.width < 1) {\n    d3.select('#' + chrModel.id + ' .bands').style('opacity', 0);\n  }\n}\n\n/**\n * Renders all the bands and outlining boundaries of a chromosome.\n */\nfunction drawChromosome(chrModel) {\n  var chrIndex, container, numChrsInSet, transform, homologIndex,\n    chrSetSelector;\n\n  chrIndex = chrModel.chrIndex;\n\n  transform = this._layout.getChromosomeSetTranslate(chrIndex);\n\n  chrSetSelector = this.selector + ' #' + chrModel.id + '-chromosome-set';\n\n  d3.selectAll(chrSetSelector + ' g').remove();\n\n  container = d3.select(chrSetSelector);\n\n  if (container.nodes().length === 0) {\n    // Append chromosome set container\n    container = d3.select(this.selector)\n      .append('g')\n      .attr('class', 'chromosome-set')\n      .attr('transform', transform)\n      .attr('id', chrModel.id + '-chromosome-set');\n  }\n\n  if (\n    'sex' in this.config &&\n    this.config.ploidy === 2 &&\n    this.sexChromosomes.index === chrIndex\n  ) {\n    this.drawSexChromosomes(container, chrIndex);\n    return;\n  }\n\n  numChrsInSet = 1;\n  if (this.config.ploidy > 1) {\n    numChrsInSet = this._ploidy.getChromosomesNumber(chrIndex);\n  }\n\n  for (homologIndex = 0; homologIndex < numChrsInSet; homologIndex++) {\n    this.appendHomolog(chrModel, chrIndex, homologIndex, container);\n  }\n}\n\n/**\n * Rotates a chromosome 90 degrees and shows or hides all other chromosomes\n * Useful for focusing or defocusing a particular chromosome\n */\nfunction rotateAndToggleDisplay(chrElement) {\n  var chrName, chrModel, chrIndex;\n\n  this.unhighlight();\n\n  // Do nothing if taxid not defined. But it should be defined.\n  // To fix that bug we should have a way to find chromosome set number.\n  if (!this.config.taxid) return;\n\n  chrName = chrElement.id.split('-')[0].replace('chr', '');\n  chrModel = this.chromosomes[this.config.taxid][chrName];\n  chrIndex = chrModel.chrIndex;\n\n  this._layout.rotate(chrIndex, chrIndex, chrElement);\n}\n\nfunction setOverflowScroll() {\n  var ideo, config, ideoWidth, ideoInnerWrap, ideoMiddleWrap, ideoSvg,\n    ploidy, ploidyPad;\n\n  ideo = this;\n  config = ideo.config;\n\n  ideoSvg = d3.select(config.container + ' svg#_ideogram');\n  ideoInnerWrap = d3.select(config.container + ' #_ideogramInnerWrap');\n  ideoMiddleWrap = d3.select(config.container + ' #_ideogramMiddleWrap');\n\n  ploidy = config.ploidy;\n  if (ploidy === 1) {\n    ploidyPad = ploidy;\n  } else {\n    ploidyPad = ploidy * 1.12;\n  }\n\n  let annotHeight = 0;\n  if ('annotationsLayout' in config) {\n    annotHeight = config.annotationHeight * config.numAnnotTracks;\n  }\n\n  if (\n    config.orientation === 'vertical' &&\n    config.perspective !== 'comparative' &&\n    config.geometry !== 'collinear'\n  ) {\n    ideoWidth =\n      (ideo.numChromosomes) *\n      (config.chrWidth + config.chrMargin + annotHeight);\n  } else {\n    return;\n  }\n\n  if (config.annotationsLayout === 'heatmap-2d') {\n    return;\n  }\n\n  ideoWidth = Math.ceil(ideoWidth * ploidyPad / config.rows);\n  if (ideo._layout._class === 'SmallLayout') ideoWidth += 100;\n\n  ideoWidth += 35; // Account for settings gear\n\n  // Ensures absolutely-positioned elements, e.g. heatmap overlaps, display\n  // properly if ideogram container also has position: absolute\n  ideoMiddleWrap.style('height', ideo._layout.getHeight() + 'px');\n\n  ideoInnerWrap\n    .style('max-width', ideoWidth + 'px')\n    .style('overflow-x', 'scroll')\n    .style('position', 'absolute');\n\n  ideoSvg.style('min-width', (ideoWidth - 5) + 'px');\n\n  if (ideo.config.showTools) {\n    initTools(ideo);\n  }\n}\n\nexport {\n  appendHomolog, drawChromosome, rotateAndToggleDisplay, setOverflowScroll\n};\n","import {d3} from '../lib';\n\nfunction getChrSetLabelLines(d, i, ideo) {\n  var lines;\n  if (d.name.indexOf(' ') === -1) {\n    lines = [d.name];\n  } else {\n    lines = d.name.match(/^(.*)\\s+([^\\s]+)$/).slice(1).reverse();\n  }\n\n  if (\n    'sex' in ideo.config &&\n    ideo.config.ploidy === 2 &&\n    i === ideo.sexChromosomes.index\n  ) {\n    if (ideo.config.sex === 'male') {\n      lines = ['XY'];\n    } else {\n      lines = ['XX'];\n    }\n  }\n\n  return lines;\n}\n\nfunction renderChromosomeSetLabel(d, i, textElement, ideo) {\n  // Get label lines\n  var lines = getChrSetLabelLines(d, i, ideo);\n\n  // Render label lines\n  d3.select(textElement).selectAll('tspan')\n    .data(lines)\n    .enter()\n    .append('tspan')\n    .attr('dy', function(d, i) {\n      return i * -1.2 + 'em';\n    })\n    .attr('x', ideo._layout.getChromosomeSetLabelXPosition())\n    .attr('class', function(a, i) {\n      var fullLabels = ideo.config.fullChromosomeLabels;\n      return i === 1 && fullLabels ? 'italic' : null;\n    })\n    .text(String);\n}\n\nfunction appendChromosomeSetLabels(ideo) {\n  var layout = ideo._layout;\n\n  d3.selectAll(ideo.selector + ' .chromosome-set')\n    .insert('text', ':first-child')\n    .data(ideo.chromosomesArray)\n    .attr('class', layout.getChromosomeLabelClass())\n    .attr('transform', layout.getChromosomeSetLabelTranslate())\n    .attr('x', layout.getChromosomeSetLabelXPosition())\n    .attr('y', function(d, i) {\n      return layout.getChromosomeSetLabelYPosition(i);\n    })\n    .attr('text-anchor', layout.getChromosomeSetLabelAnchor())\n    .each(function(d, i) {\n      renderChromosomeSetLabel(d, i, this, ideo);\n    });\n}\n\nfunction appendChromosomeLabels(ideo) {\n  var layout = ideo._layout;\n\n  d3.selectAll(ideo.selector + ' .chromosome-set')\n    .each(function(a, chrSetIndex) {\n      d3.select(this).selectAll('.chromosome')\n        .append('text')\n        .attr('class', 'chrLabel')\n        .attr('transform', layout.getChromosomeSetLabelTranslate())\n        .attr('x', function(d, i) {\n          return layout.getChromosomeLabelXPosition(i);\n        })\n        .attr('y', function(d, i) {\n          return layout.getChromosomeLabelYPosition(i);\n        })\n        .text(function(d, chrIndex) {\n          return ideo._ploidy.getAncestor(chrSetIndex, chrIndex);\n        })\n        .attr('text-anchor', 'middle');\n    });\n}\n\n/**\n * Draws labels for each chromosome, e.g. \"1\", \"2\", \"X\".\n * If ideogram configuration has 'fullChromosomeLabels: True',\n * then labels includes name of taxon, which can help when\n * depicting orthologs.\n */\nfunction drawChromosomeLabels() {\n  var ideo = this;\n  appendChromosomeSetLabels(ideo);\n  appendChromosomeLabels(ideo);\n}\n\nfunction getLabelPositionAttrs(scale) {\n  var x, y, scaleSvg;\n\n  if (\n    typeof (scale) !== 'undefined' &&\n    scale.hasOwnProperty('x') &&\n    !(scale.x === 1 && scale.y === 1)\n  ) {\n    scaleSvg = 'scale(' + scale.x + ',' + scale.y + ')';\n    x = -6;\n    y = (scale === '' ? -16 : -14);\n  } else {\n    x = -8;\n    y = -16;\n    scale = {x: 1, y: 1};\n    scaleSvg = '';\n  }\n\n  return {x: x, y: y, scaleSvg: scaleSvg, scale: scale};\n}\n\nfunction updateChrIndex(chrIndex, config) {\n  if (config.numAnnotTracks > 1 || config.orientation === '') chrIndex -= 1;\n  return chrIndex;\n}\n\nfunction rotateVerticalChromosomeLabels(chr, chrIndex, labelPosAttrs, ideo) {\n  var chrMargin2, chrMargin, y,\n    config = ideo.config;\n\n  chrIndex = updateChrIndex(chrIndex, config);\n\n  chrMargin2 = -4;\n  if (config.showBandLabels === true) {\n    chrMargin2 = config.chrMargin + config.chrWidth + 26;\n  }\n\n  chrMargin = config.chrMargin * chrIndex;\n  if (config.numAnnotTracks > 1 === false) chrMargin += 1;\n\n  y = chrMargin + chrMargin2;\n\n  chr.selectAll('text.chrLabel')\n    .attr('transform', labelPosAttrs.scaleSvg)\n    .selectAll('tspan')\n    .attr('x', labelPosAttrs.x)\n    .attr('y', y);\n}\n\nfunction rotateHorizontalChromosomeLabels(chr, chrIndex, labelPosAttrs, ideo) {\n  var chrMargin, chrMargin2, tracksHeight, x,\n    config = ideo.config;\n\n  chrMargin2 = -config.chrWidth - 2;\n  if (config.showBandLabels === true) chrMargin2 = config.chrMargin + 8;\n\n  tracksHeight = config.annotTracksHeight;\n  if (config.annotationsLayout !== 'overlay') tracksHeight *= 2;\n\n  chrMargin = config.chrMargin * chrIndex;\n  x = -(chrMargin + chrMargin2) + 3 + tracksHeight;\n  x /= labelPosAttrs.scale.x;\n\n  chr.selectAll('text.chrLabel')\n    .attr('transform', 'rotate(-90)' + labelPosAttrs.scaleSvg)\n    .selectAll('tspan')\n    .attr('x', x)\n    .attr('y', labelPosAttrs.y);\n}\n\n/**\n * Rotates chromosome labels by 90 degrees, e.g. upon clicking a chromosome.\n */\nfunction rotateChromosomeLabels(chr, chrIndex, orientation, scale) {\n  var labelPosAttrs,\n    ideo = this;\n\n  chrIndex -= 1;\n\n  labelPosAttrs = getLabelPositionAttrs(scale);\n\n  if (orientation === 'vertical' || orientation === '') {\n    rotateVerticalChromosomeLabels(chr, chrIndex, labelPosAttrs, ideo);\n  } else {\n    rotateHorizontalChromosomeLabels(chr, chrIndex, labelPosAttrs, ideo);\n  }\n}\n\nexport {drawChromosomeLabels, rotateChromosomeLabels};\n","export default function getWindow(node) {\n  if (node == null) {\n    return window;\n  }\n\n  if (node.toString() !== '[object Window]') {\n    var ownerDocument = node.ownerDocument;\n    return ownerDocument ? ownerDocument.defaultView || window : window;\n  }\n\n  return node;\n}","import getWindow from \"./getWindow.js\";\n\nfunction isElement(node) {\n  var OwnElement = getWindow(node).Element;\n  return node instanceof OwnElement || node instanceof Element;\n}\n\nfunction isHTMLElement(node) {\n  var OwnElement = getWindow(node).HTMLElement;\n  return node instanceof OwnElement || node instanceof HTMLElement;\n}\n\nfunction isShadowRoot(node) {\n  // IE 11 has no ShadowRoot\n  if (typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n\n  var OwnElement = getWindow(node).ShadowRoot;\n  return node instanceof OwnElement || node instanceof ShadowRoot;\n}\n\nexport { isElement, isHTMLElement, isShadowRoot };","export var max = Math.max;\nexport var min = Math.min;\nexport var round = Math.round;","export default function getUAString() {\n  var uaData = navigator.userAgentData;\n\n  if (uaData != null && uaData.brands && Array.isArray(uaData.brands)) {\n    return uaData.brands.map(function (item) {\n      return item.brand + \"/\" + item.version;\n    }).join(' ');\n  }\n\n  return navigator.userAgent;\n}","import getUAString from \"../utils/userAgent.js\";\nexport default function isLayoutViewport() {\n  return !/^((?!chrome|android).)*safari/i.test(getUAString());\n}","import { isElement, isHTMLElement } from \"./instanceOf.js\";\nimport { round } from \"../utils/math.js\";\nimport getWindow from \"./getWindow.js\";\nimport isLayoutViewport from \"./isLayoutViewport.js\";\nexport default function getBoundingClientRect(element, includeScale, isFixedStrategy) {\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n\n  var clientRect = element.getBoundingClientRect();\n  var scaleX = 1;\n  var scaleY = 1;\n\n  if (includeScale && isHTMLElement(element)) {\n    scaleX = element.offsetWidth > 0 ? round(clientRect.width) / element.offsetWidth || 1 : 1;\n    scaleY = element.offsetHeight > 0 ? round(clientRect.height) / element.offsetHeight || 1 : 1;\n  }\n\n  var _ref = isElement(element) ? getWindow(element) : window,\n      visualViewport = _ref.visualViewport;\n\n  var addVisualOffsets = !isLayoutViewport() && isFixedStrategy;\n  var x = (clientRect.left + (addVisualOffsets && visualViewport ? visualViewport.offsetLeft : 0)) / scaleX;\n  var y = (clientRect.top + (addVisualOffsets && visualViewport ? visualViewport.offsetTop : 0)) / scaleY;\n  var width = clientRect.width / scaleX;\n  var height = clientRect.height / scaleY;\n  return {\n    width: width,\n    height: height,\n    top: y,\n    right: x + width,\n    bottom: y + height,\n    left: x,\n    x: x,\n    y: y\n  };\n}","import getWindow from \"./getWindow.js\";\nexport default function getWindowScroll(node) {\n  var win = getWindow(node);\n  var scrollLeft = win.pageXOffset;\n  var scrollTop = win.pageYOffset;\n  return {\n    scrollLeft: scrollLeft,\n    scrollTop: scrollTop\n  };\n}","export default function getNodeName(element) {\n  return element ? (element.nodeName || '').toLowerCase() : null;\n}","import { isElement } from \"./instanceOf.js\";\nexport default function getDocumentElement(element) {\n  // $FlowFixMe[incompatible-return]: assume body is always available\n  return ((isElement(element) ? element.ownerDocument : // $FlowFixMe[prop-missing]\n  element.document) || window.document).documentElement;\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScroll from \"./getWindowScroll.js\";\nexport default function getWindowScrollBarX(element) {\n  // If <html> has a CSS width greater than the viewport, then this will be\n  // incorrect for RTL.\n  // Popper 1 is broken in this case and never had a bug report so let's assume\n  // it's not an issue. I don't think anyone ever specifies width on <html>\n  // anyway.\n  // Browsers where the left scrollbar doesn't cause an issue report `0` for\n  // this (e.g. Edge 2019, IE11, Safari)\n  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;\n}","import getWindow from \"./getWindow.js\";\nexport default function getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}","import getComputedStyle from \"./getComputedStyle.js\";\nexport default function isScrollParent(element) {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  var _getComputedStyle = getComputedStyle(element),\n      overflow = _getComputedStyle.overflow,\n      overflowX = _getComputedStyle.overflowX,\n      overflowY = _getComputedStyle.overflowY;\n\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getNodeScroll from \"./getNodeScroll.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport isScrollParent from \"./isScrollParent.js\";\nimport { round } from \"../utils/math.js\";\n\nfunction isElementScaled(element) {\n  var rect = element.getBoundingClientRect();\n  var scaleX = round(rect.width) / element.offsetWidth || 1;\n  var scaleY = round(rect.height) / element.offsetHeight || 1;\n  return scaleX !== 1 || scaleY !== 1;\n} // Returns the composite rect of an element relative to its offsetParent.\n// Composite means it takes into account transforms as well as layout.\n\n\nexport default function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n\n  var isOffsetParentAnElement = isHTMLElement(offsetParent);\n  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);\n  var documentElement = getDocumentElement(offsetParent);\n  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled, isFixed);\n  var scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  var offsets = {\n    x: 0,\n    y: 0\n  };\n\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || // https://github.com/popperjs/popper-core/issues/1078\n    isScrollParent(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n\n    if (isHTMLElement(offsetParent)) {\n      offsets = getBoundingClientRect(offsetParent, true);\n      offsets.x += offsetParent.clientLeft;\n      offsets.y += offsetParent.clientTop;\n    } else if (documentElement) {\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n\n  return {\n    x: rect.left + scroll.scrollLeft - offsets.x,\n    y: rect.top + scroll.scrollTop - offsets.y,\n    width: rect.width,\n    height: rect.height\n  };\n}","import getWindowScroll from \"./getWindowScroll.js\";\nimport getWindow from \"./getWindow.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getHTMLElementScroll from \"./getHTMLElementScroll.js\";\nexport default function getNodeScroll(node) {\n  if (node === getWindow(node) || !isHTMLElement(node)) {\n    return getWindowScroll(node);\n  } else {\n    return getHTMLElementScroll(node);\n  }\n}","export default function getHTMLElementScroll(element) {\n  return {\n    scrollLeft: element.scrollLeft,\n    scrollTop: element.scrollTop\n  };\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\"; // Returns the layout rect of an element relative to its offsetParent. Layout\n// means it doesn't take into account transforms.\n\nexport default function getLayoutRect(element) {\n  var clientRect = getBoundingClientRect(element); // Use the clientRect sizes if it's not been transformed.\n  // Fixes https://github.com/popperjs/popper-core/issues/1223\n\n  var width = element.offsetWidth;\n  var height = element.offsetHeight;\n\n  if (Math.abs(clientRect.width - width) <= 1) {\n    width = clientRect.width;\n  }\n\n  if (Math.abs(clientRect.height - height) <= 1) {\n    height = clientRect.height;\n  }\n\n  return {\n    x: element.offsetLeft,\n    y: element.offsetTop,\n    width: width,\n    height: height\n  };\n}","import getNodeName from \"./getNodeName.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport { isShadowRoot } from \"./instanceOf.js\";\nexport default function getParentNode(element) {\n  if (getNodeName(element) === 'html') {\n    return element;\n  }\n\n  return (// this is a quicker (but less type safe) way to save quite some bytes from the bundle\n    // $FlowFixMe[incompatible-return]\n    // $FlowFixMe[prop-missing]\n    element.assignedSlot || // step into the shadow DOM of the parent of a slotted node\n    element.parentNode || ( // DOM Element detected\n    isShadowRoot(element) ? element.host : null) || // ShadowRoot detected\n    // $FlowFixMe[incompatible-call]: HTMLElement is a Node\n    getDocumentElement(element) // fallback\n\n  );\n}","import getParentNode from \"./getParentNode.js\";\nimport isScrollParent from \"./isScrollParent.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nexport default function getScrollParent(node) {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    // $FlowFixMe[incompatible-return]: assume body is always available\n    return node.ownerDocument.body;\n  }\n\n  if (isHTMLElement(node) && isScrollParent(node)) {\n    return node;\n  }\n\n  return getScrollParent(getParentNode(node));\n}","import getScrollParent from \"./getScrollParent.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport getWindow from \"./getWindow.js\";\nimport isScrollParent from \"./isScrollParent.js\";\n/*\ngiven a DOM element, return the list of all scroll parents, up the list of ancesors\nuntil we get to the top window object. This list is what we attach scroll listeners\nto, because if any of these parent elements scroll, we'll need to re-calculate the\nreference element's position.\n*/\n\nexport default function listScrollParents(element, list) {\n  var _element$ownerDocumen;\n\n  if (list === void 0) {\n    list = [];\n  }\n\n  var scrollParent = getScrollParent(element);\n  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);\n  var win = getWindow(scrollParent);\n  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;\n  var updatedList = list.concat(target);\n  return isBody ? updatedList : // $FlowFixMe[incompatible-call]: isBody tells us target will be an HTMLElement here\n  updatedList.concat(listScrollParents(getParentNode(target)));\n}","import getNodeName from \"./getNodeName.js\";\nexport default function isTableElement(element) {\n  return ['table', 'td', 'th'].indexOf(getNodeName(element)) >= 0;\n}","import getWindow from \"./getWindow.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isHTMLElement, isShadowRoot } from \"./instanceOf.js\";\nimport isTableElement from \"./isTableElement.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport getUAString from \"../utils/userAgent.js\";\n\nfunction getTrueOffsetParent(element) {\n  if (!isHTMLElement(element) || // https://github.com/popperjs/popper-core/issues/837\n  getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n\n  return element.offsetParent;\n} // `.offsetParent` reports `null` for fixed elements, while absolute elements\n// return the containing block\n\n\nfunction getContainingBlock(element) {\n  var isFirefox = /firefox/i.test(getUAString());\n  var isIE = /Trident/i.test(getUAString());\n\n  if (isIE && isHTMLElement(element)) {\n    // In IE 9, 10 and 11 fixed elements containing block is always established by the viewport\n    var elementCss = getComputedStyle(element);\n\n    if (elementCss.position === 'fixed') {\n      return null;\n    }\n  }\n\n  var currentNode = getParentNode(element);\n\n  if (isShadowRoot(currentNode)) {\n    currentNode = currentNode.host;\n  }\n\n  while (isHTMLElement(currentNode) && ['html', 'body'].indexOf(getNodeName(currentNode)) < 0) {\n    var css = getComputedStyle(currentNode); // This is non-exhaustive but covers the most common CSS properties that\n    // create a containing block.\n    // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n\n    if (css.transform !== 'none' || css.perspective !== 'none' || css.contain === 'paint' || ['transform', 'perspective'].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === 'filter' || isFirefox && css.filter && css.filter !== 'none') {\n      return currentNode;\n    } else {\n      currentNode = currentNode.parentNode;\n    }\n  }\n\n  return null;\n} // Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\n\n\nexport default function getOffsetParent(element) {\n  var window = getWindow(element);\n  var offsetParent = getTrueOffsetParent(element);\n\n  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === 'static') {\n    offsetParent = getTrueOffsetParent(offsetParent);\n  }\n\n  if (offsetParent && (getNodeName(offsetParent) === 'html' || getNodeName(offsetParent) === 'body' && getComputedStyle(offsetParent).position === 'static')) {\n    return window;\n  }\n\n  return offsetParent || getContainingBlock(element) || window;\n}","export var top = 'top';\nexport var bottom = 'bottom';\nexport var right = 'right';\nexport var left = 'left';\nexport var auto = 'auto';\nexport var basePlacements = [top, bottom, right, left];\nexport var start = 'start';\nexport var end = 'end';\nexport var clippingParents = 'clippingParents';\nexport var viewport = 'viewport';\nexport var popper = 'popper';\nexport var reference = 'reference';\nexport var variationPlacements = /*#__PURE__*/basePlacements.reduce(function (acc, placement) {\n  return acc.concat([placement + \"-\" + start, placement + \"-\" + end]);\n}, []);\nexport var placements = /*#__PURE__*/[].concat(basePlacements, [auto]).reduce(function (acc, placement) {\n  return acc.concat([placement, placement + \"-\" + start, placement + \"-\" + end]);\n}, []); // modifiers that need to read the DOM\n\nexport var beforeRead = 'beforeRead';\nexport var read = 'read';\nexport var afterRead = 'afterRead'; // pure-logic modifiers\n\nexport var beforeMain = 'beforeMain';\nexport var main = 'main';\nexport var afterMain = 'afterMain'; // modifier with the purpose to write to the DOM (or write into a framework state)\n\nexport var beforeWrite = 'beforeWrite';\nexport var write = 'write';\nexport var afterWrite = 'afterWrite';\nexport var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];","import { modifierPhases } from \"../enums.js\"; // source: https://stackoverflow.com/questions/49875255\n\nfunction order(modifiers) {\n  var map = new Map();\n  var visited = new Set();\n  var result = [];\n  modifiers.forEach(function (modifier) {\n    map.set(modifier.name, modifier);\n  }); // On visiting object, check for its dependencies and visit them recursively\n\n  function sort(modifier) {\n    visited.add(modifier.name);\n    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);\n    requires.forEach(function (dep) {\n      if (!visited.has(dep)) {\n        var depModifier = map.get(dep);\n\n        if (depModifier) {\n          sort(depModifier);\n        }\n      }\n    });\n    result.push(modifier);\n  }\n\n  modifiers.forEach(function (modifier) {\n    if (!visited.has(modifier.name)) {\n      // check for visited object\n      sort(modifier);\n    }\n  });\n  return result;\n}\n\nexport default function orderModifiers(modifiers) {\n  // order based on dependencies\n  var orderedModifiers = order(modifiers); // order based on phase\n\n  return modifierPhases.reduce(function (acc, phase) {\n    return acc.concat(orderedModifiers.filter(function (modifier) {\n      return modifier.phase === phase;\n    }));\n  }, []);\n}","import getCompositeRect from \"./dom-utils/getCompositeRect.js\";\nimport getLayoutRect from \"./dom-utils/getLayoutRect.js\";\nimport listScrollParents from \"./dom-utils/listScrollParents.js\";\nimport getOffsetParent from \"./dom-utils/getOffsetParent.js\";\nimport getComputedStyle from \"./dom-utils/getComputedStyle.js\";\nimport orderModifiers from \"./utils/orderModifiers.js\";\nimport debounce from \"./utils/debounce.js\";\nimport validateModifiers from \"./utils/validateModifiers.js\";\nimport uniqueBy from \"./utils/uniqueBy.js\";\nimport getBasePlacement from \"./utils/getBasePlacement.js\";\nimport mergeByName from \"./utils/mergeByName.js\";\nimport detectOverflow from \"./utils/detectOverflow.js\";\nimport { isElement } from \"./dom-utils/instanceOf.js\";\nimport { auto } from \"./enums.js\";\nvar INVALID_ELEMENT_ERROR = 'Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.';\nvar INFINITE_LOOP_ERROR = 'Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.';\nvar DEFAULT_OPTIONS = {\n  placement: 'bottom',\n  modifiers: [],\n  strategy: 'absolute'\n};\n\nfunction areValidElements() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  return !args.some(function (element) {\n    return !(element && typeof element.getBoundingClientRect === 'function');\n  });\n}\n\nexport function popperGenerator(generatorOptions) {\n  if (generatorOptions === void 0) {\n    generatorOptions = {};\n  }\n\n  var _generatorOptions = generatorOptions,\n      _generatorOptions$def = _generatorOptions.defaultModifiers,\n      defaultModifiers = _generatorOptions$def === void 0 ? [] : _generatorOptions$def,\n      _generatorOptions$def2 = _generatorOptions.defaultOptions,\n      defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;\n  return function createPopper(reference, popper, options) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    var state = {\n      placement: 'bottom',\n      orderedModifiers: [],\n      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),\n      modifiersData: {},\n      elements: {\n        reference: reference,\n        popper: popper\n      },\n      attributes: {},\n      styles: {}\n    };\n    var effectCleanupFns = [];\n    var isDestroyed = false;\n    var instance = {\n      state: state,\n      setOptions: function setOptions(setOptionsAction) {\n        var options = typeof setOptionsAction === 'function' ? setOptionsAction(state.options) : setOptionsAction;\n        cleanupModifierEffects();\n        state.options = Object.assign({}, defaultOptions, state.options, options);\n        state.scrollParents = {\n          reference: isElement(reference) ? listScrollParents(reference) : reference.contextElement ? listScrollParents(reference.contextElement) : [],\n          popper: listScrollParents(popper)\n        }; // Orders the modifiers based on their dependencies and `phase`\n        // properties\n\n        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers, state.options.modifiers))); // Strip out disabled modifiers\n\n        state.orderedModifiers = orderedModifiers.filter(function (m) {\n          return m.enabled;\n        }); // Validate the provided modifiers so that the consumer will get warned\n        // if one of the modifiers is invalid for any reason\n\n        if (process.env.NODE_ENV !== \"production\") {\n          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function (_ref) {\n            var name = _ref.name;\n            return name;\n          });\n          validateModifiers(modifiers);\n\n          if (getBasePlacement(state.options.placement) === auto) {\n            var flipModifier = state.orderedModifiers.find(function (_ref2) {\n              var name = _ref2.name;\n              return name === 'flip';\n            });\n\n            if (!flipModifier) {\n              console.error(['Popper: \"auto\" placements require the \"flip\" modifier be', 'present and enabled to work.'].join(' '));\n            }\n          }\n\n          var _getComputedStyle = getComputedStyle(popper),\n              marginTop = _getComputedStyle.marginTop,\n              marginRight = _getComputedStyle.marginRight,\n              marginBottom = _getComputedStyle.marginBottom,\n              marginLeft = _getComputedStyle.marginLeft; // We no longer take into account `margins` on the popper, and it can\n          // cause bugs with positioning, so we'll warn the consumer\n\n\n          if ([marginTop, marginRight, marginBottom, marginLeft].some(function (margin) {\n            return parseFloat(margin);\n          })) {\n            console.warn(['Popper: CSS \"margin\" styles cannot be used to apply padding', 'between the popper and its reference element or boundary.', 'To replicate margin, use the `offset` modifier, as well as', 'the `padding` option in the `preventOverflow` and `flip`', 'modifiers.'].join(' '));\n          }\n        }\n\n        runModifierEffects();\n        return instance.update();\n      },\n      // Sync update – it will always be executed, even if not necessary. This\n      // is useful for low frequency updates where sync behavior simplifies the\n      // logic.\n      // For high frequency updates (e.g. `resize` and `scroll` events), always\n      // prefer the async Popper#update method\n      forceUpdate: function forceUpdate() {\n        if (isDestroyed) {\n          return;\n        }\n\n        var _state$elements = state.elements,\n            reference = _state$elements.reference,\n            popper = _state$elements.popper; // Don't proceed if `reference` or `popper` are not valid elements\n        // anymore\n\n        if (!areValidElements(reference, popper)) {\n          if (process.env.NODE_ENV !== \"production\") {\n            console.error(INVALID_ELEMENT_ERROR);\n          }\n\n          return;\n        } // Store the reference and popper rects to be read by modifiers\n\n\n        state.rects = {\n          reference: getCompositeRect(reference, getOffsetParent(popper), state.options.strategy === 'fixed'),\n          popper: getLayoutRect(popper)\n        }; // Modifiers have the ability to reset the current update cycle. The\n        // most common use case for this is the `flip` modifier changing the\n        // placement, which then needs to re-run all the modifiers, because the\n        // logic was previously ran for the previous placement and is therefore\n        // stale/incorrect\n\n        state.reset = false;\n        state.placement = state.options.placement; // On each update cycle, the `modifiersData` property for each modifier\n        // is filled with the initial data specified by the modifier. This means\n        // it doesn't persist and is fresh on each update.\n        // To ensure persistent data, use `${name}#persistent`\n\n        state.orderedModifiers.forEach(function (modifier) {\n          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);\n        });\n        var __debug_loops__ = 0;\n\n        for (var index = 0; index < state.orderedModifiers.length; index++) {\n          if (process.env.NODE_ENV !== \"production\") {\n            __debug_loops__ += 1;\n\n            if (__debug_loops__ > 100) {\n              console.error(INFINITE_LOOP_ERROR);\n              break;\n            }\n          }\n\n          if (state.reset === true) {\n            state.reset = false;\n            index = -1;\n            continue;\n          }\n\n          var _state$orderedModifie = state.orderedModifiers[index],\n              fn = _state$orderedModifie.fn,\n              _state$orderedModifie2 = _state$orderedModifie.options,\n              _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2,\n              name = _state$orderedModifie.name;\n\n          if (typeof fn === 'function') {\n            state = fn({\n              state: state,\n              options: _options,\n              name: name,\n              instance: instance\n            }) || state;\n          }\n        }\n      },\n      // Async and optimistically optimized update – it will not be executed if\n      // not necessary (debounced to run at most once-per-tick)\n      update: debounce(function () {\n        return new Promise(function (resolve) {\n          instance.forceUpdate();\n          resolve(state);\n        });\n      }),\n      destroy: function destroy() {\n        cleanupModifierEffects();\n        isDestroyed = true;\n      }\n    };\n\n    if (!areValidElements(reference, popper)) {\n      if (process.env.NODE_ENV !== \"production\") {\n        console.error(INVALID_ELEMENT_ERROR);\n      }\n\n      return instance;\n    }\n\n    instance.setOptions(options).then(function (state) {\n      if (!isDestroyed && options.onFirstUpdate) {\n        options.onFirstUpdate(state);\n      }\n    }); // Modifiers have the ability to execute arbitrary code before the first\n    // update cycle runs. They will be executed in the same order as the update\n    // cycle. This is useful when a modifier adds some persistent data that\n    // other modifiers need to use, but the modifier is run after the dependent\n    // one.\n\n    function runModifierEffects() {\n      state.orderedModifiers.forEach(function (_ref3) {\n        var name = _ref3.name,\n            _ref3$options = _ref3.options,\n            options = _ref3$options === void 0 ? {} : _ref3$options,\n            effect = _ref3.effect;\n\n        if (typeof effect === 'function') {\n          var cleanupFn = effect({\n            state: state,\n            name: name,\n            instance: instance,\n            options: options\n          });\n\n          var noopFn = function noopFn() {};\n\n          effectCleanupFns.push(cleanupFn || noopFn);\n        }\n      });\n    }\n\n    function cleanupModifierEffects() {\n      effectCleanupFns.forEach(function (fn) {\n        return fn();\n      });\n      effectCleanupFns = [];\n    }\n\n    return instance;\n  };\n}\nexport var createPopper = /*#__PURE__*/popperGenerator(); // eslint-disable-next-line import/no-unused-modules\n\nexport { detectOverflow };","export default function debounce(fn) {\n  var pending;\n  return function () {\n    if (!pending) {\n      pending = new Promise(function (resolve) {\n        Promise.resolve().then(function () {\n          pending = undefined;\n          resolve(fn());\n        });\n      });\n    }\n\n    return pending;\n  };\n}","export default function mergeByName(modifiers) {\n  var merged = modifiers.reduce(function (merged, current) {\n    var existing = merged[current.name];\n    merged[current.name] = existing ? Object.assign({}, existing, current, {\n      options: Object.assign({}, existing.options, current.options),\n      data: Object.assign({}, existing.data, current.data)\n    }) : current;\n    return merged;\n  }, {}); // IE11 does not support Object.values\n\n  return Object.keys(merged).map(function (key) {\n    return merged[key];\n  });\n}","import getWindow from \"../dom-utils/getWindow.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar passive = {\n  passive: true\n};\n\nfunction effect(_ref) {\n  var state = _ref.state,\n      instance = _ref.instance,\n      options = _ref.options;\n  var _options$scroll = options.scroll,\n      scroll = _options$scroll === void 0 ? true : _options$scroll,\n      _options$resize = options.resize,\n      resize = _options$resize === void 0 ? true : _options$resize;\n  var window = getWindow(state.elements.popper);\n  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);\n\n  if (scroll) {\n    scrollParents.forEach(function (scrollParent) {\n      scrollParent.addEventListener('scroll', instance.update, passive);\n    });\n  }\n\n  if (resize) {\n    window.addEventListener('resize', instance.update, passive);\n  }\n\n  return function () {\n    if (scroll) {\n      scrollParents.forEach(function (scrollParent) {\n        scrollParent.removeEventListener('scroll', instance.update, passive);\n      });\n    }\n\n    if (resize) {\n      window.removeEventListener('resize', instance.update, passive);\n    }\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'eventListeners',\n  enabled: true,\n  phase: 'write',\n  fn: function fn() {},\n  effect: effect,\n  data: {}\n};","import { auto } from \"../enums.js\";\nexport default function getBasePlacement(placement) {\n  return placement.split('-')[0];\n}","export default function getVariation(placement) {\n  return placement.split('-')[1];\n}","export default function getMainAxisFromPlacement(placement) {\n  return ['top', 'bottom'].indexOf(placement) >= 0 ? 'x' : 'y';\n}","import getBasePlacement from \"./getBasePlacement.js\";\nimport getVariation from \"./getVariation.js\";\nimport getMainAxisFromPlacement from \"./getMainAxisFromPlacement.js\";\nimport { top, right, bottom, left, start, end } from \"../enums.js\";\nexport default function computeOffsets(_ref) {\n  var reference = _ref.reference,\n      element = _ref.element,\n      placement = _ref.placement;\n  var basePlacement = placement ? getBasePlacement(placement) : null;\n  var variation = placement ? getVariation(placement) : null;\n  var commonX = reference.x + reference.width / 2 - element.width / 2;\n  var commonY = reference.y + reference.height / 2 - element.height / 2;\n  var offsets;\n\n  switch (basePlacement) {\n    case top:\n      offsets = {\n        x: commonX,\n        y: reference.y - element.height\n      };\n      break;\n\n    case bottom:\n      offsets = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n\n    case right:\n      offsets = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n\n    case left:\n      offsets = {\n        x: reference.x - element.width,\n        y: commonY\n      };\n      break;\n\n    default:\n      offsets = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n\n  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;\n\n  if (mainAxis != null) {\n    var len = mainAxis === 'y' ? 'height' : 'width';\n\n    switch (variation) {\n      case start:\n        offsets[mainAxis] = offsets[mainAxis] - (reference[len] / 2 - element[len] / 2);\n        break;\n\n      case end:\n        offsets[mainAxis] = offsets[mainAxis] + (reference[len] / 2 - element[len] / 2);\n        break;\n\n      default:\n    }\n  }\n\n  return offsets;\n}","import { top, left, right, bottom, end } from \"../enums.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getWindow from \"../dom-utils/getWindow.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport getComputedStyle from \"../dom-utils/getComputedStyle.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getVariation from \"../utils/getVariation.js\";\nimport { round } from \"../utils/math.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar unsetSides = {\n  top: 'auto',\n  right: 'auto',\n  bottom: 'auto',\n  left: 'auto'\n}; // Round the offsets to the nearest suitable subpixel based on the DPR.\n// Zooming can change the DPR, but it seems to report a value that will\n// cleanly divide the values into the appropriate subpixels.\n\nfunction roundOffsetsByDPR(_ref, win) {\n  var x = _ref.x,\n      y = _ref.y;\n  var dpr = win.devicePixelRatio || 1;\n  return {\n    x: round(x * dpr) / dpr || 0,\n    y: round(y * dpr) / dpr || 0\n  };\n}\n\nexport function mapToStyles(_ref2) {\n  var _Object$assign2;\n\n  var popper = _ref2.popper,\n      popperRect = _ref2.popperRect,\n      placement = _ref2.placement,\n      variation = _ref2.variation,\n      offsets = _ref2.offsets,\n      position = _ref2.position,\n      gpuAcceleration = _ref2.gpuAcceleration,\n      adaptive = _ref2.adaptive,\n      roundOffsets = _ref2.roundOffsets,\n      isFixed = _ref2.isFixed;\n  var _offsets$x = offsets.x,\n      x = _offsets$x === void 0 ? 0 : _offsets$x,\n      _offsets$y = offsets.y,\n      y = _offsets$y === void 0 ? 0 : _offsets$y;\n\n  var _ref3 = typeof roundOffsets === 'function' ? roundOffsets({\n    x: x,\n    y: y\n  }) : {\n    x: x,\n    y: y\n  };\n\n  x = _ref3.x;\n  y = _ref3.y;\n  var hasX = offsets.hasOwnProperty('x');\n  var hasY = offsets.hasOwnProperty('y');\n  var sideX = left;\n  var sideY = top;\n  var win = window;\n\n  if (adaptive) {\n    var offsetParent = getOffsetParent(popper);\n    var heightProp = 'clientHeight';\n    var widthProp = 'clientWidth';\n\n    if (offsetParent === getWindow(popper)) {\n      offsetParent = getDocumentElement(popper);\n\n      if (getComputedStyle(offsetParent).position !== 'static' && position === 'absolute') {\n        heightProp = 'scrollHeight';\n        widthProp = 'scrollWidth';\n      }\n    } // $FlowFixMe[incompatible-cast]: force type refinement, we compare offsetParent with window above, but Flow doesn't detect it\n\n\n    offsetParent = offsetParent;\n\n    if (placement === top || (placement === left || placement === right) && variation === end) {\n      sideY = bottom;\n      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : // $FlowFixMe[prop-missing]\n      offsetParent[heightProp];\n      y -= offsetY - popperRect.height;\n      y *= gpuAcceleration ? 1 : -1;\n    }\n\n    if (placement === left || (placement === top || placement === bottom) && variation === end) {\n      sideX = right;\n      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : // $FlowFixMe[prop-missing]\n      offsetParent[widthProp];\n      x -= offsetX - popperRect.width;\n      x *= gpuAcceleration ? 1 : -1;\n    }\n  }\n\n  var commonStyles = Object.assign({\n    position: position\n  }, adaptive && unsetSides);\n\n  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({\n    x: x,\n    y: y\n  }, getWindow(popper)) : {\n    x: x,\n    y: y\n  };\n\n  x = _ref4.x;\n  y = _ref4.y;\n\n  if (gpuAcceleration) {\n    var _Object$assign;\n\n    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? '0' : '', _Object$assign[sideX] = hasX ? '0' : '', _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? \"translate(\" + x + \"px, \" + y + \"px)\" : \"translate3d(\" + x + \"px, \" + y + \"px, 0)\", _Object$assign));\n  }\n\n  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + \"px\" : '', _Object$assign2[sideX] = hasX ? x + \"px\" : '', _Object$assign2.transform = '', _Object$assign2));\n}\n\nfunction computeStyles(_ref5) {\n  var state = _ref5.state,\n      options = _ref5.options;\n  var _options$gpuAccelerat = options.gpuAcceleration,\n      gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat,\n      _options$adaptive = options.adaptive,\n      adaptive = _options$adaptive === void 0 ? true : _options$adaptive,\n      _options$roundOffsets = options.roundOffsets,\n      roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;\n\n  if (process.env.NODE_ENV !== \"production\") {\n    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || '';\n\n    if (adaptive && ['transform', 'top', 'right', 'bottom', 'left'].some(function (property) {\n      return transitionProperty.indexOf(property) >= 0;\n    })) {\n      console.warn(['Popper: Detected CSS transitions on at least one of the following', 'CSS properties: \"transform\", \"top\", \"right\", \"bottom\", \"left\".', '\\n\\n', 'Disable the \"computeStyles\" modifier\\'s `adaptive` option to allow', 'for smooth transitions, or remove these properties from the CSS', 'transition declaration on the popper element if only transitioning', 'opacity or background-color for example.', '\\n\\n', 'We recommend using the popper element as a wrapper around an inner', 'element that can have any CSS property transitioned for animations.'].join(' '));\n    }\n  }\n\n  var commonStyles = {\n    placement: getBasePlacement(state.placement),\n    variation: getVariation(state.placement),\n    popper: state.elements.popper,\n    popperRect: state.rects.popper,\n    gpuAcceleration: gpuAcceleration,\n    isFixed: state.options.strategy === 'fixed'\n  };\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {\n      offsets: state.modifiersData.popperOffsets,\n      position: state.options.strategy,\n      adaptive: adaptive,\n      roundOffsets: roundOffsets\n    })));\n  }\n\n  if (state.modifiersData.arrow != null) {\n    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {\n      offsets: state.modifiersData.arrow,\n      position: 'absolute',\n      adaptive: false,\n      roundOffsets: roundOffsets\n    })));\n  }\n\n  state.attributes.popper = Object.assign({}, state.attributes.popper, {\n    'data-popper-placement': state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'computeStyles',\n  enabled: true,\n  phase: 'beforeWrite',\n  fn: computeStyles,\n  data: {}\n};","import getNodeName from \"../dom-utils/getNodeName.js\";\nimport { isHTMLElement } from \"../dom-utils/instanceOf.js\"; // This modifier takes the styles prepared by the `computeStyles` modifier\n// and applies them to the HTMLElements such as popper and arrow\n\nfunction applyStyles(_ref) {\n  var state = _ref.state;\n  Object.keys(state.elements).forEach(function (name) {\n    var style = state.styles[name] || {};\n    var attributes = state.attributes[name] || {};\n    var element = state.elements[name]; // arrow is optional + virtual elements\n\n    if (!isHTMLElement(element) || !getNodeName(element)) {\n      return;\n    } // Flow doesn't support to extend this property, but it's the most\n    // effective way to apply styles to an HTMLElement\n    // $FlowFixMe[cannot-write]\n\n\n    Object.assign(element.style, style);\n    Object.keys(attributes).forEach(function (name) {\n      var value = attributes[name];\n\n      if (value === false) {\n        element.removeAttribute(name);\n      } else {\n        element.setAttribute(name, value === true ? '' : value);\n      }\n    });\n  });\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state;\n  var initialStyles = {\n    popper: {\n      position: state.options.strategy,\n      left: '0',\n      top: '0',\n      margin: '0'\n    },\n    arrow: {\n      position: 'absolute'\n    },\n    reference: {}\n  };\n  Object.assign(state.elements.popper.style, initialStyles.popper);\n  state.styles = initialStyles;\n\n  if (state.elements.arrow) {\n    Object.assign(state.elements.arrow.style, initialStyles.arrow);\n  }\n\n  return function () {\n    Object.keys(state.elements).forEach(function (name) {\n      var element = state.elements[name];\n      var attributes = state.attributes[name] || {};\n      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]); // Set all values to an empty string to unset them\n\n      var style = styleProperties.reduce(function (style, property) {\n        style[property] = '';\n        return style;\n      }, {}); // arrow is optional + virtual elements\n\n      if (!isHTMLElement(element) || !getNodeName(element)) {\n        return;\n      }\n\n      Object.assign(element.style, style);\n      Object.keys(attributes).forEach(function (attribute) {\n        element.removeAttribute(attribute);\n      });\n    });\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'applyStyles',\n  enabled: true,\n  phase: 'write',\n  fn: applyStyles,\n  effect: effect,\n  requires: ['computeStyles']\n};","import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport { top, left, right, placements } from \"../enums.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport function distanceAndSkiddingToXY(placement, rects, offset) {\n  var basePlacement = getBasePlacement(placement);\n  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;\n\n  var _ref = typeof offset === 'function' ? offset(Object.assign({}, rects, {\n    placement: placement\n  })) : offset,\n      skidding = _ref[0],\n      distance = _ref[1];\n\n  skidding = skidding || 0;\n  distance = (distance || 0) * invertDistance;\n  return [left, right].indexOf(basePlacement) >= 0 ? {\n    x: distance,\n    y: skidding\n  } : {\n    x: skidding,\n    y: distance\n  };\n}\n\nfunction offset(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options,\n      name = _ref2.name;\n  var _options$offset = options.offset,\n      offset = _options$offset === void 0 ? [0, 0] : _options$offset;\n  var data = placements.reduce(function (acc, placement) {\n    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset);\n    return acc;\n  }, {});\n  var _data$state$placement = data[state.placement],\n      x = _data$state$placement.x,\n      y = _data$state$placement.y;\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.modifiersData.popperOffsets.x += x;\n    state.modifiersData.popperOffsets.y += y;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'offset',\n  enabled: true,\n  phase: 'main',\n  requires: ['popperOffsets'],\n  fn: offset\n};","var hash = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nexport default function getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, function (matched) {\n    return hash[matched];\n  });\n}","var hash = {\n  start: 'end',\n  end: 'start'\n};\nexport default function getOppositeVariationPlacement(placement) {\n  return placement.replace(/start|end/g, function (matched) {\n    return hash[matched];\n  });\n}","import { isShadowRoot } from \"./instanceOf.js\";\nexport default function contains(parent, child) {\n  var rootNode = child.getRootNode && child.getRootNode(); // First, attempt with faster native method\n\n  if (parent.contains(child)) {\n    return true;\n  } // then fallback to custom implementation with Shadow DOM support\n  else if (rootNode && isShadowRoot(rootNode)) {\n      var next = child;\n\n      do {\n        if (next && parent.isSameNode(next)) {\n          return true;\n        } // $FlowFixMe[prop-missing]: need a better way to handle this...\n\n\n        next = next.parentNode || next.host;\n      } while (next);\n    } // Give up, the result is false\n\n\n  return false;\n}","export default function rectToClientRect(rect) {\n  return Object.assign({}, rect, {\n    left: rect.x,\n    top: rect.y,\n    right: rect.x + rect.width,\n    bottom: rect.y + rect.height\n  });\n}","import { viewport } from \"../enums.js\";\nimport getViewportRect from \"./getViewportRect.js\";\nimport getDocumentRect from \"./getDocumentRect.js\";\nimport listScrollParents from \"./listScrollParents.js\";\nimport getOffsetParent from \"./getOffsetParent.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isElement, isHTMLElement } from \"./instanceOf.js\";\nimport getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport contains from \"./contains.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport rectToClientRect from \"../utils/rectToClientRect.js\";\nimport { max, min } from \"../utils/math.js\";\n\nfunction getInnerBoundingClientRect(element, strategy) {\n  var rect = getBoundingClientRect(element, false, strategy === 'fixed');\n  rect.top = rect.top + element.clientTop;\n  rect.left = rect.left + element.clientLeft;\n  rect.bottom = rect.top + element.clientHeight;\n  rect.right = rect.left + element.clientWidth;\n  rect.width = element.clientWidth;\n  rect.height = element.clientHeight;\n  rect.x = rect.left;\n  rect.y = rect.top;\n  return rect;\n}\n\nfunction getClientRectFromMixedType(element, clippingParent, strategy) {\n  return clippingParent === viewport ? rectToClientRect(getViewportRect(element, strategy)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent, strategy) : rectToClientRect(getDocumentRect(getDocumentElement(element)));\n} // A \"clipping parent\" is an overflowable container with the characteristic of\n// clipping (or hiding) overflowing elements with a position different from\n// `initial`\n\n\nfunction getClippingParents(element) {\n  var clippingParents = listScrollParents(getParentNode(element));\n  var canEscapeClipping = ['absolute', 'fixed'].indexOf(getComputedStyle(element).position) >= 0;\n  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;\n\n  if (!isElement(clipperElement)) {\n    return [];\n  } // $FlowFixMe[incompatible-return]: https://github.com/facebook/flow/issues/1414\n\n\n  return clippingParents.filter(function (clippingParent) {\n    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== 'body';\n  });\n} // Gets the maximum area that the element is visible in due to any number of\n// clipping parents\n\n\nexport default function getClippingRect(element, boundary, rootBoundary, strategy) {\n  var mainClippingParents = boundary === 'clippingParents' ? getClippingParents(element) : [].concat(boundary);\n  var clippingParents = [].concat(mainClippingParents, [rootBoundary]);\n  var firstClippingParent = clippingParents[0];\n  var clippingRect = clippingParents.reduce(function (accRect, clippingParent) {\n    var rect = getClientRectFromMixedType(element, clippingParent, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromMixedType(element, firstClippingParent, strategy));\n  clippingRect.width = clippingRect.right - clippingRect.left;\n  clippingRect.height = clippingRect.bottom - clippingRect.top;\n  clippingRect.x = clippingRect.left;\n  clippingRect.y = clippingRect.top;\n  return clippingRect;\n}","import getWindow from \"./getWindow.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport isLayoutViewport from \"./isLayoutViewport.js\";\nexport default function getViewportRect(element, strategy) {\n  var win = getWindow(element);\n  var html = getDocumentElement(element);\n  var visualViewport = win.visualViewport;\n  var width = html.clientWidth;\n  var height = html.clientHeight;\n  var x = 0;\n  var y = 0;\n\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    var layoutViewport = isLayoutViewport();\n\n    if (layoutViewport || !layoutViewport && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x + getWindowScrollBarX(element),\n    y: y\n  };\n}","import getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getWindowScroll from \"./getWindowScroll.js\";\nimport { max } from \"../utils/math.js\"; // Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable\n\nexport default function getDocumentRect(element) {\n  var _element$ownerDocumen;\n\n  var html = getDocumentElement(element);\n  var winScroll = getWindowScroll(element);\n  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;\n  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);\n  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);\n  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);\n  var y = -winScroll.scrollTop;\n\n  if (getComputedStyle(body || html).direction === 'rtl') {\n    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x,\n    y: y\n  };\n}","import getFreshSideObject from \"./getFreshSideObject.js\";\nexport default function mergePaddingObject(paddingObject) {\n  return Object.assign({}, getFreshSideObject(), paddingObject);\n}","export default function getFreshSideObject() {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0\n  };\n}","export default function expandToHashMap(value, keys) {\n  return keys.reduce(function (hashMap, key) {\n    hashMap[key] = value;\n    return hashMap;\n  }, {});\n}","import getClippingRect from \"../dom-utils/getClippingRect.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport getBoundingClientRect from \"../dom-utils/getBoundingClientRect.js\";\nimport computeOffsets from \"./computeOffsets.js\";\nimport rectToClientRect from \"./rectToClientRect.js\";\nimport { clippingParents, reference, popper, bottom, top, right, basePlacements, viewport } from \"../enums.js\";\nimport { isElement } from \"../dom-utils/instanceOf.js\";\nimport mergePaddingObject from \"./mergePaddingObject.js\";\nimport expandToHashMap from \"./expandToHashMap.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport default function detectOverflow(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      _options$placement = _options.placement,\n      placement = _options$placement === void 0 ? state.placement : _options$placement,\n      _options$strategy = _options.strategy,\n      strategy = _options$strategy === void 0 ? state.strategy : _options$strategy,\n      _options$boundary = _options.boundary,\n      boundary = _options$boundary === void 0 ? clippingParents : _options$boundary,\n      _options$rootBoundary = _options.rootBoundary,\n      rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary,\n      _options$elementConte = _options.elementContext,\n      elementContext = _options$elementConte === void 0 ? popper : _options$elementConte,\n      _options$altBoundary = _options.altBoundary,\n      altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary,\n      _options$padding = _options.padding,\n      padding = _options$padding === void 0 ? 0 : _options$padding;\n  var paddingObject = mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n  var altContext = elementContext === popper ? reference : popper;\n  var popperRect = state.rects.popper;\n  var element = state.elements[altBoundary ? altContext : elementContext];\n  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary, strategy);\n  var referenceClientRect = getBoundingClientRect(state.elements.reference);\n  var popperOffsets = computeOffsets({\n    reference: referenceClientRect,\n    element: popperRect,\n    strategy: 'absolute',\n    placement: placement\n  });\n  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets));\n  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect; // positive = overflowing the clipping rect\n  // 0 or negative = within the clipping rect\n\n  var overflowOffsets = {\n    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,\n    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,\n    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,\n    right: elementClientRect.right - clippingClientRect.right + paddingObject.right\n  };\n  var offsetData = state.modifiersData.offset; // Offsets can be applied only to the popper element\n\n  if (elementContext === popper && offsetData) {\n    var offset = offsetData[placement];\n    Object.keys(overflowOffsets).forEach(function (key) {\n      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;\n      var axis = [top, bottom].indexOf(key) >= 0 ? 'y' : 'x';\n      overflowOffsets[key] += offset[axis] * multiply;\n    });\n  }\n\n  return overflowOffsets;\n}","import getOppositePlacement from \"../utils/getOppositePlacement.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getOppositeVariationPlacement from \"../utils/getOppositeVariationPlacement.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport computeAutoPlacement from \"../utils/computeAutoPlacement.js\";\nimport { bottom, top, start, right, left, auto } from \"../enums.js\";\nimport getVariation from \"../utils/getVariation.js\"; // eslint-disable-next-line import/no-unused-modules\n\nfunction getExpandedFallbackPlacements(placement) {\n  if (getBasePlacement(placement) === auto) {\n    return [];\n  }\n\n  var oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];\n}\n\nfunction flip(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n\n  if (state.modifiersData[name]._skip) {\n    return;\n  }\n\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis,\n      specifiedFallbackPlacements = options.fallbackPlacements,\n      padding = options.padding,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      _options$flipVariatio = options.flipVariations,\n      flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio,\n      allowedAutoPlacements = options.allowedAutoPlacements;\n  var preferredPlacement = state.options.placement;\n  var basePlacement = getBasePlacement(preferredPlacement);\n  var isBasePlacement = basePlacement === preferredPlacement;\n  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));\n  var placements = [preferredPlacement].concat(fallbackPlacements).reduce(function (acc, placement) {\n    return acc.concat(getBasePlacement(placement) === auto ? computeAutoPlacement(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding,\n      flipVariations: flipVariations,\n      allowedAutoPlacements: allowedAutoPlacements\n    }) : placement);\n  }, []);\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var checksMap = new Map();\n  var makeFallbackChecks = true;\n  var firstFittingPlacement = placements[0];\n\n  for (var i = 0; i < placements.length; i++) {\n    var placement = placements[i];\n\n    var _basePlacement = getBasePlacement(placement);\n\n    var isStartVariation = getVariation(placement) === start;\n    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;\n    var len = isVertical ? 'width' : 'height';\n    var overflow = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      altBoundary: altBoundary,\n      padding: padding\n    });\n    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;\n\n    if (referenceRect[len] > popperRect[len]) {\n      mainVariationSide = getOppositePlacement(mainVariationSide);\n    }\n\n    var altVariationSide = getOppositePlacement(mainVariationSide);\n    var checks = [];\n\n    if (checkMainAxis) {\n      checks.push(overflow[_basePlacement] <= 0);\n    }\n\n    if (checkAltAxis) {\n      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);\n    }\n\n    if (checks.every(function (check) {\n      return check;\n    })) {\n      firstFittingPlacement = placement;\n      makeFallbackChecks = false;\n      break;\n    }\n\n    checksMap.set(placement, checks);\n  }\n\n  if (makeFallbackChecks) {\n    // `2` may be desired in some cases – research later\n    var numberOfChecks = flipVariations ? 3 : 1;\n\n    var _loop = function _loop(_i) {\n      var fittingPlacement = placements.find(function (placement) {\n        var checks = checksMap.get(placement);\n\n        if (checks) {\n          return checks.slice(0, _i).every(function (check) {\n            return check;\n          });\n        }\n      });\n\n      if (fittingPlacement) {\n        firstFittingPlacement = fittingPlacement;\n        return \"break\";\n      }\n    };\n\n    for (var _i = numberOfChecks; _i > 0; _i--) {\n      var _ret = _loop(_i);\n\n      if (_ret === \"break\") break;\n    }\n  }\n\n  if (state.placement !== firstFittingPlacement) {\n    state.modifiersData[name]._skip = true;\n    state.placement = firstFittingPlacement;\n    state.reset = true;\n  }\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'flip',\n  enabled: true,\n  phase: 'main',\n  fn: flip,\n  requiresIfExists: ['offset'],\n  data: {\n    _skip: false\n  }\n};","import getVariation from \"./getVariation.js\";\nimport { variationPlacements, basePlacements, placements as allPlacements } from \"../enums.js\";\nimport detectOverflow from \"./detectOverflow.js\";\nimport getBasePlacement from \"./getBasePlacement.js\";\nexport default function computeAutoPlacement(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      placement = _options.placement,\n      boundary = _options.boundary,\n      rootBoundary = _options.rootBoundary,\n      padding = _options.padding,\n      flipVariations = _options.flipVariations,\n      _options$allowedAutoP = _options.allowedAutoPlacements,\n      allowedAutoPlacements = _options$allowedAutoP === void 0 ? allPlacements : _options$allowedAutoP;\n  var variation = getVariation(placement);\n  var placements = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function (placement) {\n    return getVariation(placement) === variation;\n  }) : basePlacements;\n  var allowedPlacements = placements.filter(function (placement) {\n    return allowedAutoPlacements.indexOf(placement) >= 0;\n  });\n\n  if (allowedPlacements.length === 0) {\n    allowedPlacements = placements;\n\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(['Popper: The `allowedAutoPlacements` option did not allow any', 'placements. Ensure the `placement` option matches the variation', 'of the allowed placements.', 'For example, \"auto\" cannot be used to allow \"bottom-start\".', 'Use \"auto-start\" instead.'].join(' '));\n    }\n  } // $FlowFixMe[incompatible-type]: Flow seems to have problems with two array unions...\n\n\n  var overflows = allowedPlacements.reduce(function (acc, placement) {\n    acc[placement] = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding\n    })[getBasePlacement(placement)];\n    return acc;\n  }, {});\n  return Object.keys(overflows).sort(function (a, b) {\n    return overflows[a] - overflows[b];\n  });\n}","import { max as mathMax, min as mathMin } from \"./math.js\";\nexport function within(min, value, max) {\n  return mathMax(min, mathMin(value, max));\n}\nexport function withinMaxClamp(min, value, max) {\n  var v = within(min, value, max);\n  return v > max ? max : v;\n}","import { top, left, right, bottom, start } from \"../enums.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport getAltAxis from \"../utils/getAltAxis.js\";\nimport { within, withinMaxClamp } from \"../utils/within.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport getVariation from \"../utils/getVariation.js\";\nimport getFreshSideObject from \"../utils/getFreshSideObject.js\";\nimport { min as mathMin, max as mathMax } from \"../utils/math.js\";\n\nfunction preventOverflow(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      padding = options.padding,\n      _options$tether = options.tether,\n      tether = _options$tether === void 0 ? true : _options$tether,\n      _options$tetherOffset = options.tetherOffset,\n      tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;\n  var overflow = detectOverflow(state, {\n    boundary: boundary,\n    rootBoundary: rootBoundary,\n    padding: padding,\n    altBoundary: altBoundary\n  });\n  var basePlacement = getBasePlacement(state.placement);\n  var variation = getVariation(state.placement);\n  var isBasePlacement = !variation;\n  var mainAxis = getMainAxisFromPlacement(basePlacement);\n  var altAxis = getAltAxis(mainAxis);\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var tetherOffsetValue = typeof tetherOffset === 'function' ? tetherOffset(Object.assign({}, state.rects, {\n    placement: state.placement\n  })) : tetherOffset;\n  var normalizedTetherOffsetValue = typeof tetherOffsetValue === 'number' ? {\n    mainAxis: tetherOffsetValue,\n    altAxis: tetherOffsetValue\n  } : Object.assign({\n    mainAxis: 0,\n    altAxis: 0\n  }, tetherOffsetValue);\n  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;\n  var data = {\n    x: 0,\n    y: 0\n  };\n\n  if (!popperOffsets) {\n    return;\n  }\n\n  if (checkMainAxis) {\n    var _offsetModifierState$;\n\n    var mainSide = mainAxis === 'y' ? top : left;\n    var altSide = mainAxis === 'y' ? bottom : right;\n    var len = mainAxis === 'y' ? 'height' : 'width';\n    var offset = popperOffsets[mainAxis];\n    var min = offset + overflow[mainSide];\n    var max = offset - overflow[altSide];\n    var additive = tether ? -popperRect[len] / 2 : 0;\n    var minLen = variation === start ? referenceRect[len] : popperRect[len];\n    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len]; // We need to include the arrow in the calculation so the arrow doesn't go\n    // outside the reference bounds\n\n    var arrowElement = state.elements.arrow;\n    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {\n      width: 0,\n      height: 0\n    };\n    var arrowPaddingObject = state.modifiersData['arrow#persistent'] ? state.modifiersData['arrow#persistent'].padding : getFreshSideObject();\n    var arrowPaddingMin = arrowPaddingObject[mainSide];\n    var arrowPaddingMax = arrowPaddingObject[altSide]; // If the reference length is smaller than the arrow length, we don't want\n    // to include its full size in the calculation. If the reference is small\n    // and near the edge of a boundary, the popper can overflow even if the\n    // reference is not overflowing as well (e.g. virtual elements with no\n    // width or height)\n\n    var arrowLen = within(0, referenceRect[len], arrowRect[len]);\n    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;\n    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;\n    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);\n    var clientOffset = arrowOffsetParent ? mainAxis === 'y' ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;\n    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;\n    var tetherMin = offset + minOffset - offsetModifierValue - clientOffset;\n    var tetherMax = offset + maxOffset - offsetModifierValue;\n    var preventedOffset = within(tether ? mathMin(min, tetherMin) : min, offset, tether ? mathMax(max, tetherMax) : max);\n    popperOffsets[mainAxis] = preventedOffset;\n    data[mainAxis] = preventedOffset - offset;\n  }\n\n  if (checkAltAxis) {\n    var _offsetModifierState$2;\n\n    var _mainSide = mainAxis === 'x' ? top : left;\n\n    var _altSide = mainAxis === 'x' ? bottom : right;\n\n    var _offset = popperOffsets[altAxis];\n\n    var _len = altAxis === 'y' ? 'height' : 'width';\n\n    var _min = _offset + overflow[_mainSide];\n\n    var _max = _offset - overflow[_altSide];\n\n    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;\n\n    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;\n\n    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;\n\n    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;\n\n    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);\n\n    popperOffsets[altAxis] = _preventedOffset;\n    data[altAxis] = _preventedOffset - _offset;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'preventOverflow',\n  enabled: true,\n  phase: 'main',\n  fn: preventOverflow,\n  requiresIfExists: ['offset']\n};","export default function getAltAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}","import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport contains from \"../dom-utils/contains.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport { within } from \"../utils/within.js\";\nimport mergePaddingObject from \"../utils/mergePaddingObject.js\";\nimport expandToHashMap from \"../utils/expandToHashMap.js\";\nimport { left, right, basePlacements, top, bottom } from \"../enums.js\";\nimport { isHTMLElement } from \"../dom-utils/instanceOf.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar toPaddingObject = function toPaddingObject(padding, state) {\n  padding = typeof padding === 'function' ? padding(Object.assign({}, state.rects, {\n    placement: state.placement\n  })) : padding;\n  return mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n};\n\nfunction arrow(_ref) {\n  var _state$modifiersData$;\n\n  var state = _ref.state,\n      name = _ref.name,\n      options = _ref.options;\n  var arrowElement = state.elements.arrow;\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var basePlacement = getBasePlacement(state.placement);\n  var axis = getMainAxisFromPlacement(basePlacement);\n  var isVertical = [left, right].indexOf(basePlacement) >= 0;\n  var len = isVertical ? 'height' : 'width';\n\n  if (!arrowElement || !popperOffsets) {\n    return;\n  }\n\n  var paddingObject = toPaddingObject(options.padding, state);\n  var arrowRect = getLayoutRect(arrowElement);\n  var minProp = axis === 'y' ? top : left;\n  var maxProp = axis === 'y' ? bottom : right;\n  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets[axis] - state.rects.popper[len];\n  var startDiff = popperOffsets[axis] - state.rects.reference[axis];\n  var arrowOffsetParent = getOffsetParent(arrowElement);\n  var clientSize = arrowOffsetParent ? axis === 'y' ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;\n  var centerToReference = endDiff / 2 - startDiff / 2; // Make sure the arrow doesn't overflow the popper if the center point is\n  // outside of the popper bounds\n\n  var min = paddingObject[minProp];\n  var max = clientSize - arrowRect[len] - paddingObject[maxProp];\n  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;\n  var offset = within(min, center, max); // Prevents breaking syntax highlighting...\n\n  var axisProp = axis;\n  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset, _state$modifiersData$.centerOffset = offset - center, _state$modifiersData$);\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options;\n  var _options$element = options.element,\n      arrowElement = _options$element === void 0 ? '[data-popper-arrow]' : _options$element;\n\n  if (arrowElement == null) {\n    return;\n  } // CSS selector\n\n\n  if (typeof arrowElement === 'string') {\n    arrowElement = state.elements.popper.querySelector(arrowElement);\n\n    if (!arrowElement) {\n      return;\n    }\n  }\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!isHTMLElement(arrowElement)) {\n      console.error(['Popper: \"arrow\" element must be an HTMLElement (not an SVGElement).', 'To use an SVG arrow, wrap it in an HTMLElement that will be used as', 'the arrow.'].join(' '));\n    }\n  }\n\n  if (!contains(state.elements.popper, arrowElement)) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(['Popper: \"arrow\" modifier\\'s `element` must be a child of the popper', 'element.'].join(' '));\n    }\n\n    return;\n  }\n\n  state.elements.arrow = arrowElement;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'arrow',\n  enabled: true,\n  phase: 'main',\n  fn: arrow,\n  effect: effect,\n  requires: ['popperOffsets'],\n  requiresIfExists: ['preventOverflow']\n};","import { top, bottom, left, right } from \"../enums.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\n\nfunction getSideOffsets(overflow, rect, preventedOffsets) {\n  if (preventedOffsets === void 0) {\n    preventedOffsets = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  return {\n    top: overflow.top - rect.height - preventedOffsets.y,\n    right: overflow.right - rect.width + preventedOffsets.x,\n    bottom: overflow.bottom - rect.height + preventedOffsets.y,\n    left: overflow.left - rect.width - preventedOffsets.x\n  };\n}\n\nfunction isAnySideFullyClipped(overflow) {\n  return [top, right, bottom, left].some(function (side) {\n    return overflow[side] >= 0;\n  });\n}\n\nfunction hide(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var preventedOffsets = state.modifiersData.preventOverflow;\n  var referenceOverflow = detectOverflow(state, {\n    elementContext: 'reference'\n  });\n  var popperAltOverflow = detectOverflow(state, {\n    altBoundary: true\n  });\n  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);\n  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);\n  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);\n  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);\n  state.modifiersData[name] = {\n    referenceClippingOffsets: referenceClippingOffsets,\n    popperEscapeOffsets: popperEscapeOffsets,\n    isReferenceHidden: isReferenceHidden,\n    hasPopperEscaped: hasPopperEscaped\n  };\n  state.attributes.popper = Object.assign({}, state.attributes.popper, {\n    'data-popper-reference-hidden': isReferenceHidden,\n    'data-popper-escaped': hasPopperEscaped\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'hide',\n  enabled: true,\n  phase: 'main',\n  requiresIfExists: ['preventOverflow'],\n  fn: hide\n};","import { popperGenerator, detectOverflow } from \"./createPopper.js\";\nimport eventListeners from \"./modifiers/eventListeners.js\";\nimport popperOffsets from \"./modifiers/popperOffsets.js\";\nimport computeStyles from \"./modifiers/computeStyles.js\";\nimport applyStyles from \"./modifiers/applyStyles.js\";\nimport offset from \"./modifiers/offset.js\";\nimport flip from \"./modifiers/flip.js\";\nimport preventOverflow from \"./modifiers/preventOverflow.js\";\nimport arrow from \"./modifiers/arrow.js\";\nimport hide from \"./modifiers/hide.js\";\nvar defaultModifiers = [eventListeners, popperOffsets, computeStyles, applyStyles, offset, flip, preventOverflow, arrow, hide];\nvar createPopper = /*#__PURE__*/popperGenerator({\n  defaultModifiers: defaultModifiers\n}); // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper, popperGenerator, defaultModifiers, detectOverflow }; // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper as createPopperLite } from \"./popper-lite.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport * from \"./modifiers/index.js\";","import computeOffsets from \"../utils/computeOffsets.js\";\n\nfunction popperOffsets(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  // Offsets are the actual position the popper needs to have to be\n  // properly positioned near its reference element\n  // This is the most basic placement, and will be adjusted by\n  // the modifiers in the next step\n  state.modifiersData[name] = computeOffsets({\n    reference: state.rects.reference,\n    element: state.rects.popper,\n    strategy: 'absolute',\n    placement: state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'popperOffsets',\n  enabled: true,\n  phase: 'read',\n  fn: popperOffsets,\n  data: {}\n};","/**!\n* tippy.js v6.3.7\n* (c) 2017-2021 atomiks\n* MIT License\n*/\nimport { createPopper, applyStyles } from '@popperjs/core';\n\nvar ROUND_ARROW = '<svg width=\"16\" height=\"6\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z\"></svg>';\nvar BOX_CLASS = \"tippy-box\";\nvar CONTENT_CLASS = \"tippy-content\";\nvar BACKDROP_CLASS = \"tippy-backdrop\";\nvar ARROW_CLASS = \"tippy-arrow\";\nvar SVG_ARROW_CLASS = \"tippy-svg-arrow\";\nvar TOUCH_OPTIONS = {\n  passive: true,\n  capture: true\n};\nvar TIPPY_DEFAULT_APPEND_TO = function TIPPY_DEFAULT_APPEND_TO() {\n  return document.body;\n};\n\nfunction hasOwnProperty(obj, key) {\n  return {}.hasOwnProperty.call(obj, key);\n}\nfunction getValueAtIndexOrReturn(value, index, defaultValue) {\n  if (Array.isArray(value)) {\n    var v = value[index];\n    return v == null ? Array.isArray(defaultValue) ? defaultValue[index] : defaultValue : v;\n  }\n\n  return value;\n}\nfunction isType(value, type) {\n  var str = {}.toString.call(value);\n  return str.indexOf('[object') === 0 && str.indexOf(type + \"]\") > -1;\n}\nfunction invokeWithArgsOrReturn(value, args) {\n  return typeof value === 'function' ? value.apply(void 0, args) : value;\n}\nfunction debounce(fn, ms) {\n  // Avoid wrapping in `setTimeout` if ms is 0 anyway\n  if (ms === 0) {\n    return fn;\n  }\n\n  var timeout;\n  return function (arg) {\n    clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      fn(arg);\n    }, ms);\n  };\n}\nfunction removeProperties(obj, keys) {\n  var clone = Object.assign({}, obj);\n  keys.forEach(function (key) {\n    delete clone[key];\n  });\n  return clone;\n}\nfunction splitBySpaces(value) {\n  return value.split(/\\s+/).filter(Boolean);\n}\nfunction normalizeToArray(value) {\n  return [].concat(value);\n}\nfunction pushIfUnique(arr, value) {\n  if (arr.indexOf(value) === -1) {\n    arr.push(value);\n  }\n}\nfunction unique(arr) {\n  return arr.filter(function (item, index) {\n    return arr.indexOf(item) === index;\n  });\n}\nfunction getBasePlacement(placement) {\n  return placement.split('-')[0];\n}\nfunction arrayFrom(value) {\n  return [].slice.call(value);\n}\nfunction removeUndefinedProps(obj) {\n  return Object.keys(obj).reduce(function (acc, key) {\n    if (obj[key] !== undefined) {\n      acc[key] = obj[key];\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction div() {\n  return document.createElement('div');\n}\nfunction isElement(value) {\n  return ['Element', 'Fragment'].some(function (type) {\n    return isType(value, type);\n  });\n}\nfunction isNodeList(value) {\n  return isType(value, 'NodeList');\n}\nfunction isMouseEvent(value) {\n  return isType(value, 'MouseEvent');\n}\nfunction isReferenceElement(value) {\n  return !!(value && value._tippy && value._tippy.reference === value);\n}\nfunction getArrayOfElements(value) {\n  if (isElement(value)) {\n    return [value];\n  }\n\n  if (isNodeList(value)) {\n    return arrayFrom(value);\n  }\n\n  if (Array.isArray(value)) {\n    return value;\n  }\n\n  return arrayFrom(document.querySelectorAll(value));\n}\nfunction setTransitionDuration(els, value) {\n  els.forEach(function (el) {\n    if (el) {\n      el.style.transitionDuration = value + \"ms\";\n    }\n  });\n}\nfunction setVisibilityState(els, state) {\n  els.forEach(function (el) {\n    if (el) {\n      el.setAttribute('data-state', state);\n    }\n  });\n}\nfunction getOwnerDocument(elementOrElements) {\n  var _element$ownerDocumen;\n\n  var _normalizeToArray = normalizeToArray(elementOrElements),\n      element = _normalizeToArray[0]; // Elements created via a <template> have an ownerDocument with no reference to the body\n\n\n  return element != null && (_element$ownerDocumen = element.ownerDocument) != null && _element$ownerDocumen.body ? element.ownerDocument : document;\n}\nfunction isCursorOutsideInteractiveBorder(popperTreeData, event) {\n  var clientX = event.clientX,\n      clientY = event.clientY;\n  return popperTreeData.every(function (_ref) {\n    var popperRect = _ref.popperRect,\n        popperState = _ref.popperState,\n        props = _ref.props;\n    var interactiveBorder = props.interactiveBorder;\n    var basePlacement = getBasePlacement(popperState.placement);\n    var offsetData = popperState.modifiersData.offset;\n\n    if (!offsetData) {\n      return true;\n    }\n\n    var topDistance = basePlacement === 'bottom' ? offsetData.top.y : 0;\n    var bottomDistance = basePlacement === 'top' ? offsetData.bottom.y : 0;\n    var leftDistance = basePlacement === 'right' ? offsetData.left.x : 0;\n    var rightDistance = basePlacement === 'left' ? offsetData.right.x : 0;\n    var exceedsTop = popperRect.top - clientY + topDistance > interactiveBorder;\n    var exceedsBottom = clientY - popperRect.bottom - bottomDistance > interactiveBorder;\n    var exceedsLeft = popperRect.left - clientX + leftDistance > interactiveBorder;\n    var exceedsRight = clientX - popperRect.right - rightDistance > interactiveBorder;\n    return exceedsTop || exceedsBottom || exceedsLeft || exceedsRight;\n  });\n}\nfunction updateTransitionEndListener(box, action, listener) {\n  var method = action + \"EventListener\"; // some browsers apparently support `transition` (unprefixed) but only fire\n  // `webkitTransitionEnd`...\n\n  ['transitionend', 'webkitTransitionEnd'].forEach(function (event) {\n    box[method](event, listener);\n  });\n}\n/**\n * Compared to xxx.contains, this function works for dom structures with shadow\n * dom\n */\n\nfunction actualContains(parent, child) {\n  var target = child;\n\n  while (target) {\n    var _target$getRootNode;\n\n    if (parent.contains(target)) {\n      return true;\n    }\n\n    target = target.getRootNode == null ? void 0 : (_target$getRootNode = target.getRootNode()) == null ? void 0 : _target$getRootNode.host;\n  }\n\n  return false;\n}\n\nvar currentInput = {\n  isTouch: false\n};\nvar lastMouseMoveTime = 0;\n/**\n * When a `touchstart` event is fired, it's assumed the user is using touch\n * input. We'll bind a `mousemove` event listener to listen for mouse input in\n * the future. This way, the `isTouch` property is fully dynamic and will handle\n * hybrid devices that use a mix of touch + mouse input.\n */\n\nfunction onDocumentTouchStart() {\n  if (currentInput.isTouch) {\n    return;\n  }\n\n  currentInput.isTouch = true;\n\n  if (window.performance) {\n    document.addEventListener('mousemove', onDocumentMouseMove);\n  }\n}\n/**\n * When two `mousemove` event are fired consecutively within 20ms, it's assumed\n * the user is using mouse input again. `mousemove` can fire on touch devices as\n * well, but very rarely that quickly.\n */\n\nfunction onDocumentMouseMove() {\n  var now = performance.now();\n\n  if (now - lastMouseMoveTime < 20) {\n    currentInput.isTouch = false;\n    document.removeEventListener('mousemove', onDocumentMouseMove);\n  }\n\n  lastMouseMoveTime = now;\n}\n/**\n * When an element is in focus and has a tippy, leaving the tab/window and\n * returning causes it to show again. For mouse users this is unexpected, but\n * for keyboard use it makes sense.\n * TODO: find a better technique to solve this problem\n */\n\nfunction onWindowBlur() {\n  var activeElement = document.activeElement;\n\n  if (isReferenceElement(activeElement)) {\n    var instance = activeElement._tippy;\n\n    if (activeElement.blur && !instance.state.isVisible) {\n      activeElement.blur();\n    }\n  }\n}\nfunction bindGlobalEventListeners() {\n  document.addEventListener('touchstart', onDocumentTouchStart, TOUCH_OPTIONS);\n  window.addEventListener('blur', onWindowBlur);\n}\n\nvar isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';\nvar isIE11 = isBrowser ? // @ts-ignore\n!!window.msCrypto : false;\n\nfunction createMemoryLeakWarning(method) {\n  var txt = method === 'destroy' ? 'n already-' : ' ';\n  return [method + \"() was called on a\" + txt + \"destroyed instance. This is a no-op but\", 'indicates a potential memory leak.'].join(' ');\n}\nfunction clean(value) {\n  var spacesAndTabs = /[ \\t]{2,}/g;\n  var lineStartWithSpaces = /^[ \\t]*/gm;\n  return value.replace(spacesAndTabs, ' ').replace(lineStartWithSpaces, '').trim();\n}\n\nfunction getDevMessage(message) {\n  return clean(\"\\n  %ctippy.js\\n\\n  %c\" + clean(message) + \"\\n\\n  %c\\uD83D\\uDC77\\u200D This is a development-only message. It will be removed in production.\\n  \");\n}\n\nfunction getFormattedMessage(message) {\n  return [getDevMessage(message), // title\n  'color: #00C584; font-size: 1.3em; font-weight: bold;', // message\n  'line-height: 1.5', // footer\n  'color: #a6a095;'];\n} // Assume warnings and errors never have the same message\n\nvar visitedMessages;\n\nif (process.env.NODE_ENV !== \"production\") {\n  resetVisitedMessages();\n}\n\nfunction resetVisitedMessages() {\n  visitedMessages = new Set();\n}\nfunction warnWhen(condition, message) {\n  if (condition && !visitedMessages.has(message)) {\n    var _console;\n\n    visitedMessages.add(message);\n\n    (_console = console).warn.apply(_console, getFormattedMessage(message));\n  }\n}\nfunction errorWhen(condition, message) {\n  if (condition && !visitedMessages.has(message)) {\n    var _console2;\n\n    visitedMessages.add(message);\n\n    (_console2 = console).error.apply(_console2, getFormattedMessage(message));\n  }\n}\nfunction validateTargets(targets) {\n  var didPassFalsyValue = !targets;\n  var didPassPlainObject = Object.prototype.toString.call(targets) === '[object Object]' && !targets.addEventListener;\n  errorWhen(didPassFalsyValue, ['tippy() was passed', '`' + String(targets) + '`', 'as its targets (first) argument. Valid types are: String, Element,', 'Element[], or NodeList.'].join(' '));\n  errorWhen(didPassPlainObject, ['tippy() was passed a plain object which is not supported as an argument', 'for virtual positioning. Use props.getReferenceClientRect instead.'].join(' '));\n}\n\nvar pluginProps = {\n  animateFill: false,\n  followCursor: false,\n  inlinePositioning: false,\n  sticky: false\n};\nvar renderProps = {\n  allowHTML: false,\n  animation: 'fade',\n  arrow: true,\n  content: '',\n  inertia: false,\n  maxWidth: 350,\n  role: 'tooltip',\n  theme: '',\n  zIndex: 9999\n};\nvar defaultProps = Object.assign({\n  appendTo: TIPPY_DEFAULT_APPEND_TO,\n  aria: {\n    content: 'auto',\n    expanded: 'auto'\n  },\n  delay: 0,\n  duration: [300, 250],\n  getReferenceClientRect: null,\n  hideOnClick: true,\n  ignoreAttributes: false,\n  interactive: false,\n  interactiveBorder: 2,\n  interactiveDebounce: 0,\n  moveTransition: '',\n  offset: [0, 10],\n  onAfterUpdate: function onAfterUpdate() {},\n  onBeforeUpdate: function onBeforeUpdate() {},\n  onCreate: function onCreate() {},\n  onDestroy: function onDestroy() {},\n  onHidden: function onHidden() {},\n  onHide: function onHide() {},\n  onMount: function onMount() {},\n  onShow: function onShow() {},\n  onShown: function onShown() {},\n  onTrigger: function onTrigger() {},\n  onUntrigger: function onUntrigger() {},\n  onClickOutside: function onClickOutside() {},\n  placement: 'top',\n  plugins: [],\n  popperOptions: {},\n  render: null,\n  showOnCreate: false,\n  touch: true,\n  trigger: 'mouseenter focus',\n  triggerTarget: null\n}, pluginProps, renderProps);\nvar defaultKeys = Object.keys(defaultProps);\nvar setDefaultProps = function setDefaultProps(partialProps) {\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== \"production\") {\n    validateProps(partialProps, []);\n  }\n\n  var keys = Object.keys(partialProps);\n  keys.forEach(function (key) {\n    defaultProps[key] = partialProps[key];\n  });\n};\nfunction getExtendedPassedProps(passedProps) {\n  var plugins = passedProps.plugins || [];\n  var pluginProps = plugins.reduce(function (acc, plugin) {\n    var name = plugin.name,\n        defaultValue = plugin.defaultValue;\n\n    if (name) {\n      var _name;\n\n      acc[name] = passedProps[name] !== undefined ? passedProps[name] : (_name = defaultProps[name]) != null ? _name : defaultValue;\n    }\n\n    return acc;\n  }, {});\n  return Object.assign({}, passedProps, pluginProps);\n}\nfunction getDataAttributeProps(reference, plugins) {\n  var propKeys = plugins ? Object.keys(getExtendedPassedProps(Object.assign({}, defaultProps, {\n    plugins: plugins\n  }))) : defaultKeys;\n  var props = propKeys.reduce(function (acc, key) {\n    var valueAsString = (reference.getAttribute(\"data-tippy-\" + key) || '').trim();\n\n    if (!valueAsString) {\n      return acc;\n    }\n\n    if (key === 'content') {\n      acc[key] = valueAsString;\n    } else {\n      try {\n        acc[key] = JSON.parse(valueAsString);\n      } catch (e) {\n        acc[key] = valueAsString;\n      }\n    }\n\n    return acc;\n  }, {});\n  return props;\n}\nfunction evaluateProps(reference, props) {\n  var out = Object.assign({}, props, {\n    content: invokeWithArgsOrReturn(props.content, [reference])\n  }, props.ignoreAttributes ? {} : getDataAttributeProps(reference, props.plugins));\n  out.aria = Object.assign({}, defaultProps.aria, out.aria);\n  out.aria = {\n    expanded: out.aria.expanded === 'auto' ? props.interactive : out.aria.expanded,\n    content: out.aria.content === 'auto' ? props.interactive ? null : 'describedby' : out.aria.content\n  };\n  return out;\n}\nfunction validateProps(partialProps, plugins) {\n  if (partialProps === void 0) {\n    partialProps = {};\n  }\n\n  if (plugins === void 0) {\n    plugins = [];\n  }\n\n  var keys = Object.keys(partialProps);\n  keys.forEach(function (prop) {\n    var nonPluginProps = removeProperties(defaultProps, Object.keys(pluginProps));\n    var didPassUnknownProp = !hasOwnProperty(nonPluginProps, prop); // Check if the prop exists in `plugins`\n\n    if (didPassUnknownProp) {\n      didPassUnknownProp = plugins.filter(function (plugin) {\n        return plugin.name === prop;\n      }).length === 0;\n    }\n\n    warnWhen(didPassUnknownProp, [\"`\" + prop + \"`\", \"is not a valid prop. You may have spelled it incorrectly, or if it's\", 'a plugin, forgot to pass it in an array as props.plugins.', '\\n\\n', 'All props: https://atomiks.github.io/tippyjs/v6/all-props/\\n', 'Plugins: https://atomiks.github.io/tippyjs/v6/plugins/'].join(' '));\n  });\n}\n\nvar innerHTML = function innerHTML() {\n  return 'innerHTML';\n};\n\nfunction dangerouslySetInnerHTML(element, html) {\n  element[innerHTML()] = html;\n}\n\nfunction createArrowElement(value) {\n  var arrow = div();\n\n  if (value === true) {\n    arrow.className = ARROW_CLASS;\n  } else {\n    arrow.className = SVG_ARROW_CLASS;\n\n    if (isElement(value)) {\n      arrow.appendChild(value);\n    } else {\n      dangerouslySetInnerHTML(arrow, value);\n    }\n  }\n\n  return arrow;\n}\n\nfunction setContent(content, props) {\n  if (isElement(props.content)) {\n    dangerouslySetInnerHTML(content, '');\n    content.appendChild(props.content);\n  } else if (typeof props.content !== 'function') {\n    if (props.allowHTML) {\n      dangerouslySetInnerHTML(content, props.content);\n    } else {\n      content.textContent = props.content;\n    }\n  }\n}\nfunction getChildren(popper) {\n  var box = popper.firstElementChild;\n  var boxChildren = arrayFrom(box.children);\n  return {\n    box: box,\n    content: boxChildren.find(function (node) {\n      return node.classList.contains(CONTENT_CLASS);\n    }),\n    arrow: boxChildren.find(function (node) {\n      return node.classList.contains(ARROW_CLASS) || node.classList.contains(SVG_ARROW_CLASS);\n    }),\n    backdrop: boxChildren.find(function (node) {\n      return node.classList.contains(BACKDROP_CLASS);\n    })\n  };\n}\nfunction render(instance) {\n  var popper = div();\n  var box = div();\n  box.className = BOX_CLASS;\n  box.setAttribute('data-state', 'hidden');\n  box.setAttribute('tabindex', '-1');\n  var content = div();\n  content.className = CONTENT_CLASS;\n  content.setAttribute('data-state', 'hidden');\n  setContent(content, instance.props);\n  popper.appendChild(box);\n  box.appendChild(content);\n  onUpdate(instance.props, instance.props);\n\n  function onUpdate(prevProps, nextProps) {\n    var _getChildren = getChildren(popper),\n        box = _getChildren.box,\n        content = _getChildren.content,\n        arrow = _getChildren.arrow;\n\n    if (nextProps.theme) {\n      box.setAttribute('data-theme', nextProps.theme);\n    } else {\n      box.removeAttribute('data-theme');\n    }\n\n    if (typeof nextProps.animation === 'string') {\n      box.setAttribute('data-animation', nextProps.animation);\n    } else {\n      box.removeAttribute('data-animation');\n    }\n\n    if (nextProps.inertia) {\n      box.setAttribute('data-inertia', '');\n    } else {\n      box.removeAttribute('data-inertia');\n    }\n\n    box.style.maxWidth = typeof nextProps.maxWidth === 'number' ? nextProps.maxWidth + \"px\" : nextProps.maxWidth;\n\n    if (nextProps.role) {\n      box.setAttribute('role', nextProps.role);\n    } else {\n      box.removeAttribute('role');\n    }\n\n    if (prevProps.content !== nextProps.content || prevProps.allowHTML !== nextProps.allowHTML) {\n      setContent(content, instance.props);\n    }\n\n    if (nextProps.arrow) {\n      if (!arrow) {\n        box.appendChild(createArrowElement(nextProps.arrow));\n      } else if (prevProps.arrow !== nextProps.arrow) {\n        box.removeChild(arrow);\n        box.appendChild(createArrowElement(nextProps.arrow));\n      }\n    } else if (arrow) {\n      box.removeChild(arrow);\n    }\n  }\n\n  return {\n    popper: popper,\n    onUpdate: onUpdate\n  };\n} // Runtime check to identify if the render function is the default one; this\n// way we can apply default CSS transitions logic and it can be tree-shaken away\n\nrender.$$tippy = true;\n\nvar idCounter = 1;\nvar mouseMoveListeners = []; // Used by `hideAll()`\n\nvar mountedInstances = [];\nfunction createTippy(reference, passedProps) {\n  var props = evaluateProps(reference, Object.assign({}, defaultProps, getExtendedPassedProps(removeUndefinedProps(passedProps)))); // ===========================================================================\n  // 🔒 Private members\n  // ===========================================================================\n\n  var showTimeout;\n  var hideTimeout;\n  var scheduleHideAnimationFrame;\n  var isVisibleFromClick = false;\n  var didHideDueToDocumentMouseDown = false;\n  var didTouchMove = false;\n  var ignoreOnFirstUpdate = false;\n  var lastTriggerEvent;\n  var currentTransitionEndListener;\n  var onFirstUpdate;\n  var listeners = [];\n  var debouncedOnMouseMove = debounce(onMouseMove, props.interactiveDebounce);\n  var currentTarget; // ===========================================================================\n  // 🔑 Public members\n  // ===========================================================================\n\n  var id = idCounter++;\n  var popperInstance = null;\n  var plugins = unique(props.plugins);\n  var state = {\n    // Is the instance currently enabled?\n    isEnabled: true,\n    // Is the tippy currently showing and not transitioning out?\n    isVisible: false,\n    // Has the instance been destroyed?\n    isDestroyed: false,\n    // Is the tippy currently mounted to the DOM?\n    isMounted: false,\n    // Has the tippy finished transitioning in?\n    isShown: false\n  };\n  var instance = {\n    // properties\n    id: id,\n    reference: reference,\n    popper: div(),\n    popperInstance: popperInstance,\n    props: props,\n    state: state,\n    plugins: plugins,\n    // methods\n    clearDelayTimeouts: clearDelayTimeouts,\n    setProps: setProps,\n    setContent: setContent,\n    show: show,\n    hide: hide,\n    hideWithInteractivity: hideWithInteractivity,\n    enable: enable,\n    disable: disable,\n    unmount: unmount,\n    destroy: destroy\n  }; // TODO: Investigate why this early return causes a TDZ error in the tests —\n  // it doesn't seem to happen in the browser\n\n  /* istanbul ignore if */\n\n  if (!props.render) {\n    if (process.env.NODE_ENV !== \"production\") {\n      errorWhen(true, 'render() function has not been supplied.');\n    }\n\n    return instance;\n  } // ===========================================================================\n  // Initial mutations\n  // ===========================================================================\n\n\n  var _props$render = props.render(instance),\n      popper = _props$render.popper,\n      onUpdate = _props$render.onUpdate;\n\n  popper.setAttribute('data-tippy-root', '');\n  popper.id = \"tippy-\" + instance.id;\n  instance.popper = popper;\n  reference._tippy = instance;\n  popper._tippy = instance;\n  var pluginsHooks = plugins.map(function (plugin) {\n    return plugin.fn(instance);\n  });\n  var hasAriaExpanded = reference.hasAttribute('aria-expanded');\n  addListeners();\n  handleAriaExpandedAttribute();\n  handleStyles();\n  invokeHook('onCreate', [instance]);\n\n  if (props.showOnCreate) {\n    scheduleShow();\n  } // Prevent a tippy with a delay from hiding if the cursor left then returned\n  // before it started hiding\n\n\n  popper.addEventListener('mouseenter', function () {\n    if (instance.props.interactive && instance.state.isVisible) {\n      instance.clearDelayTimeouts();\n    }\n  });\n  popper.addEventListener('mouseleave', function () {\n    if (instance.props.interactive && instance.props.trigger.indexOf('mouseenter') >= 0) {\n      getDocument().addEventListener('mousemove', debouncedOnMouseMove);\n    }\n  });\n  return instance; // ===========================================================================\n  // 🔒 Private methods\n  // ===========================================================================\n\n  function getNormalizedTouchSettings() {\n    var touch = instance.props.touch;\n    return Array.isArray(touch) ? touch : [touch, 0];\n  }\n\n  function getIsCustomTouchBehavior() {\n    return getNormalizedTouchSettings()[0] === 'hold';\n  }\n\n  function getIsDefaultRenderFn() {\n    var _instance$props$rende;\n\n    // @ts-ignore\n    return !!((_instance$props$rende = instance.props.render) != null && _instance$props$rende.$$tippy);\n  }\n\n  function getCurrentTarget() {\n    return currentTarget || reference;\n  }\n\n  function getDocument() {\n    var parent = getCurrentTarget().parentNode;\n    return parent ? getOwnerDocument(parent) : document;\n  }\n\n  function getDefaultTemplateChildren() {\n    return getChildren(popper);\n  }\n\n  function getDelay(isShow) {\n    // For touch or keyboard input, force `0` delay for UX reasons\n    // Also if the instance is mounted but not visible (transitioning out),\n    // ignore delay\n    if (instance.state.isMounted && !instance.state.isVisible || currentInput.isTouch || lastTriggerEvent && lastTriggerEvent.type === 'focus') {\n      return 0;\n    }\n\n    return getValueAtIndexOrReturn(instance.props.delay, isShow ? 0 : 1, defaultProps.delay);\n  }\n\n  function handleStyles(fromHide) {\n    if (fromHide === void 0) {\n      fromHide = false;\n    }\n\n    popper.style.pointerEvents = instance.props.interactive && !fromHide ? '' : 'none';\n    popper.style.zIndex = \"\" + instance.props.zIndex;\n  }\n\n  function invokeHook(hook, args, shouldInvokePropsHook) {\n    if (shouldInvokePropsHook === void 0) {\n      shouldInvokePropsHook = true;\n    }\n\n    pluginsHooks.forEach(function (pluginHooks) {\n      if (pluginHooks[hook]) {\n        pluginHooks[hook].apply(pluginHooks, args);\n      }\n    });\n\n    if (shouldInvokePropsHook) {\n      var _instance$props;\n\n      (_instance$props = instance.props)[hook].apply(_instance$props, args);\n    }\n  }\n\n  function handleAriaContentAttribute() {\n    var aria = instance.props.aria;\n\n    if (!aria.content) {\n      return;\n    }\n\n    var attr = \"aria-\" + aria.content;\n    var id = popper.id;\n    var nodes = normalizeToArray(instance.props.triggerTarget || reference);\n    nodes.forEach(function (node) {\n      var currentValue = node.getAttribute(attr);\n\n      if (instance.state.isVisible) {\n        node.setAttribute(attr, currentValue ? currentValue + \" \" + id : id);\n      } else {\n        var nextValue = currentValue && currentValue.replace(id, '').trim();\n\n        if (nextValue) {\n          node.setAttribute(attr, nextValue);\n        } else {\n          node.removeAttribute(attr);\n        }\n      }\n    });\n  }\n\n  function handleAriaExpandedAttribute() {\n    if (hasAriaExpanded || !instance.props.aria.expanded) {\n      return;\n    }\n\n    var nodes = normalizeToArray(instance.props.triggerTarget || reference);\n    nodes.forEach(function (node) {\n      if (instance.props.interactive) {\n        node.setAttribute('aria-expanded', instance.state.isVisible && node === getCurrentTarget() ? 'true' : 'false');\n      } else {\n        node.removeAttribute('aria-expanded');\n      }\n    });\n  }\n\n  function cleanupInteractiveMouseListeners() {\n    getDocument().removeEventListener('mousemove', debouncedOnMouseMove);\n    mouseMoveListeners = mouseMoveListeners.filter(function (listener) {\n      return listener !== debouncedOnMouseMove;\n    });\n  }\n\n  function onDocumentPress(event) {\n    // Moved finger to scroll instead of an intentional tap outside\n    if (currentInput.isTouch) {\n      if (didTouchMove || event.type === 'mousedown') {\n        return;\n      }\n    }\n\n    var actualTarget = event.composedPath && event.composedPath()[0] || event.target; // Clicked on interactive popper\n\n    if (instance.props.interactive && actualContains(popper, actualTarget)) {\n      return;\n    } // Clicked on the event listeners target\n\n\n    if (normalizeToArray(instance.props.triggerTarget || reference).some(function (el) {\n      return actualContains(el, actualTarget);\n    })) {\n      if (currentInput.isTouch) {\n        return;\n      }\n\n      if (instance.state.isVisible && instance.props.trigger.indexOf('click') >= 0) {\n        return;\n      }\n    } else {\n      invokeHook('onClickOutside', [instance, event]);\n    }\n\n    if (instance.props.hideOnClick === true) {\n      instance.clearDelayTimeouts();\n      instance.hide(); // `mousedown` event is fired right before `focus` if pressing the\n      // currentTarget. This lets a tippy with `focus` trigger know that it\n      // should not show\n\n      didHideDueToDocumentMouseDown = true;\n      setTimeout(function () {\n        didHideDueToDocumentMouseDown = false;\n      }); // The listener gets added in `scheduleShow()`, but this may be hiding it\n      // before it shows, and hide()'s early bail-out behavior can prevent it\n      // from being cleaned up\n\n      if (!instance.state.isMounted) {\n        removeDocumentPress();\n      }\n    }\n  }\n\n  function onTouchMove() {\n    didTouchMove = true;\n  }\n\n  function onTouchStart() {\n    didTouchMove = false;\n  }\n\n  function addDocumentPress() {\n    var doc = getDocument();\n    doc.addEventListener('mousedown', onDocumentPress, true);\n    doc.addEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);\n    doc.addEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);\n    doc.addEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);\n  }\n\n  function removeDocumentPress() {\n    var doc = getDocument();\n    doc.removeEventListener('mousedown', onDocumentPress, true);\n    doc.removeEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);\n    doc.removeEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);\n    doc.removeEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);\n  }\n\n  function onTransitionedOut(duration, callback) {\n    onTransitionEnd(duration, function () {\n      if (!instance.state.isVisible && popper.parentNode && popper.parentNode.contains(popper)) {\n        callback();\n      }\n    });\n  }\n\n  function onTransitionedIn(duration, callback) {\n    onTransitionEnd(duration, callback);\n  }\n\n  function onTransitionEnd(duration, callback) {\n    var box = getDefaultTemplateChildren().box;\n\n    function listener(event) {\n      if (event.target === box) {\n        updateTransitionEndListener(box, 'remove', listener);\n        callback();\n      }\n    } // Make callback synchronous if duration is 0\n    // `transitionend` won't fire otherwise\n\n\n    if (duration === 0) {\n      return callback();\n    }\n\n    updateTransitionEndListener(box, 'remove', currentTransitionEndListener);\n    updateTransitionEndListener(box, 'add', listener);\n    currentTransitionEndListener = listener;\n  }\n\n  function on(eventType, handler, options) {\n    if (options === void 0) {\n      options = false;\n    }\n\n    var nodes = normalizeToArray(instance.props.triggerTarget || reference);\n    nodes.forEach(function (node) {\n      node.addEventListener(eventType, handler, options);\n      listeners.push({\n        node: node,\n        eventType: eventType,\n        handler: handler,\n        options: options\n      });\n    });\n  }\n\n  function addListeners() {\n    if (getIsCustomTouchBehavior()) {\n      on('touchstart', onTrigger, {\n        passive: true\n      });\n      on('touchend', onMouseLeave, {\n        passive: true\n      });\n    }\n\n    splitBySpaces(instance.props.trigger).forEach(function (eventType) {\n      if (eventType === 'manual') {\n        return;\n      }\n\n      on(eventType, onTrigger);\n\n      switch (eventType) {\n        case 'mouseenter':\n          on('mouseleave', onMouseLeave);\n          break;\n\n        case 'focus':\n          on(isIE11 ? 'focusout' : 'blur', onBlurOrFocusOut);\n          break;\n\n        case 'focusin':\n          on('focusout', onBlurOrFocusOut);\n          break;\n      }\n    });\n  }\n\n  function removeListeners() {\n    listeners.forEach(function (_ref) {\n      var node = _ref.node,\n          eventType = _ref.eventType,\n          handler = _ref.handler,\n          options = _ref.options;\n      node.removeEventListener(eventType, handler, options);\n    });\n    listeners = [];\n  }\n\n  function onTrigger(event) {\n    var _lastTriggerEvent;\n\n    var shouldScheduleClickHide = false;\n\n    if (!instance.state.isEnabled || isEventListenerStopped(event) || didHideDueToDocumentMouseDown) {\n      return;\n    }\n\n    var wasFocused = ((_lastTriggerEvent = lastTriggerEvent) == null ? void 0 : _lastTriggerEvent.type) === 'focus';\n    lastTriggerEvent = event;\n    currentTarget = event.currentTarget;\n    handleAriaExpandedAttribute();\n\n    if (!instance.state.isVisible && isMouseEvent(event)) {\n      // If scrolling, `mouseenter` events can be fired if the cursor lands\n      // over a new target, but `mousemove` events don't get fired. This\n      // causes interactive tooltips to get stuck open until the cursor is\n      // moved\n      mouseMoveListeners.forEach(function (listener) {\n        return listener(event);\n      });\n    } // Toggle show/hide when clicking click-triggered tooltips\n\n\n    if (event.type === 'click' && (instance.props.trigger.indexOf('mouseenter') < 0 || isVisibleFromClick) && instance.props.hideOnClick !== false && instance.state.isVisible) {\n      shouldScheduleClickHide = true;\n    } else {\n      scheduleShow(event);\n    }\n\n    if (event.type === 'click') {\n      isVisibleFromClick = !shouldScheduleClickHide;\n    }\n\n    if (shouldScheduleClickHide && !wasFocused) {\n      scheduleHide(event);\n    }\n  }\n\n  function onMouseMove(event) {\n    var target = event.target;\n    var isCursorOverReferenceOrPopper = getCurrentTarget().contains(target) || popper.contains(target);\n\n    if (event.type === 'mousemove' && isCursorOverReferenceOrPopper) {\n      return;\n    }\n\n    var popperTreeData = getNestedPopperTree().concat(popper).map(function (popper) {\n      var _instance$popperInsta;\n\n      var instance = popper._tippy;\n      var state = (_instance$popperInsta = instance.popperInstance) == null ? void 0 : _instance$popperInsta.state;\n\n      if (state) {\n        return {\n          popperRect: popper.getBoundingClientRect(),\n          popperState: state,\n          props: props\n        };\n      }\n\n      return null;\n    }).filter(Boolean);\n\n    if (isCursorOutsideInteractiveBorder(popperTreeData, event)) {\n      cleanupInteractiveMouseListeners();\n      scheduleHide(event);\n    }\n  }\n\n  function onMouseLeave(event) {\n    var shouldBail = isEventListenerStopped(event) || instance.props.trigger.indexOf('click') >= 0 && isVisibleFromClick;\n\n    if (shouldBail) {\n      return;\n    }\n\n    if (instance.props.interactive) {\n      instance.hideWithInteractivity(event);\n      return;\n    }\n\n    scheduleHide(event);\n  }\n\n  function onBlurOrFocusOut(event) {\n    if (instance.props.trigger.indexOf('focusin') < 0 && event.target !== getCurrentTarget()) {\n      return;\n    } // If focus was moved to within the popper\n\n\n    if (instance.props.interactive && event.relatedTarget && popper.contains(event.relatedTarget)) {\n      return;\n    }\n\n    scheduleHide(event);\n  }\n\n  function isEventListenerStopped(event) {\n    return currentInput.isTouch ? getIsCustomTouchBehavior() !== event.type.indexOf('touch') >= 0 : false;\n  }\n\n  function createPopperInstance() {\n    destroyPopperInstance();\n    var _instance$props2 = instance.props,\n        popperOptions = _instance$props2.popperOptions,\n        placement = _instance$props2.placement,\n        offset = _instance$props2.offset,\n        getReferenceClientRect = _instance$props2.getReferenceClientRect,\n        moveTransition = _instance$props2.moveTransition;\n    var arrow = getIsDefaultRenderFn() ? getChildren(popper).arrow : null;\n    var computedReference = getReferenceClientRect ? {\n      getBoundingClientRect: getReferenceClientRect,\n      contextElement: getReferenceClientRect.contextElement || getCurrentTarget()\n    } : reference;\n    var tippyModifier = {\n      name: '$$tippy',\n      enabled: true,\n      phase: 'beforeWrite',\n      requires: ['computeStyles'],\n      fn: function fn(_ref2) {\n        var state = _ref2.state;\n\n        if (getIsDefaultRenderFn()) {\n          var _getDefaultTemplateCh = getDefaultTemplateChildren(),\n              box = _getDefaultTemplateCh.box;\n\n          ['placement', 'reference-hidden', 'escaped'].forEach(function (attr) {\n            if (attr === 'placement') {\n              box.setAttribute('data-placement', state.placement);\n            } else {\n              if (state.attributes.popper[\"data-popper-\" + attr]) {\n                box.setAttribute(\"data-\" + attr, '');\n              } else {\n                box.removeAttribute(\"data-\" + attr);\n              }\n            }\n          });\n          state.attributes.popper = {};\n        }\n      }\n    };\n    var modifiers = [{\n      name: 'offset',\n      options: {\n        offset: offset\n      }\n    }, {\n      name: 'preventOverflow',\n      options: {\n        padding: {\n          top: 2,\n          bottom: 2,\n          left: 5,\n          right: 5\n        }\n      }\n    }, {\n      name: 'flip',\n      options: {\n        padding: 5\n      }\n    }, {\n      name: 'computeStyles',\n      options: {\n        adaptive: !moveTransition\n      }\n    }, tippyModifier];\n\n    if (getIsDefaultRenderFn() && arrow) {\n      modifiers.push({\n        name: 'arrow',\n        options: {\n          element: arrow,\n          padding: 3\n        }\n      });\n    }\n\n    modifiers.push.apply(modifiers, (popperOptions == null ? void 0 : popperOptions.modifiers) || []);\n    instance.popperInstance = createPopper(computedReference, popper, Object.assign({}, popperOptions, {\n      placement: placement,\n      onFirstUpdate: onFirstUpdate,\n      modifiers: modifiers\n    }));\n  }\n\n  function destroyPopperInstance() {\n    if (instance.popperInstance) {\n      instance.popperInstance.destroy();\n      instance.popperInstance = null;\n    }\n  }\n\n  function mount() {\n    var appendTo = instance.props.appendTo;\n    var parentNode; // By default, we'll append the popper to the triggerTargets's parentNode so\n    // it's directly after the reference element so the elements inside the\n    // tippy can be tabbed to\n    // If there are clipping issues, the user can specify a different appendTo\n    // and ensure focus management is handled correctly manually\n\n    var node = getCurrentTarget();\n\n    if (instance.props.interactive && appendTo === TIPPY_DEFAULT_APPEND_TO || appendTo === 'parent') {\n      parentNode = node.parentNode;\n    } else {\n      parentNode = invokeWithArgsOrReturn(appendTo, [node]);\n    } // The popper element needs to exist on the DOM before its position can be\n    // updated as Popper needs to read its dimensions\n\n\n    if (!parentNode.contains(popper)) {\n      parentNode.appendChild(popper);\n    }\n\n    instance.state.isMounted = true;\n    createPopperInstance();\n    /* istanbul ignore else */\n\n    if (process.env.NODE_ENV !== \"production\") {\n      // Accessibility check\n      warnWhen(instance.props.interactive && appendTo === defaultProps.appendTo && node.nextElementSibling !== popper, ['Interactive tippy element may not be accessible via keyboard', 'navigation because it is not directly after the reference element', 'in the DOM source order.', '\\n\\n', 'Using a wrapper <div> or <span> tag around the reference element', 'solves this by creating a new parentNode context.', '\\n\\n', 'Specifying `appendTo: document.body` silences this warning, but it', 'assumes you are using a focus management solution to handle', 'keyboard navigation.', '\\n\\n', 'See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity'].join(' '));\n    }\n  }\n\n  function getNestedPopperTree() {\n    return arrayFrom(popper.querySelectorAll('[data-tippy-root]'));\n  }\n\n  function scheduleShow(event) {\n    instance.clearDelayTimeouts();\n\n    if (event) {\n      invokeHook('onTrigger', [instance, event]);\n    }\n\n    addDocumentPress();\n    var delay = getDelay(true);\n\n    var _getNormalizedTouchSe = getNormalizedTouchSettings(),\n        touchValue = _getNormalizedTouchSe[0],\n        touchDelay = _getNormalizedTouchSe[1];\n\n    if (currentInput.isTouch && touchValue === 'hold' && touchDelay) {\n      delay = touchDelay;\n    }\n\n    if (delay) {\n      showTimeout = setTimeout(function () {\n        instance.show();\n      }, delay);\n    } else {\n      instance.show();\n    }\n  }\n\n  function scheduleHide(event) {\n    instance.clearDelayTimeouts();\n    invokeHook('onUntrigger', [instance, event]);\n\n    if (!instance.state.isVisible) {\n      removeDocumentPress();\n      return;\n    } // For interactive tippies, scheduleHide is added to a document.body handler\n    // from onMouseLeave so must intercept scheduled hides from mousemove/leave\n    // events when trigger contains mouseenter and click, and the tip is\n    // currently shown as a result of a click.\n\n\n    if (instance.props.trigger.indexOf('mouseenter') >= 0 && instance.props.trigger.indexOf('click') >= 0 && ['mouseleave', 'mousemove'].indexOf(event.type) >= 0 && isVisibleFromClick) {\n      return;\n    }\n\n    var delay = getDelay(false);\n\n    if (delay) {\n      hideTimeout = setTimeout(function () {\n        if (instance.state.isVisible) {\n          instance.hide();\n        }\n      }, delay);\n    } else {\n      // Fixes a `transitionend` problem when it fires 1 frame too\n      // late sometimes, we don't want hide() to be called.\n      scheduleHideAnimationFrame = requestAnimationFrame(function () {\n        instance.hide();\n      });\n    }\n  } // ===========================================================================\n  // 🔑 Public methods\n  // ===========================================================================\n\n\n  function enable() {\n    instance.state.isEnabled = true;\n  }\n\n  function disable() {\n    // Disabling the instance should also hide it\n    // https://github.com/atomiks/tippy.js-react/issues/106\n    instance.hide();\n    instance.state.isEnabled = false;\n  }\n\n  function clearDelayTimeouts() {\n    clearTimeout(showTimeout);\n    clearTimeout(hideTimeout);\n    cancelAnimationFrame(scheduleHideAnimationFrame);\n  }\n\n  function setProps(partialProps) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('setProps'));\n    }\n\n    if (instance.state.isDestroyed) {\n      return;\n    }\n\n    invokeHook('onBeforeUpdate', [instance, partialProps]);\n    removeListeners();\n    var prevProps = instance.props;\n    var nextProps = evaluateProps(reference, Object.assign({}, prevProps, removeUndefinedProps(partialProps), {\n      ignoreAttributes: true\n    }));\n    instance.props = nextProps;\n    addListeners();\n\n    if (prevProps.interactiveDebounce !== nextProps.interactiveDebounce) {\n      cleanupInteractiveMouseListeners();\n      debouncedOnMouseMove = debounce(onMouseMove, nextProps.interactiveDebounce);\n    } // Ensure stale aria-expanded attributes are removed\n\n\n    if (prevProps.triggerTarget && !nextProps.triggerTarget) {\n      normalizeToArray(prevProps.triggerTarget).forEach(function (node) {\n        node.removeAttribute('aria-expanded');\n      });\n    } else if (nextProps.triggerTarget) {\n      reference.removeAttribute('aria-expanded');\n    }\n\n    handleAriaExpandedAttribute();\n    handleStyles();\n\n    if (onUpdate) {\n      onUpdate(prevProps, nextProps);\n    }\n\n    if (instance.popperInstance) {\n      createPopperInstance(); // Fixes an issue with nested tippies if they are all getting re-rendered,\n      // and the nested ones get re-rendered first.\n      // https://github.com/atomiks/tippyjs-react/issues/177\n      // TODO: find a cleaner / more efficient solution(!)\n\n      getNestedPopperTree().forEach(function (nestedPopper) {\n        // React (and other UI libs likely) requires a rAF wrapper as it flushes\n        // its work in one\n        requestAnimationFrame(nestedPopper._tippy.popperInstance.forceUpdate);\n      });\n    }\n\n    invokeHook('onAfterUpdate', [instance, partialProps]);\n  }\n\n  function setContent(content) {\n    instance.setProps({\n      content: content\n    });\n  }\n\n  function show() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('show'));\n    } // Early bail-out\n\n\n    var isAlreadyVisible = instance.state.isVisible;\n    var isDestroyed = instance.state.isDestroyed;\n    var isDisabled = !instance.state.isEnabled;\n    var isTouchAndTouchDisabled = currentInput.isTouch && !instance.props.touch;\n    var duration = getValueAtIndexOrReturn(instance.props.duration, 0, defaultProps.duration);\n\n    if (isAlreadyVisible || isDestroyed || isDisabled || isTouchAndTouchDisabled) {\n      return;\n    } // Normalize `disabled` behavior across browsers.\n    // Firefox allows events on disabled elements, but Chrome doesn't.\n    // Using a wrapper element (i.e. <span>) is recommended.\n\n\n    if (getCurrentTarget().hasAttribute('disabled')) {\n      return;\n    }\n\n    invokeHook('onShow', [instance], false);\n\n    if (instance.props.onShow(instance) === false) {\n      return;\n    }\n\n    instance.state.isVisible = true;\n\n    if (getIsDefaultRenderFn()) {\n      popper.style.visibility = 'visible';\n    }\n\n    handleStyles();\n    addDocumentPress();\n\n    if (!instance.state.isMounted) {\n      popper.style.transition = 'none';\n    } // If flipping to the opposite side after hiding at least once, the\n    // animation will use the wrong placement without resetting the duration\n\n\n    if (getIsDefaultRenderFn()) {\n      var _getDefaultTemplateCh2 = getDefaultTemplateChildren(),\n          box = _getDefaultTemplateCh2.box,\n          content = _getDefaultTemplateCh2.content;\n\n      setTransitionDuration([box, content], 0);\n    }\n\n    onFirstUpdate = function onFirstUpdate() {\n      var _instance$popperInsta2;\n\n      if (!instance.state.isVisible || ignoreOnFirstUpdate) {\n        return;\n      }\n\n      ignoreOnFirstUpdate = true; // reflow\n\n      void popper.offsetHeight;\n      popper.style.transition = instance.props.moveTransition;\n\n      if (getIsDefaultRenderFn() && instance.props.animation) {\n        var _getDefaultTemplateCh3 = getDefaultTemplateChildren(),\n            _box = _getDefaultTemplateCh3.box,\n            _content = _getDefaultTemplateCh3.content;\n\n        setTransitionDuration([_box, _content], duration);\n        setVisibilityState([_box, _content], 'visible');\n      }\n\n      handleAriaContentAttribute();\n      handleAriaExpandedAttribute();\n      pushIfUnique(mountedInstances, instance); // certain modifiers (e.g. `maxSize`) require a second update after the\n      // popper has been positioned for the first time\n\n      (_instance$popperInsta2 = instance.popperInstance) == null ? void 0 : _instance$popperInsta2.forceUpdate();\n      invokeHook('onMount', [instance]);\n\n      if (instance.props.animation && getIsDefaultRenderFn()) {\n        onTransitionedIn(duration, function () {\n          instance.state.isShown = true;\n          invokeHook('onShown', [instance]);\n        });\n      }\n    };\n\n    mount();\n  }\n\n  function hide() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('hide'));\n    } // Early bail-out\n\n\n    var isAlreadyHidden = !instance.state.isVisible;\n    var isDestroyed = instance.state.isDestroyed;\n    var isDisabled = !instance.state.isEnabled;\n    var duration = getValueAtIndexOrReturn(instance.props.duration, 1, defaultProps.duration);\n\n    if (isAlreadyHidden || isDestroyed || isDisabled) {\n      return;\n    }\n\n    invokeHook('onHide', [instance], false);\n\n    if (instance.props.onHide(instance) === false) {\n      return;\n    }\n\n    instance.state.isVisible = false;\n    instance.state.isShown = false;\n    ignoreOnFirstUpdate = false;\n    isVisibleFromClick = false;\n\n    if (getIsDefaultRenderFn()) {\n      popper.style.visibility = 'hidden';\n    }\n\n    cleanupInteractiveMouseListeners();\n    removeDocumentPress();\n    handleStyles(true);\n\n    if (getIsDefaultRenderFn()) {\n      var _getDefaultTemplateCh4 = getDefaultTemplateChildren(),\n          box = _getDefaultTemplateCh4.box,\n          content = _getDefaultTemplateCh4.content;\n\n      if (instance.props.animation) {\n        setTransitionDuration([box, content], duration);\n        setVisibilityState([box, content], 'hidden');\n      }\n    }\n\n    handleAriaContentAttribute();\n    handleAriaExpandedAttribute();\n\n    if (instance.props.animation) {\n      if (getIsDefaultRenderFn()) {\n        onTransitionedOut(duration, instance.unmount);\n      }\n    } else {\n      instance.unmount();\n    }\n  }\n\n  function hideWithInteractivity(event) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('hideWithInteractivity'));\n    }\n\n    getDocument().addEventListener('mousemove', debouncedOnMouseMove);\n    pushIfUnique(mouseMoveListeners, debouncedOnMouseMove);\n    debouncedOnMouseMove(event);\n  }\n\n  function unmount() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('unmount'));\n    }\n\n    if (instance.state.isVisible) {\n      instance.hide();\n    }\n\n    if (!instance.state.isMounted) {\n      return;\n    }\n\n    destroyPopperInstance(); // If a popper is not interactive, it will be appended outside the popper\n    // tree by default. This seems mainly for interactive tippies, but we should\n    // find a workaround if possible\n\n    getNestedPopperTree().forEach(function (nestedPopper) {\n      nestedPopper._tippy.unmount();\n    });\n\n    if (popper.parentNode) {\n      popper.parentNode.removeChild(popper);\n    }\n\n    mountedInstances = mountedInstances.filter(function (i) {\n      return i !== instance;\n    });\n    instance.state.isMounted = false;\n    invokeHook('onHidden', [instance]);\n  }\n\n  function destroy() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('destroy'));\n    }\n\n    if (instance.state.isDestroyed) {\n      return;\n    }\n\n    instance.clearDelayTimeouts();\n    instance.unmount();\n    removeListeners();\n    delete reference._tippy;\n    instance.state.isDestroyed = true;\n    invokeHook('onDestroy', [instance]);\n  }\n}\n\nfunction tippy(targets, optionalProps) {\n  if (optionalProps === void 0) {\n    optionalProps = {};\n  }\n\n  var plugins = defaultProps.plugins.concat(optionalProps.plugins || []);\n  /* istanbul ignore else */\n\n  if (process.env.NODE_ENV !== \"production\") {\n    validateTargets(targets);\n    validateProps(optionalProps, plugins);\n  }\n\n  bindGlobalEventListeners();\n  var passedProps = Object.assign({}, optionalProps, {\n    plugins: plugins\n  });\n  var elements = getArrayOfElements(targets);\n  /* istanbul ignore else */\n\n  if (process.env.NODE_ENV !== \"production\") {\n    var isSingleContentElement = isElement(passedProps.content);\n    var isMoreThanOneReferenceElement = elements.length > 1;\n    warnWhen(isSingleContentElement && isMoreThanOneReferenceElement, ['tippy() was passed an Element as the `content` prop, but more than', 'one tippy instance was created by this invocation. This means the', 'content element will only be appended to the last tippy instance.', '\\n\\n', 'Instead, pass the .innerHTML of the element, or use a function that', 'returns a cloned version of the element instead.', '\\n\\n', '1) content: element.innerHTML\\n', '2) content: () => element.cloneNode(true)'].join(' '));\n  }\n\n  var instances = elements.reduce(function (acc, reference) {\n    var instance = reference && createTippy(reference, passedProps);\n\n    if (instance) {\n      acc.push(instance);\n    }\n\n    return acc;\n  }, []);\n  return isElement(targets) ? instances[0] : instances;\n}\n\ntippy.defaultProps = defaultProps;\ntippy.setDefaultProps = setDefaultProps;\ntippy.currentInput = currentInput;\nvar hideAll = function hideAll(_temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      excludedReferenceOrInstance = _ref.exclude,\n      duration = _ref.duration;\n\n  mountedInstances.forEach(function (instance) {\n    var isExcluded = false;\n\n    if (excludedReferenceOrInstance) {\n      isExcluded = isReferenceElement(excludedReferenceOrInstance) ? instance.reference === excludedReferenceOrInstance : instance.popper === excludedReferenceOrInstance.popper;\n    }\n\n    if (!isExcluded) {\n      var originalDuration = instance.props.duration;\n      instance.setProps({\n        duration: duration\n      });\n      instance.hide();\n\n      if (!instance.state.isDestroyed) {\n        instance.setProps({\n          duration: originalDuration\n        });\n      }\n    }\n  });\n};\n\n// every time the popper is destroyed (i.e. a new target), removing the styles\n// and causing transitions to break for singletons when the console is open, but\n// most notably for non-transform styles being used, `gpuAcceleration: false`.\n\nvar applyStylesModifier = Object.assign({}, applyStyles, {\n  effect: function effect(_ref) {\n    var state = _ref.state;\n    var initialStyles = {\n      popper: {\n        position: state.options.strategy,\n        left: '0',\n        top: '0',\n        margin: '0'\n      },\n      arrow: {\n        position: 'absolute'\n      },\n      reference: {}\n    };\n    Object.assign(state.elements.popper.style, initialStyles.popper);\n    state.styles = initialStyles;\n\n    if (state.elements.arrow) {\n      Object.assign(state.elements.arrow.style, initialStyles.arrow);\n    } // intentionally return no cleanup function\n    // return () => { ... }\n\n  }\n});\n\nvar createSingleton = function createSingleton(tippyInstances, optionalProps) {\n  var _optionalProps$popper;\n\n  if (optionalProps === void 0) {\n    optionalProps = {};\n  }\n\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== \"production\") {\n    errorWhen(!Array.isArray(tippyInstances), ['The first argument passed to createSingleton() must be an array of', 'tippy instances. The passed value was', String(tippyInstances)].join(' '));\n  }\n\n  var individualInstances = tippyInstances;\n  var references = [];\n  var triggerTargets = [];\n  var currentTarget;\n  var overrides = optionalProps.overrides;\n  var interceptSetPropsCleanups = [];\n  var shownOnCreate = false;\n\n  function setTriggerTargets() {\n    triggerTargets = individualInstances.map(function (instance) {\n      return normalizeToArray(instance.props.triggerTarget || instance.reference);\n    }).reduce(function (acc, item) {\n      return acc.concat(item);\n    }, []);\n  }\n\n  function setReferences() {\n    references = individualInstances.map(function (instance) {\n      return instance.reference;\n    });\n  }\n\n  function enableInstances(isEnabled) {\n    individualInstances.forEach(function (instance) {\n      if (isEnabled) {\n        instance.enable();\n      } else {\n        instance.disable();\n      }\n    });\n  }\n\n  function interceptSetProps(singleton) {\n    return individualInstances.map(function (instance) {\n      var originalSetProps = instance.setProps;\n\n      instance.setProps = function (props) {\n        originalSetProps(props);\n\n        if (instance.reference === currentTarget) {\n          singleton.setProps(props);\n        }\n      };\n\n      return function () {\n        instance.setProps = originalSetProps;\n      };\n    });\n  } // have to pass singleton, as it maybe undefined on first call\n\n\n  function prepareInstance(singleton, target) {\n    var index = triggerTargets.indexOf(target); // bail-out\n\n    if (target === currentTarget) {\n      return;\n    }\n\n    currentTarget = target;\n    var overrideProps = (overrides || []).concat('content').reduce(function (acc, prop) {\n      acc[prop] = individualInstances[index].props[prop];\n      return acc;\n    }, {});\n    singleton.setProps(Object.assign({}, overrideProps, {\n      getReferenceClientRect: typeof overrideProps.getReferenceClientRect === 'function' ? overrideProps.getReferenceClientRect : function () {\n        var _references$index;\n\n        return (_references$index = references[index]) == null ? void 0 : _references$index.getBoundingClientRect();\n      }\n    }));\n  }\n\n  enableInstances(false);\n  setReferences();\n  setTriggerTargets();\n  var plugin = {\n    fn: function fn() {\n      return {\n        onDestroy: function onDestroy() {\n          enableInstances(true);\n        },\n        onHidden: function onHidden() {\n          currentTarget = null;\n        },\n        onClickOutside: function onClickOutside(instance) {\n          if (instance.props.showOnCreate && !shownOnCreate) {\n            shownOnCreate = true;\n            currentTarget = null;\n          }\n        },\n        onShow: function onShow(instance) {\n          if (instance.props.showOnCreate && !shownOnCreate) {\n            shownOnCreate = true;\n            prepareInstance(instance, references[0]);\n          }\n        },\n        onTrigger: function onTrigger(instance, event) {\n          prepareInstance(instance, event.currentTarget);\n        }\n      };\n    }\n  };\n  var singleton = tippy(div(), Object.assign({}, removeProperties(optionalProps, ['overrides']), {\n    plugins: [plugin].concat(optionalProps.plugins || []),\n    triggerTarget: triggerTargets,\n    popperOptions: Object.assign({}, optionalProps.popperOptions, {\n      modifiers: [].concat(((_optionalProps$popper = optionalProps.popperOptions) == null ? void 0 : _optionalProps$popper.modifiers) || [], [applyStylesModifier])\n    })\n  }));\n  var originalShow = singleton.show;\n\n  singleton.show = function (target) {\n    originalShow(); // first time, showOnCreate or programmatic call with no params\n    // default to showing first instance\n\n    if (!currentTarget && target == null) {\n      return prepareInstance(singleton, references[0]);\n    } // triggered from event (do nothing as prepareInstance already called by onTrigger)\n    // programmatic call with no params when already visible (do nothing again)\n\n\n    if (currentTarget && target == null) {\n      return;\n    } // target is index of instance\n\n\n    if (typeof target === 'number') {\n      return references[target] && prepareInstance(singleton, references[target]);\n    } // target is a child tippy instance\n\n\n    if (individualInstances.indexOf(target) >= 0) {\n      var ref = target.reference;\n      return prepareInstance(singleton, ref);\n    } // target is a ReferenceElement\n\n\n    if (references.indexOf(target) >= 0) {\n      return prepareInstance(singleton, target);\n    }\n  };\n\n  singleton.showNext = function () {\n    var first = references[0];\n\n    if (!currentTarget) {\n      return singleton.show(0);\n    }\n\n    var index = references.indexOf(currentTarget);\n    singleton.show(references[index + 1] || first);\n  };\n\n  singleton.showPrevious = function () {\n    var last = references[references.length - 1];\n\n    if (!currentTarget) {\n      return singleton.show(last);\n    }\n\n    var index = references.indexOf(currentTarget);\n    var target = references[index - 1] || last;\n    singleton.show(target);\n  };\n\n  var originalSetProps = singleton.setProps;\n\n  singleton.setProps = function (props) {\n    overrides = props.overrides || overrides;\n    originalSetProps(props);\n  };\n\n  singleton.setInstances = function (nextInstances) {\n    enableInstances(true);\n    interceptSetPropsCleanups.forEach(function (fn) {\n      return fn();\n    });\n    individualInstances = nextInstances;\n    enableInstances(false);\n    setReferences();\n    setTriggerTargets();\n    interceptSetPropsCleanups = interceptSetProps(singleton);\n    singleton.setProps({\n      triggerTarget: triggerTargets\n    });\n  };\n\n  interceptSetPropsCleanups = interceptSetProps(singleton);\n  return singleton;\n};\n\nvar BUBBLING_EVENTS_MAP = {\n  mouseover: 'mouseenter',\n  focusin: 'focus',\n  click: 'click'\n};\n/**\n * Creates a delegate instance that controls the creation of tippy instances\n * for child elements (`target` CSS selector).\n */\n\nfunction delegate(targets, props) {\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== \"production\") {\n    errorWhen(!(props && props.target), ['You must specity a `target` prop indicating a CSS selector string matching', 'the target elements that should receive a tippy.'].join(' '));\n  }\n\n  var listeners = [];\n  var childTippyInstances = [];\n  var disabled = false;\n  var target = props.target;\n  var nativeProps = removeProperties(props, ['target']);\n  var parentProps = Object.assign({}, nativeProps, {\n    trigger: 'manual',\n    touch: false\n  });\n  var childProps = Object.assign({\n    touch: defaultProps.touch\n  }, nativeProps, {\n    showOnCreate: true\n  });\n  var returnValue = tippy(targets, parentProps);\n  var normalizedReturnValue = normalizeToArray(returnValue);\n\n  function onTrigger(event) {\n    if (!event.target || disabled) {\n      return;\n    }\n\n    var targetNode = event.target.closest(target);\n\n    if (!targetNode) {\n      return;\n    } // Get relevant trigger with fallbacks:\n    // 1. Check `data-tippy-trigger` attribute on target node\n    // 2. Fallback to `trigger` passed to `delegate()`\n    // 3. Fallback to `defaultProps.trigger`\n\n\n    var trigger = targetNode.getAttribute('data-tippy-trigger') || props.trigger || defaultProps.trigger; // @ts-ignore\n\n    if (targetNode._tippy) {\n      return;\n    }\n\n    if (event.type === 'touchstart' && typeof childProps.touch === 'boolean') {\n      return;\n    }\n\n    if (event.type !== 'touchstart' && trigger.indexOf(BUBBLING_EVENTS_MAP[event.type]) < 0) {\n      return;\n    }\n\n    var instance = tippy(targetNode, childProps);\n\n    if (instance) {\n      childTippyInstances = childTippyInstances.concat(instance);\n    }\n  }\n\n  function on(node, eventType, handler, options) {\n    if (options === void 0) {\n      options = false;\n    }\n\n    node.addEventListener(eventType, handler, options);\n    listeners.push({\n      node: node,\n      eventType: eventType,\n      handler: handler,\n      options: options\n    });\n  }\n\n  function addEventListeners(instance) {\n    var reference = instance.reference;\n    on(reference, 'touchstart', onTrigger, TOUCH_OPTIONS);\n    on(reference, 'mouseover', onTrigger);\n    on(reference, 'focusin', onTrigger);\n    on(reference, 'click', onTrigger);\n  }\n\n  function removeEventListeners() {\n    listeners.forEach(function (_ref) {\n      var node = _ref.node,\n          eventType = _ref.eventType,\n          handler = _ref.handler,\n          options = _ref.options;\n      node.removeEventListener(eventType, handler, options);\n    });\n    listeners = [];\n  }\n\n  function applyMutations(instance) {\n    var originalDestroy = instance.destroy;\n    var originalEnable = instance.enable;\n    var originalDisable = instance.disable;\n\n    instance.destroy = function (shouldDestroyChildInstances) {\n      if (shouldDestroyChildInstances === void 0) {\n        shouldDestroyChildInstances = true;\n      }\n\n      if (shouldDestroyChildInstances) {\n        childTippyInstances.forEach(function (instance) {\n          instance.destroy();\n        });\n      }\n\n      childTippyInstances = [];\n      removeEventListeners();\n      originalDestroy();\n    };\n\n    instance.enable = function () {\n      originalEnable();\n      childTippyInstances.forEach(function (instance) {\n        return instance.enable();\n      });\n      disabled = false;\n    };\n\n    instance.disable = function () {\n      originalDisable();\n      childTippyInstances.forEach(function (instance) {\n        return instance.disable();\n      });\n      disabled = true;\n    };\n\n    addEventListeners(instance);\n  }\n\n  normalizedReturnValue.forEach(applyMutations);\n  return returnValue;\n}\n\nvar animateFill = {\n  name: 'animateFill',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var _instance$props$rende;\n\n    // @ts-ignore\n    if (!((_instance$props$rende = instance.props.render) != null && _instance$props$rende.$$tippy)) {\n      if (process.env.NODE_ENV !== \"production\") {\n        errorWhen(instance.props.animateFill, 'The `animateFill` plugin requires the default render function.');\n      }\n\n      return {};\n    }\n\n    var _getChildren = getChildren(instance.popper),\n        box = _getChildren.box,\n        content = _getChildren.content;\n\n    var backdrop = instance.props.animateFill ? createBackdropElement() : null;\n    return {\n      onCreate: function onCreate() {\n        if (backdrop) {\n          box.insertBefore(backdrop, box.firstElementChild);\n          box.setAttribute('data-animatefill', '');\n          box.style.overflow = 'hidden';\n          instance.setProps({\n            arrow: false,\n            animation: 'shift-away'\n          });\n        }\n      },\n      onMount: function onMount() {\n        if (backdrop) {\n          var transitionDuration = box.style.transitionDuration;\n          var duration = Number(transitionDuration.replace('ms', '')); // The content should fade in after the backdrop has mostly filled the\n          // tooltip element. `clip-path` is the other alternative but is not\n          // well-supported and is buggy on some devices.\n\n          content.style.transitionDelay = Math.round(duration / 10) + \"ms\";\n          backdrop.style.transitionDuration = transitionDuration;\n          setVisibilityState([backdrop], 'visible');\n        }\n      },\n      onShow: function onShow() {\n        if (backdrop) {\n          backdrop.style.transitionDuration = '0ms';\n        }\n      },\n      onHide: function onHide() {\n        if (backdrop) {\n          setVisibilityState([backdrop], 'hidden');\n        }\n      }\n    };\n  }\n};\n\nfunction createBackdropElement() {\n  var backdrop = div();\n  backdrop.className = BACKDROP_CLASS;\n  setVisibilityState([backdrop], 'hidden');\n  return backdrop;\n}\n\nvar mouseCoords = {\n  clientX: 0,\n  clientY: 0\n};\nvar activeInstances = [];\n\nfunction storeMouseCoords(_ref) {\n  var clientX = _ref.clientX,\n      clientY = _ref.clientY;\n  mouseCoords = {\n    clientX: clientX,\n    clientY: clientY\n  };\n}\n\nfunction addMouseCoordsListener(doc) {\n  doc.addEventListener('mousemove', storeMouseCoords);\n}\n\nfunction removeMouseCoordsListener(doc) {\n  doc.removeEventListener('mousemove', storeMouseCoords);\n}\n\nvar followCursor = {\n  name: 'followCursor',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var reference = instance.reference;\n    var doc = getOwnerDocument(instance.props.triggerTarget || reference);\n    var isInternalUpdate = false;\n    var wasFocusEvent = false;\n    var isUnmounted = true;\n    var prevProps = instance.props;\n\n    function getIsInitialBehavior() {\n      return instance.props.followCursor === 'initial' && instance.state.isVisible;\n    }\n\n    function addListener() {\n      doc.addEventListener('mousemove', onMouseMove);\n    }\n\n    function removeListener() {\n      doc.removeEventListener('mousemove', onMouseMove);\n    }\n\n    function unsetGetReferenceClientRect() {\n      isInternalUpdate = true;\n      instance.setProps({\n        getReferenceClientRect: null\n      });\n      isInternalUpdate = false;\n    }\n\n    function onMouseMove(event) {\n      // If the instance is interactive, avoid updating the position unless it's\n      // over the reference element\n      var isCursorOverReference = event.target ? reference.contains(event.target) : true;\n      var followCursor = instance.props.followCursor;\n      var clientX = event.clientX,\n          clientY = event.clientY;\n      var rect = reference.getBoundingClientRect();\n      var relativeX = clientX - rect.left;\n      var relativeY = clientY - rect.top;\n\n      if (isCursorOverReference || !instance.props.interactive) {\n        instance.setProps({\n          // @ts-ignore - unneeded DOMRect properties\n          getReferenceClientRect: function getReferenceClientRect() {\n            var rect = reference.getBoundingClientRect();\n            var x = clientX;\n            var y = clientY;\n\n            if (followCursor === 'initial') {\n              x = rect.left + relativeX;\n              y = rect.top + relativeY;\n            }\n\n            var top = followCursor === 'horizontal' ? rect.top : y;\n            var right = followCursor === 'vertical' ? rect.right : x;\n            var bottom = followCursor === 'horizontal' ? rect.bottom : y;\n            var left = followCursor === 'vertical' ? rect.left : x;\n            return {\n              width: right - left,\n              height: bottom - top,\n              top: top,\n              right: right,\n              bottom: bottom,\n              left: left\n            };\n          }\n        });\n      }\n    }\n\n    function create() {\n      if (instance.props.followCursor) {\n        activeInstances.push({\n          instance: instance,\n          doc: doc\n        });\n        addMouseCoordsListener(doc);\n      }\n    }\n\n    function destroy() {\n      activeInstances = activeInstances.filter(function (data) {\n        return data.instance !== instance;\n      });\n\n      if (activeInstances.filter(function (data) {\n        return data.doc === doc;\n      }).length === 0) {\n        removeMouseCoordsListener(doc);\n      }\n    }\n\n    return {\n      onCreate: create,\n      onDestroy: destroy,\n      onBeforeUpdate: function onBeforeUpdate() {\n        prevProps = instance.props;\n      },\n      onAfterUpdate: function onAfterUpdate(_, _ref2) {\n        var followCursor = _ref2.followCursor;\n\n        if (isInternalUpdate) {\n          return;\n        }\n\n        if (followCursor !== undefined && prevProps.followCursor !== followCursor) {\n          destroy();\n\n          if (followCursor) {\n            create();\n\n            if (instance.state.isMounted && !wasFocusEvent && !getIsInitialBehavior()) {\n              addListener();\n            }\n          } else {\n            removeListener();\n            unsetGetReferenceClientRect();\n          }\n        }\n      },\n      onMount: function onMount() {\n        if (instance.props.followCursor && !wasFocusEvent) {\n          if (isUnmounted) {\n            onMouseMove(mouseCoords);\n            isUnmounted = false;\n          }\n\n          if (!getIsInitialBehavior()) {\n            addListener();\n          }\n        }\n      },\n      onTrigger: function onTrigger(_, event) {\n        if (isMouseEvent(event)) {\n          mouseCoords = {\n            clientX: event.clientX,\n            clientY: event.clientY\n          };\n        }\n\n        wasFocusEvent = event.type === 'focus';\n      },\n      onHidden: function onHidden() {\n        if (instance.props.followCursor) {\n          unsetGetReferenceClientRect();\n          removeListener();\n          isUnmounted = true;\n        }\n      }\n    };\n  }\n};\n\nfunction getProps(props, modifier) {\n  var _props$popperOptions;\n\n  return {\n    popperOptions: Object.assign({}, props.popperOptions, {\n      modifiers: [].concat((((_props$popperOptions = props.popperOptions) == null ? void 0 : _props$popperOptions.modifiers) || []).filter(function (_ref) {\n        var name = _ref.name;\n        return name !== modifier.name;\n      }), [modifier])\n    })\n  };\n}\n\nvar inlinePositioning = {\n  name: 'inlinePositioning',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var reference = instance.reference;\n\n    function isEnabled() {\n      return !!instance.props.inlinePositioning;\n    }\n\n    var placement;\n    var cursorRectIndex = -1;\n    var isInternalUpdate = false;\n    var triedPlacements = [];\n    var modifier = {\n      name: 'tippyInlinePositioning',\n      enabled: true,\n      phase: 'afterWrite',\n      fn: function fn(_ref2) {\n        var state = _ref2.state;\n\n        if (isEnabled()) {\n          if (triedPlacements.indexOf(state.placement) !== -1) {\n            triedPlacements = [];\n          }\n\n          if (placement !== state.placement && triedPlacements.indexOf(state.placement) === -1) {\n            triedPlacements.push(state.placement);\n            instance.setProps({\n              // @ts-ignore - unneeded DOMRect properties\n              getReferenceClientRect: function getReferenceClientRect() {\n                return _getReferenceClientRect(state.placement);\n              }\n            });\n          }\n\n          placement = state.placement;\n        }\n      }\n    };\n\n    function _getReferenceClientRect(placement) {\n      return getInlineBoundingClientRect(getBasePlacement(placement), reference.getBoundingClientRect(), arrayFrom(reference.getClientRects()), cursorRectIndex);\n    }\n\n    function setInternalProps(partialProps) {\n      isInternalUpdate = true;\n      instance.setProps(partialProps);\n      isInternalUpdate = false;\n    }\n\n    function addModifier() {\n      if (!isInternalUpdate) {\n        setInternalProps(getProps(instance.props, modifier));\n      }\n    }\n\n    return {\n      onCreate: addModifier,\n      onAfterUpdate: addModifier,\n      onTrigger: function onTrigger(_, event) {\n        if (isMouseEvent(event)) {\n          var rects = arrayFrom(instance.reference.getClientRects());\n          var cursorRect = rects.find(function (rect) {\n            return rect.left - 2 <= event.clientX && rect.right + 2 >= event.clientX && rect.top - 2 <= event.clientY && rect.bottom + 2 >= event.clientY;\n          });\n          var index = rects.indexOf(cursorRect);\n          cursorRectIndex = index > -1 ? index : cursorRectIndex;\n        }\n      },\n      onHidden: function onHidden() {\n        cursorRectIndex = -1;\n      }\n    };\n  }\n};\nfunction getInlineBoundingClientRect(currentBasePlacement, boundingRect, clientRects, cursorRectIndex) {\n  // Not an inline element, or placement is not yet known\n  if (clientRects.length < 2 || currentBasePlacement === null) {\n    return boundingRect;\n  } // There are two rects and they are disjoined\n\n\n  if (clientRects.length === 2 && cursorRectIndex >= 0 && clientRects[0].left > clientRects[1].right) {\n    return clientRects[cursorRectIndex] || boundingRect;\n  }\n\n  switch (currentBasePlacement) {\n    case 'top':\n    case 'bottom':\n      {\n        var firstRect = clientRects[0];\n        var lastRect = clientRects[clientRects.length - 1];\n        var isTop = currentBasePlacement === 'top';\n        var top = firstRect.top;\n        var bottom = lastRect.bottom;\n        var left = isTop ? firstRect.left : lastRect.left;\n        var right = isTop ? firstRect.right : lastRect.right;\n        var width = right - left;\n        var height = bottom - top;\n        return {\n          top: top,\n          bottom: bottom,\n          left: left,\n          right: right,\n          width: width,\n          height: height\n        };\n      }\n\n    case 'left':\n    case 'right':\n      {\n        var minLeft = Math.min.apply(Math, clientRects.map(function (rects) {\n          return rects.left;\n        }));\n        var maxRight = Math.max.apply(Math, clientRects.map(function (rects) {\n          return rects.right;\n        }));\n        var measureRects = clientRects.filter(function (rect) {\n          return currentBasePlacement === 'left' ? rect.left === minLeft : rect.right === maxRight;\n        });\n        var _top = measureRects[0].top;\n        var _bottom = measureRects[measureRects.length - 1].bottom;\n        var _left = minLeft;\n        var _right = maxRight;\n\n        var _width = _right - _left;\n\n        var _height = _bottom - _top;\n\n        return {\n          top: _top,\n          bottom: _bottom,\n          left: _left,\n          right: _right,\n          width: _width,\n          height: _height\n        };\n      }\n\n    default:\n      {\n        return boundingRect;\n      }\n  }\n}\n\nvar sticky = {\n  name: 'sticky',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var reference = instance.reference,\n        popper = instance.popper;\n\n    function getReference() {\n      return instance.popperInstance ? instance.popperInstance.state.elements.reference : reference;\n    }\n\n    function shouldCheck(value) {\n      return instance.props.sticky === true || instance.props.sticky === value;\n    }\n\n    var prevRefRect = null;\n    var prevPopRect = null;\n\n    function updatePosition() {\n      var currentRefRect = shouldCheck('reference') ? getReference().getBoundingClientRect() : null;\n      var currentPopRect = shouldCheck('popper') ? popper.getBoundingClientRect() : null;\n\n      if (currentRefRect && areRectsDifferent(prevRefRect, currentRefRect) || currentPopRect && areRectsDifferent(prevPopRect, currentPopRect)) {\n        if (instance.popperInstance) {\n          instance.popperInstance.update();\n        }\n      }\n\n      prevRefRect = currentRefRect;\n      prevPopRect = currentPopRect;\n\n      if (instance.state.isMounted) {\n        requestAnimationFrame(updatePosition);\n      }\n    }\n\n    return {\n      onMount: function onMount() {\n        if (instance.props.sticky) {\n          updatePosition();\n        }\n      }\n    };\n  }\n};\n\nfunction areRectsDifferent(rectA, rectB) {\n  if (rectA && rectB) {\n    return rectA.top !== rectB.top || rectA.right !== rectB.right || rectA.bottom !== rectB.bottom || rectA.left !== rectB.left;\n  }\n\n  return true;\n}\n\ntippy.setDefaultProps({\n  render: render\n});\n\nexport default tippy;\nexport { animateFill, createSingleton, delegate, followCursor, hideAll, inlinePositioning, ROUND_ARROW as roundArrow, sticky };\n//# sourceMappingURL=tippy.esm.js.map\n","/**\n * CSS styling rules for Tippy.js\n * Inlined to simplify Webpack configuration\n */\n\nexport const tippyCss =\n`.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:\"\";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}`\n\nexport const tippyLightCss = `.tippy-box[data-theme~=light-border]{background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,8,16,.15);color:#333;box-shadow:0 4px 14px -2px rgba(0,8,16,.08)}.tippy-box[data-theme~=light-border]>.tippy-backdrop{background-color:#fff}.tippy-box[data-theme~=light-border]>.tippy-arrow:after,.tippy-box[data-theme~=light-border]>.tippy-svg-arrow:after{content:\"\";position:absolute;z-index:-1}.tippy-box[data-theme~=light-border]>.tippy-arrow:after{border-color:transparent;border-style:solid}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-arrow:before{border-top-color:#fff}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-arrow:after{border-top-color:rgba(0,8,16,.2);border-width:7px 7px 0;top:17px;left:1px}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-svg-arrow>svg{top:16px}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-svg-arrow:after{top:17px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#fff;bottom:16px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-arrow:after{border-bottom-color:rgba(0,8,16,.2);border-width:0 7px 7px;bottom:17px;left:1px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-svg-arrow>svg{bottom:16px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-svg-arrow:after{bottom:17px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-arrow:before{border-left-color:#fff}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-arrow:after{border-left-color:rgba(0,8,16,.2);border-width:7px 0 7px 7px;left:17px;top:1px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-svg-arrow>svg{left:11px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-svg-arrow:after{left:12px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-arrow:before{border-right-color:#fff;right:16px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-arrow:after{border-width:7px 7px 7px 0;right:17px;top:1px;border-right-color:rgba(0,8,16,.2)}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-svg-arrow>svg{right:11px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-svg-arrow:after{right:12px}.tippy-box[data-theme~=light-border]>.tippy-svg-arrow{fill:#fff}.tippy-box[data-theme~=light-border]>.tippy-svg-arrow:after{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMCA2czEuNzk2LS4wMTMgNC42Ny0zLjYxNUM1Ljg1MS45IDYuOTMuMDA2IDggMGMxLjA3LS4wMDYgMi4xNDguODg3IDMuMzQzIDIuMzg1QzE0LjIzMyA2LjAwNSAxNiA2IDE2IDZIMHoiIGZpbGw9InJnYmEoMCwgOCwgMTYsIDAuMikiLz48L3N2Zz4=);background-size:16px 6px;width:16px;height:6px}`;\n","/** Get time in milliseconds between a start time (t0) and now */\nfunction timeDiff(t0) {\n  return Math.round(performance.now() - t0);\n}\n\n/** Initialize performance analysis settings */\nfunction initAnalyzeRelatedGenes(ideo) {\n  ideo.time = {\n    rg: { // times for related genes\n      t0: performance.now()\n    }\n  };\n  if ('_didRelatedGenesFirstPlot' in ideo) {\n    delete ideo._didRelatedGenesFirstPlot;\n  }\n}\n\nfunction getRelatedGenesByType() {\n  const ideo = this;\n  const relatedGenes = ideo.annotDescriptions.annots;\n\n  const related = Object.values(relatedGenes).slice();\n\n  const paralogous = related.filter(r => {\n    return r.type && r.type.includes('paralogous');\n  });\n  const interacting = related.filter(r => {\n    return r.type && r.type.includes('interacting gene');\n  });\n  const searched = Object.entries(relatedGenes).filter(entry => {\n    return entry[1].type && entry[1].type.includes('searched gene');\n  })[0][0];\n\n  return {related, paralogous, interacting, searched};\n}\n\nfunction getRelatedGenesTooltipAnalytics(annot) {\n  const ideo = this;\n\n  const timeSincePrevTooltip = performance.now() - ideo.time.prevTooltipOff;\n  const prevAnnotDomId = ideo.time.prevTooltipAnnotDomId;\n\n  if (timeSincePrevTooltip < 300 && annot.domId === prevAnnotDomId) {\n    return null;\n  }\n\n  const tooltipGene = annot.name;\n\n  // e.g. \"interacting gene\" -> \"interacting\"\n  const tooltipRelatedType =\n    ideo.annotDescriptions.annots[annot.name].type.split(' ')[0];\n\n  const countsByType = getCountsByType(ideo);\n\n  const analytics = Object.assign(\n    {tooltipGene, tooltipRelatedType}, countsByType\n  );\n\n  return analytics;\n}\n\n/** Compute granular related genes plotting analytics */\nfunction analyzePlotTimes(type, ideo) {\n  // Paralogs and interacting genes:\n  // http://localhost:8080/examples/vanilla/related-genes?q=RAD51\n  //\n  // No paralogs:\n  // http://localhost:8080/examples/vanilla/related-genes?q=BRCA1&org=mus-musculus\n  //\n  // No interacting genes:\n  // http://localhost:8080/examples/vanilla/related-genes?q=DMC1\n  //\n  // No paralogs, no interacting genes:\n  // http://localhost:8080/examples/vanilla/related-genes?q=BRCA1&org=macaca-mulatta\n\n  if (type === 'pathway') {\n    return;\n  }\n  const otherTypes = {\n    paralogous: 'interacting',\n    interacting: 'paralogous'\n  };\n  const related = ideo.getRelatedGenesByType();\n  const otherType = otherTypes[type];\n  const numThisRelated = related[type].length;\n  const numOtherRelated = related[otherType] ? related[otherType].length : 0;\n\n  if (!ideo._didRelatedGenesFirstPlot) {\n    // 1st of 2 attempted plot logs\n    ideo._didRelatedGenesFirstPlot = true;\n\n    ideo.time.rg.totalFirstPlot = timeDiff(ideo.time.rg.t0);\n\n    if (numThisRelated > 0) {\n      ideo.time.rg.timestampFirstPlot = performance.now();\n      ideo._relatedGenesFirstPlotType = type;\n    }\n  } else {\n    // 2nd of 2 attempted plot logs\n    if (numThisRelated > 0 && numOtherRelated > 0) {\n      // Paralogs and interacting genes were found, e.g. human RAD51\n      const timestampFirstPlot = ideo.time.rg.timestampFirstPlot;\n      ideo.time.rg.totalLastPlotDiff = timeDiff(timestampFirstPlot);\n    } else if (numThisRelated > 0 && numOtherRelated === 0) {\n      // Other attempt did not plot, and this did, so log this as 1st\n      // Often seen when no interacting genes found, e.g. human DMC1\n      ideo.time.rg.timestampFirstPlot = performance.now();\n      ideo.time.rg.totalFirstPlot = timeDiff(ideo.time.rg.t0);\n      ideo._relatedGenesFirstPlotType = type;\n      ideo.time.rg.totalLastPlotDiff = 0;\n\n    } else if (numThisRelated === 0 && numOtherRelated > 0) {\n      // This attempt did not plot, the other did, so log 1st plot as also last\n      // Often seen when no paralogs found, e.g. mouse BRCA1\n      ideo.time.rg.totalLastPlotDiff = 0;\n    } else {\n      // No related genes found, so note only the searched gene is plotted\n      // Example: Macaca mulatta BRCA1\n      ideo._relatedGenesFirstPlotType = 'searched';\n      ideo.time.rg.totalLastPlotDiff = 0;\n    }\n  }\n}\n\nfunction getCountsByType(ideo) {\n  const related = ideo.getRelatedGenesByType();\n\n  const numRelatedGenes = related['related'].length;\n  const numParalogs = related['paralogous'].length;\n  const numInteractingGenes = related['interacting'].length;\n  const searchedGene = related['searched'];\n\n  return {\n    numRelatedGenes, numParalogs, numInteractingGenes, searchedGene\n  };\n}\n\n/** Summarizes number and kind of related genes, performance, etc. */\nfunction analyzeRelatedGenes(ideo) {\n\n  const countsByType = getCountsByType(ideo);\n\n  const timeTotal = ideo.time.rg.total;\n  const timeTotalFirstPlot = ideo.time.rg.totalFirstPlot;\n  const timeTotalLastPlotDiff = ideo.time.rg.totalLastPlotDiff;\n  const timeParalogs = ideo.time.rg.paralogs;\n  const timeInteractingGenes = ideo.time.rg.interactions;\n  const timeSearchedGene = ideo.time.rg.searchedGene;\n  const firstPlotType = ideo._relatedGenesFirstPlotType;\n\n  const analytics = Object.assign({\n    firstPlotType,\n    timeTotal, timeTotalFirstPlot, timeTotalLastPlotDiff,\n    timeSearchedGene, timeInteractingGenes, timeParalogs\n  }, countsByType);\n\n  ideo.relatedGenesAnalytics = analytics;\n}\n\nexport {\n  initAnalyzeRelatedGenes, analyzePlotTimes, analyzeRelatedGenes, timeDiff,\n  getRelatedGenesByType, getRelatedGenesTooltipAnalytics\n};\n","/**\n * @fileoverview Colors for protein features, e.g. domains, families, and sites\n *\n * The color design is intended to visually distinguish protein features, so\n * that patterns can be recognized among interacting and paralogous genes.\n * Colors for each domain were manually assigned, in an iterative process of\n * browsing gene leads ideogram and setting colors per that intent.  Color\n * sometimes overlaps with function, and sometimes not function but moreso\n * visually distinction from other protein features in a given gene leads view.\n */\n\n// Default\nconst grey = '#AAA';\nconst greyLine = '#555';\n\nconst lightGrey = '#D8D8D8';\nconst lightGreyLine = '#888';\n\nconst darkGrey = '#888';\nconst darkGreyLine = '#333';\n\n// const red = '#F00';\n// const redLines = '#800';\nconst red = '#F55';\nconst redLine = '#A00';\nconst magenta = '#922D5E';\nconst magentaLines = '#D26D9E';\nconst faintRed = '#CAA';\nconst faintRedLine = '#866';\nconst redderFaintRed = '#E88';\nconst redderFaintRedLine = '#A55';\nconst pink = '#FFC0CB';\nconst pinkLine = '#CF909B';\n\nconst blue = '#99D';\nconst blueLine = '#22C';\nconst lightBlue = '#CCF';\nconst lightBlueLine = '#33D';\nconst veryLightBlue = '#EEF';\nconst veryLightBlueLine = '#AAF';\nconst darkBlue = '#66B';\nconst darkBlueLine = '#116';\n\nconst green = '#7D7';\nconst greenLine = '#393';\nconst darkGreen = '#3A3';\nconst darkGreenLine = '#060';\nconst seafoam = '#93E9BE';\nconst seafoamLine = '#53AC7E';\n\n// Purples\nconst darkPurple = '#51087E';\nconst darkPurpleLine = '#8138AE';\nconst purple = '#880ED4';\nconst purpleLine = '#5800A4';\nconst purple2 = '#A020F0';\nconst purple2Line = '#7000C0';\nconst lightPurple = '#B24BF3';\nconst lightPurpleLine = '#520B83';\nconst veryLightPurple = '#D7A1F9';\nconst veryLightPurpleLine = '#A771C9';\nconst ultraLightPurple = '#EEDDFF';\nconst ultraLightPurpleLine = '#A771C9';\n\nconst darkBrown = '#964B00';\nconst darkBrownLine = '#660B00';\nconst brown = '#C87D32';\nconst brownLine = '#722810';\nconst lightBrown = '#DACDBA';\nconst lightBrownLine = '#A99A89';\n\nconst orange = '#FFA500';\nconst orangeLines = '#DD8000';\nconst darkOrange = '#DD8300';\nconst darkOrangeLines = '#883000';\n\nconst lightOrange = '#FFEA66';\nconst lightOrangeLine = '#FFB466';\n\nconst orangeBrown = '#EEBB00';\nconst orangeBrownLine = '#A99A89';\n\nconst yellow = '#FF3';\nconst yellowLine = '#AA0';\nconst lightYellow = '#FFFBCC';\nconst lightYellowLine = '#CCC89A';\n\n\nconst lightGreen = '#BCB';\nconst lightGreenLine = '#9A9';\nconst veryLightGreen = '#DFD';\nconst veryLightGreenLine = '#CDC';\n\nexport function getColors(domainType) {\n\n  // Signal peptides\n  if (domainType === 'S') {\n    // return ['#F90', '#5D5'];\n    // return ['#F90', '#090'];\n    // return ['#FF2', '#F99'];\n    return ['#FF2', '#F99'];\n  }\n\n  // Topological features\n  else if (domainType === 'Extracellular') {\n    return [veryLightBlue, veryLightBlueLine];\n  } else if (domainType === 'Cytoplasmic') {\n    return [lightYellow, lightYellowLine];\n  } else if (\n    domainType === 'Helical' ||\n    domainType.startsWith('Helical ---')\n  ) {\n    return [lightBrown, lightBrownLine];\n  } else if (\n    domainType === 'Lumenal'\n  ) {\n    return [lightOrange, lightOrangeLine];\n  } else if (\n    domainType === 'Lumenal, melanosome' // e.g. in TYR\n  ) {\n    return [orangeBrown, orangeBrownLine];\n  } else if (\n    domainType === 'Mitochondrial matrix' // e.g. SDHC in ACMG\n  ) {\n    return [veryLightGreen, veryLightGreenLine];\n  } else if (\n    domainType === 'Mitochondrial intermembrane'\n  ) {\n    return [lightGreen, lightGreenLine];\n  } else if (domainType === 'Perinuclear space') {\n    // E.g. TMEM43\n    return [ultraLightPurple, ultraLightPurpleLine];\n  } else if (domainType === 'Nuclear') {\n    return [veryLightPurple, veryLightPurpleLine];\n  } else if (domainType === 'Beta stranded') {\n    return [blue, blueLine];\n  }\n\n  // Sites, domains, features, and other entries\n  else if (\n    domainType.includes('conserved site') || // https://www.google.com/search?q=pymol+conserved+site+color&tbm=isch\n    domainType.includes('conserved domain') ||\n    domainType === 'WGR domain' ||\n    domainType === 'R3H domain' ||\n    domainType.includes('QLQ') ||\n    domainType === 'Sema domain' ||\n    domainType === 'Proteasome component (PCI) domain' ||\n    domainType === 'Sterol-sensing domain' ||\n    domainType === 'Erythropoietin/thrombopoietin' ||\n    domainType === 'SPRY domain' ||\n    domainType === 'Anaphylatoxin/fibulin' ||\n    domainType === 'Tetratricopeptide repeat' ||\n    domainType === 'Doublecortin domain' ||\n    domainType.includes('Glycosyl transferase') ||\n    (\n      domainType.toLowerCase().includes('lethal') &&\n      domainType.toLowerCase().includes('c-terminal')\n    ) ||\n    domainType.includes('PUB') ||\n    domainType.includes('Myogenic determination') ||\n    domainType === 'Globin' ||\n    domainType === 'GPS motif' ||\n    domainType.includes('D-like') ||\n    domainType.toLowerCase().includes('insertion domain') || // e.g. RPLP0\n    domainType === 'Macro domain' // e.g. MACROH2A1\n  ) {\n    return [magenta, magentaLines];\n  } else if (\n    // Enzymatic sites\n    domainType.includes('active site') ||\n    domainType.includes('hydroxylation site') ||\n    domainType.includes('catalytic domain') ||\n    domainType.includes('Lipid transport') ||\n    domainType === 'BRCA1, serine-rich domain' ||\n    domainType === 'Tower domain' || // Important in BRCA2\n    domainType.endsWith('attachment site') ||\n    domainType.endsWith('amyloid-beta peptide') ||\n    domainType === 'Reverse transcriptase domain' ||\n    domainType ===\n      'Membrane attack complex component/perforin (MACPF) domain' ||\n    domainType === 'Alpha-2-macroglobulin' ||\n    domainType === 'Kinesin motor domain' ||\n    domainType === 'Adenomatous polyposis coli tumour suppressor protein' ||\n    domainType.includes('endostatin')\n  ) {\n    return [red, redLine];\n  } else if (\n    // Enzymatic domains, C-terminal regions, and miscellaneous\n    domainType === 'Cyclin, C-terminal domain' ||\n    domainType.includes('OB C-terminal domain') ||\n    domainType === 'Cationic amino acid transporter, C-terminal' ||\n    domainType === 'High mobility group box domain' ||\n    domainType === 'HMG-box domain' ||\n    domainType.includes('CUB domain') ||\n    domainType === 'C-5 cytosine methyltransferase' ||\n    domainType.includes('(G-protein), alpha subunit') ||\n    domainType === 'SCAN domain' ||\n    domainType === 'Apolipoprotein A/E' ||\n    domainType.includes('Clusterin') || // a.k.a. apolipoprotein J, e.g. CLU\n    domainType.includes('SMAD domain') ||\n    domainType === 'PLAC' ||\n    domainType.endsWith('tripeptidyl peptidase II') ||\n    domainType === 'Prohormone convertase enzyme' ||\n    domainType.includes('rod domain') ||\n    domainType === 'Osteopontin' ||\n    domainType === 'SPRY-associated' ||\n    domainType === 'C1q domain' ||\n    domainType === 'OAR domain' ||\n    domainType.includes('FTO, C-terminal') ||\n    domainType.includes('ATPase, C-terminal') ||\n    domainType.includes('Hint domain') ||\n    domainType === 'Laminin IV' ||\n    domainType === 'NACHT-associated domain' ||\n    domainType.includes('FANCD2') ||\n    domainType.startsWith('Acyl-CoA') && domainType.endsWith('C-terminal') ||\n    domainType === 'Kinesin-like' ||\n    domainType === 'GUCT' ||\n    domainType.includes('(APC) repeat') || // e.g. as in APC gene\n    domainType.includes('IP3R') // e.g. RYR1\n  ) {\n    return [faintRed, faintRedLine];\n  } else if (\n    domainType.includes('trypsin domain') ||\n    domainType.includes('scaffold dimerization') ||\n    domainType.includes('eIF-4 gamma, MA3') || // e.g. PDCD4\n    domainType === 'Troponin' || // e.g. TNNT1\n    domainType === 'SKI/SNO/DAC domain' || // SKIL gene\n    domainType.toLowerCase().includes('large ribosom') || // RPLP0\n    domainType.includes('KA1') || // e.g. MARK2\n    domainType === 'V(D)J recombination-activating protein 1' || // e.g. RAG1\n    domainType.toLowerCase().includes('opiod') || // e.g. PDYN\n    domainType === 'Corticotropin-releasing factor' || // e.g. CRH\n    domainType.includes('2Fe-2S ferredoxin') || // e.g. XDH\n    domainType.includes('acidic domain') // e.g. SYNCRIP\n  ) {\n    return [redderFaintRed, redderFaintRedLine];\n  } else if (\n    domainType === 'EGF-like calcium-binding domain' ||\n    domainType.includes('PTX/LNS') ||\n    domainType === 'HSR domain' ||\n    domainType.includes('MutS, clamp') ||\n    domainType.includes('S5 domain 2-like') || // e.g. MLH1 in ACMG\n    domainType.endsWith('CC1/2') || // e.g. PRKDC\n    domainType.includes('MUN') || // e.g. UNC13C\n    domainType.includes('second molybdopterin') // e.g. XDH\n  ) {\n    return [darkGreen, darkGreenLine];\n  } else if (\n    // Binding sites, and smaller binding regions\n    domainType.includes('binding site') ||\n    domainType === 'EF-hand domain' ||\n    domainType.includes('EF hand-like') ||\n    domainType === 'Zinc finger, nuclear hormone receptor-type' ||\n    domainType.includes('Serpin domain') ||\n    domainType === 'Peptidase C14,  p20 domain' ||\n    domainType === 'PWWP domain' ||\n    domainType === 'Peptidoglycan binding-like' ||\n    domainType === 'MAD homology 1, Dwarfin-type' ||\n    domainType === 'F-actin binding' ||\n    (\n      domainType.includes('Glycoside hydrolase') &&\n      domainType.endsWith('domain')\n    ) ||\n    domainType === 'p53 tumour suppressor family' ||\n    domainType === 'Menin' || // tumor suppressor, e.g. MEN1 in ACMG\n    domainType.includes('von Hippel') && domainType.includes('beta') || // VHLL\n    domainType === 'Pointed domain' ||\n    domainType.includes('DNA binding') ||\n    domainType === 'Helix-hairpin-helix domain' ||\n    domainType === 'Helix-hairpin-helix motif' ||\n    domainType === 'MIR motif' ||\n    domainType === 'Rad52 family' ||\n    domainType === 'Oxidoreductase FAD/NAD(P)-binding' ||\n    domainType.endsWith('NAD-binding') ||\n    domainType.endsWith('NAD binding') ||\n    domainType.includes('Bromo adjacent') ||\n    domainType === 'HARP domain' ||\n    domainType === 'FATC domain' ||\n    domainType.startsWith('XRN2-binding') ||\n    domainType === 'SRCR-like domain' ||\n    domainType.includes('SRCR') ||\n    domainType === 'Gamma-carboxyglutamic acid-rich (GLA) domain' ||\n    domainType === 'Pterin-binding domain' ||\n    domainType === 'Receptor, ligand binding region' ||\n    domainType.includes('DHEX domain') ||\n    domainType === 'SANT/Myb domain' ||\n    domainType.includes('Forkhead-associated') ||\n    domainType === 'Rap/Ran-GAP domain' ||\n    domainType.endsWith('C2 domain') ||\n    domainType.includes('tri-helix bundle domain') || // e.g. MYBPC3\n    domainType.includes('Cx50') || // e.g. GJA8\n    domainType.includes('tyrosine-rich') ||\n    domainType === 'Filaggrin' // e.g. FLG\n  ) {\n    return [blue, blueLine];\n  } else if (\n    domainType.includes('dehydrogenase, molybdopterin binding') ||\n    domainType === 'Zinc finger CCHC HIVEP-type' ||\n    domainType === 'Cyclin, N-terminal' ||\n    domainType === 'MAD homology, MH1' ||\n    domainType === 'Sodium ion transport-associated' ||\n    domainType === 'Sodium ion transport-associated domain' ||\n    domainType.endsWith('head') ||\n    domainType.includes('Pleckstrin homology domain') ||\n    domainType === 'PH domain' ||\n    domainType.endsWith('pleckstrin homology-like domain') ||\n    domainType === 'DEP domain' ||\n    domainType === 'Post-SET domain' ||\n    domainType.includes('Glycoside hydrolase') ||\n    domainType === 'Pyridoxal phosphate-dependent decarboxylase' ||\n    domainType.includes('OB1') ||\n    domainType.includes('OB3') ||\n    domainType.includes('OB domain') ||\n    domainType === 'Fork head domain' ||\n    domainType === 'Histone deacetylase domain' ||\n    domainType.includes('MG1') ||\n    domainType === 'Homocysteine-binding domain' ||\n    domainType.startsWith('Acyl-CoA') && domainType.endsWith('N-terminal') ||\n    domainType === 'Clathrin light chain' ||\n    domainType === 'Hexokinase, N-terminal' // e.g. HK2\n  ) {\n    return [lightBlue, lightBlueLine];\n  } else if (\n    // Larger binding regions and miscellaneous\n    domainType.includes('zinc-binding') ||\n    domainType.includes('DNA-binding') ||\n    domainType === 'RUNT domain' || // a DNA-binding / PPI domain, e.g. RUNX1\n    domainType === 'G protein-coupled receptor, rhodopsin-like' ||\n    domainType.includes('CXC domain') ||\n    domainType.includes('Homeobox domain') ||\n    domainType.includes('BRCT domain') ||\n    domainType.includes('EF-hand') ||\n    domainType === 'Laminin G domain' ||\n    domainType === 'Peptidase C14, caspase non-catalytic subunit p10' ||\n    domainType === 'ADD domain' ||\n    domainType === 'PDZ domain' ||\n    domainType === 'Krueppel-associated box' ||\n    domainType === 'Ets domain' ||\n    domainType === 'P domain' ||\n    domainType.includes('bHLH') ||\n    domainType === 'Ras-associating (RA) domain' ||\n    domainType === 'Ras-associating domain' ||\n    domainType ===\n      'Calcium/calmodulin-dependent protein kinase II, association-domain' ||\n    domainType === 'Bromodomain' ||\n    domainType === 'Bromodomain associated domain' ||\n    domainType === 'SLIDE domain' ||\n    domainType === 'Peptidase M24' ||\n    domainType === 'Pentraxin-related' ||\n    domainType.includes('Notch ligand') ||\n    domainType === 'Anti-proliferative protein' ||\n    domainType.includes('transpeptidase') ||\n    domainType === 'Tuberin-type domain' ||\n    domainType === 'Ras-like guanine nucleotide exchange factor, N-terminal' ||\n    domainType.includes('factor-binding protein') || // as in IGFBP3\n    domainType.includes('GPD') || // e.g. MUTYH in ACMG\n    domainType === 'ELM2 domain' // e.g. MTA2\n  ) {\n    return [darkBlue, darkBlueLine];\n  } else if (\n    domainType === 'SH2 domain' ||\n    domainType.includes('SH2-like domain') ||\n    domainType.includes('Furin-like') ||\n    domainType.includes('heparin-binding') ||\n    domainType === 'SRCR domain' ||\n    domainType === 'EGF-like domain' ||\n    domainType === 'Basic leucine zipper domain, Maf-type' ||\n    domainType.startsWith('Leucine zipper') ||\n    domainType.includes('Interleukin') && domainType.includes('propeptide') ||\n    domainType === 'Sirtuin family' ||\n    domainType === 'Amino acid/polyamine transporter I' ||\n    domainType === 'Peptidase M10, metallopeptidase' ||\n    domainType === 'Metallothionein' ||\n    domainType === 'DDHD domain' ||\n    domainType === 'Zinc finger C2H2-type' ||\n    domainType === 'Zinc finger, PARP-type' ||\n    domainType.endsWith('tail domain') ||\n    domainType === 'SET domain' ||\n    domainType === 'Hamartin' || // e.g. TSC2 in ACMG; interacts with tuberin\n    domainType.includes('von Hippel') && domainType.includes('alpha') || // VHLL\n    domainType.includes('transactivation domain 2') ||\n    domainType === 'Phosphopantetheine binding ACP domain' ||\n    domainType === 'Multicopper oxidase, second cupredoxin domain' ||\n    domainType === 'Helicase, C-terminal' ||\n    domainType.includes('Carboxylesterase') || // e.g. ACHE\n    domainType.includes('presequence') || // e.g. ALAS2\n    domainType.endsWith('CC3') // e.g. PRKDC\n  ) {\n    return [green, greenLine];\n  } else if (\n    domainType === 'Insulin-like' ||\n    domainType === 'Fibroblast growth factor family' ||\n    domainType === 'Nerve growth factor-related' ||\n    domainType === 'Transforming growth factor-beta, C-terminal' ||\n    domainType === 'Telomere-length maintenance and DNA damage repair' ||\n    domainType === 'PDGF/VEGF domain' ||\n    domainType.includes('SH3-RhoGEF') ||\n    domainType.includes('MG4') ||\n    domainType.includes('RING domain') ||\n    domainType.includes('RING-type') ||\n    domainType.startsWith('DEAD/DEAH') ||\n    domainType === 'Laminin alpha, domain I' ||\n    domainType.toLowerCase().includes('nuclear/hormone receptor') ||\n    domainType === 'P-type trefoil domain' || // e.g. GAA in ACMG\n    domainType.includes('KHDRBS')\n  ) {\n    return [darkGreen, darkGreenLine];\n  } else if (\n    domainType === 'SH3 domain' ||\n    domainType === 'Variant SH3 domain' ||\n    domainType.endsWith('SH3 domain') ||\n    domainType.includes('copper-binding') ||\n    domainType === 'Sushi/SCR/CCP domain' ||\n    domainType.includes('Coagulation factor 5/8') ||\n    domainType === 'Basic-leucine zipper domain' ||\n    domainType === 'Basic region leucine zipper' ||\n    domainType === 'Sirtuin family, catalytic core domain' ||\n    domainType === 'Amine oxidase' ||\n    domainType.includes('peroxidase') ||\n    domainType.includes('lid domain') ||\n    domainType.includes('prodomain') ||\n    domainType === 'Pre-SET domain' ||\n    domainType.includes('transactivation domain') ||\n    domainType.includes(' activation domain') ||\n    domainType.includes('activating region') ||\n    domainType === 'Thioesterase' ||\n    domainType.toLowerCase().includes('thiored') || // e.g. TXNDC12\n    domainType.includes('esterase') ||\n    domainType.endsWith('Claudin superfamily') ||\n    domainType === 'Retinoblastoma-associated protein, A-box' ||\n    domainType.includes('Between PH and SH2') ||\n    domainType.includes('inter-SH2') ||\n    domainType === 'Chromogranin A/B/C' ||\n    domainType.toLowerCase().includes('helicase') ||\n    domainType.endsWith('pro-domain') ||\n    domainType === 'Brix domain' ||\n    domainType === 'Coagulation Factor Xa inhibitory site' ||\n    domainType === 'Trypsin Inhibitor-like, cysteine rich domain' ||\n    domainType === 'WIF domain' || // Wnt1 inhibitory factor, e.g. WIF1\n    domainType.toLowerCase().includes('cystatin') ||\n    domainType === 'EGF domain' ||\n    domainType === 'Axin beta-catenin binding' ||\n    domainType === 'Peptidase M2, peptidyl-dipeptidase A' ||\n    domainType.endsWith('phosphatase domain') ||\n    domainType === 'PIGA, GPI anchor biosynthesis' ||\n    domainType.startsWith('Acyl-CoA') && domainType.endsWith('middle domain') ||\n    domainType.includes('(COR)') ||\n    domainType === 'K Homology domain, type 2' ||\n    domainType.includes('Phox') ||\n    domainType.includes('PB1') ||\n    domainType.includes('multifunctional domain') ||\n    domainType.includes('MutS, core') ||\n    domainType === 'RAP domain' || // RNA-binding, e.g. FASTK\n    domainType.endsWith('CC5') || // e.g. PRKDC\n    domainType.includes('first molybdopterin') // e.g. XDH\n  ) {\n    return [seafoam, seafoamLine];\n  } else if (\n    // Immunoglobulin domains are colored in the pink-purple spectrum\n    domainType === 'Immunoglobulin-like domain' ||\n    domainType.toLowerCase().endsWith('immunoglobulin-like domain') ||\n    domainType.endsWith('Ig domain') ||\n    domainType.endsWith('Ig-like domain') ||\n    domainType === 'Major facilitator superfamily domain' ||\n    domainType.includes('interface') ||\n    domainType === 'Class I myosin tail homology domain' ||\n    domainType === 'Myosin tail' ||\n    domainType === 'Acyl transferase' ||\n    domainType.endsWith('transferase') ||\n    domainType.startsWith('Acyl-CoA') ||\n    domainType === 'JAK, FERM F2 lobe domain' ||\n    domainType === 'Sodium/solute symporter' ||\n    domainType.includes('foci domain') ||\n    domainType.includes('Receptor L-domain') ||\n    domainType === 'Wnt' ||\n    domainType === 'R-spondin, Fu-CRD domain' ||\n    domainType.endsWith('merisation domain') || // e.g. di- / tetramerisation\n    domainType.endsWith('merization domain') ||\n    domainType.endsWith('merisation motif') || // e.g. di- / tetramerisation\n    domainType.endsWith('merization motif') ||\n    domainType.endsWith('BTB/POZ domain') || // homodimerization domain\n    domainType.includes('CBS domain') || // these domains homo-dimerize\n    domainType === 'DZF domain' || // domain associated with zinc fingers; dimerisation domain\n    domainType === 'GS domain' || // in kinase superfamily\n    domainType.includes('kinase domain') ||\n    domainType.includes('FAT') ||\n    domainType.startsWith('von Willebrand factor, type A') ||\n    domainType.includes('VWA') ||\n    domainType === 'Reeler domain' ||\n    domainType === 'BMP/retinoic acid-inducible neural-specific protein' ||\n    domainType === 'Low-density lipoprotein (LDL) receptor class A repeat' ||\n    domainType === 'TILa domain' ||\n    domainType.includes('chromosome condensation') ||\n    domainType === 'Immunoglobulin I-set' || // e.g. MYBPC3\n    domainType === 'Kinesin-associated' ||\n    domainType === 'SMCs flexible hinge' || // e.g. SMC1A\n    domainType.includes('Cys-His rich domain') // e.g. NSD2\n  ) {\n    return [pink, pinkLine];\n  } else if (\n    domainType === 'Immunoglobulin' ||\n    domainType === 'Immunoglobulin domain' ||\n    domainType === 'CD20-like family' ||\n    domainType === 'Calponin homology domain' ||\n    domainType.endsWith('Calponin-homology domain') ||\n    domainType.includes('ATPase') ||\n    domainType.includes('ATP coupling domain') ||\n    domainType.includes('globular domain') ||\n    domainType === 'Mitochondrial substrate/solute carrier' ||\n    domainType === 'Major facilitator,  sugar transporter-like' ||\n    domainType === 'Major facilitator, sugar transporter-like' ||\n    domainType === 'Sodium:neurotransmitter symporter' ||\n    domainType.toLowerCase().includes('methyltransferase') ||\n    domainType === 'Rhodanese-like domain' ||\n    domainType.startsWith('Thyroglobulin') ||\n    domainType === 'Retinoblastoma-associated protein, B-box' ||\n    domainType === 'C-type lectin-like' ||\n    domainType === 'Galectin, carbohydrate recognition domain' ||\n    domainType === 'VWFC domain' || // von Willebrand\n    domainType.includes('CFC domain') ||\n    domainType === 'POLO box domain' ||\n    domainType.endsWith('domain 1') ||\n    domainType.endsWith('domain II') || // e.g. EEF2\n    domainType === 'Fibronectin, type I' ||\n    domainType === 'Cadherin-like' ||\n    domainType === 'G-protein gamma-like domain' ||\n    domainType === 'GoLoco motif' ||\n    domainType === 'MyTH4 domain' ||\n    domainType.endsWith('isomerase') ||\n    domainType === ('BTB/Kelch-associated') || // associated with BTB/POZ\n    domainType === 'Stathmin family'\n  ) {\n    return [veryLightPurple, veryLightPurpleLine];\n  } else if (\n    domainType === 'Immunoglobulin C1-set' ||\n    domainType.includes('GTPase') ||\n    domainType === 'RGS domain' ||\n    domainType === 'Major facilitator superfamily' ||\n    domainType === 'Fibronectin type II domain' ||\n    domainType.includes('ectodomain') ||\n    domainType.endsWith('receptor domain') ||\n    domainType.endsWith('receptor domain 4') ||\n    domainType === 'MAM domain' ||\n    domainType === 'IPT domain' ||\n    domainType.endsWith('extracellular') ||\n    domainType === 'Link domain' ||\n    domainType.includes('connector domain') ||\n    domainType === 'WW domain' ||\n    domainType === 'WHIM1 domain' ||\n    domainType === 'TNFR/NGFR cysteine-rich region' ||\n    domainType === 'Frizzled domain' ||\n    domainType === 'Netrin module, non-TIMP type' ||\n    domainType === 'CFTR regulator domain' ||\n    domainType.endsWith('domain 2') ||\n    domainType === 'GNAT domain' ||\n    domainType === 'NIDO domain' ||\n    domainType === 'Myosin head, motor domain' ||\n    domainType === 'von Willebrand domain, type D domain' ||\n    domainType === 'Kinesin-like KIF1-type' ||\n    domainType.includes('Paxillin') || // e.g. PXN, an ACMG gene\n    domainType === 'Clathrin, heavy chain/VPS, 7-fold repeat' ||\n    domainType === 'Collagen IV, non-collagenous'\n  ) {\n    return [lightPurple, lightPurpleLine];\n  } else if (\n    domainType === 'Fibronectin type III' ||\n    domainType === 'Tissue factor' ||\n    domainType === 'Immunoglobulin C2-set' ||\n    domainType.includes('immunoglobulin C2-set') ||\n    domainType.includes('protein interaction') ||\n    domainType === 'SWIRM domain' ||\n    domainType.includes('(DSL) protein') ||\n    domainType === 'Dishevelled protein domain' ||\n    domainType.endsWith('domain 3') ||\n    domainType === 'DnaJ domain' ||\n    domainType.toLowerCase().includes('nuclear receptor') ||\n    domainType === 'Gonadal family'\n  ) {\n    return [purple, purpleLine];\n  } else if (\n    domainType === 'Immunoglobulin V-set domain' ||\n    domainType.includes('V-set domain') ||\n    domainType.includes('V-like') ||\n    domainType === 'Frizzled/Smoothened, 7TM' ||\n    domainType.endsWith('domain 4') ||\n    domainType === 'Integrin alpha-2' ||\n    domainType === 'Calcium-activated potassium channel BK, alpha subunit' ||\n    domainType.includes('Dbl homology (DH) domain') ||\n    domainType.includes('Glycine rich') ||\n    domainType.toLowerCase().includes('exonuclease') ||\n    domainType === 'WHIM2 domain' ||\n    domainType.includes('Coactivator CBP') || // e.g. EP300\n    domainType.includes('cryptic polo') // e.g. PLK4\n  ) {\n    return [darkPurple, darkPurpleLine];\n  }\n  // Not great in MYBPC3, an AGMC gene\n  // else if (\n  //   domainType === 'Immunoglobulin I-set'\n  // ) {\n  //   return [purple2, purple2Line];\n  // }\n\n  else if (\n    domainType === 'Desmoplakin, spectrin-like domain' ||\n    domainType === 'Spectrin repeat' ||\n    domainType.endsWith('TED domain') ||\n    domainType === 'Polyadenylate-binding protein/Hyperplastic disc protein' ||\n    domainType.includes(' cap domain') ||\n    domainType.toLowerCase().includes('agenet') ||\n    domainType.includes('TATA') ||\n    domainType.includes('Citron') ||\n    domainType === 'RIH domain' ||\n    domainType.toLowerCase().includes('sclerostin') || // e.g. SOSTDC1\n    domainType === 'ZU5 domain' || // e.g. TJP1\n    domainType === 'Piezo domain' || // e.g. PIEZO1\n    domainType === 'Histone H2A/H2B/H3' // e.g. H2AZ1\n  ) {\n    return [yellow, yellowLine];\n  }\n\n  else if (\n    // Repeats, iron, some transmembrane\n    domainType === 'Armadillo' ||\n    domainType.includes('Apple domain') ||\n    domainType === 'Protocadherin' || // Cytoplasmic\n    domainType === 'DIX domain' ||\n    domainType === 'Ferritin-like diiron domain' ||\n    domainType === '4Fe-4S dicluster domain' ||\n    domainType === 'Transferrin-like domain' || // iron-related, e.g. MELTF\n    domainType === 'PAS domain' ||\n    domainType === 'PAS fold' ||\n    domainType === 'Polyketide synthase, dehydratase domain' ||\n    domainType === 'Flavodoxin/nitric oxide synthase' ||\n    domainType === 'Flavodoxin-like fold' ||\n    domainType === 'G-patch domain' ||\n    domainType === 'Chromo domain' ||\n    domainType.toLowerCase().includes('tudor') ||\n    domainType === 'Cytochrome P450' ||\n    domainType === 'Potassium channel domain' ||\n    domainType === 'G2 nidogen/fibulin G2F' ||\n    domainType.includes('bait region') ||\n    domainType === 'WWE domain' ||\n    domainType.endsWith('deiodinase') ||\n    domainType === 'Cobalamin (vitamin B12)-binding domain' ||\n    domainType === 'Laminin domain II' ||\n    domainType === 'Troponin I residues 1-32' || // e.g. TNNI3 in ACMG\n    domainType === 'KI67R' || // KI67 / Chmadrin repeat\n    domainType.includes('FAD-binding')\n  ) {\n    return [orange, orangeLines];\n  } else if (\n    domainType.includes('Kringle') ||\n    domainType.includes('Peptidase M12A') ||\n    domainType === 'TGF-beta, propeptide' ||\n    domainType.includes('autopeptidase') ||\n    domainType.includes('GAIN') ||\n    domainType === 'PIK-related kinase' ||\n    domainType.includes('(PIK) domain') ||\n    domainType === 'LDLR class B repeat' ||\n    domainType === 'Actin family' ||\n    domainType === 'Ferritin/DPS protein domain' ||\n    domainType === 'PAS fold-3' ||\n    domainType === 'Polyketide synthase, ketoreductase domain' ||\n    domainType.startsWith('Heat shock protein') && domainType.endsWith('family') ||\n    domainType === 'BAG domain' || // e.g. BAG3 in AGMC, a chaperone\n    domainType === 'MCM domain' ||\n    domainType.endsWith('reductase-like') ||\n    domainType === 'Lipase' ||\n    domainType === 'Phospholipase A2 domain' ||\n    domainType === 'Notch domain' ||\n    domainType.includes('LCCL domain') ||\n    domainType.includes('SANT-like') ||\n    domainType ===\n      'VWF/SSPO/Zonadhesin-like, cysteine-rich domain' || // E.g. VWF\n    domainType === 'Kappa casein' ||\n    domainType === 'Casein, alpha/beta' ||\n    domainType === 'Natriuretic peptide' ||\n    domainType === 'EMI domain' ||\n    domainType === 'Neurohypophysial hormone' ||\n    domainType === 'Synuclein' ||\n    domainType.includes('Hydroxymethylglutaryl-CoA reductase') ||\n    domainType.includes('Perilipin') ||\n    domainType.includes('lipase') ||\n    domainType.includes('CRAL') || // e.g. NF1\n    domainType.includes('SAND') ||\n    domainType.toLowerCase().includes('hsp') ||\n    domainType.toLowerCase().includes('bombesin') // e.g. GRP\n  ) {\n    return [lightBrown, lightBrownLine];\n  } else if (\n    domainType === 'Notch, NOD domain' ||\n    domainType === 'Cadherin, Y-type LIR-motif' ||\n    domainType === 'Protein patched/dispatched' ||\n    domainType.includes('membrane-proximal') ||\n    domainType === 'LicD family' ||\n    domainType.includes('MoaB/Mog')\n  ) {\n    return [brown, brownLine];\n  } else if (\n    // Transmembrane, etc.\n    domainType.includes('transmembrane domain') ||\n    domainType.includes('trans-membrane domain') ||\n    domainType.includes('Transmembrane protein') ||\n    domainType.includes('7TM') || // e.g. TMEM63A\n    domainType === 'Major intrinsic protein' || // e.g. AQP1\n    domainType.includes('Triadin') ||\n    domainType.includes('Collectrin') ||\n    domainType.includes('membrane glycoprotein') ||\n    domainType === 'SEA domain' ||\n    domainType === 'CD36 family' ||\n    domainType.includes('CD34') ||\n    domainType === 'Hypoxia-inducible factor, alpha subunit' ||\n    domainType === 'Hypoxia-inducible factor, alpha subunit-like' ||\n    domainType === 'PKD domain' ||\n    domainType.includes('regulatory domain') ||\n    domainType.endsWith('E2 domain') ||\n    domainType === 'PLAT/LH2 domain' ||\n    domainType === 'Notch, NODP domain' ||\n    domainType === 'Syndecan/Neurexin domain' ||\n    domainType === 'Zona pellucida domain' ||\n    domainType.includes('Ion transport domain') ||\n    domainType.endsWith('Membrane transport protein MMPL domain') ||\n    domainType.includes('Caveolin') ||\n    domainType === 'Band 7 domain' ||\n    domainType.includes('Shisa') ||\n    domainType === 'ABC-2 family transporter protein' ||\n    domainType === 'Anoctamin' ||\n    domainType === 'Sodium-dependent phosphate transport protein' || // SLC34A2\n    domainType.includes('MHC II-interacting') // e.g. CD74\n  ) {\n    return [darkBrown, darkBrownLine];\n  } else if (\n    // Death, ubiquitination, apoptosis, etc.\n    domainType === 'DAPIN domain' ||\n    domainType === 'Death effector domain' ||\n    domainType === 'Death domain' ||\n    domainType.includes('death protein') ||\n    domainType.toLowerCase().includes('lethal') ||\n    domainType.includes('UBA domain') ||\n    domainType.includes('HECT domain') ||\n    domainType.toLowerCase().includes('ubiquitin') ||\n    domainType.includes('necrosis') ||\n    domainType.toLowerCase().includes('death') ||\n    domainType.includes('Bcl-2') ||\n    domainType.includes('CIDE-N') ||\n    domainType === 'Disintegrin domain' ||\n    domainType.includes('TRAF') ||\n    domainType.includes('TIR') ||\n    domainType.toLowerCase().includes('caspase') ||\n    domainType === 'Pellino family'\n  ) {\n    return [darkGrey, darkGreyLine];\n  } else if (\n    domainType.includes('unknown function') ||\n    domainType.toLowerCase().includes('unstructured') ||\n    domainType.startsWith('Uncharacterised')\n  ) {\n    return [grey, greyLine];\n  } else if (\n    domainType.toLowerCase().includes('leucine rich repeat') ||\n    domainType.includes('HIN') ||\n    domainType.includes('calcium') ||\n    domainType.toLowerCase().includes('calreticulin') ||\n    domainType.includes('cytokine receptor') ||\n    domainType.includes('pore forming') ||\n    domainType.includes('RHIM') ||\n    domainType.includes('SWIB') ||\n    domainType === 'Ryanodine receptor Ryr' ||\n\n    // Associated with repeats\n    domainType.includes('Armadillo') || // e.g. APC\n    domainType === 'UME domain' || // overlaps Armadillo-type fold, e.g. ATR\n    domainType.includes('WD40 domain') ||\n\n    domainType === 'WSTF/Acf1/Cbp146' || // ATP-utilising chromatin assembly and remodeling factor\n    domainType === 'BCL7' || // e.g. BCL7A\n    domainType.endsWith('repeat ring region') || // e.g. TRRAP\n\n    domainType.includes('PANDER') || // e.g. FAM3C\n\n    // GPCRs\n    domainType === 'GPCR, rhodopsin-like, 7TM' ||\n    domainType === 'GPCR, family 2, secretin-like' ||\n    domainType === 'GPCR, family 3, nine cysteines domain' ||\n    domainType === 'G-protein coupled receptor' ||\n    domainType.toLowerCase().includes('orexin') || // e.g. HCRTR2\n\n    domainType === '[2Fe-2S]-binding'\n  ) {\n    return [darkOrange, darkOrangeLines];\n  } else if (\n    domainType.includes('repeat') ||\n    domainType === 'Vitellinogen, open beta-sheet' ||\n    domainType.includes('Interleukin') && domainType.includes('family') ||\n    /Interleukin-\\d+$/.test(domainType) ||\n    domainType === 'Chemokine interleukin-8-like domain' ||\n    domainType.includes('beta-ribbon') ||\n    domainType.includes('cytoplasmic domain') ||\n    domainType.toLowerCase().includes('interleukin') ||\n    domainType === 'Citrate transporter-like domain' ||\n    domainType.toLowerCase().includes('calsequestrin')\n  ) {\n    return [orange, orangeLines];\n  } else if (\n    domainType.includes('inhibit') ||\n    domainType.includes('central') ||\n    domainType.endsWith('tail') ||\n    domainType.endsWith('helical domain') ||\n    domainType.endsWith('helical domain HD2') ||\n    domainType.endsWith('coiled-coil domain') ||\n    domainType.endsWith('coiled-coil region') ||\n    domainType.includes('zinc ribbon fold') ||\n    domainType.includes('zinc-ribbon') ||\n    domainType.toLowerCase().includes('anhydrase') || // e.g. CA6\n    domainType === 'Macroglobulin domain' ||\n    domainType.includes('KH0') ||\n    domainType.includes('EGF') ||\n    domainType.toLowerCase().includes('olfact') ||\n    domainType.toLowerCase().includes('mucin') // e.g. CEL\n  ) {\n    return [seafoam, seafoamLine];\n  } else if (\n    domainType.includes('Peptidase') ||\n    domainType.includes('Ras-binding') ||\n    domainType.includes('CRIB domain')\n  ) {\n    return [blue, blueLine];\n  } else if (\n    domainType.toLowerCase().includes('zinc finger') ||\n    domainType.toLowerCase().includes('zinc-finger') ||\n    domainType.includes('RING finger') ||\n    domainType.toLowerCase().includes('transcription factor') ||\n    domainType === 'Paired domain' || // found in eukaryotic transcription regulatory proteins involved in embryogenesis\n    domainType === 'JmjC domain' ||\n    domainType === 'BRK domain' ||\n    domainType.includes('MG3') ||\n    domainType.toLowerCase().includes('polycomb') ||\n    domainType.toLowerCase().includes('metallopeptidase') ||\n    domainType.toLowerCase().includes('metallo-peptidase') ||\n    domainType.toLowerCase().includes('metalloenzyme') ||\n    domainType === 'K Homology domain, type 1' ||\n    domainType.includes('winged helix') ||\n    domainType.toLowerCase().includes('dehydrogenase') ||\n    domainType.includes('BAR') ||\n    domainType.includes('metal') ||\n    domainType.includes('redoxin')\n  ) {\n    return [green, greenLine];\n  } else if (\n    domainType.startsWith('Tyrosine-protein kinase receptor') ||\n    domainType === 'PTB/PI domain' ||\n    domainType.endsWith('receptor') ||\n    domainType.includes('cysteine rich') ||\n    domainType.includes('cysteine-rich') ||\n    domainType === 'AWS domain' || // cysteine-rich, e.g. NSD2\n    domainType.toLowerCase().includes('somatomedin b') ||\n    domainType.includes('MHC class II') && !domainType.includes('C-terminal')\n  ) {\n    return [lightPurple, lightPurpleLine];\n  } else if (\n    domainType.toLowerCase().includes('golgi') ||\n    domainType === 'GOLD domain' ||\n    domainType.includes('deaminase') ||\n    domainType.includes('C-terminal core') ||\n    domainType.includes('nucleoside triphosphatase') ||\n    domainType.includes('globin') ||\n    domainType.includes('IspD/TarI') ||\n    domainType === 'Telethonin' ||\n    domainType.includes('Sarcoglycan') ||\n    domainType.includes('toxin') ||\n    domainType.includes('ShKT') ||\n    domainType.includes('SAM') ||\n    domainType.includes('Sterile alpha motif') ||\n    domainType.includes('Unconventional myosin-X') ||\n    domainType === 'CARD domain' ||\n    domainType.includes('endonuclease') ||\n    domainType.toLowerCase().includes('splicing factor') ||\n    domainType.toLowerCase().includes('interferon') ||\n    domainType === 'Tropomyosin' || // e.g. TPM1\n    domainType.includes('R1 domain') // e.g. MTA2\n  ) {\n    return [magenta, magentaLines];\n  } else if (\n    domainType.includes('TM') || // transmembrane, as in e.g. RYR1\n    domainType.toLowerCase().includes('transmembrane') ||\n    domainType.toLowerCase().includes('trans-membrane')\n  ) {\n    return [darkBrown, darkBrownLine];\n  } else if (\n    domainType.includes('binding domain') ||\n    domainType.includes('binding protein')\n  ) {\n    return [darkBlue, darkBlueLine];\n  } else if (\n    domainType.includes('Ribosomal protein') ||\n    domainType.toLowerCase().includes('ribosomal subunit') ||\n    domainType.toLowerCase().includes('ribosom') ||\n    domainType.toLowerCase().includes('ribonuclease')\n  ) {\n    return [darkGreen, darkGreenLine];\n  } else if (\n    domainType.includes('lectin') ||\n    domainType.includes('recognition') ||\n    domainType.toLowerCase().includes('solute carrier') ||\n    domainType.includes('isomerase') ||\n    domainType === 'Clathrin-H-link'\n  ) {\n    return [veryLightPurple, veryLightPurpleLine];\n  } else if (\n    domainType.startsWith('von Willebrand factor') ||\n    domainType.endsWith('receptor-binding') ||\n    domainType.toLowerCase().includes('link') ||\n    domainType.includes('basic domain') ||\n\n    domainType.includes('interacting') ||\n\n    domainType.includes('domain IV') || // e.g. EEF2\n\n    domainType.toLowerCase().includes('immunoglobulin domain')\n  ) {\n    return [purple, purpleLine];\n  } else if (\n    domainType.includes('transferase') ||\n    domainType.includes('merisation')\n  ) {\n    return [pink, pinkLine];\n  } else if (\n    domainType.includes('oxygenase')\n  ) {\n    return [red, redLine];\n  } else if (\n    domainType.includes('phosphatase') ||\n    domainType.includes('RNA polymerase') ||\n    domainType.includes('catenin') // e.g. VCL\n  ) {\n    return [seafoam, seafoamLine];\n  } else if (\n    domainType.includes('bind') ||\n    domainType.includes('EF')\n  ) {\n    return [blue, blueLine];\n  } else if (\n    // C-terminal regions are typically colored red in e.g. PyMol rainbow\n    domainType.includes('C-termin') ||\n    domainType.includes('C termin') ||\n    domainType.includes('kinase')\n  ) {\n    return [faintRed, faintRedLine];\n  } else if (\n    // N-terminal regions are typically colored blue in e.g. PyMol rainbow\n    domainType.includes('N-termin') ||\n    domainType.includes('N-teminal') || // Typo in \"CTNNB1 binding, N-teminal\"\n    domainType.includes('N termin') ||\n    domainType.toLowerCase().includes('decarboxylase') ||\n    domainType.toLowerCase().includes('hydrolase') ||\n    domainType.includes('PH domain') ||\n    domainType.includes('cytosolic') ||\n    domainType.toLowerCase().includes('homeobox')\n  ) {\n    return [lightBlue, lightBlueLine];\n  }\n\n  return [lightGrey, lightGreyLine];\n}\n","/**\n * @fileoverview Functions to render 2D protein structure, i.e. linear domains\n *\n * The protein diagrams are shown in the Gene Leads tooltip.\n */\n\nimport {addPositions, getGeneFromStructureName, pipe} from './gene-structure';\nimport {getColors} from './protein-color';\n\n/** Get subtle line to visually demarcate feature boundary */\nfunction getFeatureBorderLines(\n  x, y, width, baseHeight, lineColor, addTopBottom=false\n) {\n  const height = y + baseHeight;\n  const lineStroke = `stroke=\"${lineColor}\"`;\n  const leftLineAttrs =\n    `x1=\"${x}\" x2=\"${x}\" y1=\"${y}\" y2=\"${height}\" ${lineStroke}`;\n\n  const x2 = x + width;\n  const rightLineAttrs =\n    `x1=\"${x2}\" x2=\"${x2}\" y1=\"${y}\" y2=\"${height}\" ${lineStroke}`;\n\n  const startBorder = `<line class=\"subpart-line\" ${leftLineAttrs} />`;\n  const endBorder = `<line class=\"subpart-line\" ${rightLineAttrs} />`;\n\n  // Added to feature if any part of protein has topology data\n  let topBorder = '';\n  let bottomBorder = '';\n  if (addTopBottom) {\n    const topLineAttrs =\n      `x1=\"${x}\" x2=\"${x2}\" y1=\"${y}\" y2=\"${y}\" ${lineStroke}`;\n    const bottomLineAttrs =\n      `x1=\"${x}\" x2=\"${x2}\" y1=\"${height}\" y2=\"${height}\" ${lineStroke}`;\n    topBorder = `<line class=\"subpart-line\" ${topLineAttrs} />`;\n    bottomBorder = `<line class=\"subpart-line\" ${bottomLineAttrs} />`;\n  }\n\n  return startBorder + endBorder + topBorder + bottomBorder;\n}\n\n/** Get start and length for coding sequence (CDS), in pixels and base pairs */\nfunction getCdsCoordinates(subparts, isPositiveStrand) {\n  // Test case: XRCC3 (-, multiple 5'-UTRs), RAD51D (big 3'-UTR)\n  if (!isPositiveStrand) subparts = subparts.slice().reverse();\n\n  // Start of CDS is end of last 5'-UTR, for default case (positive strand)\n  const startUtr = isPositiveStrand ? \"5'-UTR\" : \"3'-UTR\";\n  const lastStartUtr = subparts.filter(s => s[0] === startUtr).slice(-1)[0];\n  let startPx, startBp;\n  if (lastStartUtr) {\n    startPx = lastStartUtr[3].x + lastStartUtr[3].width;\n    startBp = lastStartUtr[1] + lastStartUtr[2];\n  } else {\n    // For transcipts without an annotated start UTR, e.g. EGFR-205\n    startPx = 0;\n    startBp = 0;\n  }\n\n  // End of CDS is start of first 3'-UTR, for default case\n  const endUtr = isPositiveStrand ? \"3'-UTR\" : \"5'-UTR\";\n  const firstEndUtr = subparts.filter(s => s[0] === endUtr).slice(-1)[0];\n  let stopPx, stopBp;\n  if (firstEndUtr) {\n    stopPx = firstEndUtr[3].x;\n    stopBp = firstEndUtr[1];\n  } else {\n    // For transcipts without an annotated last UTR, e.g. EGFR-205\n    const lastSubpart = subparts.slice(-1)[0];\n    stopPx = lastSubpart[3].x + lastSubpart[3].width;\n    stopBp = lastSubpart[1] + lastSubpart[2];\n  }\n\n  const lengthBp = stopBp - startBp;\n  const lengthPx = stopPx - startPx;\n\n  const cdsCoordinates = {\n    px: {start: startPx, length: lengthPx},\n    bp: {start: startBp, length: lengthBp}\n  };\n  return cdsCoordinates;\n}\n\nfunction isTopologyFeature(feature) {\n  return feature[0][0] === '_';\n}\n\nfunction isSignalPeptideFeature(feature) {\n  return feature[0] === 'S';\n}\n\nconst topologyFeatureMap = {\n  '_H': 'Helical',\n  '_E': 'Extracellular',\n  '_C': 'Cytoplasmic'\n};\nfunction decompressTopologyFeature(feature) {\n  if (feature in topologyFeatureMap) {\n    return topologyFeatureMap[feature];\n  } else {\n    return feature.slice(1);\n  }\n}\n\n/** Get SVG for an inidividual protein domain */\nfunction getFeatureSvg(feature, cds, isPositiveStrand, hasTopology) {\n  let featureType = feature[0];\n  const featurePx = feature[3];\n\n  let x = cds.px.start + featurePx.x;\n  let width = featurePx.width;\n  if (!isPositiveStrand) {\n    x = cds.px.length + cds.px.start - (featurePx.x + featurePx.width);\n  };\n\n  // Perhaps make these configurable, later\n  let y = 30;\n  let height = 14;\n  const isTopology = isTopologyFeature(feature);\n  const isSignal = isSignalPeptideFeature(feature);\n  let topoAttr = '';\n  if (hasTopology) {\n    y = 38;\n    if (isTopology) {\n      featureType = decompressTopologyFeature(feature[0]);\n      y = 30;\n      height = 30;\n\n      const featureDigest = `${feature[0]} ${feature[1]} ${feature[2]}`;\n\n      if (\n        // E.g. EGF-206 alternative isoform, C-terminal cytoplasmic domain\n        isPositiveStrand && featurePx.x + featurePx.width > cds.px.length + 3 ||\n\n        // E.g. SCARB1-201 canonical isoform, C-terminal cytoplasmic domain\n        !isPositiveStrand && featurePx.x + featurePx.width > cds.px.length + 3\n      ) {\n        console.debug(`Truncate protein topology feature: ${featureDigest}`);\n        width -= (featurePx.x + featurePx.width) - cds.px.length;\n        if (!isPositiveStrand) {\n          x += width;\n        }\n      }\n      topoAttr = 'data-topology=\"true\"';\n\n      if (width < 0) {\n        // E.g. LDLR-202 alternative isoform, multiple features\n        const issue = 'Width < 0, omit protein topology feature';\n        console.debug(`${issue}: ${featureDigest}`);\n        return '';\n      };\n    }\n  }\n\n  const [color, lineColor] = getColors(featureType);\n\n  if (isSignal) {\n    featureType = 'Signal peptide';\n    height = 8;\n    y += 3;\n  }\n\n  if (isTopology) {\n    if (featureType === 'Helical') {\n      featureType = 'Transmembrane';\n    } else if (featureType.startsWith('Helical --- Name=')) {\n      featureType = featureType.replace('Helical --- Name=', 'Transmembrane: ');\n    }\n  }\n\n  const lengthAa = `${feature[2]}&nbsp;aa`;\n  const title = `data-subpart=\"${featureType} ${pipe} ${lengthAa}\"`;\n  const data = title;\n\n  const pos = `x=\"${x}\" width=\"${width}\" y=\"${y}\" height=\"${height}\"`;\n  const topoCls = isTopology ? ' topology' : '';\n  const cls = `class=\"subpart domain${topoCls}\" `;\n\n  const addTopBottom = !isTopology;\n  const line =\n    getFeatureBorderLines(x, y, width, height, lineColor, addTopBottom);\n  const domainSvg =\n    `<rect ${cls} rx=\"1.5\" fill=\"${color}\" ${pos} ${data} ${topoAttr}/>` +\n    line;\n\n  return domainSvg;\n}\n\n/** Return whether protein SVG should be shown */\nfunction isEligibleforProteinSvg(gene, ideo) {\n  return (\n    ideo.config.showProteinInTooltip &&\n    !(\n      'proteinCache' in ideo === false ||\n      gene in ideo.proteinCache === false ||\n      ('spliceExons' in ideo === false || ideo.spliceExons === false)\n    )\n  );\n}\n\nfunction getProteinRect(cds, hasTopology) {\n  const y = hasTopology ? '43' : '35';\n  const fill = hasTopology ? 'BBB' : 'DDD';\n  const stroke = hasTopology ? '555' : '777';\n  const proteinRect =\n    `<rect class=\"_ideoProteinLine\"` +\n      `x=\"${cds.px.start}\" width=\"${cds.px.length}\" ` +\n      `y=\"${y}\" height=\"4\" ` +\n      `fill=\"#${fill}\" ` +\n      `stroke=\"#${stroke}\" ` +\n    `/>`;\n  return proteinRect;\n}\n\n/**\n * Determine if any protein isoforms for this gene have topology features\n *\n * Helps ensure transcripts can be rapidly navigated via arrows in dropdown\n * menu, even when some proteins of the gene have topology and some do not.\n *\n * Example: LDLR\n */\nexport function getHasTopology(gene, ideo) {\n  const hasTopology = ideo.proteinCache[gene]?.some(entry => {\n    return entry.protein.some(\n      feature => isTopologyFeature(feature)\n    );\n  });\n  return hasTopology;\n}\n\n/** Get SVG showing 2D protein features, e.g. domains from InterPro */\nexport function getProtein(\n  structureName, subparts, isPositiveStrand, hasTopology, ideo\n) {\n  let features = [];\n  const gene = getGeneFromStructureName(structureName, ideo);\n\n  const isEligible = isEligibleforProteinSvg(gene, ideo);\n  if (!isEligible) return ['<br/>', null];\n\n  const entry = ideo.proteinCache[gene].find(d => {\n    return d.transcriptName === structureName;\n  });\n  if (!entry) return ['<br/>', null];\n  const protein = entry.protein;\n  const cds = getCdsCoordinates(subparts, isPositiveStrand);\n\n  // Number of amino acids in protein\n  //\n  // Some principles of molecular biology:\n  //   - Coding sequence (CDS) of mRNA specifies amino acids comprising protein\n  //   - Each amino acid is specified by 3 nucleotides (i.e. codon; 3 nt / aa)\n  //   - 1 codon -- the stop codon -- is not part of protein\n  //\n  // TODO: account for phase\n  //\n  // const proteinLengthAa = Math.floor(cds.bp.length/3) - 1;\n  const proteinLengthAa = null;\n\n  const domains = addPositions(subparts, protein);\n\n  const topologies = [];\n  for (let i = 0; i < domains.length; i++) {\n    const domain = domains[i];\n    const isTopology = isTopologyFeature(domain);\n    const svg = getFeatureSvg(domain, cds, isPositiveStrand, hasTopology);\n    if (isTopology) {\n      topologies.push(svg);\n    } else {\n      features.push(svg);\n    }\n  }\n\n  // Order SVG so protein domains, sites, etc. are in front,\n  // then unannotated protein,\n  // then protein topology features\n  const proteinRect = getProteinRect(cds, hasTopology);\n  topologies.push(proteinRect);\n  features = topologies.concat(features);\n\n  const proteinSvg =\n    `<g id=\"_ideoProtein\">${features.join('')}</g>`;\n\n  return [proteinSvg, proteinLengthAa];\n}\n","import tippy, {hideAll} from 'tippy.js';\nimport {tippyCss, tippyLightCss} from './tippy-styles';\n// import 'tippy.js/themes/light.css';\n\nimport {d3} from '../lib';\nimport {getIcon} from '../annotations/legend';\nimport {getProtein, getHasTopology} from './protein';\n\nconst y = 5;\n\n// Subtle visual delimiter; separates horizontally adjacent fields in UI\nexport const pipe = `<span style='color: #CCC'>|</span>`;\n\nconst utr5 = \"5'-UTR\";\nconst utr3 = \"3'-UTR\";\n\nconst heights = {\n  \"5'-UTR\": 20,\n  'exon': 20,\n  'intron': 20,\n  \"3'-UTR\": 20\n};\n\nconst colors = {\n  \"5'-UTR\": '#155069',\n  'exon': '#DAA521',\n  \"intron\": '#FFFFFF00',\n  \"3'-UTR\": '#357089'\n};\n\nconst lineColors = {\n  \"5'-UTR\": '#70A099',\n  'exon': '#BA8501',\n  \"3'-UTR\": '#90C0B9'\n};\n\nconst subpartClasses = {\n  \"5'-UTR\": 'five-prime-utr',\n  'exon': 'exon',\n  \"3'-UTR\": 'three-prime-utr',\n  'intron': 'intron'\n};\n\nconst css =\n  `<style>\n  ._ideoGeneStructureContainerName {\n    position: relative;\n    left: 45px;\n    margin-right: 20px;\n  }\n  ._ideoGeneStructureContainerName.pre-mRNA {\n    left: 70px;\n    margin-right: 70px;\n  }\n  ._ideoGeneStructureContainer rect:hover + line {\n    visibility: hidden;\n  }\n  ._ideoGeneStructureContainer {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n  }\n  ._ideoGeneStructureContainer:hover ._ideoSpliceToggle {\n    visibility: visible;\n  }\n  ._ideoGeneStructureContainer ._ideoSpliceToggle {\n    visibility: hidden;\n  }\n  ._ideoSpliceToggle {\n    margin-left: 53px; background-color: #EEE;\n  }\n  ._ideoSpliceToggle.pre-mRNA {\n    margin-left: 43px; background-color: #F8F8F8;\n  }\n  ._ideoHoveredSubpart {\n    stroke: #D0D0DD !important; stroke-width: 3px;\n  }\n  #_ideoGeneStructureTip {\n    font-style: italic;\n  }\n\n  ${tippyCss}\n\n  .tippy-box {\n    font-size: 12px;\n  }\n\n  .tippy-content {\n    padding: 3px 7px;\n  }\n  </style>`;\n\nconst hoverTip = '<span id=\"_ideoGeneStructureTip\">Hover for details</span>';\n\n/** Get DOM element for gene structure footer */\nfunction getFooter() {\n  return document.querySelector('._ideoGeneStructureFooter');\n}\n\n/** Write transcript details below the diagram */\nfunction writeFooter(container) {\n  const footer = getFooter();\n  const svgDOM = container.querySelector('svg');\n  const transcriptSummary = svgDOM.getAttribute('data-ideo-footer');\n  footer.innerHTML = `&nbsp;<br/>${transcriptSummary}`;\n}\n\n/** Write newly-selected gene structure diagram, header, and footer */\nfunction updateGeneStructure(ideo, offset=0) {\n  const [structure, selectedIndex] = getSelectedStructure(ideo, offset);\n  const isCanonical = (selectedIndex === 0);\n  const menu = document.querySelector('#_ideoGeneStructureMenu');\n  menu.options[selectedIndex].selected = true;\n  const svg = getSvg(structure, ideo, ideo.spliceExons)[0];\n  const container = document.querySelector('._ideoGeneStructureSvgContainer');\n  container.innerHTML = svg;\n  updateHeader(ideo.spliceExons, isCanonical);\n  writeFooter(container);\n  ideo.addedSubpartListeners = false;\n  addHoverListeners(ideo);\n  initTippy(ideo);\n}\n\n/** Get gene symbol from transcript / gene structure name */\nexport function getGeneFromStructureName(structureName) {\n  const gene = structureName.split('-').slice(0, -1).join('-');\n  return gene;\n}\n\n/** Get name of transcript currently selected in menu */\nfunction getSelectedStructure(ideo, offset=0) {\n  let selectedIndex, structureName;\n\n  const menu = document.querySelector('#_ideoGeneStructureMenu');\n  if (!menu) {\n    const svg = document.querySelector('._ideoGeneStructure');\n    if (!svg) return null; // No gene structure is available, e.g. for miRNA\n    structureName = svg.getAttribute('data-ideo-gene-structure-name');\n    selectedIndex = 0;\n  } else {\n    const numOptions = menu.options.length;\n    const baseIndex = menu.selectedIndex;\n    selectedIndex = baseIndex + offset;\n    if (selectedIndex >= numOptions) {\n      selectedIndex = 0;\n    } else if (selectedIndex < 0) {\n      selectedIndex = numOptions - 1;\n    }\n    structureName = menu.options[selectedIndex].value;\n  }\n  const gene = getGeneFromStructureName(structureName);\n  const geneStructure =\n    ideo.geneStructureCache[gene].find(gs => gs.name === structureName);\n\n\n  return [geneStructure, selectedIndex];\n}\n\n/**\n * Add event listeners to the transcript menu:\n * - On click, block upstream listeners from closing tooltip\n * - On change, write newly selected gene structure\n */\nfunction addMenuListeners(ideo) {\n  const menuId = '_ideoGeneStructureMenu';\n  const container = document.querySelector('._ideoGeneStructureContainer');\n\n  // Don't search this gene if clicking to expand the menu\n  container.addEventListener('click', (event) => {\n    if (event.target.id === menuId) {\n      event.stopPropagation();\n    }\n\n    let svgMaybe = event.target;\n    if (svgMaybe.parentElement.tagName === 'svg') {\n      svgMaybe = svgMaybe.parentElement;\n    };\n\n    // Go to next transcript on clicking down arrow icon, previous on up\n    if (Array.from(svgMaybe.classList).includes('_ideoMenuArrow')) {\n      const menuArrow = svgMaybe;\n      const direction = menuArrow.getAttribute('data-dir');\n      const offset = direction === 'down' ? 1 : -1;\n      updateGeneStructure(ideo, offset);\n      event.stopPropagation();\n    }\n  });\n\n  // // Go to next transcript on pressing down arrow key, previous on up\n  // document.addEventListener('keydown', (event) => {\n  //   const key = event.key;\n  //   if (['ArrowDown', 'ArrowUp'].includes(key)) {\n  //     const offset = key === 'ArrowDown' ? 1 : -1;\n  //     updateGeneStructure(ideo, offset);\n  //   }\n  // });\n}\n\nfunction toggleSpliceByKeyboard(event) {\n  if (event.key === 's') {\n    const spliceToggle = document.querySelector('._ideoSpliceToggle input');\n    if (!spliceToggle) return;\n\n    const subpartText = document.querySelector('#_ideoSubpartText');\n    if (subpartText) subpartText.innerHTML = '&nbsp;';\n    spliceToggle.dispatchEvent(new MouseEvent('click'));\n  }\n}\n\n/** Listen for keydown and click on / change to splice toggle input */\nfunction addSpliceToggleListeners(ideo) {\n  document.addEventListener('keydown', toggleSpliceByKeyboard);\n\n  const container = document.querySelector('._ideoGeneStructureContainer');\n  const toggler = document.querySelector('._ideoSpliceToggle');\n\n  if (!container) return;\n\n  toggler.addEventListener('change', (event) => {\n    toggleSplice(ideo);\n    addHoverListeners(ideo);\n    event.stopPropagation();\n  });\n}\n\n/** Helper for keyboard navigation */\nfunction nextIsOutOfSubpartBounds(i, subparts, key) {\n  const isLeft = key === 'left';\n  return (\n    i === 0 && isLeft ||\n    i === subparts.length - 1 && !isLeft\n  );\n}\n\n/**\n * Swap genome-ordered subparts so they render with expected visual layering\n *\n * SVG elements render last-on-top, which often hides subparts UTRs at the\n * ends of transcripts when they're genomically ordered, as they are in e.g.\n * Ensembl.\n *\n * See also: swapUTRsBack\n */\nfunction swapUTRsForward(subparts, isPositiveStrand) {\n  const swappedSubparts = subparts.slice();\n\n  // Account for edge case in certain nonsense-mediated-decay transcripts\n  const utr = isPositiveStrand ? utr3 : utr5;\n  const hasUtr = subparts.some(subpart => subpart[0] === utr);\n\n  subparts.forEach((subpart, i) => {\n    if (i === 0) return;\n    const prevSubpart = subparts[i - 1];\n\n    const prevIsUtr3 = prevSubpart[0] === utr3;\n    const prevIsUtr5 = prevSubpart[0] === utr5;\n    const isExon = subpart[0] === 'exon';\n\n    if (\n      isExon && hasUtr && (\n        (\n          !isPositiveStrand && prevIsUtr3 ||\n          isPositiveStrand && prevIsUtr5\n        ) && (\n          // Account for splice toggle in multi-part UTRs, as in e.g.\n          // canonicals for FAM111B and SCARB1, and alternative MAOA-204\n          subpart[1] !== prevSubpart[1] + prevSubpart[2] - 1 &&\n          prevSubpart[2] !== 2 // Handle canonicals for RAD51 and RAD51B\n        )\n      )\n    ) {\n      swappedSubparts[i] = prevSubpart;\n      swappedSubparts[i - 1] = subpart;\n    }\n  });\n\n  return swappedSubparts;\n}\n\nwindow.swapUTRsForward = swapUTRsForward;\n\nfunction is(element, cls) {\n  return element.classList.contains(cls);\n}\n\n// isExon && (\n//   !isPositiveStrand && prevIsUtr3 ||\n//   isPositiveStrand && prevIsUtr5\n// )\n\nfunction shouldSwapBackDOM(subpart, nextSubpart, isPositiveStrand, hasUtr) {\n  const utr5 = 'five-prime-utr';\n  const utr3 = 'three-prime-utr';\n  const nextIsUtr5 = is(nextSubpart, utr5);\n  const nextIsUtr3 = is(nextSubpart, utr3);\n  const isNotUtr3 = !is(subpart, utr3);\n  const isNotUtr5 = !is(subpart, utr5);\n  return (\n    hasUtr && (\n      !isPositiveStrand && nextIsUtr3 && isNotUtr3 ||\n      isPositiveStrand && nextIsUtr5 && isNotUtr5\n    )\n  );\n}\n\nfunction shouldSwapBackData(subpart, nextSubpart, isPositiveStrand, hasUtr) {\n  const nextIsUtr5 = nextSubpart[0] === utr5;\n  const nextIsUtr3 = nextSubpart[0] === utr3;\n  const isNotUtr3 = subpart[0] !== utr3;\n  const isNotUtr5 = subpart[0] !== utr5;\n  return (\n    hasUtr && (\n      !isPositiveStrand && nextIsUtr3 && isNotUtr3 ||\n      isPositiveStrand && nextIsUtr5 && isNotUtr5\n    )\n  );\n}\n\n/**\n * Restore SVG subparts to genome order, for proper keyboard navigation\n *\n * See also: swapUTRsForward\n */\nfunction swapUTRsBack(subparts, isPositiveStrand) {\n  const swappedSubparts = subparts.slice();\n  const isRaw = Array.isArray(subparts[0]);\n\n  // Account for edge case in animating exon splice for\n  // nonsense-mediated-decay transcripts that lack an annotated UTR,\n  // e.g. SREBF-204\n  let hasUtr;\n  if (isRaw) {\n    const utr = isPositiveStrand ? utr3 : utr5;\n    hasUtr = subparts.some(subpart => subpart[0] === utr);\n  } else {\n    const utr5 = 'five-prime-utr';\n    const utr3 = 'three-prime-utr';\n    const utr = isPositiveStrand ? utr3 : utr5;\n    hasUtr = subparts.some(subpart => is(subpart, utr));\n  }\n\n  subparts.forEach((subpart, i) => {\n    if (i === swappedSubparts.length - 1) return;\n    const nextSubpart = subparts[i + 1];\n    const shouldSwapBackFn = isRaw ? shouldSwapBackData : shouldSwapBackDOM;\n    const shouldSwapBack =\n      shouldSwapBackFn(subpart, nextSubpart, isPositiveStrand, hasUtr);\n    if (shouldSwapBack) {\n      swappedSubparts.splice(i, 1, nextSubpart);\n      swappedSubparts.splice(i + 1, 1, subpart);\n    }\n  });\n  return swappedSubparts;\n}\n\n/**\n * Remove any hover stroke outlines, for subpart highlight edge cases like\n * mouseenter in subpart A while distant subpart B is navigated\n */\nfunction removeHighlights() {\n  const cls = '_ideoHoveredSubpart';\n  const hovereds = document.querySelectorAll(`.${cls}`);\n  hovereds.forEach(el => el.classList.remove(cls));\n}\n\n\n/** Go to previous subpart on left arrow; next on right */\nfunction navigateSubparts(event) {\n  const domSubparts = Array.from(document.querySelectorAll('rect.subpart'));\n\n  const structure = document.querySelector('._ideoGeneStructure');\n  const strand = structure.getAttribute('data-ideo-strand');\n  const isPositiveStrand = strand === '+';\n\n  const subparts = swapUTRsBack(domSubparts, isPositiveStrand);\n\n  if (subparts.length === 0) return; // E.g. paralog neighborhoods, lncRNA\n  const cls = '_ideoHoveredSubpart';\n  const subpart = document.querySelector(`.${cls}`);\n  if (!subpart) {\n    // Accounts for edge case when changing transcripts via menu\n    event.stopPropagation();\n    event.preventDefault();\n    return;\n  }\n  let i;\n  subparts.forEach((el, index) => {\n    if (el.classList.contains(cls)) {\n      i = index;\n    }\n  });\n\n  const options = {view: window, bubbles: false, cancelable: true};\n  const mouseEnter = new MouseEvent('mouseenter', options);\n  const mouseLeave = new MouseEvent('mouseleave', options);\n\n  // Account for strand, so left key always goes left; right always right\n  const left = isPositiveStrand ? 'ArrowLeft' : 'ArrowRight';\n  const right = isPositiveStrand ? 'ArrowRight' : 'ArrowLeft';\n  let key;\n  if (event.key === left) {\n    key = 'left';\n  } else if (event.key === right) {\n    key = 'right';\n  }\n\n  // Don't fall off the end\n  if (\n    typeof key === 'undefined' ||\n    nextIsOutOfSubpartBounds(i, subparts, key)\n  ) {\n    event.stopPropagation();\n    event.preventDefault();\n    return;\n  }\n\n  removeHighlights();\n  const alt = event.altKey;\n  const meta = event.metaKey;\n\n  // Jump forward or back by 1, 10, or all subparts\n  if (event.key === left) { // Jump back\n    subpart.dispatchEvent(mouseLeave);\n    let index = i - 1;\n    if (alt) index = i - 10 < 0 ? 0 : i - 10;\n    if (meta) index = 0;\n    const prevSubpart = subparts[index];\n    prevSubpart.dispatchEvent(mouseEnter);\n  } else if (event.key === right) { // Jump forward\n    subpart.dispatchEvent(mouseLeave);\n    const last = subparts.length - 1;\n    let index = i + 1;\n    if (alt) index = i + 10 > last ? last : i + 10;\n    if (meta) index = last;\n    const nextSubpart = subparts[index];\n    nextSubpart.dispatchEvent(mouseEnter);\n  }\n  event.stopPropagation();\n  event.preventDefault();\n}\n\nfunction getMenuContainer() {\n  return document.querySelector('#_ideoGeneStructureMenuContainer');\n}\n\nfunction updateFooter(content, ideo) {\n  const footer = getFooter();\n  footer.innerHTML = content;\n  initTippy(ideo);\n}\n\nfunction addSubpartHoverListener(subpartDOM, ideo) {\n  const subpart = subpartDOM;\n\n  // On hovering over subpart, highlight it and show details\n  subpart.addEventListener('mouseenter', event => {\n    removeHighlights();\n    // Highlight hovered subpart, adding an aura around it\n    event.target.classList.add('_ideoHoveredSubpart');\n    // Show details\n    const footer = getFooter();\n    ideo.originalTooltipFooter = footer.innerHTML;\n    const subpartText = subpart.getAttribute('data-subpart');\n    const trimmedFoot = footer.innerHTML.replace('&nbsp;', '');\n    const style = 'style=\"margin-bottom: -10px; max-width: 260px;\"';\n    const id = 'id=\"_ideoSubpartText\"';\n    const content = `<div ${id} ${style}\">${subpartText}</div>${trimmedFoot}`;\n    updateFooter(content, ideo);\n    const menuContainer = getMenuContainer();\n    if (menuContainer) menuContainer.style.marginTop = '';\n  });\n\n  // On hovering out, de-highlight and hide details\n  subpart.addEventListener('mouseleave', event => {\n    event.target.classList.remove('_ideoHoveredSubpart');\n    updateFooter(ideo.originalTooltipFooter, ideo);\n    const menuContainer = getMenuContainer();\n    if (menuContainer) menuContainer.style.marginTop = '4px';\n  });\n}\n\n/** Did the mouse event occur inside the tooltip area? */\nfunction isMouseEventInTooltip(event) {\n  const tooltip = document.querySelector('._ideogramTooltip');\n  const box = tooltip.getBoundingClientRect();\n  const x = event.screenX;\n  const y = event.screenY;\n  const inTooltip =\n    (x > box.left && x < box.right && y > box.top && y < box.bottom);\n  return inTooltip;\n}\n\n/**\n * Add handlers for hover events in transcript container and beneath, e.g.:\n *\n * - Show transcript details on hovering near transcript\n * - Show subpart (i.e. exon, 3'-UTR, 5'-UTR) details on hovering over subpart\n * - Highlight subpart on hovering over subpart\n * - Navigate to previous or next subpart on pressing left or right arrow keys\n */\nfunction addHoverListeners(ideo) {\n\n  const subparts = document.querySelectorAll('rect.subpart');\n  if (subparts.length === 0) return; // E.g. paralog neighborhoods, lncRNA\n\n  ideo.subparts = subparts;\n\n  const container = document.querySelector('._ideoGeneStructureContainer');\n\n  container.addEventListener('mouseenter', () => {\n    document.addEventListener('keydown', navigateSubparts);\n    if (ideo.addedMenuListeners) return;\n    ideo.addedMenuListeners = true;\n    writeFooter(container);\n\n    // Listen for change of selected option in transcript menu\n    const tooltip = document.querySelector('._ideogramTooltip');\n    tooltip.addEventListener('change', () => {\n      updateGeneStructure(ideo);\n\n      // Without this, selecting a new transcript will close the tooltip if\n      // the selected <option> screen position is outside the tooltip (as\n      // is often the case in genes with many transcripts, like TP53).\n      ideo.oneTimeDelayTooltipHideMs = 2000; // wait 2.0 s instead of 0.25 s\n    });\n\n    if (ideo.tissueCache) {\n      const tooltipFooter = document.querySelector('._ideoTooltipFooter');\n      tooltipFooter.style.display = 'none';\n    }\n  });\n  container.addEventListener('mouseleave', (event) => {\n    ideo.oneTimeDelayTooltipHideMs = 2000; // See \"Without this...\" note above\n\n    if (ideo.tissueCache) {\n      const tooltipFooter = document.querySelector('._ideoTooltipFooter');\n      tooltipFooter.style.display = '';\n    }\n\n    const inTooltip = isMouseEventInTooltip(event);\n    if (inTooltip === true) {\n      // Only remove transcript footer if `mouseleave` event is from footer to\n      // another part of the tooltip.  If `mouseleave`-ing from footer to\n      // *outside* the tooltip -- e.g. when selecting a new transcript as in\n      // the \"Without this...\" scenario noted above -- then do not remove the\n      // footer.  This lets users always see the details in the footer for the\n      // transcript they just selected, rather than having the details\n      // frustratingly disappear immediately upon transcript selection.\n\n      updateFooter(hoverTip, ideo);\n    }\n\n\n    ideo.addedMenuListeners = false;\n    document.removeEventListener('keydown', navigateSubparts);\n  });\n\n  if (ideo.addedSubpartListeners) return;\n  ideo.addedSubpartListeners = true;\n\n  subparts.forEach(subpart => {\n    addSubpartHoverListener(subpart, ideo);\n  });\n}\n\nfunction writeStrandInFooter(ideo) {\n  const strand = getSelectedStructure(ideo)[0].strand;\n  if (strand === '+') return; // Don't remark if strand is the default\n  const tooltipFooter = document.querySelector('._ideoTooltipFooter');\n  tooltipFooter.innerText =\n    tooltipFooter.innerText.replace(')', `, ${strand})`);\n}\n\nfunction getTippyConfig(fallbackPlacements) {\n  return {\n    theme: 'light-border',\n    popperOptions: { // Docs: https://atomiks.github.io/tippyjs/v6/all-props/#popperoptions\n      modifiers: [ // Docs: https://popper.js.org/docs/v2/modifiers\n        {\n          name: 'flip',\n          options: {\n            fallbackPlacements // Defined via argument to this function\n          }\n        }\n      ]\n    },\n    onShow: function() {\n      // Ensure only 1 tippy tooltip is displayed at a time\n      document.querySelectorAll('[data-tippy-root]')\n        .forEach(tippyNode => tippyNode.remove());\n    }\n  };\n}\n\nfunction initTippy(ideo) {\n  const toggle = getTippyConfig(['top-start', 'top']);\n  ideo.tippy = tippy('._ideoSpliceToggle[data-tippy-content]', toggle);\n\n  const arrow = getTippyConfig(['bottom']);\n  arrow.popperOptions.modifiers.push({\n    name: 'offset',\n    options: {\n      offset: [-5, 20]\n    }\n  });\n  const updownTips = tippy('._ideoMenuArrow[data-tippy-content]', arrow);\n  ideo.tippy = ideo.tippy.concat(updownTips);\n}\n\nexport function addGeneStructureListeners(ideo) {\n  const structure = getSelectedStructure(ideo);\n  if (structure === null) return; // Bail for e.g. miRNA\n  addSpliceToggleListeners(ideo);\n  addHoverListeners(ideo);\n  addMenuListeners(ideo);\n  writeStrandInFooter(ideo);\n  initTippy(ideo);\n}\n\nfunction getSpliceToggleHoverTitle(spliceExons) {\n  return spliceExons ? 'Unsplice exons (s)' : 'Splice exons (s)';\n}\n\nfunction getSpliceToggle(ideo) {\n  const spliceExons = ideo.spliceExons;\n  const modifier = spliceExons ? '' : 'pre-';\n  const cls = `class=\"_ideoSpliceToggle ${modifier}mRNA\"`;\n  const checked = spliceExons ? 'checked' : '';\n  const text = getSpliceToggleHoverTitle(spliceExons);\n  const tPlace = 'data-tippy-placement=\"right\"';\n  const title = `data-tippy-content=\"${text}\" ${tPlace}`;\n  const inputAttrs =\n    `type=\"checkbox\" ${checked} ` +\n    `style=\"display: none;\"`;\n  const style =\n    'style=\"position: relative; top: -10px; ' +\n    'user-select: none; ' + // Prevent distracting highlight on quick toggle\n    'float: right; cursor: pointer; font-size: 16px; ' +\n    'padding: 2px 4px; border: 1px solid #CCC; border-radius: 3px;\"';\n  const attrs = `${cls} ${style} ${title}`;\n\n  // Scissors icon\n  const label = `<label ${attrs}><input ${inputAttrs} />&#x2702;</label>`;\n  return label;\n}\n\n/** Splice exons in transcript, removing introns; add positions */\nfunction spliceOut(subparts) {\n  const splicedSubparts = [];\n  let prevEnd = 0;\n  let prevStart = 0;\n  for (let i = 0; i < subparts.length; i++) {\n    const subpart = subparts[i];\n    const [subpartType, start, length] = subpart;\n    const isSpliceOverlap = start === prevStart;\n    let prevRawStart, prevRawLength;\n    if (i > 0) {\n      [, prevRawStart, prevRawLength] = subparts[i - 1];\n    }\n\n    // e.g. 5'-UTRs of OXTR\n    const isOtherOverlap = i > 0 && start === prevRawStart;\n\n    // e.g. 3'-UTR of LDLR, or 3'-UTR of CD44\n    const isOther3UTROverlap = i > 0 && start <= prevRawStart + prevRawLength;\n\n    let splicedStart;\n    if (isSpliceOverlap) {\n      splicedStart = start;\n    } else if (isOtherOverlap) {\n      // e.g. 5'-UTRs of OXTR\n      splicedStart = prevStart;\n    } else if (isOther3UTROverlap) {\n      splicedStart = prevStart + prevRawLength - length;\n    } else {\n      splicedStart = prevEnd;\n    }\n    const splicedEnd = splicedStart + length;\n    const splicedSubpart = [subpartType, splicedStart, length + 1];\n    splicedSubparts.push(splicedSubpart);\n    prevEnd = splicedEnd;\n    prevStart = splicedStart;\n  }\n  const splicedPositionedSubparts = addPositions(splicedSubparts);\n  return splicedPositionedSubparts;\n}\n\n/** Insert introns to transcript; add positions */\nfunction spliceIn(subparts) {\n  const splicedSubparts = [];\n  let prevEnd = 0;\n  for (let i = 0; i < subparts.length; i++) {\n    const subpart = subparts[i];\n    const [start, length] = subpart.slice(1);\n    if (start > prevEnd) {\n      const intronStart = prevEnd;\n      const intronLength = start - prevEnd - 1;\n      splicedSubparts.push(['intron', intronStart, intronLength]);\n    }\n    prevEnd = start + length;\n    splicedSubparts.push(subpart);\n  }\n  const splicedPositionedSubparts = addPositions(splicedSubparts);\n  return splicedPositionedSubparts;\n}\n\nfunction getSpliceStateText(spliceExons, isCanonical=true) {\n  let modifier = '';\n  let suffix = ' and protein';\n  let titleMod = 'without';\n  if (!spliceExons) {\n    modifier = 'pre-';\n    suffix = '';\n    titleMod = 'with';\n  }\n  const canonOrAlt = isCanonical ? 'Canonical' : 'Alternative';\n  const title = `${canonOrAlt} transcript per Ensembl, ${titleMod} introns`;\n  const name = `${canonOrAlt} ${modifier}mRNA ${suffix}`;\n  return {title, name};\n}\n\n/** Draw introns in initial splice toggle from mRNA to pre-mRNA */\nfunction drawIntrons(prelimSubparts, matureSubparts, ideo) {\n  // Hypothetical example data, in shorthand\n  // pres = [u5_1, e1, i1, e2, i2, e3, i3, e4, i4, e5, i5, e6, u3_1]\n  // mats = [u5_1, e1, e2, e3, e4, e5, e6, u3_1]\n\n  let numInserted = 0;\n  const subpartEls = document.querySelectorAll('.subpart');\n  prelimSubparts.forEach((prelimSubpart, i) => {\n    const matureIndex = i - numInserted;\n    const matureSubpart = matureSubparts[matureIndex];\n    if (matureSubpart[0] !== prelimSubpart[0]) {\n      const summary = prelimSubpart[3].summary;\n      const otherAttrs = `y=\"${y}\" height=\"20\" fill=\"#FFFFFF00\" ${summary}`;\n      const intronRect =\n        `<rect class=\"subpart intron\" ${otherAttrs} />`;\n      subpartEls[matureIndex].insertAdjacentHTML('beforebegin', intronRect);\n      numInserted += 1;\n    }\n  });\n\n  document.querySelectorAll('.intron').forEach(subpartDOM => {\n    addSubpartHoverListener(subpartDOM, ideo);\n  });\n}\n\nfunction updateHeader(spliceExons, isCanonical) {\n  // Update title for gene structure diagram\n  const nameDOM =\n  document.querySelector('._ideoGeneStructureContainerName');\n  const toggleDOM = document.querySelector('._ideoSpliceToggle');\n\n  if (nameDOM && toggleDOM) {\n    [nameDOM, toggleDOM].forEach(el => el.classList.remove('pre-mRNA'));\n    if (!spliceExons) {\n      [nameDOM, toggleDOM].forEach(el => el.classList.add('pre-mRNA'));\n    }\n    const {title, name} = getSpliceStateText(spliceExons, isCanonical);\n    nameDOM.textContent = name;\n    nameDOM.title = title;\n  }\n}\n\nfunction toggleSplice(ideo) {\n  ideo.spliceExons = !ideo.spliceExons;\n  const spliceExons = ideo.spliceExons;\n  const [structure, selectedIndex] = getSelectedStructure(ideo);\n  const isCanonical = (selectedIndex === 0);\n  const [, prelimSubparts, matureSubparts] =\n    getSvg(structure, ideo, spliceExons);\n  const proteinSvg = document.querySelector('#_ideoProtein');\n\n  if (proteinSvg && !spliceExons) proteinSvg.style.display = 'none';\n\n  const addedIntrons = document.querySelectorAll('.intron').length > 0;\n  if (!spliceExons && !addedIntrons) {\n    drawIntrons(prelimSubparts, matureSubparts, ideo);\n  } else {\n    document.querySelectorAll('.intron').forEach(el => el.remove());\n  }\n  document.querySelectorAll('.subpart-line.rna').forEach(el => el.remove());\n\n  const subparts = spliceExons ? matureSubparts : prelimSubparts;\n\n  d3.select('._ideoGeneStructure').selectAll('.subpart')\n    .data(subparts)\n    .transition()\n    .duration(750)\n    .attr('x', (d, i) => subparts[i][3].x)\n    .attr('width', (d, i) => subparts[i][3].width)\n    .on('end', (d, i) => {\n      if (i !== subparts.length - 1) return;\n      if (proteinSvg && spliceExons) proteinSvg.style.display = '';\n\n      // Restore subpart boundary lines\n      const subpartDOMs = document.querySelectorAll('.subpart:not(.domain)');\n      subpartDOMs.forEach((subpartDOM, i) => {\n        const subpart = subparts[i];\n        const line = getSubpartBorderLine(subpart);\n        subpartDOM.insertAdjacentHTML('afterend', line);\n      });\n\n      updateHeader(spliceExons, isCanonical);\n\n      const tlbpDOM = document.querySelector('#_ideoTranscriptLengthBp');\n      if (!tlbpDOM) return;\n      const transcriptLengthBp = getTranscriptLengthBp(subparts, spliceExons);\n      const prettyLength = transcriptLengthBp.toLocaleString();\n      tlbpDOM.innerText = `${prettyLength} bp`;\n\n      ideo.tippy[0].show();\n    });\n}\n\nfunction getTranscriptLengthBp(subparts, spliceExons=false) {\n  const exons = subparts.filter(sp => sp[0] === 'exon');\n  if (spliceExons) subparts = exons;\n\n  const lastSubpart = subparts.slice(-1)[0];\n  const lastStart = lastSubpart[1];\n  const lastLength = lastSubpart[2];\n  const exonFill = spliceExons ? exons.length - 1 : 0;\n\n  const transcriptLengthBp = lastStart + lastLength + exonFill;\n  return transcriptLengthBp;\n}\n\n/** Merge feature type, pixel-x position, and pixel width to each feature */\nexport function addPositions(subparts, domains=null) {\n  const transcriptLengthPx = 250;\n\n  const totalLengthBp = getTranscriptLengthBp(subparts);\n\n  const factor = domains ? 3 : 1; // 3 nt per aa\n  const bpPerPx = (totalLengthBp / transcriptLengthPx) / factor;\n\n  const features = domains ?? subparts;\n\n  for (let i = 0; i < features.length; i++) {\n    const feature = features[i];\n    if (feature.length !== 3) continue;\n    // Define subpart position, tooltip footer\n    const lengthBp = feature[2];\n    const x = feature[1] / bpPerPx;\n    const width = lengthBp / bpPerPx;\n    const type = feature[0];\n\n    features[i].push({type, x, width});\n  }\n\n  return features;\n}\n\n/** Get text shown below diagram upon hovering over an exon, intron, or UTR */\nfunction getSubpartSummary(subpartType, total, index, strand, lengthBp) {\n  if (strand === '-') index = total - index + 1;\n  const numOfTotal = total > 1 ? `${index} of ${total} ` : '';\n  const prettyType = subpartType[0].toUpperCase() + subpartType.slice(1);\n  const prettyLength = lengthBp.toLocaleString();\n  const html = `${prettyType} ${numOfTotal}${pipe} ${prettyLength} bp`;\n  const summary = `data-subpart=\"${html}\"`;\n  return summary;\n}\n\n/** Get subtle line to visually demarcate subpart boundary */\nfunction getSubpartBorderLine(subpart) {\n  const subpartType = subpart[0];\n  // Define subpart border\n  const x = subpart[3].x;\n  const height = heights[subpartType];\n  const lineHeight = y + height;\n  const lineStroke = `stroke=\"${lineColors[subpartType]}\"`;\n  const lineAttrs = // \"\";\n    `x1=\"${x}\" x2=\"${x}\" y1=\"${y}\" y2=\"${lineHeight}\" ${lineStroke}`;\n  return `<line class=\"subpart-line rna\" ${lineAttrs} />`;\n}\n\n// function getSvgList(gene, ideo, spliceExons=false) {\n//   if (\n//     'geneStructureCache' in ideo === false ||\n//     gene in ideo.geneStructureCache === false\n//   ) {\n//     return [null];\n//   }\n\n//   const svgList = ideo.geneStructureCache[gene].map(geneStructure => {\n//     return getSvg(geneStructure, ideo, spliceExons);\n//   });\n\n//   return svgList;\n// }\n\n/** Get SVG, and prelimnary and mature subparts for given gene structure */\nfunction getSvg(geneStructure, ideo, spliceExons=false) {\n  const strand = geneStructure.strand;\n\n  const rawSubparts = geneStructure.subparts;\n  let subparts;\n\n  // Add pixel coordinates to subparts, and pre-mRNA and mRNA sets\n  let prelimSubparts = spliceIn(rawSubparts);\n  let matureSubparts = spliceOut(rawSubparts);\n  if (spliceExons) {\n    subparts = matureSubparts;\n  } else {\n    subparts = prelimSubparts;\n  }\n\n  const spliceToggle = document.querySelector('._ideoSpliceToggle');\n  if (spliceToggle) {\n    const title = getSpliceToggleHoverTitle(spliceExons);\n    spliceToggle.setAttribute('data-tippy-placement', 'right');\n    // spliceToggle.setAttribute('data-tippy-placement-fallback', 'top-end');\n    spliceToggle.setAttribute('data-tippy-content', title);\n    initTippy(ideo);\n  }\n\n  const featureLengthPx = 250 - 2; // Snip to avoid overextending\n\n  const intronHeight = 1;\n  const intronColor = 'black';\n  const geneStructureArray = [];\n\n  const intronPosAttrs =\n    `x=\"0\" width=\"${featureLengthPx}\" y=\"${y + 10}\" height=\"${intronHeight}\"`;\n  const intronRect =\n    `<rect fill=\"black\" ${intronPosAttrs}/>`;\n\n  geneStructureArray.push(intronRect);\n\n  // Set up counters for e.g. \"Exon 2 of 4\" (\"<subpart> <num> of <total>\")\n  const indexBySubpart = {\n    \"5'-UTR\": 0,\n    'exon': 0,\n    'intron': 0,\n    \"3'-UTR\": 0\n  };\n  const totalBySubpart = {\n    \"5'-UTR\": 0,\n    'exon': 0,\n    'intron': 0,\n    \"3'-UTR\": 0\n  };\n\n  const isPositiveStrand = strand === '+';\n  subparts = swapUTRsForward(subparts, isPositiveStrand);\n\n  prelimSubparts = swapUTRsForward(prelimSubparts, isPositiveStrand);\n  matureSubparts = swapUTRsForward(matureSubparts, isPositiveStrand);\n\n  // Container for positional data: x, width\n  // const prelimPositions = getPositions(prelimSubparts);\n  // const maturePositions = getPositions(matureSubparts);\n\n  // matureSubparts = matureSubparts.filter(p => p[0] !== 'intron');\n  // const positions = spliceExons ? trimmedMatures : prelimPositions;\n\n  // Get counts for e.g. \"4\" in \"Exon 2 of 4\"\n  for (let i = 0; i < subparts.length; i++) {\n    const subpart = subparts[i];\n    const subpartType = subpart[0];\n    if (subpartType in totalBySubpart) {\n      totalBySubpart[subpartType] += 1;\n    }\n  }\n\n  for (let i = 0; i < subparts.length; i++) {\n    const subpart = subparts[i];\n    // const position = positions[i];\n    const subpartType = subpart[0];\n    let color = intronColor;\n    if (subpartType in colors) {\n      color = colors[subpartType];\n    }\n\n    const height = heights[subpartType];\n\n    // Define subpart position, tooltip footer\n    const lengthBp = subpart[2];\n    const x = subpart[3].x;\n    const width = subpart[3].width;\n\n    const pos = `x=\"${x}\" width=\"${width}\" y=\"${y}\" height=\"${height}\"`;\n    const cls = `class=\"subpart ${subpartClasses[subpartType]}\" `;\n\n    // TODO: Handle introns better, refine CDS vs. UTR in exons\n    const total = totalBySubpart[subpartType];\n    indexBySubpart[subpartType] += 1;\n    const subpartIndex = indexBySubpart[subpartType];\n    const summary =\n      getSubpartSummary(subpartType, total, subpartIndex, strand, lengthBp);\n    if (!spliceExons) {\n      prelimSubparts[i][3].summary = summary;\n    } else if (subpartType !== 'intron') {\n      matureSubparts[i][3].summary = summary;\n    }\n\n    const subpartSvg = (\n      `<rect ${cls} rx=\"1.5\" fill=\"${color}\" ${pos} ${summary}/>` +\n      getSubpartBorderLine(subpart)\n    );\n    geneStructureArray.push(subpartSvg);\n  }\n\n  const sharedStyle =\n    'position: relative; width: 274px; margin: auto;';\n  let transform = `style=\"${sharedStyle} left: 10px;\"`;\n  if (strand === '-') {\n    transform =\n      'transform=\"scale(-1 1)\" ' +\n      `style=\"${sharedStyle} left: -10px;\"`;\n  }\n\n  const structureName = geneStructure.name;\n  const gene = getGeneFromStructureName(structureName);\n  const menu = getMenu(gene, ideo, structureName).replaceAll('\"', '\\'');\n\n  const hasTopology = getHasTopology(gene, ideo);\n\n  const [proteinSvg, proteinLengthAa] =\n    getProtein(structureName, subparts, isPositiveStrand, hasTopology, ideo);\n\n  const transcriptLengthBp = getTranscriptLengthBp(subparts, spliceExons);\n  const prettyLength = transcriptLengthBp.toLocaleString();\n\n  const footerDetails = [\n    `${totalBySubpart['exon']} exons`,\n    `<span id='_ideoTranscriptLengthBp'>${prettyLength} bp</span> `\n  ];\n\n  // Note protein length in amino acids (aa)\n  // TODO: This is a no-op; see note about phase in protein.js\n  if (proteinLengthAa) {\n    const prettyLengthAa = proteinLengthAa.toLocaleString();\n    footerDetails.push(\n      `<span id='_ideoProteinLengthAa'>${prettyLengthAa} aa</span> `\n    );\n  }\n\n  // Note if transcript is unusual type, e.g. nonsense mediated decay (NMD)\n  const biotypeText = geneStructure.biotype.replace(/_/g, ' ');\n  if (biotypeText !== 'protein coding') {\n    footerDetails.push(biotypeText);\n  }\n  const footerData = menu + footerDetails.join(` ${pipe} `);\n\n  let svgHeight = proteinSvg === '' ? '30' : '50';\n  if (hasTopology) svgHeight = '60';\n\n  const geneStructureSvg =\n    `<svg class=\"_ideoGeneStructure\" ` +\n      `data-ideo-gene-structure-name=\"${structureName}\" ` +\n      `data-ideo-strand=\"${strand}\" data-ideo-footer=\"${footerData}\" ` +\n      `width=\"${(featureLengthPx + 20)}\" height=\"${svgHeight}\" ${transform}` +\n    `>` +\n      geneStructureArray.join('') +\n      proteinSvg +\n    '</svg>';\n\n  return [geneStructureSvg, prelimSubparts, matureSubparts];\n}\n\n/** Get down and up arrows for one-click, carousel-like navigation for menu */\nfunction getMenuArrows() {\n\n  // Get attributes\n  const style =\n    'width: 12px; height: 12px; cursor: pointer;' +\n    'user-select: none;'; // Prevent distracting highlight on quick clicks\n  const downStyle = `style=\"${style}; margin-left: 5px;\"`;\n  const upStyle = `style=\"${style}; margin-left: 2px;\"`;\n  const cls = 'class=\"_ideoMenuArrow\"';\n  const tippyPlace = 'data-tippy-placement=\"bottom-start\"';\n  const downContent = 'Next transcript';\n  const downTippy = `data-tippy-content=\"${downContent}\" ${tippyPlace}`;\n  const upContent = 'Previous transcript';\n  const upTippy = `data-tippy-content=\"${upContent}\" ${tippyPlace}`;\n  const downAttrs = `${downStyle} ${cls} data-dir=\"down\" ${downTippy}`;\n  const upAttrs = `${upStyle} ${cls} data-dir=\"up\" ${upTippy}`;\n\n  // Get SVG polygon elements\n  const down = getIcon(\n    {shape: 'triangle', color: '#888'},\n    {config: {orientation: 'down'}}\n  );\n  const up = getIcon({shape: 'triangle', color: '#888'}, {config: ''});\n\n  const downArrow = `<svg ${downAttrs}>${down}</svg>`;\n  const upArrow = `<svg ${upAttrs}>${up}</svg>`;\n  const menuArrows = downArrow + upArrow;\n\n  return menuArrows;\n}\n\n/** Get menu for all transcripts for this gene */\nfunction getMenu(gene, ideo, selectedName) {\n  const containerId = '_ideoGeneStructureMenuContainer';\n  const style = 'margin-bottom: 4px; margin-top: 4px; clear: both;';\n\n  const structures = ideo.geneStructureCache[gene];\n\n  if (structures.length === 1) {\n    const name = structures[0].name;\n    const line =\n      `<div id=\"${containerId}\" style=\"${style}\">Transcript: ${name}</div>`;\n    return line;\n  }\n\n  const options = structures.map(structure => {\n    const name = structure.name;\n    let selected = '';\n    if (selectedName && selectedName === structure.name) {\n      selected = ' selected';\n    }\n    return `<option value=\"${name}\" ${selected}>${name}</option>`;\n  }).join('');\n\n  const id = '_ideoGeneStructureMenu';\n\n  const menuArrows = getMenuArrows();\n\n  const menu =\n    `<div id=\"${containerId}\" style=\"${style}\">` +\n      `<label for=\"${id}\">Transcript:</label> ` +\n      `<select id=\"${id}\" name=\"${id}\">${options}</select>` +\n      menuArrows +\n    `</div>`;\n  return menu;\n}\n\nexport function getGeneStructureHtml(annot, ideo, isParalogNeighborhood) {\n  let geneStructureHtml = '';\n  const gene = annot.name;\n  if (\n    ideo.config.showGeneStructureInTooltip && !isParalogNeighborhood &&\n    !(\n      'geneStructureCache' in ideo === false ||\n      gene in ideo.geneStructureCache === false\n    )\n  ) {\n    ideo.addedSubpartListeners = false;\n    if ('spliceExons' in ideo === false) ideo.spliceExons = true;\n    const spliceExons = ideo.spliceExons;\n    const structure = ideo.geneStructureCache[gene][0];\n    const geneStructureSvg = getSvg(structure, ideo, spliceExons)[0];\n    const cls = 'class=\"_ideoGeneStructureContainer\"';\n    const toggle = getSpliceToggle(ideo);\n    const rnaClass = spliceExons ? '' : ' pre-mRNA';\n    const spanClass = `class=\"_ideoGeneStructureContainerName${rnaClass}\"`;\n    const {name, title} = getSpliceStateText(spliceExons);\n    const spanAttrs = `${spanClass} title=\"${title}\"`;\n    const containerStyle = '';\n    geneStructureHtml =\n      '<br/><br/>' +\n      css +\n      `<div ${cls}>` +\n      `<div><span ${spanAttrs}>${name}</span>${toggle}</div>` +\n      `<span class=\"_ideoGeneStructureSvgContainer\" ${containerStyle}>` +\n        geneStructureSvg +\n      `</span>` +\n      `<div class=\"_ideoGeneStructureFooter\">` +\n        hoverTip +\n      `</div>` +\n      `</div>`;\n\n  }\n  return geneStructureHtml;\n}\n","import {decompressSync, strFromU8} from 'fflate';\nimport { sortAnnotsByRank } from '../annotations/annotations';\n\n// Definitions for ArrowHead values in WikiPathways GPML\n//\n// See also: https://discover.nci.nih.gov/mim/formal_mim_spec.pdf\nconst interactionArrowMap = {\n  'Arrow': ['acts on', 'acted on by'],\n  'TBar': ['inhibits', 'inhibited by'],\n  'mim-binding': ['binds', 'binds'],\n  'mim-catalysis': ['catalyzes', 'catalyzed by'],\n  'mim-cleavage': ['cleaves', 'cleaved by'],\n  'mim-conversion': ['converts', 'converted by'],\n  // 'mim-covalent-bond': ['covalently binds',\n  'mim-gap': ['interacts with', 'interacts with'],\n  'mim-inhibition': ['inhibits', 'inhibited by'],\n  'mim-modification': ['modifies', 'modified by'],\n  'mim-necessary-stimulation':\n    ['necessarily stimulates', 'necessarily stimulated by'],\n  'mim-stimulation': ['stimulates', 'stimulated by'],\n  'mim-transcription-translation':\n    ['transcribes / translates', 'transcribed / translated by']\n};\n\n// Which interactions types to show first, if showing multiple\nconst rankedInteractionTypes = [\n  'transcribe',\n  'cleave',\n  'convert',\n  'bind',\n  'modifie',\n  'catalyze',\n  'necessarily stimulate',\n  'inhibit',\n  'stimulate',\n  'act'\n];\n\nexport function sortInteractionTypes(a, b) {\n  const ranks = {};\n  for (let i = 0; i < rankedInteractionTypes.length; i++) {\n    const rankedIxnType = rankedInteractionTypes[i];\n    if (rankedIxnType.includes(a)) ranks.a = i;\n    if (rankedIxnType.includes(b)) ranks.b = i;\n  }\n  return ranks.b - ranks.a;\n}\n\n/** Determine if all given interactions in *one* pathway are same */\nfunction determineIxnsInPathwayAreSame(ixns, ixnTypeReference) {\n  let isRefMatch = true;\n  let thisIsSame = true;\n\n  if (ixns.length === 0) return {isRefMatch, thisIsSame};\n\n  const thisIxnTypeReference = ixns[0].ixnType.toLowerCase();\n  ixns.forEach(ixn => {\n    const ixnType = ixn.ixnType.toLowerCase();\n    if (ixnType !== ixnTypeReference) {\n      isRefMatch = false;\n    }\n    if (ixnType !== thisIxnTypeReference) {\n      thisIsSame = false;\n    }\n  });\n  return {isRefMatch, thisIsSame};\n}\n\n/**\n * Return first valid interaction type from interactions-by-pathway object\n */\nfunction getIxnTypeReference(ixnsByPwid) {\n  const ixnTypeReference = Object.values(ixnsByPwid).find(ixns => {\n    return ixns.length > 0 && 'ixnType' in ixns[0];\n  })[0].ixnType.toLowerCase();\n\n  return ixnTypeReference;\n}\n\n/**\n * Determine whether all given interactions in all given pathways are the same\n */\nfunction setIsSame(enrichedIxns) {\n  let isSame = true;\n  const ixnsByPwid = enrichedIxns.ixnsByPwid;\n\n  const ixnTypeReference = getIxnTypeReference(ixnsByPwid);\n\n  Object.entries(ixnsByPwid).map(([pwid, ixns]) => {\n    const {isRefMatch, thisIsSame} =\n      determineIxnsInPathwayAreSame(ixns, ixnTypeReference);\n    if (!thisIsSame || !isRefMatch) {\n      isSame = false;\n    }\n    enrichedIxns.isSameByPwid[pwid] = thisIsSame;\n  });\n  enrichedIxns.isSame = isSame;\n\n  return enrichedIxns;\n}\n\n/**\n * If interactions aren't all exactly the same, then they are often still\n * directionally equivalent.\n *\n * E.g. if gene A both \"modifies\" and \"converts\" gene B, then we can summarize\n * that as gene A \"acts on\" gene B, rather than completely reverting to saying\n * gene A \"interacts with\" gene B.\n *\n */\nfunction summarizeByDirection(enrichedIxns) {\n\n  let isDirectionSame = true;\n\n  const leftTypes = []; // \"Acts on\" types\n  const rightTypes = []; // \"Acted on by\" types\n  Object.values(interactionArrowMap).forEach(directedTypes => {\n    rightTypes.push(directedTypes[0]);\n    leftTypes.push(directedTypes[1]);\n  });\n\n  const right = 'Acts on';\n  const left = 'Acted on by';\n\n  const ixnsByPwid = enrichedIxns.ixnsByPwid;\n  const firstIxnType = getIxnTypeReference(ixnsByPwid);\n  const isRight = rightTypes.includes(firstIxnType);\n  const directionReference = isRight ? right : left;\n\n  Object.entries(ixnsByPwid).map(([pwid, ixns]) => {\n    let isPwDirectionSame = true;\n    if (ixns.length > 0) {\n      const pwFirstIxnType = ixns[0].ixnType.toLowerCase();\n      const pwIsRight = rightTypes.includes(pwFirstIxnType);\n      const pwDirectionReference = pwIsRight ? right : left;\n      ixns.forEach(ixn => {\n        const ixnType = ixn.ixnType.toLowerCase();\n        const thisIsRight = rightTypes.includes(ixnType);\n        const direction = thisIsRight ? right : left;\n        enrichedIxns.directionsByPwid[pwid] = direction;\n        if (direction !== directionReference) {\n          isDirectionSame = false;\n        }\n        if (direction !== pwDirectionReference) {\n          isPwDirectionSame = false;\n        }\n      });\n    }\n    enrichedIxns.isDirectionSameByPwid[pwid] = isPwDirectionSame;\n\n  });\n\n  enrichedIxns.isDirectionSame = isDirectionSame;\n  if (isDirectionSame === true) {\n    enrichedIxns.direction = directionReference;\n  }\n\n  return enrichedIxns;\n}\n\n/**\n * Summarize interactions by direction\n *\n * @param {String} gene Interacting gene\n * @param {String} searchedGene Searched gene\n * @param {Array} pathwayIds List of WikiPathways IDs\n * @param {Object} gpmls Object of parsed GPML XMLs values, by pathway ID key\n * @returns\n */\nexport function summarizeInteractions(gene, searchedGene, pathwayIds, gpmls) {\n  let summary = null;\n\n  // Coarse interactions are cached offline, so if not connected to Internet\n  // then fallback to generic summary.\n  if (!navigator.onLine) return 'Interacts with';\n\n  const ixnsByPwid =\n    detailAllInteractions(gene, searchedGene, pathwayIds, gpmls);\n\n  const ixns = ixnsByPwid[pathwayIds[0]];\n\n  if (ixns.length > 0) {\n    let enrichedIxns = {\n      ixnsByPwid,\n      isSameByPwid: {}, // If pathway has all same interaction types\n      isSame: null, // If above is true for all pathways\n      isDirectionSameByPwid: {}, // If pathway has same ixn direction\n      isDirectionSame: null, // If above is true for all pathways\n      directionsByPwid: {}\n    };\n    enrichedIxns = setIsSame(enrichedIxns);\n\n    if (enrichedIxns.isSame) {\n      const ixnType = ixns[0].ixnType;\n      const newIxn = ixnType;\n      summary = newIxn;\n    } else {\n\n      enrichedIxns = summarizeByDirection(enrichedIxns);\n\n      if (enrichedIxns.isDirectionSame) {\n        summary = enrichedIxns.direction;\n      } else {\n        summary = 'Interacts with';\n      }\n    }\n  }\n\n\n    // if (direction !== null) {\n    //   summary = direction;\n    // }\n    // const pwidsByIxnType = {};\n    // Object.entries(ixns).map(([k, v]) => {\n    //   if (!pwidsByIxnType[v.ixnType]) {\n    //     pwidsByIxnType[v.ixnType] = [v.pathwayId];\n    //   } else {\n    //     pwidsByIxnType[v.ixnType].push([v.pathwayId]);\n    //   }\n    // });\n\n    // console.log('pwidsByIxnType')\n    // console.log(pwidsByIxnType)\n    // const tpArray = Object.entries(pwidsByIxnType);\n    // const sortedIndices = sortInteractionTypes(tpArray.map(tp => tp[0]));\n    // const sortedTpArray =\n    //   sortedIndices.map(sortedIndex => tpArray[sortedIndex]);\n\n    // console.log('sortedTpArray')\n    // console.log(sortedTpArray)\n  return summary;\n}\n\n/**\n * Get detailInteractions results for multiple pathways\n *\n * @param gene Interacting gene\n * @param pathwayIds List of WikiPathways IDs\n * @ideo ideo Ideogram instance object\n */\nexport function detailAllInteractions(gene, searchedGene, pathwayIds, gpmls) {\n  const ixnsByPwid = {};\n\n  pathwayIds.map(pathwayId => {\n    const gpml = gpmls[pathwayId];\n    const ixns = detailInteractions(gene, searchedGene, gpml);\n\n    ixnsByPwid[pathwayId] = ixns;\n  });\n  return ixnsByPwid;\n}\n\n/** Get IDs and data element objects for searched or interacting gene */\nfunction getMatches(gpml, label) {\n  // Bail if GPML not yet fetched.  Sometimes occurs on hover immediately afters\n  // search.  This mitigation ensures at least a basic tooltip is shown.\n  if (typeof gpml === 'undefined' || gpml === '') return [[], []];\n\n  const nodes = Array.from(gpml.querySelectorAll(\n    `DataNode[TextLabel=\"${label}\"]`\n  ));\n\n  const genes = nodes.map(node => {\n    return {\n      type: 'node',\n      matchedLabel: label,\n      textLabel: node.getAttribute('TextLabel'),\n      graphId: node.getAttribute('GraphId'),\n      groupRef: node.getAttribute('GroupRef')\n    };\n  });\n\n  // Get group identifiers\n  const geneGraphIds = genes.map(g => g.graphId);\n  const geneGroupRefs = genes.map(g => g.groupRef);\n  const groupSelectors =\n    geneGroupRefs.map(ggr => `Group[GroupId=\"${ggr}\"]`).join(',');\n\n  let geneGroups = [];\n  if (groupSelectors !== '') {\n    const groups = gpml.querySelectorAll(groupSelectors);\n    geneGroups = Array.from(groups).map(group => {\n      return {\n        type: 'group',\n        matchedLabel: label,\n        graphId: group.getAttribute('GraphId'),\n        groupId: group.getAttribute('GroupId')\n      };\n    });\n  }\n\n  const geneGroupGraphIds = geneGroups.map(g => g.graphId);\n  const matchingGraphIds = geneGraphIds.concat(geneGroupGraphIds);\n\n  const elements = genes.concat(geneGroups);\n\n  return [matchingGraphIds, elements];\n}\n\nasync function fetchGpml(pathwayId) {\n  if (!navigator.onLine) return '';\n  const pathwayFile = `${pathwayId}.xml.gz`;\n  const gpmlUrl = `https://cdn.jsdelivr.net/npm/ixn2/${pathwayFile}`;\n  const response = await fetch(gpmlUrl);\n  if (!response.ok) {\n    console.log(`Gracefully degrading as request failed for: ${gpmlUrl}`);\n    return '';\n  }\n  const blob = await response.blob();\n  const uint8Array = new Uint8Array(await blob.arrayBuffer());\n  const rawGpml = strFromU8(decompressSync(uint8Array));\n\n  const gpml = new DOMParser().parseFromString(rawGpml, 'text/xml');\n\n  // console.log('gpml:')\n  // console.log(gpml)\n\n  return gpml;\n}\n\n/**\n * Request compressed GPML files, which contain detailed interaction data, e.g.\n * https://cdn.jsdelivr.net/npm/ixn/WP3982.xml.gz\n *\n * For more easily readable versions, see also:\n * - https://www.wikipathways.org/index.php?title=Pathway:WP3982&action=edit\n * - https://www.wikipathways.org//wpi/wpi.php?action=downloadFile&type=gpml&pwTitle=Pathway:WP3982\n *\n * GPML (Graphical Pathway Markup Language) data encodes detailed interaction\n * data for biochemical pathways.\n */\nexport function fetchGpmls(ideo) {\n  const pathwayIdsByInteractingGene = {};\n  Object.entries(ideo.annotDescriptions.annots)\n    .forEach(([annotName, descObj]) => {\n      if ('type' in descObj && descObj.type.includes('interacting gene')) {\n        pathwayIdsByInteractingGene[annotName] = descObj.pathwayIds;\n      }\n    });\n\n  const gpmlsByInteractingGene = {};\n  Object.entries(pathwayIdsByInteractingGene)\n    .forEach(([ixnGene, pathwayIds]) => {\n      gpmlsByInteractingGene[ixnGene] = {};\n      pathwayIds.map(async pathwayId => {\n        const gpml = await fetchGpml(pathwayId);\n        gpmlsByInteractingGene[ixnGene][pathwayId] = gpml;\n      });\n    });\n\n  ideo.gpmlsByInteractingGene = gpmlsByInteractingGene;\n}\n\n/**\n * Get interaction object from a GPML graphics XML element\n *\n * This interaction object connects the searched gene and interacting gene.\n */\nfunction parseInteractionGraphic(graphic, graphIds) {\n  let interaction = null;\n\n  const {searchedGeneGraphIds, matchingGraphIds} = graphIds;\n\n  const endGraphRefs = [];\n  let numMatchingPoints = 0;\n  let isConnectedToSourceGene = false;\n  let ixnType = null;\n  let searchedGeneIndex = null;\n\n  Array.from(graphic.children).forEach(child => {\n    if (child.nodeName !== 'Point') return;\n    const point = child;\n    const graphRef = point.getAttribute('GraphRef');\n    if (graphRef === null) return;\n\n    if (matchingGraphIds.includes(graphRef)) {\n      numMatchingPoints += 1;\n      endGraphRefs.push(graphRef);\n\n      if (searchedGeneGraphIds.includes(graphRef)) {\n        isConnectedToSourceGene = true;\n      }\n\n      if (point.getAttribute('ArrowHead')) {\n        const arrowHead = point.getAttribute('ArrowHead');\n        const isStart = searchedGeneGraphIds.includes(graphRef);\n        if (searchedGeneIndex === null) {\n          searchedGeneIndex = isStart ? 0 : 1;\n        }\n        try {\n          ixnType = interactionArrowMap[arrowHead][isStart ? 0 : 1];\n        } catch (e) {\n          // TODO: Handle e.g. HGF, where arrowHead is very rare ReceptorSquare\n        }\n      }\n    }\n  });\n\n  if (numMatchingPoints >= 2 && isConnectedToSourceGene) {\n    if (searchedGeneIndex === null || ixnType === null) {\n      ixnType = 'interacts with';\n    }\n    ixnType = ixnType[0].toUpperCase() + ixnType.slice(1);\n    const interactionGraphId = graphic.parentNode.getAttribute('GraphId');\n    interaction = {\n      'interactionId': interactionGraphId,\n      'endIds': endGraphRefs,\n      ixnType\n    };\n  }\n\n  return interaction;\n}\n\n/**\n * Get all genes in the given pathway GPML\n */\nexport async function fetchPathwayInteractions(searchedGene, pathwayId, ideo) {\n  const gpml = await fetchGpml(pathwayId);\n  // Gets IDs and elements for searched gene and interacting gene, and,\n  // if they're in any groups, the IDs of those groups\n  const genes = {};\n\n  const nodes = Array.from(gpml.querySelectorAll('DataNode'));\n  nodes.forEach(node => {\n    const label = node.getAttribute('TextLabel');\n    const normLabel = label.toLowerCase();\n    const isKnownGene = normLabel in ideo.geneCache.nameCaseMap;\n    if (isKnownGene) {\n      genes[label] = 1;\n    }\n  });\n\n  const pathwayGenes = Object.keys(genes);\n  const pathwayIxns = {};\n  pathwayGenes.map(gene => {\n    if (gene === searchedGene) return;\n    const gpmls = {};\n    gpmls[pathwayId] = gpml;\n    const summary = summarizeInteractions(\n      gene, searchedGene, [pathwayId], gpmls\n    );\n    pathwayIxns[gene] = (summary ? summary : 'Shares pathway with');\n  });\n\n  return pathwayIxns;\n}\n\n/**\n * Fetch GPML for pathway and find ID of Interaction between two genes,\n * and the ID of the two DataNodes for each of those interactions.\n *\n * WikiPathways SVG isn't detailed enough to reliably determine the specific\n * interaction elements relating two genes, given only the gene symbols.  This\n * fetches augmented GPML data for the pathway, and queries it to get only\n * interactions between the two genes.\n */\nfunction detailInteractions(interactingGene, searchedGene, gpml) {\n  if (typeof gpml === 'undefined' || gpml === '') {\n    return []; // Bail if GPML not yet fetched\n  }\n\n  // Gets IDs and elements for searched gene and interacting gene, and,\n  // if they're in any groups, the IDs of those groups\n  const [searchedGeneGraphIds, se] = getMatches(gpml, searchedGene);\n  const [interactingGeneGraphIds, ie] = getMatches(gpml, interactingGene);\n\n  const elements = {\n    searchedGene: se,\n    interactingGene: ie\n  };\n\n  const matchingGraphIds =\n    searchedGeneGraphIds.concat(interactingGeneGraphIds);\n  const graphIds = {searchedGeneGraphIds, matchingGraphIds};\n\n  // Get interaction objects that connect the searched and interacting genes\n  const interactions = [];\n  const graphicsXml = gpml.querySelectorAll('Interaction Graphics');\n  Array.from(graphicsXml).forEach(graphic => {\n    const interaction = parseInteractionGraphic(graphic, graphIds);\n    if (interaction !== null) {\n      interaction.elements = elements;\n      interactions.push(interaction);\n    }\n  });\n\n  return interactions;\n}\n\n// export async function fetchInteractionDiagram(annot, descObj, ideo) {\n//   // Fetch raw SVG for pathway diagram\n//   const pathwayId = descObj.pathwayIds[0];\n//   // const baseUrl = 'https://eweitz.github.io/cachome/wikipathways/';\n//   const baseUrl = 'https://cachome.github.io/wikipathways/';\n//   // const baseUrl = 'http://localhost/wikipathways/data/';\n//   const diagramUrl = baseUrl + pathwayId + '.svg';\n//   const response = await fetch(diagramUrl);\n//   if (response.ok) {\n\n//     // console.log('searchedGene', searchedGene)\n\n//     const ixns = await detailInteractions(annot.name, pathwayId, ideo);\n\n//     let selectors = `[name=${annot.name}]`;\n//     let searchedGeneIndex = 0;\n//     let interactingGeneIndex;\n//     if (ixns.length > 0) {\n//       selectors = ixns[0].endIds.map(id => '#' + id).join(',');\n//       searchedGeneIndex = ixns[0].searchedGeneIndex;\n//       interactingGeneIndex = (searchedGeneIndex === 0) ? 1 : 0;\n//     }\n//     // https://webservice.wikipathways.org/findInteractions?query=ACE2&format=json\n\n//     const rawDiagram = await response.text();\n\n//     const pathwayDiagram =\n//       `<div class=\"pathway-diagram\">${rawDiagram}</div>`;\n\n//     annot.displayName += pathwayDiagram;\n\n//     document.querySelector('#_ideogramTooltip').innerHTML =\n//       annot.displayName;\n\n//     Ideogram.d3.select('svg.Diagram')\n//       .attr('width', 350)\n//       .attr('height', 300);\n\n//     const viewport = document.querySelector('.svg-pan-zoom_viewport');\n//     viewport.removeAttribute('style');\n//     viewport.removeAttribute('transform');\n\n//     const matches = document.querySelectorAll(selectors);\n//     console.log('matches', matches)\n//     const match0 = matches[searchedGeneIndex]\n//     const m0 = match0.getCTM();\n//     const m0Rect = match0.getBoundingClientRect();\n//     const m0Box = match0.getBBox();\n//     const m0MinX = m0.e/m0.a;\n//     const m0MinY = m0.f/m0.d;\n\n//     let minX = m0MinX;\n//     let minY = m0MinY;\n//     let width;\n//     let height;\n\n//     width = 350;\n//     height = 300;\n\n//     // matches[0].children[0].setAttribute('fill', '#F55');\n//     match0.children[0].style.fill = '#f55';\n\n//     if (matches.length > 1) {\n//       // console.log('matches.length > 1')\n//       // matches[1].children[0].setAttribute('fill', '#C4C');\n//       const match1 = matches[interactingGeneIndex];\n//       // console.log('match1')\n//       // console.log(match1)\n//       match1.children[0].style.fill = '#c4c';\n//       const m1 = matches[1].getCTM();\n//       const m1Rect = matches[1].getBoundingClientRect();\n//       const m1Box = matches[1].getBBox();\n//       console.log('m0', m0)\n//       console.log('m1', m1)\n//       const m1MinX = m1.e/m1.a;\n//       const m1MinY = m1.f/m1.d;\n//       // const m1MinX = m1.e/m1.a + m1Rect.width;\n//       // const m1MinY = m1.f/m1.d - m1Rect.height;\n//       if (m1MinX < m0MinX) minX = m1MinX;\n//       if (m1MinY < m0MinY) minY = m1MinY;\n\n//       let pairWidth = 0;\n//       if (m0Rect.left < m1Rect.left) {\n//         // pairWidth = m1Rect.right - m0Rect.left;\n//         width += m1Box.width + 40;\n//       }\n\n//       // width += pairWidth;\n\n//       // console.log('m0Rect', m0Rect)\n//       // console.log('m1Rect', m1Rect)\n//       // console.log('m1MinX', m1MinX)\n//       // console.log('m0MinX', m0MinX)\n//       // console.log('m1MinY', m1MinY)\n//       // console.log('m0MinY', m0MinY)\n//       // console.log('pairWidth', pairWidth)\n//       // console.log('width', width)\n//       // width += Math.abs(m1MinX - m0MinX);\n//       // height += Math.abs(m1MinY - m0MinY);\n\n//       // minX -= 100;\n//       // minY -= 100;\n\n//       // minX -= 150;\n//       // minY -= 150;\n//     } else {\n//       minX -= 150;\n//       minY -= 150;\n//     }\n\n//     minX = Math.round(minX);\n//     minY = Math.round(minY);\n//     width = Math.round(width);\n//     height = Math.round(height);\n\n//     const viewBox = `${minX} ${minY} ${width} ${height}`;\n//     console.log('viewBox', viewBox);\n//     document.querySelector('svg.Diagram').setAttribute('viewBox', viewBox);\n\n//   }\n// }\n","export function accessor(x, fallback) {\n  return x == null ? fallback\n    : typeof x === 'function' ? x\n    : d => d[x];\n}\n","// Deriche's approximation of Gaussian smoothing\n// Adapted from Getreuer's C implementation (BSD license)\n// https://www.ipol.im/pub/art/2013/87/gaussian_20131215.tgz\n// http://dev.ipol.im/~getreuer/code/doc/gaussian_20131215_doc/gaussian__conv__deriche_8c.html\n\nexport function dericheConfig(sigma, negative = false) {\n  // compute causal filter coefficients\n  const a = new Float64Array(5);\n  const bc = new Float64Array(4);\n  dericheCausalCoeff(a, bc, sigma);\n\n  // numerator coefficients of the anticausal filter\n  const ba = Float64Array.of(\n    0,\n    bc[1] - a[1] * bc[0],\n    bc[2] - a[2] * bc[0],\n    bc[3] - a[3] * bc[0],\n    -a[4] * bc[0]\n  );\n\n  // impulse response sums\n  const accum_denom = 1.0 + a[1] + a[2] + a[3] + a[4];\n  const sum_causal = (bc[0] + bc[1] + bc[2] + bc[3]) / accum_denom;\n  const sum_anticausal = (ba[1] + ba[2] + ba[3] + ba[4]) / accum_denom;\n\n  // coefficients object\n  return {\n    sigma,\n    negative,\n    a,\n    b_causal: bc,\n    b_anticausal: ba,\n    sum_causal,\n    sum_anticausal\n  };\n}\n\nfunction dericheCausalCoeff(a_out, b_out, sigma) {\n  const K = 4;\n\n  const alpha = Float64Array.of(\n    0.84, 1.8675,\n    0.84, -1.8675,\n    -0.34015, -0.1299,\n    -0.34015, 0.1299\n  );\n\n  const x1 = Math.exp(-1.783 / sigma);\n  const x2 = Math.exp(-1.723 / sigma);\n  const y1 = 0.6318 / sigma;\n  const y2 = 1.997 / sigma;\n  const beta = Float64Array.of(\n    -x1 * Math.cos( y1), x1 * Math.sin( y1),\n    -x1 * Math.cos(-y1), x1 * Math.sin(-y1),\n    -x2 * Math.cos( y2), x2 * Math.sin( y2),\n    -x2 * Math.cos(-y2), x2 * Math.sin(-y2)\n  );\n\n  const denom = sigma * 2.5066282746310007;\n\n  // initialize b/a = alpha[0] / (1 + beta[0] z^-1)\n  const b = Float64Array.of(alpha[0], alpha[1], 0, 0, 0, 0, 0, 0);\n  const a = Float64Array.of(1, 0, beta[0], beta[1], 0, 0, 0, 0, 0, 0);\n\n  let j, k;\n\n  for (k = 2; k < 8; k += 2) {\n    // add kth term, b/a += alpha[k] / (1 + beta[k] z^-1)\n    b[k]     = beta[k] * b[k - 2] - beta[k + 1] * b[k - 1];\n    b[k + 1] = beta[k] * b[k - 1] + beta[k + 1] * b[k - 2];\n    for (j = k - 2; j > 0; j -= 2) {\n      b[j]     += beta[k] * b[j - 2] - beta[k + 1] * b[j - 1];\n      b[j + 1] += beta[k] * b[j - 1] + beta[k + 1] * b[j - 2];\n    }\n    for (j = 0; j <= k; j += 2) {\n      b[j]     += alpha[k] * a[j]     - alpha[k + 1] * a[j + 1];\n      b[j + 1] += alpha[k] * a[j + 1] + alpha[k + 1] * a[j];\n    }\n\n    a[k + 2] = beta[k] * a[k]     - beta[k + 1] * a[k + 1];\n    a[k + 3] = beta[k] * a[k + 1] + beta[k + 1] * a[k];\n    for (j = k; j > 0; j -= 2) {\n      a[j]     += beta[k] * a[j - 2] - beta[k + 1] * a[j - 1];\n      a[j + 1] += beta[k] * a[j - 1] + beta[k + 1] * a[j - 2];\n    }\n  }\n\n  for (k = 0; k < K; ++k) {\n    j = k << 1;\n    b_out[k] = b[j] / denom;\n    a_out[k + 1] = a[j + 2];\n  }\n}\n\nexport function dericheConv2d(cx, cy, grid, [nx, ny]) {\n  // allocate buffers\n  const yc = new Float64Array(Math.max(nx, ny)); // causal\n  const ya = new Float64Array(Math.max(nx, ny)); // anticausal\n  const h = new Float64Array(5);\n  const d = new Float64Array(grid.length);\n\n  // convolve rows\n  for (let row = 0, r0 = 0; row < ny; ++row, r0 += nx) {\n    const dx = d.subarray(r0);\n    dericheConv1d(cx, grid.subarray(r0), nx, 1, yc, ya, h, dx);\n  }\n\n  // convolve columns\n  for (let c0 = 0; c0 < nx; ++c0) {\n    const dy = d.subarray(c0);\n    dericheConv1d(cy, dy, ny, nx, yc, ya, h, dy);\n  }\n\n  return d;\n}\n\nexport function dericheConv1d(\n  c, src, N,\n  stride = 1,\n  y_causal = new Float64Array(N),\n  y_anticausal = new Float64Array(N),\n  h = new Float64Array(5),\n  d = y_causal,\n  init = dericheInitZeroPad\n) {\n  const stride_2 = stride * 2;\n  const stride_3 = stride * 3;\n  const stride_4 = stride * 4;\n  const stride_N = stride * N;\n  let i, n;\n\n  // initialize causal filter on the left boundary\n  init(\n    y_causal, src, N, stride,\n    c.b_causal, 3, c.a, 4, c.sum_causal, h, c.sigma\n  );\n\n  // filter the interior samples using a 4th order filter. Implements:\n  // for n = K, ..., N - 1,\n  //   y^+(n) = \\sum_{k=0}^{K-1} b^+_k src(n - k)\n  //          - \\sum_{k=1}^K a_k y^+(n - k)\n  // variable i tracks the offset to the nth sample of src, it is\n  // updated together with n such that i = stride * n.\n  for (n = 4, i = stride_4; n < N; ++n, i += stride) {\n    y_causal[n] = c.b_causal[0] * src[i]\n      + c.b_causal[1] * src[i - stride]\n      + c.b_causal[2] * src[i - stride_2]\n      + c.b_causal[3] * src[i - stride_3]\n      - c.a[1] * y_causal[n - 1]\n      - c.a[2] * y_causal[n - 2]\n      - c.a[3] * y_causal[n - 3]\n      - c.a[4] * y_causal[n - 4];\n  }\n\n  // initialize the anticausal filter on the right boundary\n  init(\n    y_anticausal, src, N, -stride,\n    c.b_anticausal, 4, c.a, 4, c.sum_anticausal, h, c.sigma\n  );\n\n  // similar to the causal filter above, the following implements:\n  // for n = K, ..., N - 1,\n  //   y^-(n) = \\sum_{k=1}^K b^-_k src(N - n - 1 - k)\n  //          - \\sum_{k=1}^K a_k y^-(n - k)\n  // variable i is updated such that i = stride * (N - n - 1).\n  for (n = 4, i = stride_N - stride * 5; n < N; ++n, i -= stride) {\n    y_anticausal[n] = c.b_anticausal[1] * src[i + stride]\n      + c.b_anticausal[2] * src[i + stride_2]\n      + c.b_anticausal[3] * src[i + stride_3]\n      + c.b_anticausal[4] * src[i + stride_4]\n      - c.a[1] * y_anticausal[n - 1]\n      - c.a[2] * y_anticausal[n - 2]\n      - c.a[3] * y_anticausal[n - 3]\n      - c.a[4] * y_anticausal[n - 4];\n  }\n\n  // sum the causal and anticausal responses to obtain the final result\n  if (c.negative) {\n    // do not threshold if the input grid includes negatively weighted values\n    for (n = 0, i = 0; n < N; ++n, i += stride) {\n      d[i] = y_causal[n] + y_anticausal[N - n - 1];\n    }\n  } else {\n    // threshold to prevent small negative values due to floating point error\n    for (n = 0, i = 0; n < N; ++n, i += stride) {\n      d[i] = Math.max(0, y_causal[n] + y_anticausal[N - n - 1]);\n    }\n  }\n\n  return d;\n}\n\nexport function dericheInitZeroPad(dest, src, N, stride, b, p, a, q, sum, h) {\n  const stride_N = Math.abs(stride) * N;\n  const off = stride < 0 ? stride_N + stride : 0;\n  let i, n, m;\n\n  // compute the first q taps of the impulse response, h_0, ..., h_{q-1}\n  for (n = 0; n < q; ++n) {\n    h[n] = (n <= p) ? b[n] : 0;\n    for (m = 1; m <= q && m <= n; ++m) {\n      h[n] -= a[m] * h[n - m];\n    }\n  }\n\n  // compute dest_m = sum_{n=1}^m h_{m-n} src_n, m = 0, ..., q-1\n  // note: q == 4\n  for (m = 0; m < q; ++m) {\n    for (dest[m] = 0, n = 1; n <= m; ++n) {\n      i = off + stride * n;\n      if (i >= 0 && i < stride_N) {\n        dest[m] += h[m - n] * src[i];\n      }\n    }\n  }\n\n  // dest_m = dest_m + h_{n+m} src_{-n}\n  const cur = src[off];\n  if (cur > 0) {\n    for (m = 0; m < q; ++m) {\n      dest[m] += h[m] * cur;\n    }\n  }\n\n  return;\n}\n","// Scott, D. W. (1992) Multivariate Density Estimation:\n// Theory, Practice, and Visualization. Wiley.\nexport function nrd(data, x) {\n  const values = data.map(x).filter(v => v != null && v >= v);\n  values.sort((a, b) => a - b);\n  const sd = stdev(values);\n  const q1 = quantile(values, 0.25);\n  const q3 = quantile(values, 0.75);\n\n  const n = values.length,\n        h = (q3 - q1) / 1.34,\n        v = Math.min(sd, h) || sd || Math.abs(q1) || 1;\n\n  return 1.06 * v * Math.pow(n, -0.2);\n}\n\nfunction stdev(values) {\n  const n = values.length;\n  let count = 0;\n  let delta;\n  let mean = 0;\n  let sum = 0;\n  for (let i = 0; i < n; ++i) {\n    const value = values[i];\n    delta = value - mean;\n    mean += delta / ++count;\n    sum += delta * (value - mean);\n  }\n  return count > 1 ? Math.sqrt(sum / (count - 1)) : NaN;\n}\n\nfunction quantile(values, p) {\n  const n = values.length;\n\n  if (!n) return NaN;\n  if ((p = +p) <= 0 || n < 2) return values[0];\n  if (p >= 1) return values[n - 1];\n\n  const i = (n - 1) * p;\n  const i0 = Math.floor(i);\n  const v0 = values[i0];\n  return v0 + (values[i0 + 1] - v0) * (i - i0);\n}\n","import { accessor } from './accessor.js';\nimport { bin1d } from './bin1d.js';\nimport { dericheConfig, dericheConv1d } from './deriche.js';\nimport { extent as densityExtent } from './extent.js';\nimport { nrd } from './nrd.js';\n\nexport function density1d(data, options = {}) {\n  const { adjust = 1, pad = 3, bins = 512 } = options;\n  const x = accessor(options.x, x => x);\n  const w = accessor(options.weight, () => 1 / data.length);\n\n  let bandwidth = options.bandwidth ?? adjust * nrd(data, x);\n\n  const [lo, hi] = options.extent ?? densityExtent(data, x, pad * bandwidth);\n  const grid = bin1d(data, x, w, lo, hi, bins);\n  const delta = (hi - lo) / (bins - 1);\n  const neg = grid.some(v => v < 0);\n\n  let config = dericheConfig(bandwidth / delta, neg);\n  let result;\n\n  function* points(x = 'x', y = 'y') {\n    const result = estimator.grid();\n    const scale = 1 / delta;\n    for (let i = 0; i < bins; ++i) {\n      yield {\n        [x]: lo + i * delta,\n        [y]: result[i] * scale\n      };\n    }\n  }\n\n  const estimator = {\n    [Symbol.iterator]: points,\n    points,\n    grid: () => result || (result = dericheConv1d(config, grid, bins)),\n    extent: () => [lo, hi],\n    bandwidth(_) {\n      if (arguments.length) {\n        if (_ !== bandwidth) {\n          bandwidth = _;\n          result = null;\n          config = dericheConfig(bandwidth / delta, neg);\n        }\n        return estimator;\n      } else {\n        return bandwidth;\n      }\n    }\n  };\n\n  return estimator;\n}\n","export function extent(data, x, pad = 0) {\n  const n = data.length;\n  let lo;\n  let hi;\n  for (let i = 0; i < n; ++i) {\n    const v = x(data[i], i, data);\n    if (v != null) {\n      if (lo === undefined) {\n        if (v >= v) lo = hi = v;\n      } else {\n        if (v < lo) lo = v;\n        if (v > hi) hi = v;\n      }\n    }\n  }\n  return [lo - pad, hi + pad];\n}\n","export function bin1d(data, x, weight, lo, hi, n) {\n  const grid = new Float64Array(n);\n  const delta = (n - 1) / (hi - lo);\n\n  for (let i = 0; i < data.length; ++i) {\n    const d = data[i];\n    const xi = x(d, i, data);\n    const wi = weight(d, i, data);\n\n    // skip NaN and Infinite values\n    if (!(Number.isFinite(xi) && Number.isFinite(wi))) {\n      continue;\n    }\n\n    const p = (xi - lo) * delta;\n    const u = Math.floor(p);\n    const v = u + 1;\n\n    if (0 <= u && v < n) {\n      grid[u] += (v - p) * wi;\n      grid[v] += (p - u) * wi;\n    } else if (u === -1) {\n      grid[v] += (p - u) * wi;\n    } else if (v === n) {\n      grid[u] += (v - p) * wi;\n    }\n  }\n\n  return grid;\n}\n","import {\n  adjustBrightness, ensureContrast, getTextSize, d3\n} from '../lib';\nimport {density1d} from 'fast-kde';\n\nconst MINI_CURVE_HEIGHT = 12;\nconst MINI_CURVE_WIDTH = 48;\n\n/** Copyedit machine-friendly tissue name to human-friendly GTEx convention */\nfunction refineTissueName(rawName) {\n  let name = rawName.replace(/_/g, ' ').toLowerCase();\n\n  // Style abbreviations of \"Brodmann area\", and other terms\n  // per GTEx conventions\n  [\n    'ba24', 'ba9', 'basal ganglia', 'omentum', 'suprapubic', 'lower leg',\n    'cervical c-1'\n  ].forEach(term => name = name.replace(term, '(' + term + ')'));\n  ['ba24', 'ba9', 'ebv'].forEach(term => {\n    name = name.replace(term, term.toUpperCase());\n  });\n  [\n    'adipose', 'artery', 'brain', 'breast', 'cells', 'cervix', 'colon',\n    'heart', 'kidney', 'muscle', 'nerve', 'skin', 'small intestine'\n  ].forEach(term => {\n    name = name.replace(term, term + ' -');\n  });\n\n  // Shorten from long full name to brief (but also standard) abbreviation\n  name = name.replace('basal ganglia', 'BG');\n\n  name = name[0].toUpperCase() + name.slice(1);\n  return name;\n}\n\n/** Get maximum expression among tissues, or for an optional reference */\nfunction getMaxExpression(tissueExpressions, refTissue) {\n  let maxExpression = 0;\n\n  for (let i = 0; i < tissueExpressions.length; i++) {\n    const teObject = tissueExpressions[i];\n    const thisMaxExp = teObject.expression.max;\n\n    if (!refTissue) {\n      // For default display of mini-curves\n      if (thisMaxExp > maxExpression) {\n        maxExpression = thisMaxExp;\n      }\n    } else {\n      // Set a non-default tissue as reference, e.g. to frame other\n      // mini-curves relative to hovered mini-curve.\n      if (teObject.tissue === refTissue) {\n        maxExpression = thisMaxExp;\n        break;\n      }\n    }\n  }\n\n  return maxExpression;\n}\n\n/**\n * Set a `px` property in each item of tissueExpressions for key metrics\n *\n * @param {List<Object>} tissueExpressions\n * @param {Number} maxPx Maximum width\n * @param {Boolean} relative Whether offsets are relative to highest-median\n *   expression tissue (e.g. multiple mini-curves) or not (e.g. detail curve)\n * @param {Number} leftPx How much to much curves over from the left\n * @param {String} refTissue Tissue used as reference for maximum expression.\n *   refTissue maxExp becomes px.max, any greater exp. in other tissues gets\n *   truncated at right in its curve.\n * @returns {List<Object>} tissueExpressions, with a new `px` property in each\n *   for max, q3, median, q1, and min.\n */\nfunction setPxOffset(\n  tissueExpressions, maxPx, relative=true, leftPx=0, refTissue=null\n) {\n  const maxExpression = getMaxExpression(tissueExpressions, refTissue);\n  let refMinExp = 0;\n  if (refTissue) {\n    const refTeObject =\n      tissueExpressions.find(teObject => teObject.tissue === refTissue);\n    refMinExp = refTeObject.expression.min;\n  }\n\n  const metrics = ['max', 'q3', 'median', 'q1', 'min'];\n\n  tissueExpressions.map(teObject => {\n    teObject.px = {};\n    if (relative) {\n      for (let i = 0; i < metrics.length; i++) {\n        const metric = metrics[i];\n        const exp = teObject.expression[metric];\n        let px =\n          maxPx * (exp - refMinExp)/(maxExpression - refMinExp) + leftPx;\n        if (Math.round(px) > maxPx) {\n          // Often occurs when `refTissue` is specified\n          teObject.px[metric + 'Raw'] = px;\n          px += (maxPx - px);\n        }\n        px += leftPx;\n        teObject.px[metric] = px;\n      }\n    } else {\n      // min = 50,   med = 100,    max = 200\n      // px.min = 0, px.med = 250 * 100-50/(200 - 50), px.max = 250\n      const minExp = teObject.expression.min;\n      const maxExp = teObject.expression.max;\n      for (let i = 0; i < metrics.length; i++) {\n        const metric = metrics[i];\n        const exp = teObject.expression[metric];\n        const px = maxPx * (exp - minExp)/(maxExp - minExp) + leftPx;\n        teObject.px[metric] = px;\n      }\n    }\n    return teObject;\n  });\n\n  return tissueExpressions;\n}\n\n/** Get link to full detail about gene on GTEx */\nfunction getFullDetail(gene) {\n  const gtexUrl = `https://www.gtexportal.org/home/gene/${gene}`;\n  const cls = 'class=\"_ideoGtexLink\"';\n  const gtexLink =\n    `<a href=\"${gtexUrl}\" ${cls} target=\"_blank\">GTEx</a>`;\n  const fullDetail = `<i>Full detail: ${gtexLink}</i>`;\n  return fullDetail;\n}\n\nfunction getMoreOrLessToggle(gene, height, tissueExpressions, ideo) {\n\n  const fullDetail = getFullDetail(gene);\n\n  if (tissueExpressions.length <= 3) {\n    return `<br/>${fullDetail}<br/><br/>`;\n  }\n\n  const pipeStyle =\n    'style=\"margin: 0 6px; color: #CCC;\"';\n  const details =\n    `<span ${pipeStyle}>|</span>${fullDetail}`;\n  const moreOrLess =\n    !ideo.showTissuesMore ? `Less...` : 'More...';\n  const mlStyle = 'style=\"cursor: pointer;px;\"';\n  const left = `left: ${!ideo.showTissuesMore ? 1 : -50}px;`;\n  const top = 'top: -1px;';\n  const mltStyle =\n    `style=\"position: relative; ${left} ${top} font-size: ${height}px\"`\n  const moreOrLessToggleHtml =\n    `<div ${mltStyle}>` +\n      `<a class=\"_ideoMoreOrLessTissue\" ${mlStyle}>${moreOrLess}</a>` +\n      `${!ideo.showTissuesMore ? details : ''}` +\n    `</div>`;\n\n  return moreOrLessToggleHtml;\n}\n\n/** Get x, y1, y2, and style for a metric line */\nfunction getMetricLineAttrs(offsets, metric, y, height, isShifted=false) {\n  let x = offsets[metric];\n  let isTruncated = false;\n  if (isShifted && x > MINI_CURVE_WIDTH) {\n    x = MINI_CURVE_WIDTH + 1;\n    isTruncated = true;\n  }\n  let metricHeight =\n    !isTruncated ? offsets[metric + 'Height'] : MINI_CURVE_HEIGHT;\n\n  if (isNaN(metricHeight)) {\n    // Seen upon e.g. hovering over \"Artery - Coronary\" in STAT1\n    metricHeight = MINI_CURVE_HEIGHT;\n  }\n\n  const top = height - metricHeight;\n  const y1 = top + y + 0.5;\n  const y2 = top + y + metricHeight;\n\n  // E.g. brain mini-curve in AGT\n  const isNarrow = offsets.max - offsets.min <= 8;\n  const isMedian = metric === 'median';\n  const isNarrowMedian = isNarrow && isMedian;\n  const style = isNarrowMedian ? 'display: none' : '';\n\n  // Whether to hide median at end of transition, e.g. when focus is\n  // esophagus in ACE2 and testis median should be hidden\n  const isTruncatedMedian = isTruncated && isMedian;\n\n  const endStyle =\n    isTruncatedMedian || isNarrowMedian ? 'display: none;' : '';\n\n  return {x, y1, y2, style, endStyle};\n}\n\n/** Get a vertical line to show in distribution curve for median, Q1, or Q2 */\nfunction getMetricLine(\n  metric, offsets, color, y, height,\n  dash=false\n) {\n  const classMetric = metric[0].toUpperCase() + metric.slice(1);\n  const {x, y1, y2, style} = getMetricLineAttrs(offsets, metric, y, height);\n  const styleAttr = style === '' ? '' : `style=\"${style}\"`;\n  const baseColor = adjustBrightness(color, 0.55);\n  const strokeColor = ensureContrast(baseColor, color);\n  const dasharray = dash ? 'stroke-dasharray=\"3\" ' : '';\n  const attrs =\n    `x1=\"${x}\" y1=\"${y1}\" x2=\"${x}\" y2=\"${y2}\" ${styleAttr} ` +\n    dasharray +\n    `class=\"_ideoExpression${classMetric}\" `;\n  const metricLine = `<line stroke=\"${strokeColor}\" ${attrs} />`;\n  return metricLine;\n}\n\n/**\n * Get vertical lines for median, Q1, Q3, to overlay in distribution curve plot\n *\n * Median line is solid, and shown in both mini-curve and detailed curve.\n * Q1 and Q3 lines are dashed, and only shown in detailed curve.\n */\nfunction getMetricLines(offsets, y, height, color) {\n  const medianLine = getMetricLine('median', offsets, color, y, height, false);\n  const q1Line = getMetricLine('q1', offsets, color, y, height, true);\n  const q3Line = getMetricLine('q3', offsets, color, y, height, true);\n\n  return [medianLine, q1Line, q3Line];\n}\n\nfunction getCurveShape(teObject, y, height, numKdeBins=64, isShifted=false) {\n  const quantiles = teObject.expression.quantiles;\n  const offsets = teObject.px;\n  const samples = teObject.samples;\n  const spreadQuantiles = [];\n\n  // `quantiles` is an array encoding a histogram.\n  // To get a kernel density estimation (KDE) -- i.e., a curve that smooths the\n  // crude bars of the histogram -- we need to \"spread\" or \"flatten\" the\n  // histogram array so e.g.\n  // [0, 5, 4, 1] (= 0 samples in quantile 1, 5 samples in quantile 2, etc.)\n  // becomes\n  // [0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3]\n  quantiles.map((quantileCount, j) => {\n    for (let k = 0; k < quantileCount; k++) {\n      spreadQuantiles.push(j);\n    }\n  });\n\n  const sampleThreshold = 70; // GTEx sample threshold\n\n  // Small bandwidth : sharp curve :: large bandwidth : smooth curve\n  //\n  // Increasing bandwidth when there are few samples helps avoid sharp curves\n  // that are mere artifacts of having few points, which would be problematic\n  // as it almost certainly misrepresents the underlying population.\n  const bandwidth = samples >= sampleThreshold ? 0.7 : 1.5;\n\n  const numBins = numKdeBins; // The number of lines in the KDE curve\n  const kde = density1d(\n    spreadQuantiles, {bins: numBins, bandwidth}\n  );\n  const rawKdeArray = Array.from(kde);\n  const kdeArray = rawKdeArray\n    .filter(point => 0 <= point.x && point.x <= 10);\n\n  if (kdeArray.length === 0) return '';\n\n  // Get scaling factor to convert kernel coordinates to pixels\n  const maxKernelY = Math.max(...kdeArray.map(p => p.y));\n  const minKernelX = kdeArray[0].x;\n  const maxKernelX = kdeArray.slice(-1)[0].x;\n  const kdeWidth = maxKernelX - minKernelX;\n  const thisMax = ('maxRaw' in offsets) ? offsets.maxRaw : offsets.max;\n  const offsetsWidth = thisMax - offsets.min;\n  const pixelsPerKernel = offsetsWidth/kdeWidth;\n\n  const bottom = height + y;\n\n  // Convert KDE x,y points to pixel coordinates, each a segment of the curve;\n  // and set heights for each metric plotted in detailed distribution\n  let prevPixelX = 0;\n  const rawPoints = kdeArray.map((point, i) => {\n    let pixelX = (point.x - minKernelX) * pixelsPerKernel + offsets.min;\n    if (isShifted && pixelX > MINI_CURVE_WIDTH) {\n      pixelX = MINI_CURVE_WIDTH;\n    }\n    const segmentHeight = height * (point.y / maxKernelY);\n    const pixelY = bottom - segmentHeight;\n\n    if (i > 0) {\n      ['q1', 'median', 'q3'].forEach(metric => {\n        const metricX = offsets[metric];\n        if (prevPixelX < metricX && metricX <= pixelX) {\n          offsets[metric + 'Height'] = segmentHeight;\n        }\n      });\n    }\n\n    prevPixelX = pixelX;\n\n    return `${pixelX},${pixelY}`;\n  });\n\n  let refinedMax = offsets.max;\n  let refinedMin = offsets.min;\n  if (isShifted) {\n    if (offsets.max > MINI_CURVE_WIDTH) refinedMax = MINI_CURVE_WIDTH;\n    if (offsets.min > MINI_CURVE_WIDTH) refinedMin = MINI_CURVE_WIDTH;\n  }\n\n  // Tie up loose ends of the curved diagram\n  rawPoints.push(refinedMax + ',' + bottom);\n  rawPoints.push(refinedMin + ',' + bottom);\n  const originPoint = rawPoints[0];\n  rawPoints.push(originPoint);\n  const points = rawPoints.join(' ');\n\n  return [points, offsets];\n}\n\n/**\n * Get a distribution curve of expression, via kernel density estimation (KDE)\n */\nfunction getCurve(teObject, y, height, color, borderColor, numKdeBins=64) {\n  const [points, offsets] = getCurveShape(teObject, y, height, numKdeBins);\n\n  const curveAttrs =\n    `fill=\"${color}\" ` +\n    `stroke=\"${borderColor}\" ` +\n    `points=\"${points}\" ` +\n    'class=\"tissue-curve\" ' +\n    `data-tissue-curve=\"${teObject.tissue}\"`;\n\n  const curve = `<polyline ${curveAttrs} />`;\n\n  return [curve, offsets];\n}\n\n/**\n * Remove detailed distribution curve; unhide RNA & protein diagrams, footer\n */\nfunction removeDetailedCurve() {\n  const container = document.querySelector('._ideoDistributionContainer');\n  if (!container) return;\n  container.remove();\n\n  const structureDom = document.querySelector('._ideoGeneStructureContainer');\n  if (structureDom) {\n    structureDom.style.display = '';\n  }\n  const footer = document.querySelector('._ideoTooltipFooter');\n  footer.style.display = '';\n}\n\n/**\n * Get small vertical lines (\"ticks\") for min, max, and median in detailed\n * distribution curve\n */\nfunction getMetricTicks(teObject, height) {\n  const min = teObject.px.min;\n  const minExp = teObject.expression.min;\n  const max = teObject.px.max;\n  const maxExp = teObject.expression.max;\n  const median = teObject.px.median;\n  const medianExp = teObject.expression.median;\n  const mid = max/2;\n  const y = height + 5;\n  const stroke = `stroke=\"#CCC\" stroke-width=\"1px\"`;\n\n  const fontObject = {\n    config: {weight: 400, annotLabelSize: 12}\n  };\n\n  const textY = y + 16;\n  const expTextY = y + 27;\n  const tickY1 = y - 3;\n  const tickY2 = y + 5;\n\n  const maxRawText = 'Max';\n  const maxTextWidth = getTextSize(maxRawText, fontObject).width;\n  const maxExpTextWidth = getTextSize(maxExp, fontObject).width;\n  const maxTextX = max - maxTextWidth / 2;\n  const maxExpTextX = max - maxExpTextWidth / 2;\n  const maxTickAttrs =\n    `x1=\"${max}\" x2=\"${max}\" y1=\"${tickY1}\" y2=\"${tickY2}\" ${stroke}`;\n  const maxText =\n    `<line ${maxTickAttrs} />` +\n    `<text x=\"${maxTextX}\" y=\"${textY}\">${maxRawText}.</text>` +\n    `<text x=\"${maxExpTextX}\" y=\"${expTextY}\">${maxExp}</text>`;\n\n  const minRawText = 'Min';\n  const minTextWidth = getTextSize(minRawText, fontObject).width;\n  const minExpTextWidth = getTextSize(minExp, fontObject).width;\n  let minTextX = min - minTextWidth / 2;\n  let minExpTextX = min - minExpTextWidth / 2;\n  const minTextEndX = min + minTextWidth;\n  const minTickAttrs =\n    `x1=\"${min}\" x2=\"${min}\" y1=\"${tickY1}\" y2=\"${tickY2}\" ${stroke}`;\n\n  const medianRawText = 'Median';\n  const medianTextWidth = getTextSize(medianRawText, fontObject).width;\n  const medianExpTextWidth = getTextSize(medianExp, fontObject).width;\n  const medianTextX = median - medianTextWidth / 2;\n  const medianExpTextX = median - medianExpTextWidth / 2;\n  const medianTickAttrs =\n    `x1=\"${median}\" x2=\"${median}\" y1=\"${tickY1}\" y2=\"${tickY2}\" ${stroke}`;\n\n  let medianX = medianTextX;\n  let medianExpX = medianExpTextX;\n\n  // Align \"Median\" to right of tick if text would clash with \"Min.\"\n  const isMinMedSoftCollide = minTextEndX >= medianX;\n  if (isMinMedSoftCollide) {\n    medianX = median;\n    medianExpX = median;\n  }\n\n  // If right-aligning \"Median\" doesn't fix clash,\n  // then left-align \"Min.\" and nudge \"Median\" right\n  const isMinMedCollide = minTextEndX >= medianX;\n\n  // Examples: \"More...\" tissues in PCSK9 and (especially) TTN\n  if (isMinMedCollide) {\n    medianX += 1.5;\n    medianExpX += 1.5;\n    minTextX = min - minTextWidth - 1.5;\n    minExpTextX = min - minExpTextWidth - 1.5;\n  }\n\n  const medianText =\n    `<line ${medianTickAttrs} />` +\n    `<text x=\"${medianX}\" y=\"${textY}\">Median</text>` +\n    `<text x=\"${medianExpX}\" y=\"${expTextY}\">${medianExp}</text>`;\n\n  const minText =\n    `<line ${minTickAttrs} />` +\n    `<text x=\"${minTextX}\" y=\"${textY}\" >${minRawText}.</text>` +\n    `<text x=\"${minExpTextX}\" y=\"${expTextY}\" >${minExp}</text>`;\n\n  const nameAttrs =\n    `x=\"${mid - 40}\" y=\"${y + 46}\"`;\n  const sampleAttrs =\n    `x=\"${mid - 70}\" y=\"${y + 59}\"`;\n\n  return (\n    `<g>` +\n    minText +\n    maxText +\n    medianText +\n    `<text ${nameAttrs}>Expression (TPM)</text>` +\n    `<text ${sampleAttrs}>Samples: ${teObject.samples} | Source: GTEx</text>` +\n    `</g>`\n  );\n}\n\n/**\n * Write a large, detailed distribution curve to the DOM.\n *\n * This is shown upon hovering over a mini-curve.  The detailed curve shows\n * more metrics than the mini-curve, in a zoomed-in view that makes it easier\n * to discern the overall shape and local features of gene expression\n * distribution in the tissue.\n */\nfunction addDetailedCurve(traceDom, ideo) {\n  const gene = traceDom.getAttribute('data-gene');\n  const tissue = traceDom.getAttribute('data-tissue');\n  const tissueExpressions = ideo.tissueExpressionsByGene[gene];\n\n  let teObject = tissueExpressions.find(t => t.tissue === tissue);\n  const maxWidthPx = 225; // Same width as RNA & protein diagrams\n  const leftPx = 35;\n  teObject = setPxOffset(\n    [teObject], maxWidthPx, false, leftPx\n  )[0];\n\n  const y = 0;\n  const height = 50;\n\n  const color = `#${teObject.color}`;\n  const borderColor = adjustBrightness(color, 0.85);\n\n  const numBins = 256;\n  const [distributionCurve, offsetsWithHeight] = getCurve(\n    teObject, y + 1, height, color, borderColor, numBins\n  );\n\n  const [medianLine, q1Line, q3Line] = getMetricLines(\n    offsetsWithHeight, y, height, color\n  );\n  const metricTicks = getMetricTicks(teObject, height);\n\n  // Hide RNA & protein diagrams, footer\n  let ledgeDom;\n  const structureDom = document.querySelector('._ideoGeneStructureContainer');\n  const footer = document.querySelector('._ideoTooltipFooter');\n  if (structureDom) { // Account for e.g. ncRNA, like MALAT1\n    ledgeDom = structureDom;\n    structureDom.style.display = 'none';\n    footer.style.display = 'none';\n  } else {\n    ledgeDom = footer;\n    const plotContainer = document.querySelector('._ideoTissuePlotContainer');\n    plotContainer.setAttribute('style', 'margin-bottom: 20px');\n  }\n\n  const svgHeight = 119.5; // Keeps tooltip bottom flush with prior state\n  const style = `style=\"position: relative; height: ${svgHeight}px\"`;\n  const svgStyle = 'style=\"position: absolute; top: 2px; left: -5px;\"';\n  const container =\n    `<div class=\"_ideoDistributionContainer\" ${style}>` +\n    `<svg width=\"280px\" height=\"${svgHeight}px\" ${svgStyle}>` +\n    metricTicks +\n    distributionCurve +\n    medianLine +\n    q1Line +\n    q3Line +\n    `</svg>` +\n    '</div>';\n\n  ledgeDom.insertAdjacentHTML('beforebegin', container);\n}\n\nfunction getMiniCurveY(i, height) {\n  const y = 1 + i * (height + 2);\n  return y;\n}\n\n/** Get mini distribution curves and  */\nfunction getExpressionPlotHtml(gene, tissueExpressions, ideo) {\n  const maxWidth = MINI_CURVE_WIDTH;\n  tissueExpressions = setPxOffset(tissueExpressions, maxWidth, true, 0);\n\n  const height = MINI_CURVE_HEIGHT;\n\n  const moreOrLessToggleHtml =\n    getMoreOrLessToggle(gene, height, tissueExpressions, ideo);\n  const numTissues = !ideo.showTissuesMore ? 10 : 3;\n\n  let y;\n  const rects = tissueExpressions.slice(0, numTissues).map((teObject, i) => {\n    y = getMiniCurveY(i, height);\n    const tissue = refineTissueName(teObject.tissue);\n    const color = `#${teObject.color}`;\n    const borderColor = adjustBrightness(color, 0.85);\n\n    const [distributionCurve, offsetsWithHeight] = getCurve(\n      teObject, y, height, color, borderColor\n    );\n\n    const [medianLine] = getMetricLines(offsetsWithHeight, y, height, color);\n\n    const dataTissue = `data-tissue=\"${teObject.tissue}\"`;\n\n    // Invisible; enables tooltip upon hover anywhere in diagram area,\n    // not merely the (potentially very small) diagram itself\n    const containerAttrs =\n      `height=\"${height + 2}\" ` +\n      `width=\"${maxWidth}px\" ` +\n      'fill=\"#FFF\" ' +\n      'opacity=\"0\" ' +\n      `x=\"0\" ` +\n      `y=\"${y}\" ` +\n      `data-gene=\"${gene}\" ` +\n      dataTissue;\n\n    const textAttrs =\n      `y=\"${y + height}\" ` +\n      `style=\"font-size: ${height}px;\" ` +\n      `x=\"${maxWidth + 10}\" ` +\n      dataTissue;\n\n    return (\n      `<g data-group-tissue=\"${teObject.tissue}\">` +\n      `<text ${textAttrs}>${tissue}</text>` +\n      distributionCurve +\n      medianLine +\n      `<rect ${containerAttrs} class=\"_ideoExpressionTrace\" />` +\n      '</g>'\n    );\n  }).join('');\n\n  let containerStyle = '';\n  const hasStructure = gene in ideo.geneStructureCache;\n  if (!hasStructure) { // e.g. MALAT1\n    containerStyle = 'style=\"margin-bottom: 10px;\"';\n  }\n\n  const plotAttrs = `style=\"margin-top: 15px; margin-bottom: -15px;\"`;\n  const cls = 'class=\"_ideoTissuePlotTitle\"';\n  const titleAttrs = `${cls} style=\"margin-bottom: 4px;\"`;\n  const style = `style=\"position: relative; left: 10px\"`;\n  const plotHtml =\n    `<div class=\"_ideoTissuePlotContainer\" ${containerStyle}>` +\n      `<div class=\"_ideoTissueExpressionPlot\" ${plotAttrs}>\n        <div ${titleAttrs}>Reference expression by tissue</div>\n        <svg width=\"275\" height=\"${y + height + 2}\" ${style}>${rects}</svg>\n        ${moreOrLessToggleHtml}\n      </div>` +\n    '</div>';\n  return plotHtml;\n}\n\nfunction updateTissueExpressionPlot(ideo) {\n  const plot = document.querySelector('._ideoTissueExpressionPlot');\n  const plotParent = plot.parentElement;\n\n  const gene = document.querySelector('#ideo-related-gene').innerText;\n  const tissueExpressions = ideo.tissueExpressionsByGene[gene];\n\n  const newPlotHtml = getExpressionPlotHtml(gene, tissueExpressions, ideo);\n\n  plotParent.innerHTML = newPlotHtml;\n  addTissueListeners(ideo);\n}\n\nfunction colorTissueText(traceDom, color) {\n  const tissue = traceDom.getAttribute('data-tissue');\n  const tissueTextDom = document.querySelector(`text[data-tissue=\"${tissue}\"]`);\n  tissueTextDom.setAttribute('fill', color);\n}\n\nexport function addTissueListeners(ideo) {\n  const moreOrLess = document.querySelector('._ideoMoreOrLessTissue');\n  if (moreOrLess) {\n    moreOrLess.addEventListener('click', (event) => {\n      event.stopPropagation();\n      event.preventDefault();\n      ideo.showTissuesMore = !ideo.showTissuesMore;\n      updateTissueExpressionPlot(ideo);\n    });\n  }\n\n  const traces = document.querySelectorAll('._ideoExpressionTrace')\n  traces.forEach(trace => {\n    trace.addEventListener('mouseenter', () => {\n      colorTissueText(trace, '#338');\n      focusMiniCurve(trace, ideo);\n      addDetailedCurve(trace, ideo);\n    });\n    trace.addEventListener('mouseleave', () => {\n      colorTissueText(trace, '#000');\n      focusMiniCurve(traces[0], ideo, true);\n      removeDetailedCurve(trace, ideo);\n    });\n  });\n}\n\n/**\n * Update mini-curve shapes to focus on hovered tissue\n *\n * This helps compare the focused tissue to other tissues.  Without this,\n * often almost all curves are too small, and their distributions can't be\n * richly compared, because one or a few tissues have a maximum drastically\n * larger than others.  With this feature, expression in those non-dominant\n * tissues (which are often the majority, and biologically relevant) can be\n * compared in detail.\n *\n * The focused tissue becomes the new coordinate reference for all mini-curves.\n * The new reference tissue (refTissue) gets scaled and translated to occupy\n * the full width available to mini-curves (MINI_CURVE_WIDTH).  Other curves get\n * transformed to be viewed from the perspective of the focused tissue.\n **/\nfunction focusMiniCurve(traceDom, ideo, reset=false) {\n  const gene = traceDom.getAttribute('data-gene');\n  const refTissue = reset ? null : traceDom.getAttribute('data-tissue');\n\n  const numTissues = !ideo.showTissuesMore ? 10 : 3;\n  let tissueExpressions = ideo.tissueExpressionsByGene[gene];\n\n  const maxPx = MINI_CURVE_WIDTH;\n  const relative = true;\n  const leftPx = 0;\n  tissueExpressions =\n    setPxOffset(tissueExpressions, maxPx, relative, leftPx, refTissue)\n      .slice(0, numTissues);\n\n  const height = MINI_CURVE_HEIGHT;\n  tissueExpressions.forEach((teObject, i) => {\n    const thisTissue = teObject.tissue;\n    const thisTeObject = tissueExpressions.find(te => te.tissue === thisTissue);\n    const y = getMiniCurveY(i, height);\n\n    const isShifted = !reset;\n    const [newPoints, newOffsets] =\n      getCurveShape(thisTeObject, y, height, 64, isShifted);\n    tissueExpressions[i].points = newPoints;\n\n    const medianLineAttrs =\n      getMetricLineAttrs(newOffsets, 'median', y, height, isShifted);\n    tissueExpressions[i].medianLine = medianLineAttrs;\n  });\n\n  d3.select('._ideoTissueExpressionPlot').selectAll('polyline')\n    .data(tissueExpressions)\n    .transition()\n    .duration(500)\n    .attr('points', (_, i) => tissueExpressions[i].points);\n\n  d3.select('._ideoTissueExpressionPlot').selectAll('._ideoExpressionMedian')\n    .data(tissueExpressions)\n    .attr('style', (_, i) => tissueExpressions[i].medianLine.style)\n    .transition()\n    .duration(500)\n    .attr('x1', (_, i) => tissueExpressions[i].medianLine.x)\n    .attr('x2', (_, i) => tissueExpressions[i].medianLine.x)\n    .attr('y1', (_, i) => tissueExpressions[i].medianLine.y1)\n    .attr('y2', (_, i) => tissueExpressions[i].medianLine.y2)\n    .attr('style', (_, i) => tissueExpressions[i].medianLine.endStyle);\n}\n\nexport function getTissueHtml(annot, ideo) {\n  if (!ideo.tissueCache || !(annot.name in ideo.tissueCache.byteRangesByName)) {\n    // e.g. MIR23A\n    return '<br/>';\n  }\n\n  if (ideo.showTissuesMore === undefined) {\n    ideo.showTissuesMore = true;\n  }\n\n  const gene = annot.name;\n  const tissueExpressions = ideo.tissueExpressionsByGene[gene];\n  if (!tissueExpressions) return;\n  const tissueHtml =\n    getExpressionPlotHtml(gene, tissueExpressions, ideo);\n\n  return tissueHtml;\n}\n","/**\n * @fileoverview Kit used in \"Related genes\" example\n *\n * This file simplifies client code for reusing a \"related genes\" ideogram --\n * which finds and displays related genes for a searched gene.\n *\n * Related genes here are either \"interacting genes\" or \"paralogs\".\n * Interacting genes are genes immediately upstream or downstream of the\n * searched gene in a biochemical pathway. Paralogs are evolutionarily\n * similar genes in the same species.\n *\n * Data sources:\n *   - Interacting genes: WikiPathways\n *   - Paralogs: Ensembl\n *   - Genomic coordinates: Ensembl, via MyGene.info\n *\n * Features provided by this module help users discover and explore genes\n * related to their gene of interest.\n *\n * The reference implementation is available at:\n * https://eweitz.github.io/ideogram/related-genes\n */\n\nimport {decompressSync, strFromU8} from 'fflate';\nimport tippy, {hideAll} from 'tippy.js';\nimport {tippyCss, tippyLightCss} from './tippy-styles';\n\nimport {\n  initAnalyzeRelatedGenes, analyzePlotTimes, analyzeRelatedGenes, timeDiff,\n  getRelatedGenesByType, getRelatedGenesTooltipAnalytics\n} from './analyze-related-genes';\nimport {\n  getGeneStructureHtml, addGeneStructureListeners\n} from './gene-structure';\n\nimport {\n  sortAnnotsByRank, applyRankCutoff, setAnnotRanks\n} from '../annotations/annotations';\nimport {writeLegend} from '../annotations/legend';\nimport {getAnnotDomId} from '../annotations/process';\nimport {\n  getDir, pluralize, getTextSize, getTippyConfig\n} from '../lib';\nimport {\n  fetchGpmls, summarizeInteractions, fetchPathwayInteractions\n} from './wikipathways';\nimport {getTissueHtml, addTissueListeners} from './tissue';\n// import {drawAnnotsByLayoutType} from '../annotations/draw';\n// import {organismMetadata} from '../init/organism-metadata';\n\n/** Sets DOM IDs for ideo.relatedAnnots; needed to associate labels */\nfunction setRelatedAnnotDomIds(ideo) {\n  const updated = [];\n\n  const sortedChrNames = ideo.chromosomesArray.map((chr) => {\n    return chr.name;\n  });\n\n  if ('relatedAnnots' in ideo) {\n    ideo.relatedAnnots = applyAnnotsIncludeList(ideo.relatedAnnots, ideo);\n\n    // Count two related annots for same gene as one.\n    // E.g. gene Foo can both interact with and be paralog of gene Bar\n    // Instead of count Foo interacting annot and Foo paralog annot as two,\n    // only count it as one as they are merged in downstream UI.\n    //\n    // Searching STAT3 without this block shows the problem this fixes.\n    const seenNames = {};\n    ideo.relatedAnnots = ideo.relatedAnnots.filter(annot => {\n      if (annot.name in seenNames) {\n        return false;\n      }\n      seenNames[annot.name] = 1;\n      return true;\n    });\n  }\n\n  // Arrange related annots by chromosome\n  const annotsByChr = {};\n  ideo.annots.forEach((annot) => {\n    const relevanceSortedAnnots = annot.annots.sort((a, b) => {\n      return -ideo.annotSortFunction(a, b);\n    });\n    annotsByChr[annot.chr] = relevanceSortedAnnots;\n    // }\n  });\n\n\n  // // Sort related annots by relevance within each chromosome\n  // const relevanceSortedAnnotsNamesByChr = {};\n  // Object.entries(annotsByChr).map(([chr, annots]) => {\n\n  //   if ('annots' in annots) annots = annots.annots;\n  //   annots = setAnnotRanks(annots, ideo);\n\n  //   // Sort so first annots are drawn last, and thus at top layer\n  //   annots = annots.sort((a, b) => ideo.annotSortFunction(a, b));\n\n  //   const annotNames = annots.map((annot) => annot.name);\n  //   relevanceSortedAnnotsNamesByChr[chr] = annotNames;\n  // });\n\n  // annotsByChr.annots.sort((a, b) => {\n  //   // Reverse-sort, so first annots are drawn last, and thus at top layer\n  //   return -ideo.annotSortFunction(a, b);\n  // });\n\n  const updatedAnnots = {};\n  Object.entries(annotsByChr).forEach(([chr, annots]) => {\n    updatedAnnots[chr] = {chr, annots: []};\n    annots.forEach((annot, annotIndex) => {\n\n      // Annots have DOM IDs keyed by chromosome index and annotation index.\n      // We reconstruct those here using structures built in two blocks above.\n      const chrIndex = sortedChrNames.indexOf(chr);\n      // const annotIndex =\n      //   relevanceSortedAnnotsNamesByChr[chr].indexOf(annot.name);\n\n      annot.domId = getAnnotDomId(chrIndex, annotIndex);\n      updatedAnnots[chr].annots.push(annot);\n    });\n    updated.push(updatedAnnots[chr]);\n  });\n\n  ideo.annots = updated;\n}\n\n/**\n * Determines if interaction node might be a gene\n *\n * Some interaction nodes are biological processes; this filters out many.\n * Filtering these out makes downstream queries faster.\n *\n * ixn {Object} Interaction from WikiPathways\n * gene {Object} Gene from MyGene.info\n */\nfunction maybeGeneSymbol(ixn, gene) {\n  return (\n    ixn !== '' &&\n    !ixn.includes(' ') &&\n    !ixn.includes('/') && // e.g. Akt/PKB\n    ixn.toLowerCase() !== gene.name.toLowerCase()\n  );\n}\n\n// /** Helpful for debugging race conditions caused by concurrency */\n// const sleep = (delay) => {\n//  new Promise((resolve) => setTimeout(resolve, delay));\n// }\n\n/** Reports if interaction node is a gene and not previously seen */\nfunction isInteractionRelevant(rawIxn, gene, nameId, seenNameIds, ideo) {\n  let isGeneSymbol;\n  if ('geneCache' in ideo && gene.name) {\n    isGeneSymbol = rawIxn.toLowerCase() in ideo.geneCache.nameCaseMap;\n  } else {\n    isGeneSymbol = maybeGeneSymbol(rawIxn, gene);\n  }\n\n  return isGeneSymbol && !(nameId in seenNameIds);\n}\n\n/**\n * Retrieves interacting genes from WikiPathways API\n *\n * Docs:\n * https://webservice.wikipathways.org/ui/\n * https://www.wikipathways.org/index.php/Help:WikiPathways_Webservice/API\n *\n * Examples:\n * https://webservice.wikipathways.org/findInteractions?query=ACE2&format=json\n * https://webservice.wikipathways.org/findInteractions?query=RAD51&format=json\n */\nasync function fetchInteractions(gene, ideo) {\n  const ixns = {};\n  const seenNameIds = {};\n  const orgNameSimple = ideo.config.organism.replace(/-/g, ' ');\n  const upperGene = gene.name.toUpperCase();\n\n  let data = {result: []};\n\n  if (ideo.interactionCache) {\n    if (upperGene in ideo.interactionCache) {\n      data = ideo.interactionCache[upperGene];\n    }\n  } else {\n\n    // const queryString = `?query=${gene.name}&format=json`;\n    // const url =\n    //   `https://webservice.wikipathways.org/findInteractions${queryString}`;\n    // const url = `http://localhost:8080/dist/data/cache/${gene.name}.json.gz`;\n    const url = `https://cdn.jsdelivr.net/npm/ixn2/${upperGene}.json.gz`;\n\n    // await sleep(3000);\n\n    const response = await fetch(url);\n    // const data = await response.json();\n\n    if (response.ok) {\n      const blob = await response.blob();\n      const uint8Array = new Uint8Array(await blob.arrayBuffer());\n      data = JSON.parse(strFromU8(decompressSync(uint8Array)));\n    }\n  }\n\n  // For each interaction, get nodes immediately upstream and downstream.\n  // Filter out pathway nodes that are definitely not gene symbols, then\n  // group pathways by gene symbol. Each interacting gene can have\n  // multiple pathways.\n  data.result.forEach(interaction => {\n    if (interaction.species.toLowerCase() === orgNameSimple) {\n      const right = interaction.fields.right.values;\n      const left = interaction.fields.left.values;\n      // let mediator = [];\n      // if ('mediator' in interaction.fields) {\n      //   mediator = interaction.fields.mediator.values;\n      //   console.log('mediator', mediator)\n      // }\n      // const rawIxns = right.concat(left, mediator);\n      const rawIxns = right.concat(left);\n      const name = interaction.name;\n      const id = interaction.id;\n\n      // rawIxns can contain multiple genes, e.g. when\n      // a group (i.e. a complex or a set of paralogs)\n      // interacts with the searched gene\n      const wrappedRawIxns = rawIxns.map(rawIxn => {\n        return {name: rawIxn, color: ''};\n      });\n      const sortedRawIxns =\n        sortAnnotsByRank(wrappedRawIxns, ideo).map(i => i.name);\n\n      sortedRawIxns.forEach(rawIxn => {\n\n        const normRawIxn = rawIxn.toLowerCase();\n\n        // Prevent overwriting searched gene.  Occurs with e.g. human CD4\n        if (normRawIxn.includes(gene.name.toLowerCase())) return;\n\n        // if (rawIxn === '') return; // Avoid oddly blank placeholders\n\n        const nameId = name + id;\n\n        const isRelevant =\n          isInteractionRelevant(normRawIxn, gene, nameId, seenNameIds, ideo);\n\n        if (isRelevant) {\n          seenNameIds[nameId] = 1;\n          const ixn = {name, pathwayId: id};\n          if (normRawIxn in ixns) {\n            ixns[normRawIxn].push(ixn);\n          } else {\n            ixns[normRawIxn] = [ixn];\n          }\n        }\n      });\n    }\n  });\n\n  return ixns;\n}\n\n/**\n * Queries MyGene.info API, returns parsed JSON\n *\n * Docs:\n * https://docs.mygene.info/en/v3/\n *\n * Example:\n * https://mygene.info/v3/query?q=symbol:cdk2%20OR%20symbol:brca1&species=9606&fields=symbol,genomic_pos,name\n */\nasync function fetchMyGeneInfo(queryString) {\n  const myGeneBase = 'https://mygene.info/v3/query';\n  const response = await fetch(myGeneBase + queryString + '&size=400');\n  const data = await response.json();\n  return data;\n}\n\nfunction parseNameAndEnsemblIdFromMgiGene(gene) {\n  const name = gene.name;\n  const id = gene.genomic_pos.ensemblgene;\n  let ensemblId = id;\n  if (typeof id === 'undefined') {\n    // Encountered in AKT3, when querying related genes for MTOR\n    // A 'chr'omosome value containing _ indicates an alt loci scaffold,\n    // so ignore that and take the Ensembl ID associated with the\n    // first position of a primary chromosome.\n    ensemblId =\n      gene.genomic_pos.filter(pos => !pos.chr.includes('_'))[0].ensemblgene;\n  }\n  return {name, ensemblId};\n}\n\n// /**\n//  * Summarizes genes in a pathway\n//  *\n//  * This comprises most of the content for tooltips for pathway genes.\n//  */\n//  function describePathwayGene(pathwayGene, searchedGene, pathway, summary) {\n//   let ixnsDescription = '';\n\n//   const pathwaysBase = 'https://www.wikipathways.org/index.php/Pathway:';\n//   const url = `${pathwaysBase}${pathway.id}`;\n//   const attrs =\n//     `href=\"${url}\" ` +\n//     `target=\"_blank\" ` +\n//     `title=\"See pathway diagram in WikiPathways\"`;\n//   ixnsDescription =\n//     `${summary} ${searchedGene.name} in:</br/>` +\n//     `<a ${attrs}>${pathway.name}</a>`;\n\n//   const {name, ensemblId} = parseNameAndEnsemblIdFromMgiGene(pathwayGene);\n//   const type = 'pathway gene';\n//   const descriptionObj = {\n//     description: ixnsDescription,\n//     ixnsDescription, ensemblId, name, type\n//   };\n//   return descriptionObj;\n// }\n\n// /** Limit number of shown interaction links, and enable toggling full list */\n// function limitInteractionLinks(links) {\n//   if (links.length > 5) {\n//     // Seen in e.g. interacting gene AKT1 for MTOR searched gene\n//     const numMore = links.length - 5;\n//     links = links.slice(0, 5);\n//     const moreText = `${numMore} more ${pluralize('pathway', numMore)}`;\n//     const attrs = 'id=\"_ideoIxnLinkToggler\" style=\"font-style: italic\"';\n//     const toggler = `<span ${attrs}>${moreText}</span>`;\n//     links.push(`<span ${attrs}>${moreText}</span>`);\n//   }\n//   return links;\n// }\n\n// function toggleInteractionLinks() {\n//   const ixnLinkToggler = document.querySelector('._ideoIxnLinkToggler');\n// }\n\n/**\n * Summarizes interactions for a gene\n *\n * This comprises most of the content for tooltips for interacting genes.\n */\nfunction describeInteractions(gene, ixns, searchedGene) {\n  const pathwayIds = [];\n  const pathwayNames = [];\n  let ixnsDescription = '';\n\n  if (typeof ixns !== 'undefined') {\n    // ixns is undefined when querying e.g. CDKN1B in human\n    let links = ixns.map(ixn => {\n      // pathwayIds.push(ixn.pathwayId);\n      // pathwayNames.push(ixn.name);\n      // const attrs =\n      //   `class=\"ideo-pathway-link\" ` +\n      //   `title=\"Click to search for other genes in this pathway\" ` +\n      //   `style=\"cursor: pointer\" ` +\n      //   `data-pathway-id=\"${ixn.pathwayId}\" ` +\n      //   `data-pathway-name=\"${ixn.name}\"`;\n      // return `<a ${attrs}>${ixn.name}</a>`;\n\n      const pathwaysBase = 'https://classic.wikipathways.org/index.php/Pathway:';\n      const url = `${pathwaysBase}${ixn.pathwayId}`;\n      pathwayIds.push(ixn.pathwayId);\n      pathwayNames.push(ixn.name);\n      const attrs =\n        `class=\"ideo-pathway-link\" ` +\n        `title=\"View in WikiPathways\" ` +\n        `data-pathway-id=\"${ixn.pathwayId}\" ` +\n        `target=\"_blank\" ` +\n        `href=\"${url}\"`;\n      return `<a ${attrs}>${ixn.name}</a>`;\n    });\n\n    // links = limitInteractionLinks(links);\n\n    links = links.join('<br/>');\n\n    ixnsDescription =\n      `Interacts with ${searchedGene.name} in:<br/>${links}`;\n  }\n\n  const {name, ensemblId} = parseNameAndEnsemblIdFromMgiGene(gene);\n  const type = 'interacting gene';\n  const descriptionObj = {\n    description: ixnsDescription,\n    ixnsDescription, ensemblId, name, type, pathwayIds, pathwayNames\n  };\n  return descriptionObj;\n}\n\n/** Throw error when searched gene (e.g. \"Foo\") isn't found */\nfunction throwGeneNotFound(geneSymbol, ideo) {\n  const organism = ideo.organismScientificName;\n  throw Error(`\"${geneSymbol}\" is not a known gene in ${organism}`);\n}\n\n/**\n * Lookup genes by synonym, a.k.a. alias\n *\n * E.g. getGeneBySynonym(\"p53\", ideo) returns \"TP53\"\n */\nfunction getGeneBySynonym(name, ideo) {\n  if (!ideo.synonymCache) return null;\n\n  const nameLc = name.toLowerCase();\n\n  if (!ideo.synonymCache?.nameCaseMap) {\n    // JIT initialization of canonicalized synonym lookup data.\n    // Done only once.\n    const nameCaseMap = {};\n    for (const gene in ideo.synonymCache.byGene) {\n      const synonyms = ideo.synonymCache.byGene[gene];\n      nameCaseMap[gene.toLowerCase()] = synonyms.map(s => s.toLowerCase());\n    }\n    ideo.synonymCache.nameCaseMap = nameCaseMap;\n  }\n\n  const nameCaseMap = ideo.synonymCache.nameCaseMap;\n  for (const geneLc in nameCaseMap) {\n    const synonymsLc = nameCaseMap[geneLc];\n    if (synonymsLc.includes(nameLc)) {\n      // Got a hit!  Return standard gene symbol, e.g. \"tp53\" -> \"TP53\".\n      return ideo.geneCache.nameCaseMap[geneLc];\n    }\n  }\n\n  return null;\n}\n\n/**\n * Fetch genes from cache\n * Construct objects that match format of MyGene.info API response\n */\nfunction fetchGenesFromCache(names, type, ideo) {\n  const cache = ideo.geneCache;\n  const isSymbol = (type === 'symbol');\n  const locusMap = isSymbol ? cache.lociByName : cache.lociById;\n  const nameMap = isSymbol ? cache.idsByName : cache.namesById;\n\n  const hits = names.map(name => {\n\n    const nameLc = name.toLowerCase();\n\n    if (\n      !locusMap[name] &&\n      !cache.nameCaseMap[nameLc] &&\n      !getGeneBySynonym(name, ideo)\n    ) {\n      if (isSymbol) {\n        throwGeneNotFound(name, ideo);\n      } else {\n        return;\n      }\n    }\n\n    let isSynonym = false;\n    let synonym = null;\n\n    // Canonicalize name if it is mistaken in upstream data source.\n    // This can sometimes happen in WikiPathways, e.g. when searching\n    // interactions for rat Pten, it includes a result for \"PIK3CA\".\n    // In that case, this would correct PIK3CA to be Pik3ca.\n    if (isSymbol && !locusMap[name]) {\n      if (cache.nameCaseMap[nameLc]) {\n        name = cache.nameCaseMap[nameLc];\n      } else {\n        synonym = name;\n        name = getGeneBySynonym(synonym, ideo);\n        isSynonym = true;\n      }\n    }\n\n    const locus = locusMap[name];\n    const symbol = isSymbol ? name : nameMap[name];\n    const ensemblId = isSymbol ? nameMap[name] : name;\n    const fullName = cache.fullNamesById[ensemblId];\n\n    const hit = {\n      symbol,\n      name: fullName,\n      source: 'cache',\n      genomic_pos: {\n        chr: locus[0],\n        start: locus[1],\n        end: locus[2],\n        ensemblgene: ensemblId\n      },\n      isSynonym,\n      synonym\n    };\n\n    return hit;\n  });\n\n  const hitsWithGenomicPos = hits.filter(hit => hit !== undefined);\n\n  return hitsWithGenomicPos;\n}\n\n/** Wait for a certain time (delay) in milliseconds */\nfunction wait(delay) {\n  return new Promise((resolve) => setTimeout(resolve, delay));\n}\n\n/**\n * Get time to wait before retrying a fail service, gracefully\n *\n * The returned wait time helps avoid flooding the server\n */\nfunction exponentialBackoffWithJitter(numFailures, baseWaitMs) {\n  const jitter = 10 * Math.random();\n  return Math.round(baseWaitMs + jitter) * (numFailures ** 2);\n}\n\nasync function retryFetch(requestedThing, numLimit, fn, args) {\n\n  const numFailed = numFailedFetches[requestedThing];\n  if (numFailed > numLimit) {\n    const preamble = 'Failed to fetch from Ideogram third-party service for: ';\n    throw new TypeError(preamble + requestedThing);\n  }\n\n  numFailedFetches[requestedThing] += 1;\n\n  // Exponential backoff\n  const baseWaitMs = 500;\n  const waitMilliseconds = exponentialBackoffWithJitter(numFailed, baseWaitMs);\n\n  console.log(\n    `Failed fetch for ${requestedThing} ${numFailed} times, ` +\n    `retrying in ${waitMilliseconds} ms`\n  );\n\n  await wait(waitMilliseconds);\n  return await fn(...args);\n}\n\n/** Number of times fetches for various things have consecutively failed */\nconst numFailedFetches = {\n  genes: 0\n};\n\n/** Fetch genes from cache, or, if needed, from MyGene.info API */\nasync function fetchGenes(names, type, ideo) {\n\n  let data;\n\n  // Account for single-gene fetch\n  if (typeof names === 'string') names = [names];\n\n  // Query parameter for MyGene.info API\n  const qParam = names.map(name => `${type}:${name.trim()}`).join(' OR ');\n  const taxid = ideo.config.taxid;\n\n  const queryStringBase = `?q=${qParam}&species=${taxid}&fields=`;\n\n  if (ideo.geneCache) {\n    const hits = fetchGenesFromCache(names, type, ideo);\n\n    // Asynchronously fetch full name, but don't await the response, because\n    // full names are only shown upon hovering over an annotation.\n    hits.forEach((hit) => {\n      const symbol = hit.symbol;\n      const fullName = hit.name;\n      const isSynonym = hit.isSynonym;\n      const synonym = hit.synonym;\n      if (symbol in ideo.annotDescriptions.annots) {\n        ideo.annotDescriptions.annots[symbol].name = fullName;\n        ideo.annotDescriptions.annots[symbol].isSynonym = hit.isSynonym;\n        ideo.annotDescriptions.annots[symbol].synonym = hit.synonym;\n      } else {\n        ideo.annotDescriptions.annots[symbol] = {\n          name: fullName,\n          isSynonym,\n          synonym\n        };\n      }\n    });\n\n    data = {hits, fromGeneCache: true};\n  } else {\n    // Fetch gene data from MyGene.info\n    const queryString = `${queryStringBase}symbol,genomic_pos,name`;\n    try {\n      data = await fetchMyGeneInfo(queryString);\n    } catch (error) {\n      const isFailedFetch = (error.message === 'Failed to fetch');\n      if (isFailedFetch && navigator.onLine) {\n        // Retry fetching 3 times, waiting longer each time\n        data = await retryFetch('genes', 3, fetchGenes, [names, type, ideo]);\n      }\n    }\n  }\n\n  return data;\n}\n\n/**\n * Retrieves position and other data on interacting genes from MyGene.info\n */\nasync function fetchInteractionAnnots(interactions, searchedGene, ideo) {\n\n  const annots = [];\n  const symbols = Object.keys(interactions);\n\n  if (symbols.length === 0) return annots;\n\n  const data = await fetchGenes(symbols, 'symbol', ideo);\n\n  data.hits.forEach(gene => {\n    // If hit lacks position\n    // or is same as searched gene (e.g. search for human SRC),\n    // then skip processing\n    if (\n      'genomic_pos' in gene === false ||\n      gene.symbol === searchedGene.name\n    ) {\n      return;\n    }\n\n    const annot = parseAnnotFromMgiGene(gene, ideo, 'purple');\n    annots.push(annot);\n\n    const ixns = interactions[gene.symbol.toLowerCase()];\n\n    const descriptionObj = describeInteractions(gene, ixns, searchedGene);\n\n    mergeDescriptions(annot, descriptionObj, ideo);\n  });\n\n  // Fetch GPML files to use when updating interaction descriptions with\n  // refined direction.\n  fetchGpmls(ideo);\n\n  return annots;\n}\n\n/** Fetch paralog positions from MyGeneInfo */\nasync function fetchParalogPositionsFromMyGeneInfo(\n  homologs, searchedGene, ideo\n) {\n  const annots = [];\n\n  const cached = homologs.length && typeof homologs[0] === 'string';\n  const ensemblIds = cached ? homologs : homologs.map(homolog => homolog.id);\n  const data = await fetchGenes(ensemblIds, 'ensemblgene', ideo);\n\n  data.hits.forEach(gene => {\n\n    // If hit lacks position, skip processing\n    if ('genomic_pos' in gene === false) return;\n    if ('name' in gene === false) return;\n\n    const annot = parseAnnotFromMgiGene(gene, ideo, 'pink');\n    annots.push(annot);\n\n    const description =\n      ideo.tissueCache ? '' : `Paralog of ${searchedGene.name}`;\n\n    const {name, ensemblId} = parseNameAndEnsemblIdFromMgiGene(gene);\n    const type = 'paralogous gene';\n    const descriptionObj = {description, ensemblId, name, type};\n    mergeDescriptions(annot, descriptionObj, ideo);\n  });\n\n  return annots;\n}\n\nfunction drawNeighborhoods(neighborhoodAnnots, ideo) {\n  neighborhoodAnnots = applyAnnotsIncludeList(neighborhoodAnnots, ideo);\n  ideo.drawAnnots(neighborhoodAnnots, 'overlay', true, true);\n  moveLegend(ideo);\n}\n\n/** Plot paralog neighborhoods */\nfunction plotParalogNeighborhoods(annots, ideo) {\n  if (!ideo.config.showParalogNeighborhoods) return;\n\n  if (ideo.neighborhoodAnnots?.length > 0) {\n    ideo.neighborhoodAnnots.forEach(annot => {\n      ideo.annotDescriptions.annots[annot.name] = annot;\n    });\n\n    drawNeighborhoods(ideo.neighborhoodAnnots, ideo);\n    return;\n  }\n\n  const searchedAnnot = ideo.relatedAnnots[0];\n  annots = applyAnnotsIncludeList(annots, ideo);\n\n  annots.unshift(searchedAnnot);\n\n  if (annots.length < 2) return;\n\n  // Arrays of paralogs within 10 Mbp of each other\n  const neighborhoods = {};\n\n  neighborhoods[annots[0].chr] = {};\n  neighborhoods[annots[0].chr][annots[0].start] = [annots[0]];\n\n  const windowInt = 2_000_000;\n  const windowProse = '2 Mbp';\n\n  for (let i = 1; i < annots.length; i++) {\n    const annot = annots[i];\n    const chr = annot.chr;\n    const start = annot.start;\n    if (chr in neighborhoods) {\n      const starts = Object.keys(neighborhoods[chr]);\n      for (let j = 0; j < starts.length; j++) {\n        const startJInt = parseInt(starts[j]);\n        if (Math.abs(start - startJInt) < windowInt) {\n          neighborhoods[chr][startJInt].push(annot);\n        } else {\n          neighborhoods[chr][start] = [annot];\n        }\n      }\n    } else {\n      neighborhoods[chr] = {};\n      neighborhoods[chr][start] = [annot];\n    }\n  }\n\n  // Big enough to see and hover\n  const overlayAnnotLength = 15_000_000;\n\n  const searchedGene = searchedAnnot.name;\n\n  const neighborhoodAnnots =\n    Object.entries(neighborhoods).map(([chr, neighborhood], index) => {\n      const start = parseInt(Object.keys(neighborhood)[0]);\n      let paralogs = Object.values(neighborhood)[0];\n\n      if (paralogs.length < 2) {\n        return {paralogs};\n      }\n\n      let includesSearched = false;\n      if (paralogs[0].name === searchedAnnot.name) {\n        paralogs = paralogs.slice(1);\n        includesSearched = true;\n      }\n\n      // paralogs.map(paralog => {\n      //   console.log(paralog);\n      // })\n\n      const paralogsText = pluralize('paralog', paralogs.length)\n      const description =\n        `${paralogs.length} nearby ${paralogsText} of ${searchedGene}`;\n\n      const chrLength = ideo.chromosomes[ideo.config.taxid][chr].bpLength;\n      let annotStart = start - overlayAnnotLength/2;\n      let annotStop = start + overlayAnnotLength/2;\n      if (annotStop > chrLength) {\n        annotStart = start - overlayAnnotLength;\n        annotStop = chrLength;\n      } else if (annotStart < 1) {\n        annotStart = 1;\n        annotStop = overlayAnnotLength;\n      };\n\n      if ('geneCache' in ideo) {\n        paralogs = paralogs.map(paralog => {\n          paralog.fullName = ideo.geneCache.fullNamesById[paralog.id];\n\n          const ranks = ideo.geneCache.interestingNames;\n          if (ranks.includes(paralog.name)) {\n            paralog.rank = ranks.indexOf(paralog.name) + 1;\n          } else {\n            paralog.rank = 1E10;\n          }\n\n          return paralog;\n        });\n      }\n\n      const key = 'paralogNeighborhood-' + index;\n      const fStart = start.toLocaleString(); // Format for readability\n      const displayCoordinates = `chr${chr}:${fStart} ± ${windowProse}`;\n\n      const annot = {\n        name: key,\n        chr,\n        start: annotStart,\n        stop: annotStop,\n        color: 'pink',\n        description,\n        paralogs,\n        type: 'paralog neighborhood',\n        displayCoordinates,\n        includesSearched\n      };\n\n      ideo.annotDescriptions.annots[annot.name] = annot;\n      return annot;\n    }).filter(n => n.paralogs.length > 1 || n.includesSearched);\n\n  ideo.neighborhoodAnnots = neighborhoodAnnots;\n\n  if (neighborhoodAnnots.length > 0) {\n    drawNeighborhoods(neighborhoodAnnots, ideo);\n  }\n}\n\n/**\n * Fetch paralogs of searched gene\n */\nasync function fetchParalogs(annot, ideo) {\n  const taxid = ideo.config.taxid;\n\n  let homologs;\n  // Fetch paralogs\n  if (ideo.paralogCache) {\n    // const baseUrl = 'http://localhost:8080/dist/data/cache/paralogs/';\n    // const url = `${baseUrl}homo-sapiens/${annot.name}.tsv`;\n    // const response = await fetch(url);\n    // const oneRowTsv = await response.text();\n    // const rawHomologEnsemblIds = oneRowTsv.split('\\t');\n    // homologs = rawHomologEnsemblIds.map(r => getEnsemblId('ENSG', r));\n    const paralogsByName = ideo.paralogCache.paralogsByName;\n    const nameUc = annot.name.toUpperCase();\n    const hasParalogs = nameUc in paralogsByName;\n    homologs = hasParalogs ? paralogsByName[nameUc] : [];\n  } else {\n    const params = `&format=condensed&type=paralogues&target_taxon=${taxid}`;\n    const path = `/homology/id/${annot.id}?${params}`;\n    const ensemblHomologs = await Ideogram.fetchEnsembl(path);\n    homologs = ensemblHomologs.data[0].homologies;\n  }\n\n  // Fetch positions of paralogs\n  let annots =\n    await fetchParalogPositionsFromMyGeneInfo(homologs, annot, ideo);\n\n  // Omit genes named like \"AC113554.1\", which is an \"accession.version\".\n  // Such accVers are raw and poorly suited here.\n  annots = annots.filter(annot => {\n    const isAccVer = annot.name.match(/^AC[0-9.]+$/);\n    return !isAccVer;\n  });\n\n  return annots;\n}\n\n/**\n * Filters out placements on alternative loci scaffolds, an advanced\n * genome assembly feature we are not concerned with in ideograms.\n *\n * Example:\n * https://mygene.info/v3/query?q=symbol:PTPRC&species=9606&fields=symbol,genomic_pos,name\n */\nfunction getGenomicPos(gene, ideo) {\n  let genomicPos = null;\n  if (Array.isArray(gene.genomic_pos)) {\n    genomicPos = gene.genomic_pos.filter(pos => {\n      return pos.chr in ideo.chromosomes[ideo.config.taxid];\n    })[0];\n  } else {\n    genomicPos = gene.genomic_pos;\n  }\n  return genomicPos;\n}\n\n/**\n * Transforms MyGene.info (MGI) gene into Ideogram annotation\n */\nfunction parseAnnotFromMgiGene(gene, ideo, color='red') {\n  const genomicPos = getGenomicPos(gene, ideo);\n\n  const annot = {\n    name: gene.symbol,\n    chr: genomicPos.chr,\n    start: genomicPos.start,\n    stop: genomicPos.end,\n    id: genomicPos.ensemblgene,\n    color\n  };\n\n  return annot;\n}\n\n/** Return type (interacting, paralogous, or searched) of legend entry */\nfunction getLegendType(li) {\n  const lcText = li.innerText.toLowerCase();\n\n  let type;\n  if (lcText.includes('interacting')) type = 'interacting';\n  if (lcText.includes('paralogous')) type = 'paralogous';\n  if (lcText.includes('searched')) type = 'searched';\n\n  return type;\n}\n\n/** Return color (purple, pink, or red) of legend entry */\nfunction getLegendEntryColor(li) {\n  const type = getLegendType(li);\n\n  const colorMap = {\n    'interacting': 'purple',\n    'paralogous': 'pink',\n    'searched': 'red'\n  };\n  const color = colorMap[type];\n\n  return color;\n}\n\n/** Highlight / filter upon hovering over legend entry */\nfunction highlightByType(li, ideo) {\n  li.classList += ' active';\n\n  const selectedColor = getLegendEntryColor(li);\n\n  if (ideo.config.showAnnotLabels) {\n    ideo.clearAnnotLabels();\n\n    ideo.flattenAnnots().forEach(annot => {\n      if (annot.color !== selectedColor) {\n        document.getElementById(annot.domId).style.display = 'none';\n      }\n    });\n\n    const sortedAnnots = ideo.flattenAnnots().sort((a, b) => {\n      return ideo.annotSortFunction(a, b);\n    }).filter(annot => annot.color === selectedColor);\n\n    const numLabels = Math.min(sortedAnnots.length, 20);\n    ideo.fillAnnotLabels(sortedAnnots, numLabels);\n  }\n}\n\n/** Remove highlight / filter upon hovering out of legend entry */\nfunction dehighlightAll(ideo) {\n  document.querySelectorAll('#_ideogramLegend li').forEach(li => {\n    li.classList.remove('active');\n  });\n\n  ideo.flattenAnnots().forEach(annot => {\n    document.getElementById(annot.domId).style.display = null;\n  });\n\n  if (ideo.config.showAnnotLabels) {\n    const sortedAnnots = ideo.flattenAnnots().sort((a, b) => {\n      return ideo.annotSortFunction(a, b);\n    });\n\n    ideo.fillAnnotLabels(sortedAnnots);\n  }\n}\n\nfunction initInteractiveLegend(ideo) {\n  // Highlight and filter annotations by type on hovering over legend entries\n  function highlight(event) {\n    const li = event.target;\n    highlightByType(li, ideo);\n    if (ideo.onHoverLegendCallback) {\n      ideo.onHoverLegendCallback();\n    }\n  }\n  // // Highlight and filter annotations by type on hovering over legend entries\n  // WIP: 14373b18319e99febd91816fbc0c1b2e0f20f277\n  // function toggleHighlight(event) {\n  //   const li = event.target;\n  //   return toggleHighlightByType(li, ideo);\n  // }\n  function dehighlight() {\n    dehighlightAll(ideo);\n  }\n  const entrySelector = '#_ideogramLegend li._ideoLegendEntry';\n  document.querySelectorAll(entrySelector).forEach(li => {\n    // li.addEventListener('click', toggleHighlight);\n    // WIP: 14373b18319e99febd91816fbc0c1b2e0f20f277\n    li.addEventListener('mouseenter', highlight);\n    li.addEventListener('mouseleave', dehighlight);\n\n    const legendType = getLegendType(li);\n    const tippyContentMap = {\n      'interacting':\n        'Adjacent to searched gene in a biochemical pathway, ' +\n        'per WikiPathways',\n      'paralogous':\n        'Evolutionarily related to searched gene ' +\n        'by a duplication event, per Ensembl'\n    };\n    // const placement = 'data-tippy-placement=\"top-end\"';\n    const placement = '';\n    const tippy =\n      `data-tippy-content=\"${tippyContentMap[legendType]}\" ${placement}`;\n    const reset = 'position: inherit; left: inherit';\n    // const glossary = 'text-decoration: underline dashed;';\n    // const style = `style=\"${glossary} ${reset}`;\n    const style = `style=\"${reset}\"`;\n    const attrs = `class=\"_ideoLegendEntry\" ${style} ${tippy}`;\n    if (legendType === 'paralogous') {\n      li.innerHTML = `<span ${attrs}>Paralogous genes</span>`;\n    } else if (legendType === 'interacting') {\n      li.innerHTML = `<span ${attrs}>Interacting genes</span>`;\n    }\n  });\n\n  const css =\n    `<style>\n    ${tippyCss}\n\n    .tippy-box {\n      font-size: 12px;\n    }\n\n    .tippy-content {\n      padding: 3px 7px;\n    }\n\n    #_ideogramLegend li {\n      padding-left: 5px;\n      border-radius: 2px;\n    }\n\n    #_ideogramLegend li.active {\n      color: #00C;\n      background-color: #EEF;\n    }\n    </style>`;\n  const legendDom = document.querySelector('#_ideogramLegend');\n  legendDom.insertAdjacentHTML('afterBegin', css);\n  const tippyConfig = getTippyConfig();\n  tippyConfig.maxWidth = 180;\n  tippyConfig.offset = [-30, 10];\n  ideo.legendTippy =\n    tippy('._ideoLegendEntry[data-tippy-content]', tippyConfig);\n}\n\nfunction moveLegend(ideo, extraPad=0) {\n  const ideoInnerDom = document.querySelector('#_ideogramInnerWrap');\n  const decorPad = setRelatedDecorPad({}).legendPad;\n  const left = decorPad + 20 + extraPad;\n  const legendStyle = `position: absolute; top: 15px; left: ${left}px`;\n\n  const legend = document.querySelector('#_ideogramLegend');\n  ideoInnerDom.prepend(legend);\n  legend.style = legendStyle;\n\n  initInteractiveLegend(ideo);\n}\n\n/**\n * Filter annotations to only include those in configured list\n *\n * @return {List<Object>} includedAnnots List of filtered annots objects\n */\nfunction applyAnnotsIncludeList(annots, ideo) {\n  if (ideo.config.annotsInList === 'all') return annots;\n\n  const includedAnnots = [];\n  annots.forEach(annot => {\n    if (ideo.config.annotsInList.includes(annot.name.toLowerCase())) {\n      includedAnnots.push(annot);\n    }\n  });\n  return includedAnnots;\n}\n\nfunction filterByAnnotsIncludeList(annots, ideo) {\n  if (ideo.config.annotsInList === 'all') return annots;\n\n  const annotsInList = ideo.config.annotsInList;\n\n  const updated = [];\n  const updatedAnnots = {};\n  ideo.annots.forEach(chrAnnots => {\n    const {chr, annots} = chrAnnots;\n    updatedAnnots[chr] = {chr, annots: []};\n    annots.forEach((annot) => {\n\n      const lcAnnotName = annot.name.toLowerCase();\n      if (\n        'relatedAnnots' in ideo &&\n        !annotsInList.includes(lcAnnotName)\n      ) {\n        return;\n      }\n\n      updatedAnnots[chr].annots.push(annot);\n    });\n    updated.push(updatedAnnots[chr]);\n  });\n  return updated;\n}\n\n/** Fetch and draw interacting genes, return Promise for annots */\nfunction processInteractions(annot, ideo) {\n  return new Promise(async (resolve) => {\n    const t0 = performance.now();\n\n    const interactions = await fetchInteractions(annot, ideo);\n    const annots = await fetchInteractionAnnots(interactions, annot, ideo);\n\n    ideo.relatedAnnots.push(...annots);\n    finishPlotRelatedGenes('interacting', ideo);\n\n    ideo.time.rg.interactions = timeDiff(t0);\n    plotParalogNeighborhoods(annots, ideo);\n\n    resolve();\n  });\n}\n\n/** Find and draw paralogs, return Promise for annots */\nfunction processParalogs(annot, ideo) {\n  return new Promise(async (resolve) => {\n    const t0 = performance.now();\n\n    const annots = await fetchParalogs(annot, ideo);\n    ideo.relatedAnnots.push(...annots);\n    finishPlotRelatedGenes('paralogous', ideo);\n    plotParalogNeighborhoods(annots, ideo);\n\n    ideo.time.rg.paralogs = timeDiff(t0);\n\n    resolve();\n  });\n}\n\n// /**\n//  * Sorts gene names consistently.\n//  *\n//  * Might also loosely rank by first-discovered or most prominent\n//  */\n// function sortGeneNames(aName, bName) {\n//   // Rank shorter names above longer names\n//   if (bName.length !== aName.length) return bName.length - aName.length;\n\n//   // Rank names of equal length alphabetically\n//   return [aName, bName].sort().indexOf(aName) === 0 ? 1 : -1;\n// }\n\n/** Sorts by relevance of related type, then rank */\nexport function sortByRelatedType(a, b) {\n  var aName, bName, aColor, bColor;\n  if ('name' in a) {\n    // Locally processed annotations\n    aName = a.name;\n    bName = b.name;\n    aColor = a.color;\n    bColor = b.color;\n  } else {\n    // Raw annotations\n    [aName, aColor] = [a[0], a[3]];\n    [bName, bColor] = [b[0], b[3]];\n  }\n\n  if ('initRank' in a === false) {\n    // Rank red (searched gene) highest\n    if (aColor === 'red') return -1;\n    if (bColor === 'red') return 1;\n\n    // Rank purple (interacting gene) above pink (paralogous gene)\n    if (aColor === 'purple' && bColor === 'pink') return -1;\n    if (bColor === 'purple' && aColor === 'pink') return 1;\n  }\n\n  return a.rank - b.rank;\n\n  // return sortGeneNames(aName, bName);\n}\n\nfunction mergeDescriptions(annot, desc, ideo) {\n  let mergedDesc;\n  const descriptions = ideo.annotDescriptions.annots;\n\n  if (annot.name in descriptions) {\n    const otherDesc = descriptions[annot.name];\n    mergedDesc = desc;\n    if (desc.type === otherDesc.type) return;\n    Object.keys(otherDesc).forEach(function(key) {\n      if (key in mergedDesc === false) {\n        mergedDesc[key] = otherDesc[key];\n      }\n    });\n    // Object.assign({}, descriptions[annot.name]);\n    if ('type' in otherDesc && !ideo.tissueCache) {\n      mergedDesc.type += ', ' + otherDesc.type;\n      mergedDesc.description += `<br/><br/>${otherDesc.description}`;\n    }\n  } else {\n    mergedDesc = desc;\n  }\n\n  ideo.annotDescriptions.annots[annot.name] = mergedDesc;\n}\n\n/** Combines paralogs and interacting gene, if name matches */\nfunction mergeAnnots(unmergedAnnots) {\n  const seenAnnots = {};\n  let mergedAnnots = [];\n\n  unmergedAnnots.forEach((annot) => {\n    if (annot.name in seenAnnots === false) {\n      mergedAnnots.push(annot);\n      seenAnnots[annot.name] = 1;\n    } else {\n      if (annot.color === 'purple') {\n        mergedAnnots = mergedAnnots.map((mergedAnnot) => {\n          return (annot.name === mergedAnnot.name) ? annot : mergedAnnot;\n        });\n      }\n    }\n  });\n\n  return mergedAnnots;\n}\n\n/**\n * Prevents bug when showing gene leads instantly on page load,\n * then hovering over an annotation, as in e.g.\n * https://eweitz.github.io/ideogram/gene-leads\n */\nfunction waitForTissueCache(geneNames, ideo, n) {\n  setTimeout(() => {\n    if (n < 40) { // 40 * 50 ms = 2 s\n      if (!ideo.tissueCache) {\n        waitForTissueCache(geneNames, ideo, n + 1);\n      } else {\n        setTissueExpressions(geneNames, ideo);\n      }\n    }\n  }, 50);\n}\n\nasync function setTissueExpressions(geneNames, ideo) {\n  if (\n    !ideo.tissueCache\n    // || !(annot.name in ideo.tissueCache.byteRangesByName)\n  ) {\n    waitForTissueCache(geneNames, ideo, 0);\n    return;\n  }\n\n  const tissueExpressionsByGene = {};\n  const cache = ideo.tissueCache;\n\n  const promises = [];\n  geneNames.forEach(async gene => {\n    const promise = new Promise(async (resolve) => {\n      const tissueExpressions = await cache.getTissueExpressions(gene, ideo);\n      tissueExpressionsByGene[gene] = tissueExpressions;\n      resolve();\n    });\n    promises.push(promise);\n  });\n\n  await Promise.all(promises);\n\n  ideo.tissueExpressionsByGene = tissueExpressionsByGene;\n}\n\nfunction onBeforeDrawAnnots() {\n  const ideo = this;\n  setRelatedAnnotDomIds(ideo);\n\n  const geneNames = [];\n\n  // Handle differential expression extension\n  const chrAnnots = ideo.annots;\n  for (let i = 0; i < chrAnnots.length; i++) {\n    const annots = chrAnnots[i].annots;\n\n    for (let j = 0; j < annots.length; j++) {\n      const annot = annots[j];\n\n      geneNames.push(annot.name);\n\n      if (ideo.config.colorMap && annot.differentialExpression?.length) {\n        const colorMap = ideo.config.colorMap;\n        const group = annot.differentialExpression[0].group;\n        annot.color = colorMap[group];\n        ideo.annots[i].annots[j] = annot;\n      }\n    }\n  }\n\n  setTissueExpressions(geneNames, ideo);\n}\n\nfunction filterAndDrawAnnots(annots, ideo) {\n  annots = applyAnnotsIncludeList(annots, ideo);\n  ideo.drawAnnots(annots);\n}\n\n/** Filter, sort, draw annots.  Move legend. */\nfunction finishPlotRelatedGenes(type, ideo) {\n\n  let annots = ideo.relatedAnnots;\n\n  if (annots.length > 1 && ideo.onFindGenesCallback) {\n    ideo.onFindGenesCallback();\n  }\n\n  annots = mergeAnnots(annots);\n\n  filterAndDrawAnnots(annots, ideo);\n\n  if (ideo.config.showAnnotLabels) {\n    const sortedAnnots = ideo.flattenAnnots().sort((a, b) => {\n      return ideo.annotSortFunction(a, b);\n    });\n    ideo.fillAnnotLabels(sortedAnnots);\n  }\n\n  moveLegend(ideo);\n\n  analyzePlotTimes(type, ideo);\n}\n\n/** Fetch position of searched gene, return corresponding annotation */\nasync function processSearchedGene(geneSymbol, ideo) {\n  const t0 = performance.now();\n\n  const data = await fetchGenes(geneSymbol, 'symbol', ideo);\n\n  if (data.hits.length === 0) {\n    return;\n  }\n  const gene = data.hits.find(hit => {\n    const genomicPos = getGenomicPos(hit, ideo); // omits alt loci\n    return genomicPos && genomicPos.ensemblgene;\n  });\n  const ensemblId = gene.genomic_pos.ensemblgene;\n\n  // Assign tooltip content.  Much of the content is often retrieved from\n  // the gene cache.  In that case, all fields except `name` are fetched\n  // from cache.  Occasionally, e.g. often upon the very first search, no\n  // content is yet available from cache.\n  let desc = {description: '', ensemblId, type: 'searched gene'};\n  if (gene.symbol in ideo.annotDescriptions.annots) {\n    // Most content already set via cache.\n    // `name` will be set via non-blocking part of `fetchGenes`.\n    const oldDesc = ideo.annotDescriptions.annots[gene.symbol];\n    desc = Object.assign(oldDesc, desc);\n  } else {\n    // No content has been set yet via cache.  In this case, `gene` already\n    // has all the data needed for the searched gene's tooltip content.\n    desc.name = gene.name;\n  }\n\n  ideo.annotDescriptions.annots[gene.symbol] = desc;\n\n  const annot = parseAnnotFromMgiGene(gene, ideo);\n\n  ideo.relatedAnnots.push(annot);\n\n  ideo.time.rg.searchedGene = timeDiff(t0);\n\n  return annot;\n}\n\nfunction adjustPlaceAndVisibility(ideo) {\n  var ideoContainerDom = document.querySelector(ideo.config.container);\n\n  ideoContainerDom.style.visibility = '';\n  ideoContainerDom.style.position = 'absolute';\n  ideoContainerDom.style.width = '100%';\n\n  var ideoInnerDom = document.querySelector('#_ideogramInnerWrap');\n  ideoInnerDom.style.position = 'relative';\n  ideoInnerDom.style.marginLeft = 'auto';\n  ideoInnerDom.style.marginRight = 'auto';\n  ideoInnerDom.style.overflowY = 'hidden';\n  document.querySelector('#_ideogramMiddleWrap').style.overflowY = 'hidden';\n\n  const legendPad = ideo.config.legendPad;\n\n  if (typeof ideo.didAdjustIdeogramLegend === 'undefined') {\n    // Accounts for moving legend when external content at left or right\n    // is variable upon first rendering plotted genes\n\n    var ideoDom = document.querySelector('#_ideogram');\n    const legendWidth = 160;\n    ideoInnerDom.style.maxWidth =\n      (\n        parseInt(ideoInnerDom.style.maxWidth) +\n        legendWidth +\n        legendPad\n      ) + 'px';\n\n    ideoDom.style.minWidth =\n      (parseInt(ideoDom.style.minWidth) + legendPad) + 'px';\n    ideoDom.style.maxWidth =\n      (parseInt(ideoDom.style.minWidth) + legendPad) + 'px';\n    ideoDom.style.position = 'relative';\n    ideoDom.style.left = legendWidth + 'px';\n\n    ideo.didAdjustIdeogramLegend = true;\n  }\n}\n\n// function sortByPathwayIxn(a, b) {\n//   const aColor = a.color;\n//   const bColor = b.color;\n\n//   // Rank red (searched gene) highest\n//   if (aColor === 'red') return -1;\n//   if (bColor === 'red') return 1;\n\n//   // Rank not grey above grey\n//   if (aColor === 'grey' && bColor !== 'grey') return 1;\n//   if (bColor === 'grey' && aColor !== 'grey') return -1;\n\n//   return a.rank - b.rank;\n// }\n\n// async function fetchPathwayGeneAnnots(searchedGene, pathway, ideo) {\n//   const annots = [];\n\n//   const pathwayIxns =\n//     await fetchPathwayInteractions(searchedGene.name, pathway.id, ideo);\n\n//   const pathwayGenes = Object.keys(pathwayIxns);\n//   const data = await fetchGenes(pathwayGenes, 'symbol', ideo);\n\n//   const ixnColors = {\n//     'Stimulates': 'green',\n//     'Stimulated by': 'green',\n//     'Necessarily stimulates': 'green',\n//     'Necessarily stimulated by': 'green',\n//     'Transcribes / translates': 'brown',\n//     'Transcribed / translated by': 'brown',\n//     'Inhibits': 'red',\n//     'Inhibited by': 'red',\n//     'Modifies': 'blue',\n//     'Modified by': 'blue',\n//     'Acts on': 'blue',\n//     'Acted on by': 'blue',\n//     'Catalyzes': 'orange',\n//     'Catalyzed by': 'orange',\n//     'Converts': 'orange',\n//     'Converted by': 'orange',\n//     'Binds': 'black',\n//     'Shares pathway with': 'grey'\n//   };\n\n//   data.hits.forEach(gene => {\n//     // If hit lacks position\n//     // or is same as searched gene (e.g. search for human SRC),\n//     // then skip processing\n//     if (\n//       'genomic_pos' in gene === false ||\n//       gene.symbol === searchedGene.name\n//     ) {\n//       return;\n//     }\n\n//     // Account for edge case: cyclic AMP (cAMP) is not \"CAMP\" gene\n//     if (gene.symbol === 'cAMP') return;\n\n//     const summary = pathwayIxns[gene.symbol];\n//     const color = ixnColors[summary];\n//     // if (color !== 'blue') console.log(gene);\n\n//     const annot = parseAnnotFromMgiGene(gene, ideo, color);\n//     annots.push(annot);\n\n//     const descriptionObj =\n//       describePathwayGene(gene, searchedGene, pathway, summary);\n\n//     mergeDescriptions(annot, descriptionObj, ideo);\n//   });\n\n//   ideo.annotSortFunction = sortByPathwayIxn;\n\n//   const sortedAnnots = annots.sort(sortByPathwayIxn).slice(0, 40);\n\n//   return sortedAnnots;\n// }\n\n// /**\n//  *\n//  */\n// async function plotPathwayGenes(searchedGene, pathway, ideo) {\n//   const headerTitle = 'Genes in pathway';\n//   initAnnotDescriptions(ideo, headerTitle);\n\n//   legendPathwayName = pathway.name;\n//   ideo.config.legend = pathwayLegend;\n//   writeLegend(ideo);\n//   moveLegend(ideo);\n\n//   ideo.relatedAnnots = [];\n\n//   await processSearchedGene(searchedGene.name, ideo);\n\n//   const annots = await fetchPathwayGeneAnnots(searchedGene, pathway, ideo);\n//   ideo.relatedAnnots.push(...annots);\n//   finishPlotRelatedGenes('pathway', ideo);\n// }\n\nfunction initAnnotDescriptions(ideo, headerTitle) {\n  const organism = ideo.getScientificName(ideo.config.taxid);\n  const version = Ideogram.version;\n  const headers = [\n    `# ${headerTitle}`,\n    `# Organism: ${organism}`,\n    `# Generated by Ideogram.js version ${version}, https://github.com/eweitz/ideogram`,\n    `# Generated at ${window.location.href}`\n  ].join('\\n');\n\n  delete ideo.annotDescriptions;\n  ideo.annotDescriptions = {headers, annots: {}};\n\n}\n\n/**\n * For given gene, finds and draws interacting genes and paralogs\n *\n * @param geneSymbol {String} Gene symbol, e.g. RAD51\n */\nasync function plotRelatedGenes(geneSymbol=null) {\n\n  const ideo = this;\n\n  if (!geneSymbol) {\n    return plotGeneHints(ideo);\n  }\n\n  ideo.clearAnnotLabels();\n  const legend = document.querySelector('#_ideogramLegend');\n  if (legend) legend.remove();\n\n  ideo.config = setRelatedDecorPad(ideo.config);\n\n  initAnnotDescriptions(ideo, `Related genes for ${geneSymbol}`);\n\n  const ideoSel = ideo.selector;\n  const annotSel = ideoSel + ' .annot';\n  document.querySelectorAll(annotSel).forEach(el => el.remove());\n\n  ideo.startHideAnnotTooltipTimeout();\n\n  // Refine style\n  document.querySelectorAll('.chromosome').forEach(chromosome => {\n    chromosome.style.cursor = '';\n  });\n\n  adjustPlaceAndVisibility(ideo);\n\n  ideo.relatedAnnots = [];\n  ideo.neighborhoodAnnots = [];\n\n  // Fetch positon of searched gene\n  const annot = await processSearchedGene(geneSymbol, ideo);\n\n  if (typeof annot === 'undefined') throwGeneNotFound(geneSymbol, ideo);\n\n  ideo.config.legend = relatedLegend;\n  writeLegend(ideo);\n  moveLegend(ideo);\n\n  await Promise.all([\n    processInteractions(annot, ideo),\n    processParalogs(annot, ideo)\n  ]);\n\n  ideo.time.rg.total = timeDiff(ideo.time.rg.t0);\n\n  analyzeRelatedGenes(ideo);\n\n  if (ideo.onPlotFoundGenesCallback) ideo.onPlotFoundGenesCallback();\n}\n\nfunction getAnnotByName(annotName, ideo) {\n  var annotByName;\n  ideo.annots.forEach(annotsByChr => {\n    annotsByChr.annots.forEach(annot => {\n      if (annotName === annot.name) {\n        annotByName = annot;\n      }\n    });\n  });\n\n  if (annotByName === null) {\n    annotByName = ideo.annotDescriptions.annots[annotName];\n  }\n  return annotByName;\n}\n\n/**\n * Manage click on pathway links in annotation tooltips\n */\n// function managePathwayClickHandlers(searchedGene, ideo) {\n//   setTimeout(function() {\n//     const pathways = document.querySelectorAll('.ideo-pathway-link');\n//     if (pathways.length > 0 && !ideo.addedPathwayClickHandler) {\n//       pathways.forEach(pathway => {\n//         // pathway.removeEventListener('click', handlePathwayClick);\n//         pathway.addEventListener('click', function(event) {\n//           const target = event.target;\n//           const pathwayId = target.getAttribute('data-pathway-id');\n//           const pathwayName = target.getAttribute('data-pathway-name');\n//           const pathway = {id: pathwayId, name: pathwayName};\n//           plotPathwayGenes(searchedGene, pathway, ideo);\n//         });\n//       });\n\n//       // Ensures handler isn't added redundantly.  This is used because\n//       // addEventListener options like {once: true} don't suffice\n//       // ideo.addedPathwayClickHandler = true;\n//     }\n//   }, 100);\n// }\n\n/** Move tooltip mass to vertical center of viewport */\nfunction centralizeTooltipPosition() {\n  const tooltip = document.querySelector('#_ideogramTooltip');\n  const tooltipTop = tooltip.getBoundingClientRect().top;\n  const ideoDom = document.querySelector('#_ideogram');\n  const ideogramTop = ideoDom.getBoundingClientRect().top;\n  if (tooltipTop > ideogramTop) {\n    tooltip.style.top = ideogramTop + 'px';\n  }\n}\n\nfunction onDidShowAnnotTooltip() {\n  const ideo = this;\n  if (ideo.tissueCache) {\n    centralizeTooltipPosition();\n  }\n  handleTooltipClick(ideo);\n  addGeneStructureListeners(ideo);\n  addTissueListeners(ideo);\n  ideo.tissueTippy =\n    tippy('._ideoGeneTissues[data-tippy-content]', getTippyConfig());\n}\n\n/**\n * Handles click within annotation tooltip\n *\n * Makes clicking link in tooltip behave same as clicking annotation\n */\nexport function handleTooltipClick(ideo) {\n  // const tooltip = document.querySelector('._ideogramTooltip');\n  // if (!ideo.addedTooltipClickHandler) {\n  //   tooltip.addEventListener('click', () => {\n  //     const geneDom = document.querySelector('#ideo-related-gene');\n  //     const annotName = geneDom.textContent;\n  //     const annot = getAnnotByName(annotName, ideo);\n  //     ideo.onClickAnnot(annot);\n  //   });\n\n  //   // Ensures handler isn't added redundantly.  This is used because\n  //   // addEventListener options like {once: true} don't suffice\n  //   ideo.addedTooltipClickHandler = true;\n  // }\n\n  const tooltip = document.querySelector('._ideogramTooltip');\n  if (!ideo.addedTooltipClickHandler) {\n    tooltip.addEventListener('click', (event) => {\n      if (['input', 'label'].includes(event.target.localName)) {\n        return;\n      }\n\n      let geneDom = document.querySelector('#ideo-related-gene');\n      if (!geneDom) {\n        geneDom = event.target;\n      }\n      const annotName = geneDom.textContent;\n      const annot = getAnnotByName(annotName, ideo);\n\n      ideo.onClickAnnot(annot);\n    });\n\n    // const ixnLinkToggler = document.querySelector('#_ideoIxnLinkToggler');\n    // if (ixnLinkToggler) {\n    //   ixnLinkToggler.addEventListener('click', (event) => {\n    //     const isOpen = !ixnLinkToggler.classList.contains('closed');\n    //     const newToggleClass = isOpen ? 'closed' : '';\n    //     if (isOpen) {\n    //       ixnLinkToggler\n    //     } else {\n\n    //     }\n    //   });\n    // }\n\n    // Ensures handler isn't added redundantly.  This is used because\n    // addEventListener options like {once: true} don't suffice\n    ideo.addedTooltipClickHandler = true;\n  }\n}\n\n/** Return searched gene from annotation descriptions in Ideogram object */\nfunction getSearchedFromDescriptions(ideo) {\n  return (\n    Object.entries(ideo.annotDescriptions.annots)\n      .find(([k, v]) => v.type === 'searched gene')[0]\n  );\n}\n\nfunction decorateInteractingGene(annot, descObj, ideo) {\n  if ('type' in descObj && descObj.type.includes('interacting gene')) {\n    const pathwayIds = descObj.pathwayIds;\n    // Get symbol of the searched gene, e.g. \"PTEN\"\n    const searchedGene = getSearchedFromDescriptions(ideo);\n\n    const gpmls = ideo.gpmlsByInteractingGene[annot.name];\n\n    const summary =\n      summarizeInteractions(annot.name, searchedGene, pathwayIds, gpmls);\n    if (summary !== null) {\n      const oldSummary = 'Interacts with';\n      descObj.description =\n        descObj.description.replace(oldSummary, summary);\n    }\n  }\n\n  return descObj;\n}\n\nfunction decorateParalogNeighborhood(annot, descObj, style) {\n  // Rank 1st highest, then put it last as it already has a triangle\n  // annotation, and is often also labeled.\n  const sortedParalogs =\n    descObj.paralogs.sort((a, b) => a.rank - b.rank);\n  // const firstRanked = sortedParalogs.shift(); // Take off first\n  // sortedParalogs.push(firstRanked); // Make it last\n\n  const originalDisplay =\n    'Paralog neighborhood<br/>' +\n    '<br/>' +\n    descObj.description + ':<br/>' +\n    `${sortedParalogs\n      .map(paralog => {\n        let title = '';\n        if (paralog.fullName) title = paralog.fullName;\n        if (paralog.rank) {\n          const rank = paralog.rank;\n          title += ` &#013;Ranked ${rank} in general or scholarly interest`;\n        }\n        if (title !== '') title = `title=\"${title}\"`;\n        return (\n          `<span class=\"ideo-paralog-neighbor\" ${title} style=\"${style}\"'>${\n            paralog.name\n          }</span>`\n        );\n      }).join('<br/>')}` +\n    '<br/>';\n  annot.displayCoordinates = descObj.displayCoordinates;\n\n  return [annot, originalDisplay];\n}\n\n/**\n * Enhance tooltip shown on hovering over gene annotation\n */\nfunction decorateAnnot(annot) {\n  const ideo = this;\n  if (\n    annot.name === ideo.prevClickedAnnot?.name &&\n    ideo.isTooltipCooling\n  ) {\n    // Cancels showing tooltip immediately after clicking gene\n    return null;\n  }\n\n  let descObj = ideo.annotDescriptions.annots[annot.name];\n\n  if (ideo.config.relatedGenesMode === 'related') {\n    descObj = decorateInteractingGene(annot, descObj, ideo);\n  }\n\n  const description =\n    descObj.description.length > 0 ? `<br/>${descObj.description}` : '';\n  const fullName = descObj.name;\n  const style = 'color: #0366d6; cursor: pointer;';\n\n  let fullNameAndRank = fullName;\n  if ('rank' in annot) {\n    const rank = 'Ranked ' + annot.rank + ' in general or scholarly interest';\n    fullNameAndRank = `<span title=\"${rank}\">${fullName}</span>`;\n  }\n\n  let synonym = '';\n  if (descObj?.isSynonym) {\n    const queriedSynonym = descObj.synonym;\n    const synStyle = 'style=\"font-style: italic\"';\n    synonym = `<div ${synStyle}>Synonym: ${queriedSynonym}</div>`;\n    // const synList = ideo.synonymCache.byGene[annot.name];\n    // const litSyns = synList.map(s => {\n    //   // Emphasize (\"highlight\") any synonyms that match the user's query\n    //   if (s.toLowerCase() === queriedSynonym.toLowerCase()) {\n    //     const style =\n    //       'style=\"font-weight: bold; text-decoration: underline\"';\n    //     return `<span ${style}>${s}</span>`;\n    //   }\n    //   return s;\n    // });\n    // const synText = 'Synonyms: ' + litSyns.join(', ') + '<br/>';\n    // const synStyle =\n    //   'style=\"max-width: 300px; color: #666;\"'; // Minimum WCAG AA contrast\n    // synonyms = `<div ${synStyle}>${synText}</div>`;\n  }\n\n  const isParalogNeighborhood = annot.name.includes('paralogNeighborhood');\n\n  const geneStructureHtml = getGeneStructureHtml(\n    annot, ideo, isParalogNeighborhood\n  );\n\n  const tissueHtml = getTissueHtml(annot, ideo);\n\n  const geneSymbolAndFullName =\n    `<span id=\"_ideoGeneSymbolAndFullName\">\n      <span id=\"ideo-related-gene\" style=\"${style}\">${annot.name}</span><br/>` +\n      `${fullNameAndRank}<br/>\n    </span>`;\n\n  let originalDisplay =\n    geneSymbolAndFullName +\n    synonym +\n    description +\n    tissueHtml +\n    geneStructureHtml;\n\n  if (isParalogNeighborhood) {\n    [annot, originalDisplay] =\n      decorateParalogNeighborhood(annot, descObj, style);\n  }\n\n  annot.displayName = originalDisplay;\n\n  // managePathwayClickHandlers(annot, ideo);\n\n  return annot;\n}\n\nconst shape = 'triangle';\n\nfunction getLegendName(nameText, legendContent=null) {\n  const legendHeaderStyle =\n    `font-size: 14px; font-weight: bold; font-color: #333;`;\n\n  let content = `<div style=\"${legendHeaderStyle}\">${nameText}</div>`;\n  if (legendContent) content = legendContent;\n  return `\n    <div style=\"position: relative; left: 30px;\">\n      ${content}\n      <i>Click gene to search</i>\n    </div>\n  `;\n}\n\nconst relatedLegend = [{\n  name: getLegendName('Related genes'),\n  nameHeight: 50,\n  rows: [\n    {name: 'Interacting gene', color: 'purple', shape: shape},\n    {name: 'Paralogous gene', color: 'pink', shape: shape},\n    {name: 'Searched gene', color: 'red', shape: shape}\n  ]\n}];\n\nlet legendPathwayName = '';\n\nconst pathwayLegend = [{\n  name: getLegendName('Related genes'),\n  nameHeight: 50,\n  rows: [\n    {name: 'Pathway gene', color: 'blue', shape: shape},\n    {name: 'Searched gene', color: 'red', shape: shape}\n  ]\n}];\n\nconst citedLegend = [{\n  name: getLegendName('Highly cited genes'),\n  nameHeight: 30,\n  rows: []\n}];\n\n/** Sets legendPad for related genes view */\nfunction setRelatedDecorPad(kitConfig) {\n  kitConfig.legendPad = kitConfig.showAnnotLabels ? 70 : 30;\n  return kitConfig;\n}\n\nconst globalKitDefaults = {\n  chrWidth: 9,\n  chrHeight: 100,\n  chrLabelSize: 12,\n  annotationHeight: 7,\n  showFullyBanded: false,\n  rotatable: false,\n  legend: relatedLegend,\n  chrBorderColor: '#333',\n  chrLabelColor: '#333',\n  onBeforeDrawAnnots,\n  onWillShowAnnotTooltip: decorateAnnot,\n  onDidShowAnnotTooltip,\n  showTools: true,\n  showAnnotLabels: true,\n  chrFillColor: {centromere: '#DAAAAA'}\n};\n\n\nfunction plotGeneHints() {\n  const ideo = this;\n\n  if (!ideo || 'annotDescriptions' in ideo) return;\n\n  ideo.annotDescriptions = {annots: {}};\n\n  ideo.flattenAnnots().map((annot) => {\n    let description = [];\n    if ('significance' in annot && annot.significance !== 'n/a') {\n      description.push(annot.significance);\n    }\n    if ('citations' in annot && annot.citations !== undefined) {\n      description.push(annot.citations);\n    }\n    description = description.join('<br/><br/>');\n    ideo.annotDescriptions.annots[annot.name] = {\n      description,\n      name: decodeURIComponent(annot.fullName)\n    };\n  });\n\n  adjustPlaceAndVisibility(ideo);\n  moveLegend(ideo, -60);\n\n  const container = ideo.config.container;\n  document.querySelector(container).style.visibility = '';\n\n  if (ideo.config.showAnnotLabels) {\n    const sortedAnnots = ideo.flattenAnnots().sort((a, b) => {\n      return ideo.annotSortFunction(a, b);\n    });\n    ideo.fillAnnotLabels(sortedAnnots);\n  }\n}\n\n/**\n * Wrapper for Ideogram constructor, with generic \"Related genes\" options\n *\n * This function is made available as a static method on Ideogram.\n *\n * @param {Object} config Ideogram configuration object\n */\nfunction _initRelatedGenes(config, annotsInList) {\n\n  if (config.relatedGenesMode === 'leads') {\n    delete config.onDrawAnnots;\n    delete config.relatedGenesMode;\n  };\n\n  const kitDefaults = Object.assign({\n    showParalogNeighborhoods: true,\n    isLegendInteractive: true,\n    relatedGenesMode: 'related',\n    useCache: true,\n    awaitCache: true\n  }, globalKitDefaults);\n\n  return initSearchIdeogram(kitDefaults, config, annotsInList);\n}\n\n/**\n * Wrapper for Ideogram constructor, with generic \"Gene leads\" options\n *\n * This function is made available as a static method on Ideogram.\n *\n * @param {Object} config Ideogram configuration object\n */\n function _initGeneLeads(config, annotsInList) {\n  delete config.onPlotFoundGenes;\n\n  if (config.legendName) {\n    if (config.legendContent) {\n      citedLegend[0].name = getLegendName(\n        config.legendName, config.legendContent\n      );\n    } else if (config.geneLeadsDE) {\n      // citedLegend[0].name = getLegendName(config.legendName);\n      const content =\n        '<span style=\"font-size: 14px; font-weight: bold; left: 0\">Gene leads</span> from<br/>' +\n        // `<div style=\"margin-top: 10px; padding: 3px 6px; border: 1px solid #4D72AA; border-radius: 3px; color: #3D629A;\">${fileIcon} <span style=\"margin-left: 20px; position: relative; top: -1px;\">Publication</span></div>` +\n        // `<div style=\"margin-top: 5px; margin-bottom: 0px; padding: 3px 6px; border: 1px solid #4D72AA; border-radius: 3px; color: #3D629A;\">${deltaIcon} <span style=\"margin-left: 20px;\">Differential expression</span></div><br/>`;\n        `<div style=\"margin-top: 10px; padding: 3px 6px; font-size: 14px; font-weight: bold; color: #3D629A;\">${fileIcon} <span style=\"margin-left: 20px; position: relative; top: -1px;\">Publication</span></div>` +\n        // `<div style=\"margin-top: 5px; margin-bottom: -5px; font-size: 14px; font-weight: bold; padding: 3px 6px; color: #3D629A;\">${deltaIcon} <span style=\"margin-left: 20px;\">Differential expression</span></div><br/>`;\n        `<div style=\"margin-top: 3px; margin-bottom: -10px; font-size: 14px; padding: 3px 6px;\">${deltaIcon} <span style=\"margin-left: 20px;\">Differential expression</span></div><br/>`;\n        // `<div>Publication</div>` +\n        // `<div>Differential expression</div>`;\n\n      citedLegend[0].name = getLegendName(\n        config.legendName, content\n      );\n    } else {\n      citedLegend[0].name = getLegendName(config.legendName);\n    }\n  }\n\n  config.legend = citedLegend;\n\n  let rawPath, mode;\n  if (config.geneLeadsDE) {\n    mode = 'leads';\n    rawPath = 'annotations/gene_leads.tsv';\n  } else {\n    mode = 'hints';\n    rawPath = 'cache/homo-sapiens-top-genes.tsv';\n  }\n\n  const kitDefaults = Object.assign({\n    relatedGenesMode: mode,\n    chrMargin: -4,\n    // annotationsPath: getDir('cache/homo-sapiens-top-genes.tsv'),\n    annotationsPath: getDir(rawPath),\n    onDrawAnnots: plotGeneHints,\n    useCache: true\n  }, globalKitDefaults);\n\n  return initSearchIdeogram(kitDefaults, config, annotsInList);\n}\n\nfunction initSearchIdeogram(kitDefaults, config, annotsInList) {\n  if (annotsInList !== 'all') {\n    annotsInList = annotsInList.map(name => name.toLowerCase());\n  }\n  config.annotsInList = annotsInList;\n\n  kitDefaults.legendPad = kitDefaults.showAnnotLabels ? 80 : 30;\n\n  if ('onWillShowAnnotTooltip' in config) {\n    const key = 'onWillShowAnnotTooltip';\n    const clientFn = config[key];\n    const defaultFunction = kitDefaults[key];\n    const newFunction = function(annot) {\n      annot = defaultFunction.bind(this)(annot);\n      annot = clientFn.bind(this)(annot);\n      return annot;\n    };\n    kitDefaults[key] = newFunction;\n    delete config[key];\n  }\n\n  if ('onDidShowAnnotTooltip' in config) {\n    const key = 'onDidShowAnnotTooltip';\n    const clientFn = config[key];\n    const defaultFunction = kitDefaults[key];\n    const newFunction = function(annot) {\n      annot = defaultFunction.bind(this)(annot);\n      annot = clientFn.bind(this)(annot);\n      return annot;\n    };\n    kitDefaults[key] = newFunction;\n    delete config[key];\n  }\n\n  if ('onBeforeDrawAnnots' in config) {\n    const key = 'onBeforeDrawAnnots';\n    const clientFn = config[key];\n    const defaultFn = kitDefaults[key];\n    const newFunction = function() {\n      if (defaultFn) defaultFn.bind(this)();\n      clientFn.bind(this)();\n    };\n    kitDefaults[key] = newFunction;\n    delete config[key];\n  }\n\n  if ('onDrawAnnots' in config) {\n    const key = 'onDrawAnnots';\n    const clientFn = config[key];\n    const defaultFn = kitDefaults[key];\n    const newFunction = function() {\n      if (defaultFn) defaultFn.bind(this)();\n      clientFn.bind(this)();\n    };\n    kitDefaults[key] = newFunction;\n    delete config[key];\n  }\n\n  // Override kit defaults if client specifies otherwise\n  const kitConfig = Object.assign(kitDefaults, config);\n\n  const ideogram = new Ideogram(kitConfig);\n\n  // Called upon 1) finding paralogs, and 2) finding interacting genes\n  if (config.onFindGenes) {\n    ideogram.onFindGenesCallback = config.onFindGenes;\n  }\n\n  // Called upon completing last plot, including all related genes\n  if (config.onPlotFoundGenes) {\n    ideogram.onPlotFoundGenesCallback = config.onPlotFoundGenes;\n  }\n\n  // Called upon hovering over a legend entry, e.g. \"Interacting genes\"\n  if (config.onHoverLegend) {\n    ideogram.onHoverLegendCallback = config.onHoverLegend;\n  }\n\n  ideogram.getTooltipAnalytics = getRelatedGenesTooltipAnalytics;\n\n  ideogram.annotSortFunction = sortByRelatedType;\n\n  initAnalyzeRelatedGenes(ideogram);\n\n  return ideogram;\n}\n\nexport {\n  _initGeneLeads, _initRelatedGenes,\n  plotRelatedGenes, getRelatedGenesByType\n};\n","/**\n * @fileoverview Core module of Ideogram.js, links all other modules\n * This file defines the Ideogram class, its constructor method, and its\n * static methods.  All instance methods are defined in other modules.\n *\n */\n\nimport version from './version';\n\nimport {\n  configure, initDrawChromosomes, handleRotateOnClick, onLoad,\n  init, finishInit, writeContainer\n} from './init/init';\n\nimport {\n  onLoadAnnots, onDrawAnnots, processAnnotData, restoreDefaultTracks,\n  updateDisplayedTracks, initAnnotSettings, fetchAnnots, drawAnnots,\n  getHistogramBars, drawHeatmaps, deserializeAnnotsForHeatmap, fillAnnots,\n  drawProcessedAnnots, drawSynteny, startHideAnnotTooltipTimeout,\n  showAnnotTooltip, onWillShowAnnotTooltip, onDidShowAnnotTooltip,\n  setOriginalTrackIndexes,\n  afterRawAnnots, onClickAnnot, downloadAnnotations, addAnnotLabel,\n  removeAnnotLabel, fillAnnotLabels, clearAnnotLabels, flattenAnnots\n  // fadeOutAnnotLabels\n} from './annotations/annotations';\n\nimport {highlight, unhighlight} from './annotations/highlight';\n\nimport {\n  esearch, esummary, elink,\n  getOrganismFromEutils, getTaxids,\n  getAssemblyAndChromosomesFromEutils\n} from './services/services';\n\nimport {\n  drawBandLabels, getBandColorGradients, processBandData,\n  setBandsToShow, hideUnshownBandLabels, drawBandLabelText, drawBandLabelStalk\n} from './bands/bands';\n\nimport {onBrushMove, onBrushEnd, createBrush} from './brush';\nimport {onCursorMove, createClickCursor} from './cursor';\nimport {drawSexChromosomes, setSexChromosomes} from './sex-chromosomes';\nimport {convertBpToPx, convertPxToBp} from './coordinate-converters';\nimport {\n  unpackAnnots, packAnnots, initCrossFilter, filterAnnots\n} from './filter';\n\nimport {\n  assemblyIsAccession, getDataDir, round, onDidRotate, getSvg, d3,\n  getTaxid, getCommonName, getScientificName, fetch as _fetch,\n  isRoman, parseRoman\n} from './lib';\n\nimport {\n  getChromosomeModel, getChromosomePixels\n} from './views/chromosome-model';\n\nimport {\n  appendHomolog, drawChromosome, rotateAndToggleDisplay, setOverflowScroll\n} from './views/draw-chromosomes';\n\nimport {\n  drawChromosomeLabels, rotateChromosomeLabels\n} from './views/chromosome-labels.js';\n\nimport {\n  _initGeneLeads, _initRelatedGenes,\n  plotRelatedGenes, getRelatedGenesByType\n} from './kit/related-genes';\n\nexport default class Ideogram {\n  constructor(config) {\n\n    // Functions from init.js\n    this.configure = configure;\n    this.initDrawChromosomes = initDrawChromosomes;\n    this.onLoad = onLoad;\n    this.handleRotateOnClick = handleRotateOnClick;\n    this.init = init;\n    this.finishInit = finishInit;\n    this.writeContainer = writeContainer;\n\n    // Functions from annotations.js\n    this.onLoadAnnots = onLoadAnnots;\n    this.onDrawAnnots = onDrawAnnots;\n    this.processAnnotData = processAnnotData;\n    this.restoreDefaultTracks = restoreDefaultTracks;\n    this.updateDisplayedTracks = updateDisplayedTracks;\n    this.initAnnotSettings = initAnnotSettings;\n    this.fetchAnnots = fetchAnnots;\n    this.drawAnnots = drawAnnots;\n    this.getHistogramBars = getHistogramBars;\n    this.drawHeatmaps = drawHeatmaps;\n    this.deserializeAnnotsForHeatmap = deserializeAnnotsForHeatmap;\n    this.fillAnnots = fillAnnots;\n    this.drawProcessedAnnots = drawProcessedAnnots;\n    this.drawSynteny = drawSynteny;\n    this.startHideAnnotTooltipTimeout = startHideAnnotTooltipTimeout;\n    this.showAnnotTooltip = showAnnotTooltip;\n    this.onWillShowAnnotTooltip = onWillShowAnnotTooltip;\n    this.onDidShowAnnotTooltip = onDidShowAnnotTooltip;\n    this.onClickAnnot = onClickAnnot;\n    this.setOriginalTrackIndexes = setOriginalTrackIndexes;\n    this.afterRawAnnots = afterRawAnnots;\n    this.downloadAnnotations = downloadAnnotations;\n    this.addAnnotLabel = addAnnotLabel;\n    this.removeAnnotLabel = removeAnnotLabel;\n    // this.fadeOutAnnotLabels = fadeOutAnnotLabels;\n    this.fillAnnotLabels = fillAnnotLabels;\n    this.clearAnnotLabels = clearAnnotLabels;\n    this.flattenAnnots = flattenAnnots;\n\n    this.highlight = highlight;\n    this.unhighlight = unhighlight;\n\n    // Variables and functions from services.js\n    this.esearch = esearch;\n    this.esummary = esummary;\n    this.elink = elink;\n    this.getOrganismFromEutils = getOrganismFromEutils;\n    this.getTaxids = getTaxids;\n    this.getAssemblyAndChromosomesFromEutils =\n      getAssemblyAndChromosomesFromEutils;\n\n    // Functions from bands.js\n    this.drawBandLabels = drawBandLabels;\n    this.getBandColorGradients = getBandColorGradients;\n    this.processBandData = processBandData;\n    this.setBandsToShow = setBandsToShow;\n    this.hideUnshownBandLabels = hideUnshownBandLabels;\n    this.drawBandLabelText = drawBandLabelText;\n    this.drawBandLabelStalk = drawBandLabelStalk;\n\n    // Functions from brush.js\n    this.onBrushMove = onBrushMove;\n    this.onBrushEnd = onBrushEnd;\n    this.createBrush = createBrush;\n\n    // Functions from cursor.js\n    this.createClickCursor = createClickCursor;\n    this.onCursorMove = onCursorMove;\n\n    // Functions from sex-chromosomes.js\n    this.drawSexChromosomes = drawSexChromosomes;\n    this.setSexChromosomes = setSexChromosomes;\n\n    // Functions from coordinate-converters.js\n    this.convertBpToPx = convertBpToPx;\n    this.convertPxToBp = convertPxToBp;\n\n    // Functions from filter.js\n    this.unpackAnnots = unpackAnnots;\n    this.packAnnots = packAnnots;\n    this.initCrossFilter = initCrossFilter;\n    this.filterAnnots = filterAnnots;\n\n    // Functions from lib\n    this.assemblyIsAccession = assemblyIsAccession;\n    this.getDataDir = getDataDir;\n    this.round = round;\n    this.onDidRotate = onDidRotate;\n    this.getSvg = getSvg;\n    this.fetch = _fetch;\n    this.getTaxid = getTaxid;\n    this.getCommonName = getCommonName;\n    this.getScientificName = getScientificName;\n\n    // Functions from views/chromosome-model.js\n    this.getChromosomeModel = getChromosomeModel;\n    this.getChromosomePixels = getChromosomePixels;\n\n    // Functions from views/chromosome-labels.js\n    this.drawChromosomeLabels = drawChromosomeLabels;\n    this.rotateChromosomeLabels = rotateChromosomeLabels;\n\n    // Functions from views/draw-chromosomes.js\n    this.appendHomolog = appendHomolog;\n    this.drawChromosome = drawChromosome;\n    this.rotateAndToggleDisplay = rotateAndToggleDisplay;\n    this.setOverflowScroll = setOverflowScroll;\n\n    this.plotRelatedGenes = plotRelatedGenes;\n    this.getRelatedGenesByType = getRelatedGenesByType;\n\n    this.configure(config);\n  }\n\n  /**\n   * Get the current version of Ideogram.js\n   */\n  static get version() {\n    return version;\n  }\n\n  /**\n  * Enable use of D3 in client apps, via \"d3 = Ideogram.d3\"\n  */\n  static get d3() {\n    return d3;\n  }\n\n  /**\n   * Request data from Ensembl REST API\n   * Docs: https://rest.ensembl.org/\n   *\n   * @param {String} path URL path\n   * @param {Object} body POST body\n   * @param {String} method HTTP method; 'GET' (default) or 'POST'\n   */\n  static async fetchEnsembl(path, body = null, method = 'GET') {\n    const init = {\n      method: method\n    };\n    if (body !== null) init.body = JSON.stringify(body);\n    if (method === 'GET') {\n      // Use HTTP parameter, not header, to avoid needless OPTIONS request\n      const delimiter = path.includes('&') ? '&' : '?';\n      path += delimiter + 'content-type=application/json';\n    } else {\n      // Method is POST, so content-type must be defined in header\n      init.headers = {'Content-Type': 'application/json'};\n    }\n\n    // const random = Math.random();\n    // console.log(random)\n    // if (random < 0.5) {\n    const response = await fetch(`https://rest.ensembl.org${path}`, init);\n    const json = await response.json();\n    return json;\n    // } else {\n    //   // Mock error\n    //   init.headers = {'Content-Type': 'application/json'};\n    //   const response = await fetch('https://httpstat.us/500/cors', init);\n    //   const json = await response.json();\n    //   return json;\n    // }\n  }\n\n  /**\n   * Helper for sortChromosomes().\n   * Gets names and biological types for diverse chromosome variables\n   */\n  static getChrSortNamesAndTypes(a, b) {\n    var chrAName, chrBName,\n      aIsCP, bIsCP, aIsMT, bIsMT, aIsAP, bIsAP, aIsNuclear, bIsNuclear;\n\n    if (typeof a === 'string' || 'chr' in a && 'annots' in a) {\n      // Chromosome data is from either:\n      //    - Ideogram static file cache (e.g. homo-sapiens.json)\n      //    - Ideogram raw annotations\n      chrAName = (typeof a === 'string') ? a : a.chr;\n      chrBName = (typeof b === 'string') ? b : b.chr;\n\n      aIsCP = chrAName === 'CP';\n      bIsCP = chrBName === 'CP';\n      aIsMT = chrAName === 'MT';\n      bIsMT = chrBName === 'MT';\n      aIsAP = chrAName === 'AP';\n      bIsAP = chrBName === 'AP';\n      aIsNuclear = (!aIsCP && !aIsMT && !aIsAP);\n      bIsNuclear = (!bIsCP && !bIsMT && !bIsAP);\n    } else {\n      // Chromosome data is from NCBI E-Utils web API\n      chrAName = a.name;\n      chrBName = b.name;\n\n      aIsCP = a.type === 'chloroplast';\n      bIsCP = b.type === 'chloroplast';\n      aIsMT = a.type === 'mitochondrion';\n      bIsMT = b.type === 'mitochondrion';\n      aIsAP = a.type === 'apicoplast';\n      bIsAP = b.type === 'apicoplast';\n      aIsNuclear = a.type === 'nuclear';\n      bIsNuclear = b.type === 'nuclear';\n    }\n\n    const chrTypes = {\n      aIsNuclear, bIsNuclear, aIsCP, bIsCP, aIsMT, bIsMT, aIsAP, bIsAP\n    };\n\n    return [chrAName, chrBName, chrTypes];\n  }\n\n  /**\n   * Sorts two chromosome objects by type and name\n   * - Nuclear chromosomes come before non-nuclear chromosomes.\n   * - Among nuclear chromosomes, use \"natural sorting\", e.g.\n   *   numbers come before letters\n   * - Among non-nuclear chromosomes, i.e. \"MT\" (mitochondrial DNA) and\n   *   \"CP\" (chromoplast DNA), MT comes first\n   *\n   * @param a Chromosome string or object \"A\"\n   * @param b Chromosome string or object \"B\"\n   * @returns {Number} JavaScript sort order indicator\n   */\n  static sortChromosomes(a, b) {\n\n    let [chrAName, chrBName, chrTypes] =\n      Ideogram.getChrSortNamesAndTypes(a, b);\n\n    const {\n      aIsNuclear, bIsNuclear, aIsCP, bIsCP, aIsMT, bIsMT, aIsAP, bIsAP\n    } = chrTypes;\n\n    if (aIsNuclear && bIsNuclear) {\n\n      if (isRoman(chrAName) && isRoman(chrBName)) {\n        // As in yeast genome\n        chrAName = parseRoman(chrAName).toString();\n        chrBName = parseRoman(chrBName).toString();\n      }\n\n      return chrAName.localeCompare(chrBName, 'en', {numeric: true});\n    } else if (!aIsNuclear && bIsNuclear) {\n      return 1;\n    } else if (aIsMT && bIsCP) {\n      return 1;\n    } else if (aIsCP && bIsMT) {\n      return -1;\n    } else if (!aIsAP && !aIsMT && !aIsCP && (bIsMT || bIsCP || bIsAP)) {\n      return -1;\n    }\n  }\n\n  /**\n   * Wrapper for Ideogram constructor, with generic \"Related genes\" options\n   *\n   * @param {Object} config Ideogram configuration object\n   */\n  static initRelatedGenes(config, annotsInList='all') {\n    return _initRelatedGenes(config, annotsInList);\n  }\n\n\n  /**\n   * Wrapper for Ideogram constructor, with generic \"Gene leads\" options\n   *\n   * @param {Object} config Ideogram configuration object\n  */\n  static initGeneLeads(config, annotsInList='all') {\n    return _initGeneLeads(config, annotsInList);\n  }\n}\n","import Ideogram from './ideogram';\n\n// Enable references to Ideogram when loaded via traditional script tag\nwindow.Ideogram = Ideogram;\n\n// Enable references to Ideogram when imported as an ES6 module\nexport default Ideogram;\n"],"names":["root","factory","exports","module","define","amd","a","i","self","_","e","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","none","selector","this","querySelector","x","Array","from","empty","querySelectorAll","matches","childMatcher","node","find","childFirst","firstElementChild","filter","children","update","length","EnterNode","parent","datum","ownerDocument","namespaceURI","_next","_parent","__data__","bindIndex","group","enter","exit","data","groupLength","dataLength","bindKey","keyValue","nodeByKeyValue","Map","keyValues","has","set","delete","ascending","b","NaN","constructor","appendChild","child","insertBefore","next","xhtml","svg","xlink","xml","xmlns","name","prefix","indexOf","slice","namespaces","space","local","attrRemove","removeAttribute","attrRemoveNS","fullname","removeAttributeNS","attrConstant","setAttribute","attrConstantNS","setAttributeNS","attrFunction","v","apply","arguments","attrFunctionNS","defaultView","document","styleRemove","style","removeProperty","styleConstant","priority","setProperty","styleFunction","styleValue","getPropertyValue","getComputedStyle","propertyRemove","propertyConstant","propertyFunction","classArray","string","trim","split","classList","ClassList","_node","_names","getAttribute","classedAdd","names","list","n","add","classedRemove","remove","classedTrue","classedFalse","classedFunction","textRemove","textContent","textConstant","textFunction","htmlRemove","innerHTML","htmlConstant","htmlFunction","raise","nextSibling","parentNode","lower","previousSibling","firstChild","creatorInherit","uri","documentElement","createElement","createElementNS","creatorFixed","namespace","constantNull","removeChild","selection_cloneShallow","clone","cloneNode","selection_cloneDeep","onRemove","typename","on","__on","j","m","type","removeEventListener","listener","options","onAdd","event","contextListener","addEventListener","push","dispatchEvent","params","window","CustomEvent","createEvent","initEvent","bubbles","cancelable","detail","dispatchConstant","dispatchFunction","join","splice","contains","Selection","groups","parents","_groups","_parents","selection","select","subgroups","subnode","subgroup","selectAll","array","arrayAll","selectorAll","selectChild","match","childFind","selectChildren","childrenFilter","matcher","bind","enterGroup","updateGroup","previous","i0","i1","_enter","_exit","map","sparse","onenter","onupdate","onexit","append","merge","order","Error","groups0","groups1","m0","m1","Math","min","merges","group0","group1","compareDocumentPosition","sort","compare","compareNode","sortgroups","sortgroup","callback","nodes","size","each","attr","getAttributeNS","property","classed","text","html","create","creator","insert","before","deep","t","typenames","parseTypenames","dispatch","iterator","responseBlob","response","ok","status","statusText","blob","input","init","fetch","then","responseArrayBuffer","arrayBuffer","EOL","EOF","QUOTE","NEWLINE","RETURN","objectConverter","columns","Function","JSON","stringify","inferColumns","rows","columnSet","forEach","row","column","pad","width","s","delimiter","reFormat","RegExp","DELIMITER","charCodeAt","parseRows","f","N","I","eof","eol","token","c","replace","preformatBody","formatValue","formatRow","Date","date","year","hours","getUTCHours","minutes","getUTCMinutes","seconds","getUTCSeconds","milliseconds","getUTCMilliseconds","isNaN","getUTCFullYear","getUTCMonth","getUTCDate","formatDate","test","parse","convert","object","customConverter","format","concat","formatBody","formatRows","csv","dsv","csvParse","tsv","tsvParse","responseText","dsvParse","Promise","resolve","reject","image","Image","onerror","onload","src","responseJson","json","parser","DOMParser","parseFromString","noop","Dispatch","types","T","copy","that","args","preventDefault","stopImmediatePropagation","extend","Color","darker","brighter","reI","reN","reP","reHex","reRgbInteger","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","color_formatHex","rgb","formatHex","color_formatRgb","formatRgb","color","l","toLowerCase","exec","parseInt","rgbn","Rgb","rgba","hsla","g","opacity","rgb_formatHex","hex","rgb_formatRgb","clampa","clampi","max","round","toString","h","Hsl","hslConvert","clamph","clampt","hsl2rgb","m2","basis","t1","v0","v1","v2","v3","t2","t3","channels","assign","displayable","formatHex8","formatHsl","k","pow","clamp","nogamma","linear","rgbGamma","y","exponential","gamma","start","end","rgbSpline","spline","colors","genericArray","nb","na","setTime","values","floor","reA","reB","source","am","bm","bs","bi","lastIndex","q","index","number","one","zero","ArrayBuffer","isView","DataView","isArray","valueOf","arraylike","sourceEvent","currentTarget","ownerSVGElement","createSVGPoint","point","clientX","clientY","matrixTransform","getScreenCTM","inverse","getBoundingClientRect","rect","left","clientLeft","top","clientTop","pageX","pageY","context","taskHead","taskTail","timeout","interval","pokeDelay","clockLast","clockNow","clockSkew","clock","performance","now","setFrame","requestAnimationFrame","setTimeout","clearNow","Timer","_call","_time","timer","delay","time","restart","wake","timerFlush","t0","Infinity","sleep","nap","poke","clearTimeout","clearInterval","setInterval","elapsed","stop","TypeError","emptyOn","emptyTween","CREATED","STARTING","STARTED","ENDING","ENDED","id","timing","schedules","__transition","tween","state","tick","duration","ease","schedule","active","svgNode","degrees","PI","identity","translateX","translateY","rotate","skewX","scaleX","scaleY","sqrt","atan2","atan","interpolateTransform","pxComma","pxParen","degParen","pop","xa","ya","xb","yb","translate","scale","interpolateTransformCss","DOMMatrix","WebKitCSSMatrix","isIdentity","decompose","interpolateTransformSvg","transform","baseVal","consolidate","matrix","tweenRemove","tween0","tween1","tweenFunction","tweenValue","transition","_id","interpolate","value1","string00","interpolate0","string1","string0","string10","attrTweenNS","attrInterpolateNS","_value","attrTween","attrInterpolate","delayFunction","delayConstant","durationFunction","durationConstant","Transition","_name","newId","selection_prototype","inherit","id0","id1","on0","on1","sit","every","onFunction","styleTween","styleNull","listener0","styleMaybeRemove","styleInterpolate","textTween","textInterpolate","removeFunction","easeConstant","easeVarying","cancel","interrupt","defaultTiming","BrushEvent","target","mode","defineProperties","configurable","MODE_DRAG","MODE_SPACE","MODE_HANDLE","MODE_CENTER","abs","number1","number2","X","handles","output","xy","Y","XY","cursors","overlay","w","nw","ne","se","sw","flipX","flipY","signsX","signsY","defaultFilter","ctrlKey","button","defaultExtent","hasAttribute","viewBox","height","defaultTouchable","navigator","maxTouchPoints","__brush","brushSelection","dim","brushX","brushY","touchending","extent","touchable","keys","listeners","handleSize","brush","initialize","handle","redraw","started","touchmoved","touchended","emitter","clean","emit","Emitter","touches","w0","w1","n0","n1","e0","e1","s0","s1","moving","lockX","lockY","metaKey","altKey","signX","signY","W","E","S","dx","dy","shifting","shiftKey","points","identifier","pointer","point0","beforestart","pts","move","moved","ended","view","keyCode","noevent","__noselect","MozUserSelect","p","changedTouches","cur","noclick","selection0","selection1","clear","starting","keyModifiers","formatDecimalParts","toExponential","coefficient","prefixExponent","re","formatSpecifier","specifier","FormatSpecifier","fill","align","sign","symbol","comma","precision","exponent","toFixed","toLocaleString","toPrecision","formatRounded","toUpperCase","formatPrefix","prefixes","locale","grouping","thousands","Number","substring","reverse","currencyPrefix","currency","currencySuffix","decimal","numerals","formatNumerals","String","percent","minus","nan","newFormat","formatTypes","suffix","formatType","maybeSuffix","valuePrefix","valueSuffix","valueNegative","out","formatTrim","padding","defaultLocale","step","e10","e5","e2","tickIncrement","count","power","log","LN10","error","descending","bisector","compare1","compare2","delta","lo","hi","mid","center","right","ascendingBisect","bisectRight","unit","normalize","bimap","domain","range","d0","d1","r0","r1","polymap","bisect","initRange","linearish","ticks","isFinite","tickFormat","step0","step1","tickStep","precisionPrefix","precisionRound","precisionFixed","nice","prestep","maxIter","ceil","organismMetadata","commonName","scientificName","assemblies","default","GRCh38","GRCh37","NCBI36","hasGeneCache","hasParalogCache","hasInteractionCache","hasGeneStructureCache","hasProteinCache","hasSynonymCache","hasTissueCache","GRCm39","GRCm38","MGSCv37","TAIR10","R64","GCA_000002765","d3","d3fetch","d3brush","d3dispatch","d3format","assemblyIsAccession","config","assembly","getDir","dir","script","tmp","ideogramInLeaf","scripts","version","Ideogram","location","pathname","includes","fetchWithRetry","url","isRetry","getDataDir","coord","onDidRotate","chrModel","onDidRotateCallback","getSvg","fetchWithAuth","contentType","headers","Headers","accessToken","Authorization","getTaxid","organism","taxid","organisms","slug","getCommonName","getScientificName","camel","str","camelCaseString","isRoman","parseRoman","val","M","D","C","L","V","reduce","aa","getFont","ideo","family","fontFamily","weight","fontWeight","annotLabelSize","getTextSize","font","canvas","getContext","metrics","measureText","actualBoundingBoxRight","actualBoundingBoxLeft","actualBoundingBoxAscent","actualBoundingBoxDescent","hexToRgb","result","componentToHex","ensureContrast","bgColor","rgbColorToHex","bgRgb","rgb1","rgb2","lum1","luminance","lum2","scaleLinear","untransform","unknown","piecewise","rescale","invert","rangeRound","u","transformer","valueof","RED","GREEN","BLUE","GAMMA","adjustBrightness","brightness","br","getTippyConfig","theme","allowHTML","popperOptions","modifiers","onShow","tippyNode","staticColors","configuredCss","configure","chromosomesArray","coordinateSystem","maxLength","bp","iscn","chromosomes","numChromosomes","debug","dataDir","container","resolution","orientation","showChromosomeLabels","showNonNuclearChromosomes","chromosomeScale","showTools","ploidy","sexChromosomes","sex","ancestors","P","ploidyDesc","configurePloidy","showBandLabels","showFullyBanded","bandsToShow","bandData","configureBands","chrHeight","configureHeight","chrWidth","configureWidth","geometry","chrMargin","configureMargin","onLoad","onLoadCallback","onLoadAnnots","onLoadAnnotsCallback","onBeforeDrawAnnots","onBeforeDrawAnnotsCallback","onDrawAnnots","onDrawAnnotsCallback","onBrushMove","onBrushMoveCallback","onBrushEnd","onBrushEndCallback","onCursorMove","onCursorMoveCallback","onWillShowAnnotTooltip","onWillShowAnnotTooltipCallback","onDidShowAnnotTooltip","onDidShowAnnotTooltipCallback","onClickAnnot","onClickAnnotCallback","configureCallbacks","organismsWithBands","configureOrganisms","bump","adjustedBump","configureBump","chromosome","rotatable","configureSingleChromosome","chrLabelSize","chrLabelColor","configureTextStyle","initAnnotSettings","annotationsLayout","annotTracksHeight","chrSets","yOffsets","annotLabelHeight","demarcateCollinearChromosomes","prevChr","prevWidth","seenTaxids","getYOffsets","chrSet","chrLabelX","adjustedX","orgIndex","taxids","labelSpan","labelGenomes","rearrangeChromosomes","multiorganism","maxHeight","xOffsets","annotHeight","annotationHeight","numAnnotTracks","getXOffsets","adjustedY","chrLabelY","org","maxWidth","collinearizeVerticalChromosomes","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","_a","fl","revfl","_b","fd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","flt","fdt","bits","bits16","slc","BYTES_PER_ELEMENT","subarray","ec","err","ind","msg","nt","code","captureStackTrace","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","pos","bt","lm","dm","lbt","dbt","tbts","flrm","fdrm","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","et","gzs","flg","zs","gzl","zlv","decompressSync","gunzipSync","inflateSync","unzlibSync","td","TextDecoder","decode","stream","dutf8","fromCharCode","strFromU8","latin1","queueMicrotask","errorCode","details","super","messageGenerator","async","request","originalResponse","rangeHeader","boundaries","normalizedRangeHeader","startsWith","rangeParts","parseRangeHeader","originalBlob","effectiveBoundaries","blobSize","effectiveStart","effectiveEnd","calculateEffectiveBoundaries","slicedBlob","slicedBlobSize","slicedResponse","Response","getCacheUrl","orgName","cacheDir","cacheType","fileType","getFullId","slimId","fullNumLength","padStart","getServiceWorkerCache","currentIdeogram","caches","open","cacheFetch","cache","ideoCache","createPartialResponse","decompressedUrl","rawResponse","contentLength","decompressedResponse","Blob","put","cacheRangeFetch","byteRange","rangeStart","rangeEnd","Request","fullResponse","partialResponse","deserializeSubparts","rawSubparts","subpartKeys","subparts","rawSubpart","subpart","parseMetainformationHeader","line","splitHead","metaHeader","entry","splitEntry","deserializeProtein","rawProtein","domainKeys","domains","rawDomain","parseTissueKeys","rawTissuesString","tissueNames","tissueColors","tissueSamples","getTissueExpressions","gene","tissueCache","byteRangesByName","cacheUrl","tissueExpressions","rawExpressions","rawValues","numValues","tissueId","boxMetrics","expression","parseFloat","q1","median","q3","quantiles","tissue","samples","allCacheProps","metadata","fn","parsedCache","interestingNames","nameCaseMap","namesById","fullNamesById","idsByName","lociByName","lociById","geneCache","parseFn","rawTsv","perfTimes","preAnnots","tissueIdsByName","ensemblPrefix","lines","rawTsvSplit","rawStart","rawLength","slimEnsemblId","rawFullName","tissueIds","fullName","decodeURIComponent","ensemblId","locus","processedTissueIds","splitTissueIds","parseCacheLoop","parseAnnots","paralog","paralogsByName","paralogCache","geneSlimId","paralogs","paralogSuperList","geneId","unshift","slimEnsemblIds","interaction","interactionsByName","interactionCache","extension","rawJson","desluggedOrg","ixnLists","compressedIxn","slimPwId","fields","species","geneStructure","featuresByGene","geneStructureCache","biotypeKeys","splitLine","biotypeCompressed","strand","feature","biotype","protein","proteinCache","refTxBaseNum","transcriptName","splitTxName","txNum","synonym","synonymCache","byGene","synonyms","parsedTissueKeys","cacheFactory","cacheName","cacheProps","startTime","getEarlyTaxid","parseOrgMetadata","cacheProp","supportsCache","staticProp","fetchStartTime","fetchEndTime","path","rawOffset","offset","offsetEnd","fetchByteRangesByName","parseCache","fetchAndParse","console","timeEnd","total","preamble","processAnnots","rawAnnots","setOriginalTrackIndexes","annotationsDisplayedTracks","annots","updateDisplayedTracks","processAnnotData","filterable","initCrossFilter","drawProcessedAnnots","finishInit","t0A","getTime","confAnnots","annotations","initDrawChromosomes","annotationsPath","checkAnnotData","waitForAndProcessAnnots","chrID","t0C","t1C","hideUnshownBandLabels","rotateChromosomeLabels","drawChromosomeLabels","processLabels","createBrush","cursorPosition","createClickCursor","drawAnnots","afterRawAnnots","t1A","reportDebugTimings","setOverflowScroll","collinearizeChromosomes","useCache","awaitCache","cachePromise","all","showGeneStructureInTooltip","initCaches","Ploidy","_config","_description","_normalize","getChromosomesNumber","setIndex","chrSetCode","description","descValue","normalized","existence","_getexistenceArray","getSetSize","chrSetIndex","getAncestor","chrIndex","exists","armIndex","desc","ChromosomeUtil","getLabel","getSetLabel","_ideo","_ploidy","_translate","chrSetMargin","_tickSize","_isRotated","_getLeftMargin","margin","_getYScale","getChromosomeLabels","chrElement","util","labels","getChromosomeBandLabelTranslate","band","tickSize","px","didRotate","chrName","bands","oldWidth","chrSetElement","getChromosomeModel","drawChromosome","handleRotateOnClick","displayedTrackIndexes","drawBandLabels","otherChrs","ideoBounds","labelSelectors","chrHeightOriginal","chrWidthOriginal","annotationHeightOriginal","rotateBack","_layout","rotateForward","elementLength","windowLength","_class","innerWidth","innerHeight","getChromosomeLabelClass","_getAdditionalOffset","numTracks","annotationsNumTracks","_getChromosomeSetSize","getChromosomeSetLabelAnchor","getChromosomeLabelYPosition","getChromosomeSetLabelYPosition","Layout","getChromosomeScale","getChromosomeScaleBack","getChromosomeSetTranslate","getHeight","getWidth","getChromosomeBandTickY1","getChromosomeBandTickY2","getChromosomeSetLabelTranslate","getChromosomeBandLabelAnchor","ideoBox","chrBox","getChromosomeSetYTranslate","barWidth","legendPad","prevTranslate","getChromosomeSetLabelXPosition","getChromosomeLabelXPosition","xOffset","lastSetOffset","setSize","chromosomeSetYTranslate","chrs","numChrs","chrsPerRow","yOffset","additionalPadding","handleEscape","tooltip","writeContainer","fetchAnnots","setPloidy","perspective","PairedLayout","SmallLayout","VerticalLayout","HorizontalLayout","getLayout","svgClass","getContainerSvgClass","getBandColorGradients","writeContainerDom","isOnlyIdeogram","writeTooltipContainer","lastBandDataUrl","getBandUrl","bandDataFileNames","isHeterogameticChromosome","prepareChromosomes","bandsArray","setCoordinateSystem","chrBands","chr","setSexChromosomes","_gotChrModels","element","rotateAndToggleDisplay","getBandFileName","accession","bandFileName","getBandFileNames","bandFileNames","isCustomOrganism","prepareContainer","bandDataUrl","hasNonGenBankAssembly","shouldFetchBands","numBandDataResponses","rawBands","fileNames","fetchedTaxid","fileName","setBandData","fetchBands","processBandData","ideoNext","ideoQueued","ideoWait","containerId","getOrganismFromEutils","getTaxids","initializeTaxids","organismScientificName","promises","taxidsAndBandsArrays","taxidAndBandsArray","getBandsAndPrepareContainer","BedParser","bed","parseBed","static","parseGenomicCoordinates","ucscStyle","parseAnnotFromTsvLine","tsvLine","annot","label","rgbToHex","parseRawAnnots","bedStartIndex","tsvLines","TsvParser","parseTsv","innerKeysByField","customHeaders","keySplit","field","custom","customValues","customHeader","innerKeys","customValue","innerObj","innerValues","innerKey","innerValue","reservedTrackKeys","defaultHeatmapColors","getLabels","heatmaps","trackLabels","inflateThresholds","thresholds","heatmapThresholds","shouldUseThresholdColor","numThresholds","prevThreshold","threshold","getHeatmapAnnotColor","thresholdList","tvNum","thresholdColor","writeCanvases","chrLeft","trackLeft","trackWidth","contextArray","fillCanvasAnnots","demarcateChrs","trackIndex","fillStyle","startPx","fillRect","fillCanvasAnnotValues","ideoMarginTop","add2dAnnotsForChr","omittedAnnots","annotsByChr","ra","stopPx","convertBpToPx","shift","startHideTrackLabelTimeout","showTrackLabel","hideTrackLabelTimeout","ideoHeight","drawHeatmaps","annotContainers","prevX","xBump","showChromosomesLabels","labelContainer","markBump","renderTrackLabels","writeTrackLabels","drawHeatmapsCollinear","writeCanvas","drawHeatmaps2d","writeTrackLabelContainer","trackCanvas","firstTrackId","trackBox","labelBox","getTrackLabelOffsets","getNewRawAnnots","heatmapKeyIndexes","newRa","newRas","deserializeAnnotsForHeatmap","rawAnnotsContainer","newRaContainers","heatmapKey","rawAnnotBoxes","raContainer","getNewRawAnnotContainers","reportPerformance","hideAnnotTooltip","startHideAnnotTooltipTimeout","showAnnotTooltip","hideMs","oneTimeDelayTooltipHideMs","hideAnnotTooltipTimeout","isTooltipCooling","hideAnnotTooltipCounter","prevClickedAnnot","content","cx","cy","prevTooltipAnnotName","includeLength","displayCoordinates","num","item","digits","getCoarseBpLength","displayName","getContentAndYOffset","renderTooltip","getAnnotDomLabelId","domId","changeAnnotState","labelId","annotId","triggerAnnotEvent","annotElement","parentElement","prevTooltipOff","prevTooltipAnnotDomId","_ideoActiveTimeout","getAnnotByName","annotName","found","thisAnnot","getAnnotLabelLayout","annotDom","annotRect","ideoRect","bottom","addAnnotLabel","backgroundColor","borderColor","layout","didSetLabelStyle","insertAdjacentHTML","renderLabel","fillAnnotLabels","sortedAnnots","numLabels","deepCopy","clearAnnotLabels","spacedAnnots","spacedLayouts","flattenAnnots","some","xOverlap","oLeft","nLeft","oRight","nRight","getIsXOverlap","yOverlap","oTop","nTop","oBottom","nBottom","getIsYOverlap","relatedGenesMode","annotSortFunction","removeAnnotLabel","getHistogramBars","chrModels","bars","isFirstGet","histogramScaling","setIdeoHistogramScaling","maxAnnotsPerBar","lastBand","numBins","bar","convertPxToBp","annotationsColor","getRawBars","chrAnnots","barAnnots","barPx","nextBarPx","assignAnnotsToBars","maxAnnotsPerBarAllChrs","barCount","setIdeoMaxAnnotsPerBar","barCountRatio","ideoIsRotated","setProportionalBarHeight","reportGetHistogramBarPerformance","legendStyle","getIcon","icon","shape","getListItems","nameHeight","lineHeight","getLineHeight","writeLegend","legend","nameStyle","lineHeightCss","friendlyAnnots","keep","isOtherLayout","rawAnnot","parseFriendlyAnnots","parseFriendlyKeys","processedAnnots","annotsOther","chrAnnot","numAnnots","warn","warnIfTooManyAnnots","filledAnnots","getChrAnnotNodes","fillAnnots","shapes","triangle","circle","rectangle","getShapes","determineShape","writeTrackAnnots","x1","x2","writeOverlayAnnots","chrWidths","y1","y2","thisChrWidth","getHistogramPoints","writeHistogramAnnots","drawAnnotsByLayoutType","writeSyntenicRegion","syntenies","regionID","activeRegion","others","writeSyntenicRegionPolygons","syntenicRegion","r2","regions","writeSyntenicRegionPolygonsHorizontal","getRegionsR1AndR2","r1Offset","r2Offset","r1ChrDom","r1GenomeHorizontalXOffset","getCTM","r1GenomeVerticalXOffset","r2ChrDom","r2GenomeHorizontalXOffset","r2GenomeVerticalXOffset","writeSyntenicRegionLines","stroke","writeSyntenicRegionLabels","regionId","rangeIds","r1Width","drawSynteny","syntenicRegions","writeSyntenicRegions","drawSyntenyCollinear","drawSyntenyCollinearHorizontal","restoreDefaultTracks","trackIndexes","displayedRawAnnotsByChr","displayedAnnots","getDisplayedRawAnnotsByChr","setAnnotsByChr","setAnnots","trackIndexOriginal","numAvailTracks","getSetAnnotsByChr","colorMap","addAnnot","annotationTracks","annotTrack","addClientAnnot","addSparseServerAnnot","addBasicClientAnnot","getAnnotDomId","annotIndex","addAnnotsForChr","shouldAssignDomId","setAnnotRanks","warnOfUndefinedChromosome","addAnnots","unorderedAnnots","orderAnnotContainers","numOmittedTracks","sendTrackAndAnnotWarnings","ExpressionMatrixParser","setRawAnnots","fetchCoordinates","coordinates","parseExpressionMatrix","ensemblData","expressions","cells","downloadAnnotations","annotDescriptions","annotsTsv","annotsHref","encodeURIComponent","evt","MouseEvent","body","initAnnotHeight","localAnnotationsPath","initNumTracksAndBarWidth","initTooltip","onWillAddAnnotLabel","onWillAddAnnotLabelCallback","initAnnotLabel","sortChromosomes","displayedTracks","inflateHeatmaps","seen","duplicates","detectDuplicateChrsInRawAnnots","accumulator","annotsUrl","is2dHeatmap","alert","validateAnnotsUrl","rawAnnotsResponse","chrArray","ranks","rank","initRank","highlight","chrNames","highlightsHtml","chrId","chrDom","unhighlight","highlightsSelector","apiKey","eutils","esearch","esummary","elink","getTaxidFromEutils","taxonomySearch","esearchresult","idlist","commonname","setAssemblyAndChromosomes","originalChrs","filteredChrs","urlOrg","getAssemblyAndChromosomesFromEutils","chromosomesUrl","promise2","catch","errorMessage","chrData","splitBand","asmAndChrTaxidsArray","seenChrs","setTaxidData","asmChrTaxidsArray","isOrganismSupported","ideoOrg","getTaxidsForOrganismsInConfig","tmpChrs","chrsOrgSlugs","orgs","promise","getTaxidFromEutilsPromises","augmentedOrganismMetadata","orgNameAndTaxid","warning","customMetadata","populateNonNativeOrg","orgMetadata","orgFields","prepareTmpChrsAndTaxids","asmAccs","asmAndChrPromises","configOrganisms","sortedTaxids","sortTaxidsByOriginalOrganismOption","taxidInit","getIsMultiorganism","getTaxidsForOrganismsNotInConfig","parseChromosome","genome","cnIndex","subtype","subname","parseMitochondrion","parseChloroplastOrPlastid","parseApicoplast","substr","parseNuclear","getChrNameAndType","slen","assemblyAccession","asmSearchUrl","termStem","getAssemblySearchUrl","asmUid","asmSummaryUrl","fetchAssemblySummary","uids","qs","webenv","linksets","getESearchUrlForChromosomes","esearchUrl","ids","ntSummary","fetchNucleotideSummary","results","seenChrId","parseChromosomes","rejectedReason","getPrevRight","prevLabelXRight","prevHiddenBoxIndex","textOffsets","updateShown","indexesToShow","overlapRight","prevRight","isBefore","hiddenIndex","doSkip","getIndexesToShow","offsets","textsLength","setBandsToShow","selectorsToShow","ithLength","drawBandLabelText","bandsToLabel","drawBandLabelStalk","getChrModels","getStainAndColors","gradients","stain","color1","color2","color3","getGradients","updateLines","getStain","getLineObject","shouldSkipBand","chrsAreList","chrNotInList","thisChr","getBandsArray","bandsByChr","chrLength","setChromosomesByTaxid","chrBandsArray","updateChromosomes","getDelimiterTsvLinesAndInit","parseBands","setChrsByTaxidsWithBands","to","chrLengthBp","bpDomain","pxRange","nameSplit","fromToSplit","refineGenomicCoordinates","cm","getChrModel","getBasePairDomainAndPixelRange","xScale","selectedRegion","setBrush","setSelectedRegion","x0","writeBrush","position","cursorBrush","setCursorPosition","newPosition","offsetX","setCursor","drawSexChromosomes","sexChromosomeIndexes","sciLength","sci","homologIndex","appendHomolog","sexChrs","iscnStart","iscnLength","bpStart","bpStop","bpLength","pxStart","pxLength","getPx","throwBpToPxError","getBp","iscnStop","pxStop","throwPxToBpError","array8","arrayUntyped","array16","array32","arrayLengthen","arrayLengthenUntyped","arrayWiden","arrayWidenUntyped","bitarray","subarrays","masks","lengthen","len","dest","truncate","zeroExcept","zeroExceptMask","mask","only","onlyExcept","onlyOffset","onlyOne","heap_by","heap","sift","by","heapselect_by","queue","bisect_by","reg","REMOVED_INDEX","crossfilter","heapselect","permute","filters","predicate","newIndex","removed","usePred","shouldRemove","index1","index2","filterListeners","removeDataListeners","index3","index4","triggerOnChange","dimension","iterable","accessorPath","newValues","iterablesIndexCount","iterablesIndexFilterStatus","refilterFunction","filterValue","filterValuePresent","filterAll","filterRange","filterFunction","filterExact","currentFilter","hasCurrentFilter","top_offset","hi0","toSkip","lo0","iterablesEmptyRows","bottom_offset","groupAll","orderNatural","dispose","accessor","sortRange","cr_range","A","B","refilter","indexListeners","dimensionGroups","dataListeners","preAdd","postAdd","removeData","newData","newIterablesIndexCount","newIterablesIndexFilterStatus","cr_index","unsortedIndex","sortMap","bounds","lo1","hi1","old_n0","oldValues","oldIndex","oldIterablesIndexFilterStatus","oldiiclength","index5","reIndex","oldDataIndex","filterIndexBounds","filterIndexFunction","added","valueIndexAdded","valueIndexRemoved","newAdded","newRemoved","indexLength","reduceCount","reduceSum","groupIndex","reduceAdd","reduceRemove","reduceInitial","n0old","groupWidth","groupCapacity","capacity","reset","resetNeeded","g0","oldGroups","initial","k0","groupIncrement","updateMany","resetMany","updateOne","resetOne","oldK","seenGroups","filterOne","filterOffset","notFilter","reduceValue","allFiltered","ignore_dimensions","maskForDimensions","onChange","cb","callbacks","isElementFiltered","dimensions","eventName","unpackAnnots","unpackedAnnots","packAnnots","facet","annotsByFacet","facets","filterAnnots","filterSelections","filteredAnnots","selections","counts","getFilteredResults","getChromosomePixels","hasBands","csLength","cs","pcenIndex","getPixelAndOtherData","getChrScale","getChrModelScaffold","fullChromosomeLabels","centromerePosition","firstBand","smallLength","getCentromerePosition","deleteExtraneousBands","gearIcon","deactivate","items","closeTools","display","handleToolClick","toolHeaders","toolHeader","trigger","getTrigger","tool","panel","getPanel","toElement","toId","panelElement","handleHideForHoverables","ideoSvg","canvasId","ideoSvgClone","getElementById","ctx","setTransform","imageSmoothingEnabled","XMLSerializer","serializeToString","domUrl","URL","webkitURL","img","svgBlob","createObjectURL","imgUrl","drawImage","revokeObjectURL","toDataURL","downloadPng","closeButton","initTools","toolsHtml","elements","outsideClickListener","clickedOutsideCount","removeClickListener","hideOnClickOutside","handleGearClick","gear","showGearOnIdeogramHover","ModelAdapter","model","_model","ModelNoBandsAdapter","getModel","getCssClass","isMT","getArmColor","armColors","_getPolyploidArmColor","getBorderColor","chrBorderColor","getFillColor","chrFillColor","arm","centromere","ancestor","Range","_data","getColor","_getColor","Chromosome","adapter","_adapter","_color","_bumpCoefficient","TelocentricPChromosome","TelocentricQChromosome","MetacentricChromosome","_addPArmShape","clipPath","isPArmRendered","_getPArmShape","_addQArmShape","isQArmRendered","_getQArmShape","render","isFullyBanded","centromereFill","_renderArm","_renderRangeSet","fillColor","class","strokeWidth","rangeSet","rangesContainer","_getShapeData","firstQBand","rightTerminalPosition","x3","x2b","_renderBands","Boolean","_pArmOffset","_qArmOffset","homologOffset","defs","getInstance","numChrsInSet","chrSetSelector","ideoWidth","ideoInnerWrap","ideoMiddleWrap","ploidyPad","textElement","getChrSetLabelLines","fullLabels","renderChromosomeSetLabel","appendChromosomeSetLabels","appendChromosomeLabels","labelPosAttrs","scaleSvg","getLabelPositionAttrs","chrMargin2","updateChrIndex","rotateVerticalChromosomeLabels","tracksHeight","rotateHorizontalChromosomeLabels","getWindow","isElement","Element","isHTMLElement","HTMLElement","isShadowRoot","ShadowRoot","getUAString","uaData","userAgentData","brands","brand","userAgent","isLayoutViewport","includeScale","isFixedStrategy","clientRect","offsetWidth","offsetHeight","visualViewport","addVisualOffsets","offsetLeft","offsetTop","getWindowScroll","win","scrollLeft","pageXOffset","scrollTop","pageYOffset","getNodeName","nodeName","getDocumentElement","getWindowScrollBarX","isScrollParent","_getComputedStyle","overflow","overflowX","overflowY","getCompositeRect","elementOrVirtualElement","offsetParent","isFixed","isOffsetParentAnElement","offsetParentIsScaled","isElementScaled","scroll","getLayoutRect","getParentNode","assignedSlot","host","getScrollParent","listScrollParents","_element$ownerDocumen","scrollParent","isBody","updatedList","isTableElement","getTrueOffsetParent","getOffsetParent","isFirefox","currentNode","css","contain","willChange","getContainingBlock","auto","basePlacements","viewport","popper","variationPlacements","acc","placement","modifierPhases","visited","Set","modifier","requires","requiresIfExists","dep","depModifier","DEFAULT_OPTIONS","strategy","areValidElements","_len","_key","popperGenerator","generatorOptions","_generatorOptions","_generatorOptions$def","defaultModifiers","_generatorOptions$def2","defaultOptions","reference","pending","orderedModifiers","modifiersData","attributes","styles","effectCleanupFns","isDestroyed","instance","setOptions","setOptionsAction","cleanupModifierEffects","scrollParents","contextElement","merged","phase","orderModifiers","current","existing","enabled","_ref3","_ref3$options","effect","cleanupFn","forceUpdate","_state$elements","rects","_state$orderedModifie","_state$orderedModifie2","_options","destroy","onFirstUpdate","passive","getBasePlacement","getVariation","getMainAxisFromPlacement","computeOffsets","_ref","basePlacement","variation","commonX","commonY","mainAxis","unsetSides","mapToStyles","_ref2","_Object$assign2","popperRect","gpuAcceleration","adaptive","roundOffsets","_offsets$x","_offsets$y","hasX","hasY","sideX","sideY","heightProp","widthProp","_Object$assign","commonStyles","_ref4","dpr","devicePixelRatio","roundOffsetsByDPR","initialStyles","arrow","attribute","_options$offset","invertDistance","skidding","distance","distanceAndSkiddingToXY","_data$state$placement","popperOffsets","hash","getOppositePlacement","matched","getOppositeVariationPlacement","rootNode","getRootNode","isSameNode","rectToClientRect","getClientRectFromMixedType","clippingParent","clientWidth","clientHeight","layoutViewport","getViewportRect","getInnerBoundingClientRect","winScroll","scrollWidth","scrollHeight","direction","getDocumentRect","mergePaddingObject","paddingObject","expandToHashMap","hashMap","detectOverflow","_options$placement","_options$strategy","_options$boundary","boundary","_options$rootBoundary","rootBoundary","_options$elementConte","elementContext","_options$altBoundary","altBoundary","_options$padding","altContext","clippingClientRect","mainClippingParents","clippingParents","clipperElement","getClippingParents","firstClippingParent","clippingRect","accRect","getClippingRect","referenceClientRect","popperClientRect","elementClientRect","overflowOffsets","offsetData","multiply","axis","_skip","_options$mainAxis","checkMainAxis","_options$altAxis","altAxis","checkAltAxis","specifiedFallbackPlacements","fallbackPlacements","_options$flipVariatio","flipVariations","allowedAutoPlacements","preferredPlacement","oppositePlacement","getExpandedFallbackPlacements","placements","_options$allowedAutoP","allowedPlacements","overflows","computeAutoPlacement","referenceRect","checksMap","makeFallbackChecks","firstFittingPlacement","_basePlacement","isStartVariation","isVertical","mainVariationSide","altVariationSide","checks","check","_loop","_i","fittingPlacement","within","_options$tether","tether","_options$tetherOffset","tetherOffset","isBasePlacement","tetherOffsetValue","normalizedTetherOffsetValue","offsetModifierState","_offsetModifierState$","mainSide","altSide","additive","minLen","maxLen","arrowElement","arrowRect","arrowPaddingObject","arrowPaddingMin","arrowPaddingMax","arrowLen","minOffset","maxOffset","arrowOffsetParent","clientOffset","offsetModifierValue","tetherMax","preventedOffset","_offsetModifierState$2","_mainSide","_altSide","_offset","_min","_max","isOriginSide","_offsetModifierValue","_tetherMin","_tetherMax","_preventedOffset","withinMaxClamp","_state$modifiersData$","toPaddingObject","minProp","maxProp","endDiff","startDiff","clientSize","centerToReference","axisProp","centerOffset","_options$element","getSideOffsets","preventedOffsets","isAnySideFullyClipped","side","_options$scroll","_options$resize","resize","_ref5","_options$gpuAccelerat","_options$adaptive","_options$roundOffsets","preventOverflow","referenceOverflow","popperAltOverflow","referenceClippingOffsets","popperEscapeOffsets","isReferenceHidden","hasPopperEscaped","CONTENT_CLASS","BACKDROP_CLASS","ARROW_CLASS","SVG_ARROW_CLASS","TOUCH_OPTIONS","capture","TIPPY_DEFAULT_APPEND_TO","getValueAtIndexOrReturn","defaultValue","invokeWithArgsOrReturn","ms","arg","normalizeToArray","pushIfUnique","arr","arrayFrom","removeUndefinedProps","div","setTransitionDuration","els","el","transitionDuration","setVisibilityState","updateTransitionEndListener","box","action","method","actualContains","_target$getRootNode","currentInput","isTouch","lastMouseMoveTime","onDocumentTouchStart","onDocumentMouseMove","onWindowBlur","activeElement","_tippy","isReferenceElement","blur","isVisible","isIE11","msCrypto","defaultProps","appendTo","aria","expanded","getReferenceClientRect","hideOnClick","ignoreAttributes","interactive","interactiveBorder","interactiveDebounce","moveTransition","onAfterUpdate","onBeforeUpdate","onCreate","onDestroy","onHidden","onHide","onMount","onShown","onTrigger","onUntrigger","onClickOutside","plugins","showOnCreate","touch","triggerTarget","animateFill","followCursor","inlinePositioning","sticky","animation","inertia","role","zIndex","defaultKeys","getExtendedPassedProps","passedProps","pluginProps","plugin","evaluateProps","props","valueAsString","getDataAttributeProps","dangerouslySetInnerHTML","createArrowElement","className","setContent","getChildren","boxChildren","backdrop","onUpdate","prevProps","nextProps","_getChildren","$$tippy","idCounter","mouseMoveListeners","mountedInstances","createTippy","showTimeout","hideTimeout","scheduleHideAnimationFrame","lastTriggerEvent","currentTransitionEndListener","isVisibleFromClick","didHideDueToDocumentMouseDown","didTouchMove","ignoreOnFirstUpdate","debouncedOnMouseMove","onMouseMove","popperInstance","isEnabled","isMounted","isShown","clearDelayTimeouts","cancelAnimationFrame","setProps","partialProps","invokeHook","removeListeners","addListeners","cleanupInteractiveMouseListeners","handleAriaExpandedAttribute","handleStyles","createPopperInstance","getNestedPopperTree","nestedPopper","show","isAlreadyVisible","isDisabled","isTouchAndTouchDisabled","getCurrentTarget","getIsDefaultRenderFn","visibility","addDocumentPress","_getDefaultTemplateCh2","getDefaultTemplateChildren","_instance$popperInsta2","_getDefaultTemplateCh3","_box","_content","handleAriaContentAttribute","onTransitionEnd","onTransitionedIn","hide","isAlreadyHidden","removeDocumentPress","_getDefaultTemplateCh4","onTransitionedOut","unmount","hideWithInteractivity","getDocument","enable","disable","destroyPopperInstance","_props$render","pluginsHooks","hasAriaExpanded","scheduleShow","getNormalizedTouchSettings","getIsCustomTouchBehavior","_instance$props$rende","getDelay","isShow","fromHide","pointerEvents","hook","shouldInvokePropsHook","_instance$props","pluginHooks","currentValue","nextValue","onDocumentPress","actualTarget","composedPath","onTouchMove","onTouchStart","doc","eventType","handler","onMouseLeave","splitBySpaces","onBlurOrFocusOut","_lastTriggerEvent","shouldScheduleClickHide","isEventListenerStopped","wasFocused","isMouseEvent","scheduleHide","isCursorOverReferenceOrPopper","popperTreeData","_instance$popperInsta","popperState","topDistance","bottomDistance","leftDistance","rightDistance","exceedsTop","exceedsBottom","exceedsLeft","exceedsRight","isCursorOutsideInteractiveBorder","relatedTarget","_instance$props2","computedReference","_getNormalizedTouchSe","touchValue","touchDelay","tippy","targets","optionalProps","instances","isNodeList","getArrayOfElements","setDefaultProps","tippyCss","timeDiff","getRelatedGenesByType","relatedGenes","related","paralogous","interacting","searched","entries","getRelatedGenesTooltipAnalytics","timeSincePrevTooltip","prevAnnotDomId","tooltipGene","tooltipRelatedType","countsByType","getCountsByType","numRelatedGenes","numParalogs","numInteractingGenes","searchedGene","greyLine","lightGrey","lightGreyLine","darkGrey","darkGreyLine","redLine","magentaLines","faintRed","faintRedLine","redderFaintRed","redderFaintRedLine","pinkLine","blueLine","lightBlue","lightBlueLine","veryLightBlue","veryLightBlueLine","darkBlue","darkBlueLine","greenLine","darkGreen","darkGreenLine","seafoam","seafoamLine","darkPurple","darkPurpleLine","purpleLine","lightPurple","lightPurpleLine","veryLightPurple","veryLightPurpleLine","ultraLightPurple","ultraLightPurpleLine","darkBrown","darkBrownLine","brownLine","lightBrown","lightBrownLine","orangeLines","darkOrange","darkOrangeLines","lightOrange","lightOrangeLine","orangeBrown","orangeBrownLine","yellowLine","lightYellow","lightYellowLine","lightGreen","lightGreenLine","veryLightGreen","veryLightGreenLine","isTopologyFeature","topologyFeatureMap","getFeatureSvg","cds","isPositiveStrand","hasTopology","featureType","featurePx","isTopology","isSignal","isSignalPeptideFeature","topoAttr","decompressTopologyFeature","featureDigest","issue","lineColor","domainType","endsWith","lengthAa","pipe","cls","baseHeight","addTopBottom","lineStroke","topBorder","bottomBorder","getFeatureBorderLines","utr5","utr3","heights","lineColors","subpartClasses","hoverTip","getFooter","writeFooter","footer","transcriptSummary","updateGeneStructure","structure","selectedIndex","getSelectedStructure","isCanonical","selected","spliceExons","updateHeader","addedSubpartListeners","addHoverListeners","initTippy","getGeneFromStructureName","structureName","menu","numOptions","gs","toggleSpliceByKeyboard","spliceToggle","subpartText","swapUTRsForward","swappedSubparts","utr","hasUtr","prevSubpart","prevIsUtr3","prevIsUtr5","is","shouldSwapBackDOM","nextSubpart","nextIsUtr5","nextIsUtr3","isNotUtr3","isNotUtr5","shouldSwapBackData","removeHighlights","navigateSubparts","domSubparts","isRaw","swapUTRsBack","stopPropagation","mouseEnter","mouseLeave","isLeft","nextIsOutOfSubpartBounds","alt","meta","last","getMenuContainer","updateFooter","addSubpartHoverListener","subpartDOM","originalTooltipFooter","menuContainer","marginTop","addedMenuListeners","inTooltip","screenX","screenY","isMouseEventInTooltip","toggle","updownTips","addGeneStructureListeners","toggler","prelimSubparts","matureSubparts","proteinSvg","addedIntrons","numInserted","subpartEls","prelimSubpart","matureIndex","summary","intronRect","drawIntrons","getSubpartBorderLine","tlbpDOM","prettyLength","getTranscriptLengthBp","innerText","toggleSplice","addSpliceToggleListeners","svgMaybe","tagName","addMenuListeners","tooltipFooter","writeStrandInFooter","getSpliceToggleHoverTitle","getSpliceStateText","titleMod","canonOrAlt","title","nameDOM","toggleDOM","exons","sp","lastSubpart","addPositions","bpPerPx","features","lengthBp","getSubpartSummary","subpartType","numOfTotal","prettyType","splicedSubparts","prevEnd","intronStart","intronLength","spliceIn","prevStart","isSpliceOverlap","prevRawStart","prevRawLength","splicedStart","splicedEnd","splicedSubpart","spliceOut","geneStructureArray","indexBySubpart","totalBySubpart","subpartSvg","sharedStyle","selectedName","structures","menuArrows","tippyPlace","upAttrs","getMenuArrows","getMenu","replaceAll","_ideo$proteinCache$ge","getHasTopology","proteinLengthAa","isEligible","showProteinInTooltip","isEligibleforProteinSvg","startUtr","lastStartUtr","startBp","endUtr","firstEndUtr","stopBp","getCdsCoordinates","topologies","proteinRect","getProteinRect","getProtein","footerDetails","prettyLengthAa","biotypeText","svgHeight","interactionArrowMap","getIxnTypeReference","ixnsByPwid","ixns","ixnType","getMatches","gpml","genes","matchedLabel","textLabel","graphId","groupRef","geneGraphIds","groupSelectors","ggr","geneGroups","groupId","geneGroupGraphIds","fallback","dericheConfig","sigma","negative","Float64Array","bc","a_out","b_out","alpha","of","exp","beta","cos","sin","denom","dericheCausalCoeff","ba","accum_denom","b_causal","b_anticausal","sum_causal","sum_anticausal","dericheConv1d","stride","y_causal","y_anticausal","dericheInitZeroPad","stride_2","stride_3","stride_4","stride_N","sum","off","quantile","density1d","adjust","bins","bandwidth","sd","mean","stdev","nrd","grid","xi","wi","bin1d","neg","estimator","MINI_CURVE_HEIGHT","MINI_CURVE_WIDTH","setPxOffset","maxPx","relative","leftPx","refTissue","maxExpression","teObject","thisMaxExp","getMaxExpression","refMinExp","refTeObject","metric","minExp","maxExp","getMetricLineAttrs","isShifted","isTruncated","metricHeight","isMedian","isNarrowMedian","endStyle","getMetricLine","dash","classMetric","styleAttr","getMetricLines","getCurveShape","numKdeBins","spreadQuantiles","quantileCount","kde","kdeArray","maxKernelY","minKernelX","kdeWidth","pixelsPerKernel","maxRaw","prevPixelX","rawPoints","pixelX","segmentHeight","pixelY","metricX","refinedMax","refinedMin","originPoint","getCurve","getMiniCurveY","getExpressionPlotHtml","moreOrLessToggleHtml","fullDetail","getFullDetail","moreOrLess","showTissuesMore","getMoreOrLessToggle","numTissues","rawName","term","refineTissueName","distributionCurve","offsetsWithHeight","medianLine","dataTissue","containerAttrs","textAttrs","containerStyle","colorTissueText","traceDom","addTissueListeners","plotParent","newPlotHtml","tissueExpressionsByGene","updateTissueExpressionPlot","traces","trace","focusMiniCurve","q1Line","q3Line","metricTicks","medianExp","fontObject","maxText","minTextWidth","minExpTextWidth","minTextX","minExpTextX","minTextEndX","minTickAttrs","medianX","medianExpX","getMetricTicks","ledgeDom","structureDom","addDetailedCurve","removeDetailedCurve","thisTissue","thisTeObject","te","newPoints","newOffsets","medianLineAttrs","parseNameAndEnsemblIdFromMgiGene","genomic_pos","ensemblgene","throwGeneNotFound","geneSymbol","getGeneBySynonym","_ideo$synonymCache","nameLc","geneLc","numFailedFetches","fetchGenes","queryStringBase","hits","isSymbol","locusMap","nameMap","isSynonym","hit","fetchGenesFromCache","fromGeneCache","queryString","fetchMyGeneInfo","message","onLine","requestedThing","numLimit","numFailed","waitMilliseconds","numFailures","baseWaitMs","jitter","random","exponentialBackoffWithJitter","retryFetch","fetchInteractionAnnots","interactions","symbols","parseAnnotFromMgiGene","descriptionObj","pathwayIds","pathwayNames","ixnsDescription","links","ixn","pathwayId","describeInteractions","mergeDescriptions","pathwayIdsByInteractingGene","descObj","gpmlsByInteractingGene","ixnGene","gpmlUrl","rawGpml","fetchGpml","fetchGpmls","drawNeighborhoods","neighborhoodAnnots","applyAnnotsIncludeList","moveLegend","plotParalogNeighborhoods","_ideo$neighborhoodAnn","showParalogNeighborhoods","searchedAnnot","relatedAnnots","neighborhoods","starts","startJInt","overlayAnnotLength","neighborhood","includesSearched","paralogsText","annotStart","annotStop","getGenomicPos","genomicPos","getLegendType","li","lcText","initInteractiveLegend","selectedColor","getLegendEntryColor","showAnnotLabels","highlightByType","onHoverLegendCallback","dehighlight","dehighlightAll","legendType","attrs","tippyConfig","legendTippy","extraPad","ideoInnerDom","setRelatedDecorPad","prepend","annotsInList","includedAnnots","processInteractions","seenNameIds","orgNameSimple","upperGene","uint8Array","rawIxns","sortedRawIxns","sortAnnotsByRank","rawIxn","normRawIxn","nameId","isRelevant","isGeneSymbol","maybeGeneSymbol","isInteractionRelevant","fetchInteractions","finishPlotRelatedGenes","rg","processParalogs","homologs","nameUc","fetchEnsembl","homologies","ensemblIds","homolog","fetchParalogPositionsFromMyGeneInfo","fetchParalogs","sortByRelatedType","aName","bName","aColor","bColor","mergedDesc","descriptions","otherDesc","waitForTissueCache","geneNames","setTissueExpressions","onFindGenesCallback","unmergedAnnots","seenAnnots","mergedAnnots","mergedAnnot","mergeAnnots","filterAndDrawAnnots","otherType","numThisRelated","numOtherRelated","_didRelatedGenesFirstPlot","timestampFirstPlot","totalLastPlotDiff","totalFirstPlot","_relatedGenesFirstPlotType","analyzePlotTimes","adjustPlaceAndVisibility","ideoContainerDom","marginLeft","marginRight","didAdjustIdeogramLegend","ideoDom","legendWidth","minWidth","plotRelatedGenes","plotGeneHints","headerTitle","href","initAnnotDescriptions","annotSel","cursor","oldDesc","processSearchedGene","relatedLegend","timeTotal","timeTotalFirstPlot","timeTotalLastPlotDiff","timeParalogs","timeInteractingGenes","timeSearchedGene","firstPlotType","analytics","relatedGenesAnalytics","analyzeRelatedGenes","onPlotFoundGenesCallback","decorateInteractingGene","getSearchedFromDescriptions","gpmls","interactingGene","searchedGeneGraphIds","interactingGeneGraphIds","ie","matchingGraphIds","graphIds","graphicsXml","graphic","endGraphRefs","numMatchingPoints","isConnectedToSourceGene","searchedGeneIndex","graphRef","arrowHead","isStart","parseInteractionGraphic","detailInteractions","detailAllInteractions","enrichedIxns","isSameByPwid","isSame","isDirectionSameByPwid","isDirectionSame","directionsByPwid","ixnTypeReference","pwid","isRefMatch","thisIsSame","thisIxnTypeReference","determineIxnsInPathwayAreSame","setIsSame","leftTypes","rightTypes","directedTypes","firstIxnType","directionReference","isPwDirectionSame","pwFirstIxnType","pwDirectionReference","summarizeByDirection","summarizeInteractions","oldSummary","getLegendName","nameText","legendContent","citedLegend","kitConfig","globalKitDefaults","updated","sortedChrNames","seenNames","relevanceSortedAnnots","updatedAnnots","setRelatedAnnotDomIds","_annot$differentialEx","differentialExpression","_ideo$prevClickedAnno","_descObj","fullNameAndRank","isParalogNeighborhood","geneStructureHtml","geneStructureSvg","checked","getSpliceToggle","spanClass","getGeneStructureHtml","tissueHtml","getTissueHtml","originalDisplay","sortedParalogs","decorateParalogNeighborhood","tooltipTop","ideogramTop","centralizeTooltipPosition","addedTooltipClickHandler","localName","geneDom","annotByName","handleTooltipClick","tissueTippy","significance","citations","initSearchIdeogram","kitDefaults","clientFn","defaultFunction","newFunction","defaultFn","ideogram","onFindGenes","onPlotFoundGenes","onHoverLegend","getTooltipAnalytics","_fetch","chrAName","chrBName","aIsCP","bIsCP","aIsMT","bIsMT","aIsAP","bIsAP","aIsNuclear","bIsNuclear","chrTypes","getChrSortNamesAndTypes","localeCompare","numeric","isLegendInteractive","_initRelatedGenes","legendName","geneLeadsDE","fileIcon","deltaIcon","rawPath","_initGeneLeads"],"sourceRoot":""}